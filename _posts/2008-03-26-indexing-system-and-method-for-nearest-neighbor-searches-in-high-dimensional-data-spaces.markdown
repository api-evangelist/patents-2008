---

title: Indexing system and method for nearest neighbor searches in high dimensional data spaces
abstract: Vectors representing objects in n-dimensional space are approximated by local polar coordinates on partitioned cells of the data space in response to a query, e.g., a query data vector entered with a request to find “k” nearest neighbors to the query vector. A set of candidate near neighbors is generated using the approximations, with the local polar coordinates being independent of the dimensionality of the data space. Then, an answer set of near neighbors is returned in response to the query. Thus, the present invention acts as a filter to reduce the number of actual data vectors in the data set that must be considered in responding to the query.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07917504&OS=07917504&RS=07917504
owner: International Business Machines Corporation
number: 07917504
owner_city: Armonk
owner_country: US
publication_date: 20080326
---
This is a continuation of U.S. patent application Ser. No. 11 869 189 filed Oct. 9 2007 now U.S. Pat. No. 7 761 472 which is a continuation of Ser. No. 09 512 949 filed Feb. 25 2000 now U.S. Pat. No. 7 318 053 from which priority is claimed.

The present invention relates to methods and systems for indexing objects in high dimensional data spaces to respond to user queries.

Nearest neighbor searching on high dimensional data spaces is essentially a method of searching for objects in a data space that are similar to a user selected object with the user selected object defining a query. For example using the present assignee s QBIC system a user can select a digital image and use the image as a query to a data base for images that are similar to the user selected digital image. In response to the query the k closest images are returned where k is an integer defined by the user or search engine designer. These k images are referred to as the k nearest neighbors to the image that was used as the query and for indexing and search purposes they are typically considered to be multidimensional data points p that are close to a multidimensional data point q representing the query. Other non limiting examples of applications that use nearest neighbor searching include video databases data mining pattern classification and machine learning.

In any case multidimensional indexing methods MIMs have been introduced for indexing multidimensional objects by partitioning the data space clustering data according to the partitioning and using the partitions to prune the search space to promote fast query execution It will readily be appreciated that in the context of large databases that hold a high number of objects the time to execute a query like the one discussed above would be excessive in the absence of MIMs. As recognized by the present invention while effective for low dimensionalities MIMs are not effective and indeed tend toward being counterproductive for objects having high dimensionalities e.g. of ten twenty or more. Image objects for example can have hundreds of dimensions and text documents can have thousands of dimensions.

Weber et al. disclose a filtering method intended to be an improvement over conventional MIMs in A Quantitative Analysis and Performance Study for Similarity Search Methods in High Dimensional Spaces 241998 VA file method . In the VA file method compact approximations of data objects also referred to as vectors are generated and by first scanning the compact approximations a large number of the larger actual vectors can be filtered out such that only a small number of vectors need be examined. In this way query execution time is minimized.

The present invention has recognized however that the VA file method has at least two drawbacks The first is that as the dimensionality of the data objects increases the number of bits used in the approximations also increases significantly to facilitate adequate filtering. This means that the performance of the VA file method like the performance of the above mentioned MIMs degrades significantly when applied to high dimensional data spaces e.g. dimensions over 100 The second drawback with the VA file method is that its filtering capability decreases in the case of clustered data such as multimedia data. The present invention having recognized the above noted deficiencies in the prior art has provided the improvements disclosed below.

The invention is a general purpose computer programmed according to the inventive steps herein The invention can also be embodied as an article of manufacture a machine component that is used by a digital processing apparatus and which tangibly embodies a program of instructions that are executable by the digital processing apparatus to undertake the present invention. This invention is realized in a critical machine component that causes a digital processing apparatus to perform the inventive method steps herein. The invention is also a computer implemented method for undertaking the acts disclosed below.

Accordingly a computer is programmed to undertake method acts for querying for data using a query. The method acts undertaken by the computer include for at least some data vectors in a data space generating respective approximations in polar coordinates. Also the method acts executed by the computer include returning k nearest neighbors to the query based on the approximations.

In a preferred embodiment the method acts executed by the computer further include dividing the data space into plural cells and approximating at least one data point in at least one cell by using polar coordinates with respect to the at least one cell. Accordingly the method is referred to as local polar coordinate based approximation . In a particularly preferred embodiment the data space has d dimensions and a number of b bits to be assigned to each cell is determined. Then the data space is divided into 2cells 

As disclosed in greater detail below each approximation defines a lower bound drain dand an upper bound d and the method acts executed by the computer include generating a candidate set of approximations based on the lower bound dand upper bound dof the approximations. Moreover the query can be represented by a query vector q and the computer adds a first approximation having a first lower bound dto the candidate set if d

In another aspect a computer program product includes a program of instructions that have computer readable code means for generating local polar coordinate based approximations of at least some data vectors p in at least one data set having a dimensionality of d . The local polar coordinates are independent of d . Computer readable code means use the approximations to return k nearest neighbors to a query.

In yet another aspect a computer implemented method is disclosed for finding in a data space k closest data vectors p to a query vector q. The method includes rendering approximations of at least some of the data vectors p using local polar coordinates and filtering the approximations. After filtering the k closest data vectors p are returned.

The details of the present invention both as to its structure and operation can best be understood in reference to the accompanying drawings in which like reference numerals refer to like parts and in which 

Referring initially to a system is shown generally designated that includes a data space server having access to a local or remote software implemented index module . Using an input device a user of a user computer can input a query for data from a database and the server by means of the index module accesses the database and returns the requested data to the user computer for display or storage thereof on an output device such as a monitor . More specifically as set forth further below the user computer sends a query for data essentially using a query vector q with the index module returning the k nearest neighbors referred to herein as the k data vectors p that are closest to q in response. The query vector q can be e.g. an example image for which the user wants close matches. Other applications of k nearest neighbor searching are contemplated herein such as but not limited to document retrieval data mining pattern classification and machine learning.

As intended herein either or both of the server user computer can be a server computer made by International Business Machines Corporation IBM of Armonk N.Y. Other digital processors however may be used such as personal computers laptop computers mainframe computers palmtop computers personal assistants or any other suitable processing apparatus can be used The input device can be established by one or more of a computer mouse keyboards keypads trackballs and voice recognition devices. Output devices other than the monitor can be used such as printers other computers or data storage devices and computer networks.

In any case the processor of the server accesses the module to undertake the logic of the present invention which may be executed by a processor as a series of computer executable instructions. The instructions may be contained on a data storage device with a computer readable medium such as a computer diskette having a computer usable medium with a program of instructions stored thereon Or the instructions may be stored on random access memory RAM of the computer on a DASD array or on magnetic tape conventional hard disk drive electronic read only memory optical storage device or other appropriate data storage device. In an illustrative embodiment of the invention the computer executable instructions may be lines of C or C or Java code.

Indeed the flow charts herein illustrate the structure of the logic of the present invention as embodied in computer program software Those skilled in the art will appreciate that the flow charts illustrate the structures of computer program code elements including logic circuits on an integrated circuit that function according to this invention. Manifestly the invention is practiced in its essential embodiment by a machine component that renders the program code elements in a form that instructs a digital processing apparatus that is a computer to perform a sequence of function steps corresponding to those shown.

The logic of the present starts in at blocks and wherein the data space in the database is divided into 2cells wherein b is an integer number of data points that are assigned to each cell and d is the dimensionality of the database . For illustration purposes shows a two dimensional data space that has been divided into plural cells while illustrates a single three dimensional cell . The use of two and three dimensions in is for simplicity of disclosure only it being understood that the principles set forth herein apply to any high dimensional data spaces.

Moving to block a DO loop is entered such that for each data point an approximation in local polar coordinates is generated at block . As shown in each cell has a local origin O at its bottom left corner and each cell can be represented by its coordinates shown in .

A vector pis generated in local polar coordinates having a radius r from the cell s local origin O to the idata point and an angle between the vector and the bisecting diagonal of the cell. This is illustrated in . As a result each vector p is represented by an approximation a . At block a complete local polar coordinate LPC file is generated which in the preferred embodiment can be an array of approximations a representing vectors p.

As can be appreciated in reference to an approximation is a set of points having radius r and angle within a cell. In the two dimensional illustration shown in the approximation represents two points p and p which have polar coordinates r and which are symmetric with respect to the diagonal . This is in contrast to the above mentioned VA method wherein the approximation would represent the entire cell. In the three dimensional illustration of the approximation is represented by a circle around the diagonal of the cell whereas the above mentioned VA file method would produce an approximation that would consist of the entire cube. Thus it will readily be appreciated that the present method produces more efficient approximations than does the VA file method. In higher dimensions an approximation in the present invention is a set of points on a hypersphere.

Without loss of generality these properties hold for any number of dimensions. In the three dimensional case shown in the point A representing d C representing d the origin O the point B the endpoint of the query vector q and the point D the corner of the cell opposite to the origin O all lie in the same plane.

With the above understanding in mind the logic moves from block to decision diamond wherein for the candidate near neighbor under test it is determined whether the corresponding minimum distance dis greater than the k largest distance k NN q between the query vector q and the data vectors p in an initially null answer set. The distance k NN q is initialized at an appropriate large value. This test can be thought of as a coarse test which if positive leads to the immediate elimination of the candidate at block . The next candidate is retrieved at block and the logic loops back to decision diamond to test the next candidate.

On the other hand if the candidate passes the test at decision diamond indicating that the candidate might be a k nearest neighbor the candidate is added to a candidate set at block . Then the candidate s maximum distance is compared to the k largest distance k NN q at decision diamond and if the candidate s maximum distance is equal to or greater than the k largest distance k NN q the logic loops back to block to retrieve the next candidate for test.

In contrast if the candidate s maximum distance is less than the k largest distance k NN q indicating that the candidate is probably one of the k near neighbors being sought the data vector p that corresponds to the candidate is added to an answer set knn at block The answer set knn can be ordered by distance between the query vector q and each data vector p in the set. Then at block the k largest distance k NN q is potentially recomputed by setting it equal to the k largest distance k NN q corresponding to the kvector p in the answer set.

After the logic of it will be appreciated that all candidate approximations have been tested and most have been eliminated. In other words most data points have been filtered out. Those that remain have been added to the candidate set and the best of the candidates in the candidate set as indicated by having a relatively small d have been added to the answer set. The next stage of the logic is then commenced at block wherein the k largest distance k NN q is set equal to the maximum distance of the p vectors in the answer set knn . Then a DO loop is entered at block wherein the actual data points represented by the candidates in the candidate set are scanned in increasing order of distance. The next candidate is retrieved at block and at decision diamond the distance between the data vector p under test and the query vector q is compared to the k largest distance k NN q . If it is not less than k NN q the logic loops back to block to retrieve the next candidate in the candidate set. On the other hand if the candidate passes the test at decision diamond it is inserted into the answer set knn at block and the k largest distance k NN q is recomputed at block . The next candidate is then retrieved at block for test. Owing to the ordering by distance in the candidate set and answer set the logic can end when the lower bound dof a candidate is encountered which exceeds the k th distance k NN q such that not all candidates in the candidate set need be tested.

While the particular INDEXING SYSTEM AND METHOD FOR NEAREST NEIGHBOR SEARCHES IN HIGH DIMENSIONAL DATA SPACES as herein shown and described in detail is fully capable of attaining the above described objects of the invention it is to be understood that it is the presently preferred embodiment of the present invention and is thus representative of the subject matter which is broadly contemplated by the present invention that the scope of the present invention fully encompasses other embodiments which may become obvious to those skilled in the art and that the scope of the present invention is accordingly to be limited by nothing other than the appended claims in which reference to an element in the singular is not intended to mean one and only one unless explicitly so stated but rather one or more . All structural and functional equivalents to the elements of the above described preferred embodiment that are known or later come to be known to those of ordinary skill in the art are expressly incorporated herein by reference and are intended to be encompassed by the present claims. Moreover it is not necessary for a device or method to address each and every problem sought to be solved by the present invention for it to be encompassed by the present claims. Furthermore no element component or method step in the present disclosure is intended to be dedicated to the public regardless of whether the element component or method step is explicitly recited in the claims. No claim element herein is to be construed under the provisions of 35 U.S.C. 112 sixth paragraph unless the element is expressly recited using the phrase means for or in the case of a method claim the element is recited as a step instead of an act .

