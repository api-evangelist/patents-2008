---

title: Integrating security server policies with optimized routing control
abstract: In one embodiment, a first set of one or more control policies at a control server of a network domain may be transmitted to a routing master controller of the network domain, which uses a second set of one or more traffic policies to determine optimal paths for directing traffic through the domain. The routing master controller may then generate a third set of one or more integrated policies based on the first and second sets of policies, e.g., based on the knowledge and policies of both the control server and the routing master controller.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08023504&OS=08023504&RS=08023504
owner: Cisco Technology, Inc.
number: 08023504
owner_city: San Jose
owner_country: US
publication_date: 20080827
---
The present disclosure relates generally to computer networks and more particularly to integrating policies of devices in the computer network.

A computer network typically comprises one or more nodes interconnected by communication links and segments for transporting data traffic. These nodes such as personal computers servers etc. may interact with one another through one or more intermediate network nodes such as routers. For interaction between multiple network domains e.g. autonomous systems or ASes one or more edge routers may be employed that allow nodes of different domains to communicate. A particular type of edge router for example is an optimized edge router OER which may be used to gather network statistics such as bandwidth delay jitter etc. from communication pathways to help calculate an optimal e.g. best path through which the traffic should travel between the domains e.g. ASes . In particular the edge routers may relay the statistics to a routing master controller RMC of their respective domain which may then use those statistics to determine and enforce the optimal path. For example the optimal path may be determined according to one or more traffic policies such as based on given traffic types destination address prefixes etc. Upon determining the optimal paths the RMC may notify the edge routers and other routers devices of its respective domain of the optimal paths so those routers devices may handle traffic in the network accordingly.

Computer networks may also employ distributed security control services e.g. with a security control server and one or more security control agents to enforce security control policies within the network. For example to ensure secure operation of the network a particular control policy may involve assigning priorities to different types of traffic as well as defining actions to be taken in the event of inter alia a detected threat an attack and or other actions. Generally the security control server may define and distribute the relevant control policies to the one or more agents e.g. acting on nodes of the network which are responsible for locally enforcing the specified control policies on the respective nodes e.g. by taking action such as marking priorities on traffic etc. . Notably the control policies may be further acted upon by routers in the network such as based on the priorities marked on traffic at the agents etc.

There may be occasions however where a particular network may have both a security control server and an RMC in operation. Conventionally there is little or no interaction between the control server and the RMC and as such the RMC typically has no knowledge of the control server s traffic policies and vice versa that is without inefficient and cumbersome manual configuration. Accordingly the RMC would thus be unable to optimize routing paths of the network domain based on those control server traffic policies. Furthermore without collaboration between the control server and the RMC conflicts between each of their policies may arise such as different priority assignments and handling for particular types of traffic etc.

According to embodiments of the disclosure a first set of one or more control policies at a control server of a network domain may be transmitted to a routing master controller of the network domain which uses a second set of one or more traffic policies to determine one or more optimal paths for directing traffic through the domain. The routing master controller may then generate a third set of one or more integrated policies based on the first and second sets of policies e.g. based on the knowledge and policies of both the control server and the routing master controller.

Also according to embodiments of the disclosure the routing master controller may classify one or more traffic classes and associate at least one optimal path with each of the one or more traffic classes based on the third set of integrated policies. The routing master controller may notify one or more routers in the network domain of the at least one optimal path for the traffic classes and the routers may then route traffic based on the traffic class and the associated optimal path i.e. based on the third set of integrated policies that is a combination of both control and traffic policies .

A computer network is a geographically distributed collection of nodes interconnected by communication links and segments for transporting data between end nodes such as personal computers and workstations. Many types of networks are available with the types ranging from local area networks LANs to wide area networks WANs . LANs typically connect the nodes over dedicated private communications links located in the same general physical location such as a building or campus. WANs on the other hand typically connect geographically dispersed nodes over long distance communications links such as common carrier telephone lines optical light paths synchronous optical networks SONET or synchronous digital hierarchy SDH links. The Internet is an example of a WAN that connects disparate networks throughout the world providing global communication between nodes on various networks. The nodes typically communicate over the network by exchanging discrete frames or packets of data according to predefined protocols such as the Transmission Control Protocol Internet Protocol TCP IP . In this context a protocol consists of a set of rules defining how the nodes interact with each other. Computer networks may be further interconnected by an intermediate network node such as a router to extend the effective size of each network.

Since management of interconnected computer networks can prove burdensome smaller groups of computer networks may be maintained as routing domains or autonomous systems. The networks within an autonomous system AS are typically coupled together by conventional intradomain routers configured to execute intradomain routing protocols and are generally subject to a common authority. To improve routing scalability a service provider e.g. an ISP may divide an AS into multiple areas or levels. It may be desirable however to increase the number of nodes capable of exchanging data in this case interdomain routers executing interdomain routing protocols are used to interconnect nodes of the various ASes. Moreover it may be desirable to interconnect various ASes that operate under different administrative domains. As used herein an AS area or level is generally referred to as a domain and a node that interconnects different domains together is generally referred to as an edge node router or border node router .

Data packets e.g. traffic may be exchanged among the nodes devices of the computer network using predefined network communication protocols such as the TCP IP User Datagram Protocol UDP Asynchronous Transfer Mode ATM protocol Frame Relay protocol Internet Packet Exchange IPX protocol etc.

The memory comprises a plurality of storage locations that are addressable by the processor s and the network interfaces for storing software programs and data structures associated with the embodiments described herein. Each processor may comprise necessary elements or logic adapted to execute the software programs and manipulate the data structures such as security server policies table . An operating system e.g. the Internetworking Operating System or IOS of Cisco Systems Inc. portions of which are typically resident in memory and executed by the processor s functionally organizes the security control server by inter alia invoking network operations in support of software processes and or services executing on the device. These software processes and or services may comprise a security server process in accordance with one or more embodiments described herein. It will be apparent to those skilled in the art that other types of processors and memory including various computer readable media may be used to store and execute program instructions pertaining to the inventive technique described herein. Notably an illustrative security control server that may be configured to operate in accordance with the embodiments described herein is a Cisco Security Agent CSA server available from Cisco Systems Inc. 

Security Control server process services contain computer executable instructions that may be executed by each processor to perform functions directed to defining and managing policies e.g. security control policies in the network for which the server is responsible. In particular the server process may distinguish classify traffic based on certain information such as traffic types and traffic classes to which security policies may be assigned. For example traffic type information may generally include whether the traffic is voice data email data backup etc. thus identifying a type of traffic as will be understood by those skilled in the art. In addition traffic class information may generally include more specific classification such as particular types of traffic to from particular sources destinations etc. or even more specifically to particular application data streams e.g. a particular stream of data for an application such as a particular voice call otherwise often referred to by those skilled in the art as a flow .

According to embodiments described herein traffic types classes may be associated for instance with a particular designated marking such that devices within the network may differentiate packets based on the designated markings. For example markings are generally used for basic packet identification as described herein as well as for other purposes such as for detecting and handling particular packets according to defined policies applied to the associate traffic type class. For instance known types of packet markings may include priority values as well as Differentiated Services Code Point DSCP values. Notably while priority and DSCP fields are mentioned markings may be based on any field of the packets such as certain Access Control List ACL fields as will be appreciated by those skilled in the art.

As used herein a policy or treatment is any defined rule that determines the use of resources within the network. A policy may be based on a user a device a subnetwork a network or an application. For example a security control policy may be defined to grant voice traffic higher priority than data traffic. Also security control policies may define a set of hosts as privileged hosts which may have higher priority than other hosts in the network. Another example of security control policies may involve threat detection to detect inter alia various threats attacks or other abnormal behavior. Any threats may then be dropped or sent to a quarantine area for further investigation e.g. firewalls or administrator inspection . Note that the term security control policy is used generally herein to describe policies defined configured at the security control server and is not meant to limit the embodiments described herein to security related policies only such as threat detection etc. As used herein therefore the use of the modifier security control or hereinafter simply control implies policies maintained and managed by the security control server hereinafter control server as opposed to traffic policies maintained and managed by the RMC described below. For instance illustrative control policies may be policies for which an execution trigger is an explicit control plane event and for which the action s does not generally entail the processing of a forwarded data packet. 

Upon defining the control policies the control server may distribute the policies to one or more security control agents within the network such that the agents may act to enforce the control policies accordingly. Notably the communication between the control server and agents may be a proprietary protocol or other known communication protocol e.g. advertisements .

Application processes contain computer executable instructions executed by each processor and operable on the node device in accordance with one or more applications e.g. software programs as will be understood by those skilled in the art. For example such applications may comprise voice calls web access email word processing computer games and or other applications programs that may be configured to operate on the node device . Illustratively applications as used herein may be configured to communicate data traffic over the network . Accordingly a particular application may send a stream or flow of data over the network e.g. an application data stream such as a particular voice call sending a plurality of data voice packets between a particular source e.g. node and a particular destination e.g. in a same or different AS of network .

Security control agent process services contain computer executable instructions executed by each processor to perform functions related to enforcement of control policies in the network. For instance control agent process services may receive control policies and updates from the control server and thus enforce the policies upon incoming and outgoing traffic to from the device agent . In particular the agent process acting on nodes e.g. PCs laptops may be configured to receive control polices from the control server and to store the policies in a control agent policies table . Policies stored in table may then be accessed by the control agent process and applied to incoming outgoing traffic at the node through policy enforcement process .

For example a control agent may have received from a control server a policy to assign a higher priority e.g. priority 0 to voice traffic than to data traffic e.g. priority 1 such that should there be a contention for resources e.g. bandwidth the nodes within the network e.g. routers may enforce the policies by securing the resources available to send receive voice traffic before sending receiving data traffic as will be appreciated by those skilled in the art. Accordingly the control agent process may receive traffic and based on distinguishing features such as indicated traffic type source application etc. may determine a policy classification to which the traffic belongs and may perform the action defined by the policy e.g. adjusting a priority value of the traffic or as described herein inserting a traffic marking e.g. EE EF etc. . Alternatively locally enforced policies may also be defined such as enforcing various queuing techniques at the node prior to transmitting the traffic in to the network e.g. voice before data or blocking traffic received from certain hosts e.g. malicious traffic etc. Again the policies mentioned herein are merely illustrative examples and are not meant to be limiting to the scope of the embodiments described herein. Once the control agents classify and apply associated policies for outgoing traffic the traffic may be transmitted into the network toward its destination e.g. via one or more routers .

Routing process services contain computer executable instructions executed by each processor to perform functions provided by one or more routing protocols such as the Interior Gateway Protocol IGP e.g. Open Shortest Path First OSPF and Intermediate System to Intermediate System IS IS the Border Gateway Protocol BGP etc. as will be understood by those skilled in the art. These functions may be configured to manage routing forwarding information databases e.g. routing table containing for example data used to make routing forwarding decisions. In particular changes in the network topology may be communicated among routers using routing protocols such as the conventional OSPF and IS IS link state protocols e.g. to converge to an identical view of the network topology .

The routing table is a searchable data structure in which network addresses are mapped to their associated routing information. However those skilled in the art will understand that the routing table need not be organized as a table and alternatively may be another type of searchable data structure. Although its routing table may be configured with a predetermined set of routing information the router also may dynamically acquire learn network routing information as it sends and receives data packets. In addition the routing table may be populated by various routing protocols e.g. IGP BGP etc. or other means such as in accordance with OER as described herein. When a packet is received at the router the packet s destination address may be used to identify a routing table entry containing routing information associated with the received packet. Among other things the packet s routing information may indicate the packet s next hop address. Notably routing services may also perform functions related to virtual routing protocols such as maintaining VRF instances not shown or tunneling protocols such as for Multi Protocol Label Switching etc. each as will be understood by those skilled in the art.

Policy enforcement process services contain computer executable instructions that may be executed by each processor to enforce policies e.g. as stored in a policy table . Such policies may include conventional policies known to those skilled in the art for routers of the network such as handling of priority traffic control e.g. shaping dropping etc. and other defined polices that may be illustratively received from an administrator or the routing master controller as described herein. For example policy enforcement process may determine that traffic is designated as having a certain priority and handling the traffic according to policies in place in table corresponding to the classified traffic e.g. queuing higher priority traffic in a high priority queue etc. . As an example while a security agent policy may indicate that a certain host s traffic be granted a particular priority value the routers of the network act on that priority accordingly. 

Certain routers of the network may be configured to operate in conjunction with optimized edge routing OER techniques e.g. as either optimized edge routers e.g. ER and ER or as internal routers A D within the network. Accordingly such routers may comprise appropriate OER processes services that contain computer executable instructions that may be executed by each processor to perform functions related to OER. In particular the OER process executing on the edge routers may monitor of a set of address prefixes e.g. through passive monitoring and or active probing for inter alia network statistics corresponding to the monitored prefixes. For example OER process may monitor delay round trip time RTT data throughput the amount of data transferred or received reachability packet loss mean opinion score MOS bandwidth utilization etc. for each of the monitored prefixes.

Notably while one OER process is illustratively shown in memory it is also possible that the process be distributed in each network interface not shown . In general the OER processes may measure any arbitrary traffic metric including conventional cost based and distance based metrics. Further the OER Process may calculate statistical averages variances medians etc. of a collection of traffic measurements and even send routing updates to other routers of the network . These statistics may then be sent to a routing master controller OER master controller node described below accordingly. Note also that the OER process may be in communication with the routing master controller to receive requests to monitor particular prefixes as well as to receive various other requests commands such as policy updates in accordance with the techniques described herein.

The RMC e.g. master OER controller process services contains computer executable instructions that may be executed by each processor to perform functions related to controlling OER functions in the network . In particular RMC process may incorporate the statistics and measurements received from one or more routers OER processes discussed above and may determine one or more optimal network paths e.g. toward a particular network egress of ER and ER through which traffic should travel that is best exit selection e.g. based on its routing table similar to routing table described above . Such best exit selections may be based on traffic type traffic class destination prefixes etc. as well as their real time performance as determined by the received statistics. Illustratively the best exit selections may be forwarded to edge routers of the network e.g. ER and ER which may propagate routing advertisements to other routers A D within the network accordingly. For instance the RMC process may inform the edge routers how to redistribute traffic by e.g. associating new BGP local preference values with selected traffic or statically changing the routing table contents of the edge nodes. These BGP local preferences or routing table contents are then distributed by the edge routers within the network . Notably the RMC may be distributed among a plurality of nodes and thus need not reside in a single RMC node. Also it is not necessary for a single RMC node to contain routing processes or routing tables other than what is necessary for communication with the border nodes.

Illustratively the RMC may have a policy table that stores OER based policies for use with making OER based decisions e.g. best exit selections . For instance a policy may be defined to route traffic from a type of high speed application e.g. voice calls over an optimal path based on the shortest delay or RTT while other policies may be defined to route low speed applications e.g. email data backup etc. over an optimal path that has the lowest packet loss. In other words through various OER based policies voice traffic from a prefix X destined to prefix Y may utilize a first network egress ER e.g. via a first ISP A while backup traffic from X to Y may utilize a second network egress ER e.g. via a second ISP B based on the performance characteristics of each traffic class as measured over the available paths to meet the policy requirements. Note also that OER policies or traffic policies are used generally herein to describe policies defined configured at the RMC and is not meant to limit the embodiments described herein to OER related policies only such as for best exit selection etc. For instance illustrative traffic policies may be policies for which an execution trigger is the arrival of a data packer and for which the action s constitutes some form of processing of this packet before it is forwarded to another device. 

In particular policy classification field may illustratively be used to store distinguishing information that may be used for classifications e.g. types classes of traffic to which policies may be applied. For instance traffic may be distinguished classified based on certain information such as traffic type information e.g. whether the traffic is voice data email data backup etc. traffic class information e.g. particular types of traffic to from particular sources destinations etc. or even more specifically to particular application data streams e.g. a particular stream of data for an application such as a particular voice call as described herein. Any other distinguishing feature that may be applied to traffic within the network may also be contained within policy classification field e.g. time of day dependent combination policies such as if this AND that etc. and those mentioned herein are merely representative examples. Notably default policy classifications may also be applied such as applying a policy to all traffic as will be appreciated by those skilled in the art.

Also action field may illustratively store appropriate actions responses to be performed on policies of entries in response to traffic s being classified within a particular policy classification . For example depending upon the policy configuration various actions may be performed such as setting altering priority values applying traffic control e.g. shaping dropping queuing etc. defining alternate routes etc. Entries of action field are merely illustrative and may comprise other actions to be taken as will be understood by those skilled in the art.

As noted above there may be occasions where network may have both a control server and an RMC in operation but with little or no interaction. Because of this the RMC typically has no knowledge of the control server s control policies and vice versa that is without inefficient and cumbersome manual configuration. For example the control server may have one or more control policies directed toward sources hosts of the traffic such as assigning higher priority to preferred privileged users than non preferred non privileged users. Conversely the RMC may have other OER traffic policies directed toward differentiating voice traffic as a higher priority than data traffic. Without interaction these policies may conflict in a manner that is contrary to original intentions of the policies. For instance based on this simplified example the non preferred users may have voice traffic sent at a higher priority than data traffic sent by the preferred users which may defeat the purpose of the control policies in the network .

As another example the control agents may be aware of the particular types classes of traffic or more particularly specific streams of traffic to which the control server wishes to apply certain policies. However those policies often become moot within the network e.g. at routers since the routers are often unaware of the classifications type class of the traffic known to the agents and would further be unaware of the actions to be applied to that traffic i.e. the routers have no knowledge of the control policies . For instance a control policy may define certain path criteria for a specific type of traffic e.g. maximum delay values for a specific application but without identifying that specific application or the maximum delay value to the RMC the paths through the network for that type of traffic may not be optimally routed according to the desires of the control server.

In other words as noted above the RMC is generally unable to optimize routing paths of the network domain based on control server traffic policies. Furthermore without collaboration between the control server and the RMC conflicts between each of their policies may arise such as different priority assignments and handling for particular types of traffic etc.

According to embodiments of the disclosure a first set of one or more control policies at a control server of a network domain may be transmitted to an RMC of the network domain which uses a second set of one or more traffic policies to determine one or more optimal paths for directing traffic through the domain. The RMC may then generate a third set of one or more integrated policies based on the first and second sets of policies e.g. based on the knowledge and policies of both the control server and the RMC. Also the RMC may classify one or more traffic classes and associate at least one optimal path with each of the one or more traffic classes based on the third set of integrated policies. The RMC may notify one or more routers in the network domain of the at least one optimal path for the traffic classes and the routers may then route traffic based on the traffic class and the associated optimal path i.e. based on the integrated set of policies .

In particular the embodiments described herein not only combine the control policies and traffic policies for ease of configuration but also provide an advanced level of policy generation and processing. For instance as described further below the control server s knowledge may add value to the generation of policies at the RMC. That is the control server has knowledge of control policies but also other control based or security based knowledge such as the priority of certain hosts in the network etc. For example the control server may define a set of privileged hosts having a higher priority than other hosts in the network. In this manner in times of congestion in the network integrated policies generated by the RMC may use that knowledge to forward traffic through the network in an appropriate manner. In other words if the traffic flow s source or destination address matches the address of the privileged hosts then those traffic streams may be given a higher priority than any other traffic streams e.g. when there is contention for network resources the integrated policies from the RMC ensure that the host with the higher priority is given access to its required network resources .

In addition the control server is aware of certain applications within the network and thus may not only dictate the priority of the hosts and the control policies but may also formulate control policies regarding application performance. For example based on the applications as well as the control server s knowledge of the kind of optimization treatment each traffic class should be given the control server may generate knowledgeable control policies which may be shared with the RMC for dynamic integration into the policies distributed to routers devices of the network accordingly.

Further to policy optimization the control server may be configured to detect a threat attack or other detectable abnormal behavior of traffic flowing through the network. As such the control server may communicate with the RMC requesting that the offending traffic either be dropped at the network edge edge routers ER and or ER or be sent to a quarantine area thus enabling the network to secure itself.

According to one or more embodiments as described herein therefore techniques not only dynamically integrate routing control and performance policies with security control policies for ease of configuration but also add value to the formulation of policies by applying control server knowledge at the RMC . In this manner control server polices configuration and knowledge may be advantageously integrated with RMC optimized network performance and control.

Illustratively one or more embodiments described herein may utilize a policy integration process of RMC in conjunction with control server process of control server e.g. and policy enforcement processes and to allow multiple sets of policies to be integrated into a single set of comprehensive policies. In particular policy integration process contains computer executable instructions that may be executed by each processor to perform functions related to the embodiments described herein for integrating policies such as described above and further below. For example the RMC may use its own set of one or more policies in conjunction with one or more policies from the control server to establish an integrated set of one or more policies by which to route traffic in network . Also the RMC may inform routers e.g. edge routers ER and ER of optimized paths for the traffic which may be derived using both control server policies and RMC policies i.e. the integrated third set of policies in an advantageous manner as described herein.

Operationally according to one or more embodiments described herein a first set of one or more control policies e.g. control server policies is determined at a control server of the network domain as described above. For example control server policies may be based on inter alia host priority traffic class application stream flow etc. Once the control server has a set of one or more control policies a first set of policies the security server may then transmit the control policies to RMC . For example in addition to sending the policies to control agents of the network the control server may be configured to transmit its policies to an RMC of the network e.g. discovered through manual configuration and or dynamic discovery. For instance the RMC may have advertised its functionality within the network such as through various proprietary or standardized advertisement techniques e.g. broadcast IGP messages such that the control server may discover the RMC as may be appreciated by those skilled in the art. Once the control server is aware of the RMC a collaboration message may be sent over the links of the network in accordance with one or more embodiments herein e.g. a directly addressed message from the server to RMC such as e.g. for an application programming interface or API session . Alternatively the message may be advertised within the network without knowledge of the RMC such that the RMC may detect the control server s message and utilize it accordingly e.g. message may be broadcast into the network for receipt by the agents and RMC .

As an illustrative example assume that the following application traffic streams are flowing within network e.g. through ER and ER whose traffic classes may be defined by the control server 

As described above these defined traffic markings may be transmitted from the control server to the one or more control agents in the network . As such the control agents may mark the traffic in response to the control server s defined markings e.g. marking voice traffic with ED etc. . In addition the control server may know corresponding optimization treatments that should be given to each traffic class such as for example 

However without the techniques described above the control agents are substantially powerless to direct traffic within the network according to the defined policies and may simply mark the traffic accordingly and hope for the best . In accordance with one or more embodiments described herein though the control server may have particular knowledge about these one or more significant applications in the network that the RMC may not have been conventionally aware and may share this knowledge accordingly. In other words through message the control server may inform the RMC of the one or more control policies.

Upon receiving the set of one or more policies from the control server the RMC may store the control policies in a corresponding table . Illustratively table is a separate table from OER policies table e.g. populated as described above however in an alternative embodiment tables and may be a shared table not shown that may contain an indication within its entries as to whether the respective policy originated at the RMC or was received from the control server or other device .

In accordance with one or more embodiments described herein the RMC may generate a third set of integrated policies based on the OER traffic policies in table and the control or other policies in table . For instance the integrated policies e.g. stored in table or a combined table as mentioned above may be illustratively derived by combining the first and second sets of policies that is the control and traffic policies. For example if an OER traffic policy indicates that voice traffic be sent over a path having the lowest delay and a control policy indicates that voice traffic be granted a priority value of 1 then a combined integrated policy may state that voice traffic be granted a priority value of 1 AND be sent over a path having the lowest delay. Alternatively the integrated set of policies may simply contain both policies priority 1 and lowest delay path so long as the policies do not conflict i.e. the traffic may be classified under more than one policy classification this more than one corresponding policy action may be performed on the traffic accordingly .

In the event however that policies from the control and traffic policies do conflict in some manner various techniques may be applied to resolve such conflicts. For instance one set of policies may simply override or trump another set such as where the OER traffic policies trump any overlapping polices of the control policies. For example if an OER traffic policy indicates that voice traffic be granted a priority value of 3 and a control policy indicates that voice traffic be granted a priority value of 1 then a combined integrated policy may state that voice traffic be granted a priority value of 3 where the OER traffic policy trumps the control policy. Note that various policies may be combined in any manner possible and any such combination of the two or more sets of policies is contemplated herein to derive the third set of policies. As one example the priority values 1 and 3 may be averaged to 2 as an integrated policy or conversely the highest or lowest priority value may always be selected regardless of the priority value s origin etc. As another example assume that the control server assigns both a certain priority value e.g. 0 the highest to a particular host such as a president of a company and another priority value for all other traffic e.g. 3 while the RMC places a generic priority on voice traffic e.g. 2 . An example integrated policy may be that any traffic from the particular host receive priority 0 all other voice traffic receive priority 2 and all non voice and non particular host traffic receive priority 3 .

Other more complex examples of policy combinations and or conflicts may exist and such combinations conflicts may be resolved in any manner deemed appropriate by a system administrator or other dynamic selection process. Those described herein are merely illustrative examples. For instance further assume that the control server indicates that voice traffic to a destination prefix X be sent over low delay links but the RMC has determined that traffic to destination prefix X should be sent over links with the lowest packet loss. If there is high packet loss when traffic is sent over the lowest delay links to the destination X or high delay when sent over low loss links e.g. as determined by RMC through obtained statistics as described above the policies above conflict. Thus the RMC may resolve the conflicts in any manner deemed appropriate e.g. as mentioned above . Accordingly by resolving the conflicts and providing a single set of integrated policies either through combination overriding merging etc. the techniques described herein may avoid any conflict between dissimilar policies of identically defined traffic classes e.g. all voice traffic between the control server and RMC .

Notably modifications to either the control or OER traffic policies may respectively modify the integrated policies. For example the control server may update the RMC of the newly modified control policies and or the RMC may itself be aware of changes to the OER policies. Accordingly the RMC policy integration process may re generate the integrated policies in table as needed.

In addition to informing the RMC of the control policies the control server may also inform the RMC of additional information useful to integrating policies and more particularly to acting upon those integrated policies. For instance in order for the RMC to classify traffic classes the security server may inform the RMC of the traffic classes defined by the control server. For example the markings application streams or other traffic class classification information may be included within the collaboration message transmitted from the control server e.g. in the same message as the policies or in a separate message . As such the RMC may thus classify one or more traffic classes such as by mapping the application streams or markings to respective traffic classes. Alternatively or in addition the RMC may learn the application streams dynamically and may map the stream to a policy e.g. Red because of the stream s properties e.g. DSCP in this example and then take the action defined in policy Red. In such an example the traffic class with DSCP marking EF can be associated with policy Red which may have a priority of 1 and has one or more exit selection rules such that the traffic is sent through the path with least latency. In another example any data that is unmarked could have the lowest priority. Note again that DSCP based traffic identification is merely an example. 

Also according to one or more embodiments herein the RMC may based on the integrated policies determine at least one optimal path that is an optimal exit egress from network which conforms to the integrated policies to be associated with each of the one or more traffic classes. For example the RMC may use network statistical information obtained through OER processes described above to determine that traffic exiting through ER will have the lowest RTT while traffic exiting through ER will have the lowest packet loss illustrative examples only . Having made such a determination the RMC may calculate an optimal path for the various traffic classes that are so interested in such statistics such as according to policies Red and Yellow above. For instance traffic marked with an EF e.g. Citrix application traffic may be routed through ER for the lowest RTT according to policy Red while traffic marked EE e.g. data backup traffic may be routed through ER for the lowest packet loss. Notably assuming equal reachability the destination address prefix to which the traffic EF and EE is bound may be the same prefix but through the distinguishing classification of packet marking may be routed differently out of network that is over individualized optimal paths based on the integrated policies accordingly.

Moreover in accordance with OER techniques described above RMC may determine that additional traffic monitoring and statistic gathering may be beneficial based on the received policies from the control server . For instance if the control policies indicate particular traffic classes not already monitored for the RMC e.g. particular application traffic particular application data streams flows etc. then the RMC may request that the OER process of edge routers ER and ER monitor those new traffic classes or other parameters in order to more directly determine an optimal path for those traffic classes.

Illustratively the RMC may notify one or more routers in the network domain of the at least one optimal path associated with each of the one or more traffic classes. For instance the path selections may be sent only to the edge routers ER and ER e.g. OER equipped routers which may then send advertise the path selections into the network domain according to conventional routing protocols. For example if traffic marked ED is to be routed out edge router ER then routes may be advertised for the traffic marking accordingly and the routers may thus store the received routes as part of an adequately configured routing table i.e. configured to route based on traffic markings .

Alternatively routers may be directly informed of the integrated policies and may store the received policies in policy table . In this manner the routers e.g. A D themselves may be configured to apply the integrated policies through policy enforcement process to the policies to route traffic accordingly. For example rather than indicating in routing tables that traffic ED is to be routed toward ER the routers may determine the marking and may perform a lookup into the policies to determine that the traffic is to be routed toward ER and then based on routing tables determine the path to ER accordingly.

Regardless of how the policies are propagated to the routers upon receiving traffic at one of the routers of the network the receiving router may determine the traffic class of the traffic such as by identifying the markings of the traffic e.g. DSCP or other identifying classifying feature e.g. source destination etc. . Based on the integrated policies e.g. policy enforcement process using policy table and routing techniques e.g. routing process and routing table the routers route the traffic accordingly. For instance local policies at the router may indicate that higher priority traffic be granted network resources before lower priority traffic. Other policies may be maintained at the routers within routing table such as utilizing the associated optimal paths received from the RMC e.g. via edge routers ER and ER routing the traffic based on the traffic markings classes and routing the traffic according to routing entries corresponding to the identified traffic e.g. EE traffic to ER EF traffic to ER unmarked voice traffic to ER etc. . On the other hand as mentioned above the traffic classifications may be applied to policy table and then appropriate routes based on the associated policy may be determined from the routing table .

Further the routing master controller may be configured to classify traffic classes in step e.g. as informed from the security server and or as determined by the routing master controller itself. In addition in step the routing master controller may receive information from the control server and or dynamically learn information itself to map one or more application streams to respective traffic classes. In step the routing master controller may associate at least one optimal path with each of the one or more traffic classes based on the integrated policies as described above and in step may notify one or more routers in the network domain of the optimal paths e.g. ER and ER . The procedure for the RMC then ends in step .

Notably while the steps in each of have been shown in a particular illustrative order it should be appreciated by those skilled in the art that any suitable ordering of the above steps is contemplated. For example traffic classes may be defined by the routing master controller in prior to receiving additional traffic class information from the control server or the control server in may transmit markings to control agents prior to the routing master controller etc.

Advantageously the novel techniques described herein integrate a plurality of traffic routing policy sets into a single integrated traffic routing policy set in a computer network. By creating an integrated policy set table at an RMC the novel techniques allow for communication within a network that is optimized based on the integrated policies such as for routing optimization and for security access control within the network. Also the dynamic aspects of one or more embodiments described herein alleviate the need for cumbersome and inefficient manual configuration e.g. such that modification to the first or second sets of policies may result in dynamic modification of the integrated third set of policies accordingly.

Note that as another example of integrated policies where control policies may involve threat detection e.g. preventing various threats attacks or other abnormal behavior such threats may have been dropped or sent to a quarantine area for further investigation by the control agents . According to the techniques above by distributing the control policies to routers in the network e.g. ER and ER traffic threats may now be advantageously averted at the edge of the network prior to entering the network and causing potential harm e.g. in essence delegating certain control agent responsibilities to routers of the network . For example the control server may detect a security event such as a threat attack or other abnormal behavior and may inform the RMC requesting performance of a particular security action such as dropping the traffic or redirecting it to a quarantine area or sinkhole . Alternatively the control server may inform the RMC of various control policies that would allow the RMC or the routers to which the integrated policies are distributed to detect the threat attack etc. security events and to act accordingly as described above.

While there have been shown and described illustrative embodiments that route traffic based on an integrated set of one or more policies it is to be understood that various other adaptations and modifications may be made within the spirit and scope of the present invention. For example the embodiments have been shown and described herein with reference to security control servers and security control policies. However the embodiments of the invention in their broader sense are not so limited and may in fact be used with other types of network devices configured to maintain a policy set that may beneficially be integrated with optimized routing policies as may be appreciated by those skilled in the art. Also while the illustrative policy integration process is shown and described within RMC a separate policy integration device not shown may be used to obtain and integrate the sets of policies e.g. the security policies and routing policies and to distribute the integrated policies to appropriate devices e.g. agents routers RMCs etc. within the network.

The foregoing description has been directed to specific embodiments of this invention. It will be apparent however that other variations and modifications may be made to the described embodiments with the attainment of some or all of their advantages. For instance it is expressly contemplated that the components and or elements described herein can be implemented as software including a computer readable medium having program instructions executing on a computer hardware firmware or a combination thereof. Also electromagnetic signals may be generated to carry computer executable instructions that implement aspects of the present invention over e.g. a wireless data link or a data network such as the Internet. Accordingly this description is to be taken only by way of example and not to otherwise limit the scope of the invention. Therefore it is the object of the appended claims to cover all such variations and modifications as come within the true spirit and scope of the invention.

