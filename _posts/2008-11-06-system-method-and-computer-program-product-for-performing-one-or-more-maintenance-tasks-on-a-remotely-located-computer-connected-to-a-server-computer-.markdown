---

title: System, method and computer program product for performing one or more maintenance tasks on a remotely located computer connected to a server computer via a data network
abstract: A method and computer executable program code are disclosed for performing one or more maintenance tasks on a remotely located computer connected to a server computer via a data network.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08706576&OS=08706576&RS=08706576
owner: McAfee, Inc.
number: 08706576
owner_city: Santa Clara
owner_country: US
publication_date: 20081106
---
The present application is a continuation of a patent application filed Sep. 14 2007 under Ser. No. 11 855 970 now U.S. Pat. No. 7 472 419 which is in turn a continuation of a patent application filed Dec. 21 2005 under Ser. No. 11 316 562 now U.S. Pat. No. 7 480 941 which is in turn a continuation of a patent application filed Oct. 20 2005 under Ser. No. 11 256 521 which is in turn a continuation of a patent application filed Oct. 4 2002 under Ser. No. 10 265 030 now issued as U.S. Pat. No. 6 988 209 which is in turn a continuation of a patent application filed Feb. 11 1999 under Ser. No. 09 248 115 now issued as U.S. Pat. No. 6 499 109 which in turn claims the benefit of priority from and is a continuation in part of the commonly owned application Ser. No. 09 208 735 filed Dec. 8 1998 now issued as U.S. Pat. No. 6 266 774 all of which are incorporated herein by reference.

This relates to a variety of problems such as computer viruses cleanup of unusable or unwanted programs and upgrading software that annoy and inconvenience the users of personal computers.

Despite the existence of good programs to detect and remove computer viruses unscrupulous and adventurous computer programmers frequently try to skirt the virus antidote programs by creating new viruses that are hard to detect or remove. Thus there is an on going struggle between the creators of virus programs and the companies that find the antidotes for such viruses. A diligent user of a computer therefore must keep abreast of the developments in the computer virus warfare and upgrade to the latest software to detect and eliminate any new virus that may have infected his computer system. An automatic way of upgrading the virus antidote programs would help to ease the burden on the computer user.

Today there are hundreds of vendors who offer trial versions demonstration copies of software as a method of gaining inroads in the market place. A typical computer user may wish to evaluate demonstration copies of software programs by different vendors before making a decision to purchase the best program for a particular use. These demonstration copies once downloaded and activated will reside on the computer after any expiration date set therein unless deliberate efforts are made to remove them. Once a demonstration copy has expired it will not be useful to a computer user and will only take up valuable storage space on the user s computer. A typical computer user must plod through all directories in the computer to identify the unusable or unwanted computer programs and remove them in a careful manner. To perform such task manually is not an optimal use of the time of a typical user. Additionally in a manual cleanup of unusable or unwanted computer programs there is a danger of deleting critical or useful programs accidentally thus rendering the computer inoperative. Thus there has developed a need for an accounting of software that is functional and useful and that which is unusable and merely occupying storage space on the computer.

To overcome some difficulties in removing outdated software programs from a user s computers some vendors have started to market software programs like TuneUp to perform these tasks automatically. However because of changes in the releases of operating systems or the addition of new features newer versions of such programs are released often. This creates a situation where a user must purchase and upgrade the previous versions of the tuneup programs. Accordingly there is a need for an automatic method and system to cleanup a computer storage without the need to purchase newer versions of cleanup software. It is beneficial to a user if such cleanup happens without the user s intervention and during the times when the user does not attend to the computer.

Another problem faced by a computer user is prompt notification that a new upgraded version of software is available. In the past vendors have developed different ways to notify their customers. One method is to place a new advertisement banner indicating a new product or offering on other web sites and lead users to the advertiser s web site. But not many customers respond to such Internet invitations to click on an advertisement banner. Another way is to post a What s New page on a vendor s web site with links to other pages containing detailed information. This does not work well because this requires users to visit the vendor s web site periodically looking for new information. A third way is to maintain lists of electronic mail addresses for interested customers and send them e mail notification periodically. Maintenance of these lists has proved to be tedious. Additionally many customers object to receiving unsolicited electronic missives.

In order to automatically update information in a personal computer via the Internet a new technology called the push technology has emerged. This technology incorporates the broadcasting model into web servers and browsers. The primary purpose of this technology is to overcome the problem of ensuring that interested parties are notified whenever information content in a web site is updated. Content is distinguished from other kinds of electronic information such as programs and electronic mail messages in that content is the subject matter contained in a newspaper a Lexis Nexis database or the like. Content is neither a machine to perform a task nor a structure or description of how data are arranged in a computer. The push technology has helped corporations tailor their sites for particular groups of users so that interesting content is easily located. The push technology also has enabled messages to be sent to the audiences when it was deemed ready for publication. Using push publishing web site publishers have delivered newsletters to niche audiences or notified subsets of their readers of updated content.

PointCast was one of the earliest implementations of the push technology to deliver information content. A user is typically advised to specify the type of content news entertainment sports or interest group related information to be downloaded as it is updated. When upgraded content is available the user may elect to download the information which can be browsed locally at the user s computer. PointCast however is configured only to deliver content to the browser of a computer over the Internet. It is not designed or equipped with the means to download executable programs to a storage device connected to a computer and execute them at the remote computer.

Other products are aimed at delivering executable computer programs to a user computer and executing them locally. Oil Change is such a product. Once installed on the user computer it allows automatic updating of computer programs via the Internet. In the case of Oil Change a user can update to new versions of previously purchased and loaded software or download a new patch or a bugfix device drivers for new peripheral devices templates clip art and business forms to work in conjunction with word processing software packages screen saver images or the latest amendments to the tax code to work with accounting software packages. Another example of a similar commercially available product is Castane from Marimba Inc. In these systems a user is required to download executable software programs from the vendor s web site via the Internet using a variant of a protocol called the File Transfer Protocol ftp and manually execute the downloaded programs on the user s personal computer thereafter. This mechanism is similar to loading software from a store bought portable storage medium such as a magnetic tape a floppy disk or a CD ROM and running the software locally on a user s computer except that the program is downloaded from the Internet instead of being loaded from a storage device.

Executing software on a 32 bit personal computer running a Windows 95 98 or NT operating system involves registering the software in a data store called Windows Registry. Windows Registry is a configuration data store for both hardware and software. The settings in Windows Registry control the behavior of the software. When a user attempts to execute software on a personal computer equipped with the above mentioned operating systems the operating system interprets the user s attempt and runs the software based exclusively on the information from the Windows Registry. Typically an entry in Windows Registry is made during the installation process of new software on a computer. Vendors of software application programs provide automatic means to ensure proper installation of their programs. If on the other hand no entry is made in the Windows Registry the context under which a user used the software is lost. There is a need therefore for a system and method to store the information related to the context of software usage without using the Windows Registry as a repository of such information.

The programming language Java contemplates a virtual machine called the Java Virtual Machine JVM to run compiled Java code and stand alone programs called applets after they are downloaded to a compatible web browser such as the Netscape Navigator in a tightly controlled and secure environment. The JVM is a software implementation of a central processing unit CPU an essential component in every computer. Software written in this virtual machine methodology run within a contained environment defined to work only in a browser program and cannot access a client computer s file system or desktop easily.

Other programming methodologies such as the Component Object Model COM have been developed to overcome this deficiency. However this does not solve all the problems with delivering executable software to a client computer over the Internet in a form ready to be automatically executed. There is a need therefore for a method to encapsulate software as to make it executable automatically upon delivery to the client computer.

Users of personal computers do not wish to entrust access to their computers to an unknown remotely located entity for fear of losing privacy or causing damage to data stored in their computers. A service offered by a trustworthy source such as McAfee Associates Inc. a well known vendor of computer security software will overcome the user reluctance to allowing access of their personal computers to a remote operator.

In summary the state of the art provides means to deliver components of programs means to deliver executable programs that must be executed locally by manual intervention and means to provide content rather than executable programs. This art can be improved by delivering executable software rather than mere components to a personal computer by allowing a trusted remote operator to access the internal components of a personal computer and by executing programs automatically from a remote location. There is a need for example for a system and method in which when a user connects with a web site an application may be downloaded installed registered and executed without any further intervention on the part of the user.

The public data networks collectively called the Internet and colloquially referred to as the Web are becoming increasingly popular. Among other things the Internet provides a communication medium to distribute software products to computers that are located at distant places. The numerous methods by which sellers of computer software programs deliver executable programs automatically to client computers owned or operated by users are described herein and in the parent application the disclosure of which is hereby incorporated by reference.

To understand the invention it is helpful to understand the distinctions among the terms content browser type setting program embedded object and script. These five types of entities are described below in the context of Internet related software.

Content is the subject matter contained in a web page. Content is distinguished from the other entities described herein in that content is not a program it is the data that is presented to a user.

A web browser or simply a browser is a computer program that provides access to the vast resources of the Internet. Typically this is done by providing a window to the data located on other computers connected to the Internet. A frame is a part or section of a browser window that contains a distinct display area. If a web page is defined to contain multiple frames each frame can act as an independent display area and can download web pages located at different web sites while displaying them together in one window on a browser. Alternatively a web page may cause multiple browser windows to be created on the user s computer. A browser can also be described as a container of the various components it displays. Thus while the components are embedded in a browser the browser envelops the components.

In general in a window based computer system such as the Windows 98 program marketed by the Microsoft Corporation windows are arranged hierarchically. A browser program that executes on a window based computer system is also arranged hierarchically. When a browser application is launched on a windows based computer system the first window that appears is called parent window or main window or top level window. This top level window can later spawn or fork other windows which are called sub windows that run other applications. A sub window may be created by executing a script within a browser window and may be programmed to run another instance of a browser program. In such cases the sub window is called an opener window. Thus it may be the case that a first window running a browser program a top level window is programmed to point to a web site and a sub window created from the same browser program is programmed to point to a different web site.

A type setting program is a presentation program typically written in the Hyper Text Markup Language HTML . In an HTML encoded program content is surrounded by codes that indicate the manner in which the browser presents the content to a user. Additionally HTML encodes certain devices called links that allow a user to navigate the web by simply clicking on a sensitive area of the web page.

A document that contains objects or components like graphics audio or video files or charts in addition to text is called an embedded document object. Several competing standards exist in the marketplace for documents that can be transmitted over the Internet and displayed in a browser. For example two such standards are OpenDoc promoted by the International Business Machines Corporation and Object Linking and Embedding OLE promoted by the Microsoft Corporation. Typically these standards provide for an application programming interface API that allows an independent software vendor ISV to develop applications that deliver components via the Internet. An API generally allows a programmer to interact with an enveloping browser. For example a programmer may seek to determine the precise configuration of the browser by reading the values of its internal parameters. Alternatively a programmer may wish to adapt the browser to a desired configuration by appropriately setting the browser s parameters.

Finally a script is a list of computer executable instructions typically written in a human readable language. Some browsers are configured to execute instructions written in script languages. In such browsers an analog of a Central Processor Unit CPU which is an essential component of all modern computers is defined within the software contained in the browser. This software defined CPU executes the scripts within the browser environment. For example JavaScript is a language in which a programmer can code in a human readable set of instructions that can be executed within the browser environment. In this case the browser is said to be a container object to execute the script within its bounds.

Referring now to the parent application to achieve the objective stated therein a web browser program running on a client computer must be able to access the inner workings of the client computer. This can be achieved with the help of the OLE document object technology. The OLE technology is a system level object architecture that includes services for all inclusive data access remote distribution of software components across heterogeneous platforms robust transaction processing and large group development ActiveX technology developed by the Microsoft Corporation of Redmond Wash. uses the OLE architecture and provides the building blocks that enable a provider to distribute over a network software executables that can be executed on a client machine. In general such distribution of software executables is done via a web browser as described in the parent application. Typically this execution on a client machine is done when a page source is input to it by invoking certain scripts embedded in the web browser. The downloaded software components are called ActiveX controls which are computer executable pieces of program code. One feature of ActiveX controls is that they have no restrictions placed on them once they reach a user s machine. For example a programmer may write an ActiveX control that upon downloading to a user s computer can shut down the computer or reformat its hard drive thereby destroying all data stored on the computer. This creates an easy way for malicious programs such as viruses to reach the client computer and be executed without the user s notice.

To overcome these security problems the Microsoft Corporation requires all ActiveX controls to be verified by a signature initiative called Authenticode. This verification works in the following way. Each ActiveX control is given a secure and encrypted digital signature by a trusted corporation. All browsers that allow download and execution of ActiveX controls are pre programmed to verify the digital signature. Every time an ActiveX control is about to be downloaded the browser examines the digital signature associated with the control. If the signature is verified as authentic by the browser it is downloaded without any problems. Otherwise the browser issues a warning message to the user.

As explained in the parent application the invention described therein uses some of the features of a programming methodology exemplified by ActiveX to effect easy and hands free automatic downloading of software executables to a user s computer without any action taken on the part of the user. While the invented method and system help achieve the stated ends a security threat may be created because of the above mentioned feature of the ActiveX like technologies that allows unrestricted access by the embedded code to a user s computer.

Because computers today are interconnected by networks such as the Internet computer security has become a more important issue than before. Today computers are more prone to attacks by viruses and Trojan Horses. A virus is a piece of computer code that replicates itself without a user s intervention. Left unchecked a virus may copy itself stealthily to other computers and corrupt the data stored in storage devices connected to the computers. For example a virus may rewrite a section of a computer start up program called the boot sector . Every time a computer is started the virus copies itself into the memory of the computer and waits. Suppose a user wishes to copy some data from the computer to a portable medium such as a floppy disk. The virus that has copied itself to the memory could be programmed to intercept the writing of the data to the disk and copy itself to the disk along with the data. In this manner the virus has replicated itself to the floppy disk and is now ready to infect other computers where the floppy disk is used.

In contrast to a computer virus a Trojan Horse is a malicious computer program that like the fabled instrument of war used by ancient Greeks to gain entry into Troy causes a user to believe that it is a legitimate program and entices the user operating a computer to perform certain actions that lead to compromising the security of the data stored in the computer.

Referring back to the parent application assume that in accordance with the invention described therein an Internet Clinical Services Provider ICSP downloads a software program called QuickClean designed to cleanup the user s hard drive. In accordance with the above mentioned ActiveX Authenticode initiative a license file is delivered to the user along with the QuickClean program. This software is designed with embedded methods or sub routines that when invoked properly using a script rid the user computer of unwanted or unused software in an orderly manner. However since these methods or sub routines for removing unwanted or unused software are invoked by a script a malicious user can also invoke the script in such a way as to remove desirable or valuable software thereby causing severe damage to the user s computer. Moreover a malicious user may also attempt to secretly transfer the contents of a user s computer by e mailing these to his own computer. In the computer security lingo such a malicious user or programmer is called a computer hacker. The above mentioned malicious act called computer hacking can be accomplished in two ways.

In accordance with a first way of hacking a hacker obtains a legitimate copy of QuickClean and its associated license file from the ICSP. The hacker can then create his own web site and host both QuickClean and the associated Authenticode license file on his web site and invite others to use the free software. The hacker creates a web page on his web site that contains a malicious script that will use the methods or sub routines in the QuickClean program to erase a user s hard disk. When a user enticed by the free software downloads the web page from the hacker s web site the hacker will download the QuickClean program to the user s computer and invoke the methods in the program to erase the user s hard disk. Alternatively suppose a user visits an authorized ICSP web site first and downloads the QuickClean program along with the associated Authenticode license file. Later the user visits the hacker s web site. Since the QuickClean program is already stored on the user s computer the hacker does not need to obtain a legitimate copy to wreak havoc on a user s computer by providing a script to invoke the sub routines embedded in the QuickClean program.

In accordance with a second way of hacking a hacker may entice an unsuspecting user to visit his web site. The hacker may program his web pages to invoke multiple frames or multiple browser windows. In one frame or browser window the hacker can cause the user computer to download the QuickClean program and the associated license file from the ICSP web site. In a second frame or browser window the hacker can run his malicious script thereby causing damage as described above.

There is a need therefore for a system and method to prevent a hacker from activating the methods or sub routines embedded in a computer executable code downloaded to a user computer via the web.

A method and computer executable program code are disclosed for performing one or more maintenance tasks on a remotely located computer connected to a server computer via a data network.

Referring to the drawings wherein like reference numbers refer to like parts illustrates one embodiment of the invention. An Internet clinical services provider ICSP maintains and controls a server computer which is connected to a data communication network such as a Local Area Network a Wide Area Network or other similar network. In a preferred embodiment as shown in the data communication network is the Internet . The server computer is equipped with storage memory and a network interface device to connect to the Internet . The server computer makes available information that can be accessed via Internet by user computer using a browser. User computer is connected to the Internet via a modem . The user computer is equipped with a semiconductor memory a storage device such as a disk drive a central processing unit such as a Pentium Pentium II or Motorola 68000 microprocessor and a display device such as a CRT. Additionally the user computer is equipped with software that enables the user to connect to the Internet via the modem as well as a browser shown in that allows the user to surf the Internet .

Now referring to in a preferred embodiment the server computer comprises web server software and is coupled to server side engines to deliver Hyper Text Markup Language HTML Microsoft Active Server Pages ASP and ActiveX .

Also on the server computer a Common Gateway Interface CGI program provides the software interconnection between the Internet and other programs running on the server computer . Typically the CGI program forms the gateway to the Internet by opening a connection via a Transport Control Protocol Internet Protocol TCP IP stack. All requests enter the server computer via the CGI program and all responses are delivered to the user computer via the Internet by way of the CGI program .

In a preferred embodiment the server side engine software is implemented in the programming language ActiveX marketed by the Microsoft Corporation of Redmond Wash. ActiveX is a set of technologies that enables software components to interact with one another in a networked environment regardless of the language in which they were created. ActiveX is built on the Component Object Model COM . An ActiveX control is an object created using the ActiveX technology.

The server side engines are information delivery systems that respond to an Internet request for a particular type of service. A user makes an Internet request for service typically by typing a Universal Resource Locator URL in the web browser running on the user computer and submitting it in the form of a packet of data to the server computer . Thus the user computer establishes a logical connection with the server computer. When the user computer requests an ActiveX service the server side ActiveX engine delivers corresponding objects called ActiveX controls and accompanying script files embedded in a HTML file to the user computer . ActiveX controls are programming building blocks that enable small component parts of software to be embedded in a HTML page and sent to the client computer in response to a user request. A more detailed explanation of the workings of the ActiveX controls and the method by which they are delivered to a user computer is provided in the book Understanding ActiveX and OLE by David Chappell Microsoft Press Washington 1996 which is incorporated herein by reference. One of ordinary skill in the art will recognize that ActiveX controls could easily be substituted with other similar mechanisms without undue experimentation if a Java enabled browser or any other browser provides a mechanism to access the inner workings of the user computer .

Also connected to the server computer is an application knowledge base which is a repository of data pertaining to the various software that are delivered to the client computer by the server side engines . The data stored by the application knowledge base typically relates to the specific characteristics of an executable software program. For example if a new version of an anti virus program is available then the knowledge base stores the changed programs or dynamic link libraries DLL of the new version. Before the server side engines download software to the user computer they consult with the knowledge base and determine that an upgrade is needed for the user computer .

The server computer is additionally connected to a billing database and a user profile database . The billing database stores the information related to any user requests for services offered by the ICSP the user profile database enables storage update and retrieval of any user related information such as name contact address telephone number and e mail address. In a preferred embodiment both the billing database and the user profile database are implemented using a Microsoft SQL Serve database system. In alternative embodiments any indexing system relational database management system flat files or other data storage and retrieval mechanism can be used. The billing database and the user profile database provide interfaces that enable a server side engine to request pertinent information in the form of a database query response interaction method such as the Structured Query Language SQL method.

It is to be appreciated that in accordance with a preferred embodiment an account for the user may be created on the server computer before or during the registration step. Generally speaking this will include the steps of taking a customer credit card number or receiving other funds from the customer and adding funds to the account. Each time the user uses the services of the ICSP the account may be debited. Alternatively the account need not be debited every time the user uses the services of the ICSP but rather the ICSP services may be offered on a subscription basis wherein the customer may purchases a subscription at the beginning of a time period such as one year and may then use the services of the ICSP as much as desired through the course of the time period.

Illustrative operation of the invention is described in conjunction with . A user at a personal computer such as computer accesses the ICSP by typing the URL for the clinic web page . This causes browser to access the server computer thereby establishing a logical connection with the server computer. The server computer then responds to the user request by sending web page preferably a home page for the ICSP service to user computer for display. The web page contains fields for an identification number a user s e mail address and optionally a web password . The user enters the user identification information in the web page and sends the page to the server computer step . The CGI program running on the server computer receives the user identification information and performs a lookup in the user profile database to authenticate the user step . If the user is not authenticated the CGI program sends an error message to the user computer in the form of a web page step . If on the other hand the user is authenticated the CGI program on the server computer creates a secured connection between the user computer and the server computer step . This process of authenticating the user computer and creating a secured connection between the two computers and is called registering the user computer with the ICSP. The act of registering the user computer at the server computer web site causes the user computer to allow the server computer to run scripts to start applications.

An event is an action performed by a user or by the server computer . For example registering a user computer at the ICSP web site is an event. Similarly the occurrence of a timeout condition the automatic downloading of an anti virus program to the user computer or the termination of the secure connection are events caused by the server computer . A transaction is defined as a set of events that occur between the registration of the user computer at the ICSP web site and the completion of the actions by the server computer or the termination of the connection established between the two computers. After the user computer is registered at the ICSP entries are made in the billing database and the user profile database for the event step .

The CGI program running on the server computer causes a web page to be downloaded to the user computer . Embedded in the web page are ActiveX controls and scripts that cause a search program to be executed on the user computer to determine if any executable software needs execution installation upgrades or updates step . In a preferred embodiment this results in a search of the user computer s storage medium for example in the cache area of the browser to determine if any program needs to be downloaded. Additionally the program looks to determine if there is a need to execute any software program such as an anti virus program step . If no execution installation upgrades or updates are needed then the connection between the server computer and the user computer is terminated step .

If on the other hand an execution installation upgrade or update is determined to be needed the server computer then proceeds to download new executable software to the user computer via the Internet connection step or to execute previously downloaded software step . In a preferred embodiment the server computer downloads an application engine by wrapping it in a COM ActiveX wrapper and storing the entire package in a browser cache area of the client computer .

These application engines are configured to perform different tasks or a combination of different tasks. These tasks include but are not limited to checking for any computer viruses on the user computer compressing the software or data located on the storage connected to the user computer searching for software or data on the user computer that needs upgraded versions upgrading the software or data on the user computer searching for and deleting unused obsolete unneeded or undesired software components or data on the user computer archiving software or data located on the user computer shredding or deleting without trace the data or software located on the user computer advising or responding to user questions as an expert advisor system performing hardware and software diagnostics on the user computer and providing a health report card for the user computer . It should be noted that a person skilled in the art may download software to accomplish other tasks in a similar manner. Accordingly the scope of the present invention encompasses that as well.

After the server computer downloads a program to the user computer according to step the server computer automatically executes the program on the user computer without any intervention by the user step . The details of the execution of the downloaded program are recorded in the database and the user profile database connected to the server computer step .

After the application is executed on the user computer the server computer checks if any other programs need to be downloaded or upgraded on the client computer step . If other programs are to be downloaded or executed then the server computer performs steps without any further intervention by the user.

Upon the expiration of a time period set by the ICSP or upon demand a report is generated by the server computer of the transactions logged in the databases and step . This report is either in a textual form summarizing different classes of transactions requested by users of the ICSP or in a graphical form with two or three dimensional bar graphs stacked bar graphs line graphs or pie charts displaying statistical analyses of different operations performed by or with the server computer . Reports of the statistical analysis and graphs representing such analysis are then transmitted in an electronic form to the user computer .

Accordingly using a method in accordance with the preferred embodiments a relatively unsophisticated computer user who has an Internet browser such as Internet Explorer 4.0 or Netscape Communicator 4.0 installed on their computer system is capable of maintaining a secure up to date and optimized computer system without needing to manually perform the sophisticated steps of purchasing and installing software upgrades optimization software antivirus programs etc. Rather in a manner analogous to the way a car owner simply takes their car to a service garage and walk away while the car is automatically upgraded or repaired a user in a system according to the preferred embodiments may simply park their computer at the ICSP using their Web browser and after registration or other validation procedure may simply walk away while their computer is automatically upgraded or repaired by encapsulated routines that are automatically downloaded from the ICSP.

The foregoing describes a new and useful method and system for automatically downloading and remotely executing software applications over a secure Internet connection. Those skilled in the art may make numerous modifications and departures from the specific embodiments without departing from the spirit and scope of the claimed invention. For example the server computer can comprise a distributed computing system or a cluster of networked computers the database may comprise a distributed database or several databases. Additionally web pages may comprise an interface that is not specified herein. Other embodiments may include a network connection other than the Internet between the server computer and the user computer and the software downloaded may be intended to perform tasks such as database management word processing spread sheet games or other tasks that are not specified herein.

As described in the parent application the server computer is operated by an Internet Clinical Services Provider ICSP . The server computer comprises a processor such as a Pentium II microprocessor a memory such as a semiconductor memory and a storage device such as a computer hard drive. The server computer is configured to receive request messages from the client computer over the internet in the Hyper Text Transfer Protocol HTTP File Transfer Protocol FTP or any similar protocol used to transfer data video voice or a combination of these media. The server computer is configured to transmit in response messages that include web pages that are programmed in Hyper Text Markup Language HTML or a similar language. Embedded in the web pages are components such as documents scripts objects frames and others that enable the server computer to display colorful graphical images on the display device coupled to the client computer .

Now referring to in accordance with the invention described in the parent application a user operating the client computer enters the Universal Resource Locator URL pertaining to the server computer in a window provided by the browser program running on the client computer . When the user presses a send button on the browser this causes a request message to be transmitted to the server computer . Step . The server computer then causes an identification web page to be displayed on the browser window at the client computer . After the user enters the appropriate identification information in the browser window this information is transmitted to the server computer. Step .

The server computer authenticates the user Step and if authenticated proceeds to download a copy of an ActiveX control like software program and an associated license file to the client computer . Step . For the purposes of illustration assume that the software program is QuickClean and the license file is named QuickCleanLicense. The license file works in conjunction with the software program in the following way. When software objects embedded in the software program are to be executed the browser or another program running on the client computer verifies if the license file and the software objects are related. If they are found to be related the methods or sub routines within the software objects can be invoked by a script running on the client computer . Step . If on the other hand QuickCleanLicense is found to be not related to QuickClean software then the client computer terminates the program after displaying or sounding an alarm message. Step . It should be noted that authentication of the user by the server computer described in step and the verification of the software objects by the client computer described in step are different tasks and should not be confused with each other.

The invented method adds an additional step to the art described in the parent application. After the client computer determines that the QuickClean software and the QuickCleanLicense are related the code in the QuickClean software must be enabled before it can be put to intended use. This is done by appropriately programming the QuickClean software to perform a first check and a second check as follows.

In order to prevent the first method of hacking described in this application the QuickClean software is programmed to perform a first check whereby it is determined if the browser is pointed to an ICSP authorized web site when the software is invoked by the script running on the client computer. When the script invokes a sub routine or a method in the QuickClean software a first set of instructions embedded in the QuickClean software queries the browser to determine the URL to which the browser is pointed. Step .

A hacker may mislead the client computer when it performs the above mentioned first check. He can do this by causing the client computer to open a new browser window or a new browser window frame according to the second method of hacking described above. To prevent this the following method is used to perform a second check of the QuickClean software. This is accomplished by a second set of instructions embedded in the QuickClean software. The second set of instructions queries the browser to determine the URL pointed to by the top level window and the opener window. Step .

For example if ActiveX objects embedded in an OLE compatible browser are used to implement the QuickClean program the URL to which the browser is pointed can be obtained by calling the method GetDisplayName provided in the Monicker Interface or by calling the GetLocation method provided in the Service Provider Interface of the IOleClientSite object defined within the ActiveX object. If both the methods or sub routine calls return the same result which is a ICSP authorized URL then the QuickClean software is deemed to have passed the first check. Step . These two methods can be illustrated as follows 

Additionally the ActiveX objects embedded in the OLE compatible browser can determine the URL pointed to by the top level window of the browser by calling the BrowserApp Interface which can query the Document Object to obtain the HREF property of the Top Window Object. The opener window is determined in a similar manner. This can be illustrated in the following sequence of function calls 

 1 BrowserAppInterface DocumentObject WindowObject TopWindowObject LocationInterface Href Property top level URL

 2 BrowserAppInterface DocumentObject WindowObject TopWindowObject OpenerWindowObject LocationInterface Href Property opener URL

Once it is determined that the top level URL and the opener URL point to the same authorized URL then the QuickClean software is deemed secondarily enabled. Step .

Upon a successful enablement according to steps and the QuickClean software is executed by scripts running on the client computer . Step . If on the other hand the QuickClean software is not enabled according to steps or then an attempt by a script to run the software results in error messages. Step .

There is described in the foregoing a new and useful invention to prevent a hacker from causing a threat to the information contained in a client computer by misusing authenticated objects designed to perform secure tasks. One skilled in the art may make several modifications to or departures from the preferred embodiments provided herein without departing from the spirit and scope of the invention or without undue experimentation. For example the order in which steps and are executed may be interchanged other browser programs can be used to practice the invention and the technologies described herein to deliver and execute software via a computer network may be replaced with other similar technologies. All such departures and modifications are within the scope of this invention and should be construed accordingly.

