---

title: Multi-mode digital-to-analog converter
abstract: Various apparatuses, methods and systems for a multi-mode DAC with selectable output range, granularity and offset and controlled slew rate are disclosed herein. For example, some embodiments of the present invention provide an apparatus for supplying a reference signal, including a digital-to-analog converter, a counter and a clock. The digital-to-analog converter has a digital input and an analog output that supplies a reference signal based on the digital input. The counter has a digital control word input, a clock input, a clock enable output and a count output connected to the digital input of the digital-to-analog converter. The counter is adapted to assert the clock enable output when the digital control word input requests an output count that is different from an actual count at the count output of the counter. The clock has an enable input connected to the clock enable output of the counter and a clock output connected to the clock input of the counter. The clock is adapted to produce clock pulses on the clock output while the enable input is asserted.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07728749&OS=07728749&RS=07728749
owner: Texas Instruments Incorporated
number: 07728749
owner_city: Dallas
owner_country: US
publication_date: 20080822
---
The present application claims priority to i.e. is a continuation in part of U.S. patent application Ser. No. 12 137 385 entitled DUAL MODE DIGITAL TO ANALOG CONVERTER DAC FOR IMVP CPU AND CRESTLINE GRAPHICS POWER SUPPLY CONTROLLERS and filed Jun. 11 2008 by Biranchinath Sahu which claims priority to i.e. is a non provisional of U.S. Provisional Patent Application No. 60 943 330 entitled DUAL MODE DIGITAL TO ANALOG CONVERTER DAC FOR IMVP CPU AND CRESTLINE GRAPHICS POWER SUPPLY CONTROLLERS and filed Jun. 12 2007. The aforementioned application is assigned to an entity common hereto and the entirety of the aforementioned application is incorporated herein by reference for all purposes.

The present invention is related to a multi mode digital to analog converter DAC and more particularly to a multi mode DAC with selectable output range granularity or resolution and offset and controlled slew rate.

Digital to analog converters are used in many electronic circuits to provide adjustable analog reference signals voltage and current . The analog output signal may be set to different levels by changing the value of a digital control word at the control input to the DAC. For example many power supply circuits rely on an analog reference signal to set the output voltage or current from the power supply. Adjustable power supplies may therefore need a DAC to generate an adjustable reference signal. As the digital control word at the input of the DAC is changed the analog reference signal to the power supply is changed and the output voltage or current from the power supply follows the changes in the analog reference signal from the DAC.

Digital to analog converters are typically designed with a fixed granularity resolution or step size output range and bias value or offset. Each sequential step in the digital control word increases or decreases the analog output by a fixed amount which is also known as step size of least significant bit LSB . For example given a DAC with a fixed output range of 5 volts and a 3 bit digital control word with a range of 0 7 where an input of 0 selects an output of 0V and an input of 5 selects an output of 5V the analog output may be changed in increments of 1 7 of the 5 volt maximum or about 0.7 volts. Based on the requirements of the power supply the granularity and output range may fixed at different values and is not necessarily limited to an even division of the fixed output range by the number of possible input values according to the width or number of bits in the digital control word. For example an application may specify that the output granularity is to be in steps of 0.1V with a range of 5V which would leave a number of unused values in a 6 bit digital control word. The DAC may also be designed to provide a fixed offset or bias in the analog output. For example given a digital input of 0 the DAC may be configured to generate a non zero analog output such as 2.5 volts as the fixed lower limit.

For complex electronic systems requiring multiple different reference signals such as a notebook computer requiring power supplies with several different individually adjustable voltage levels to power various subsystems multiple conventional DACs are needed to provide the different reference signals. This is particularly true when the various subsystems or operational modes have different requirements for the granularity output range and offset of the DAC.

The use of a conventional DAC to provide an analog reference signal can also cause noise or other problems due to the rapid slew rate particularly if large changes are made to the digital control word causing the analog output to respond to the rapid and drastic changes its reference signal goes through. This problem is typically addressed using a buffer amplifier at the output of the DAC to drive a capacitor. This slows changes in the analog reference signal due to the time constant of the system including the capacitor value. If the DAC and buffer amplifier are embodied in an integrated circuit the capacitor is typically an external capacitor requiring a dedicated pin on the integrated circuit to connect the capacitor. The capacitor must be changed from application to application based on the desired slew rate. Furthermore even with an external capacitor the slew rate cannot be precisely controlled because the current of the buffer amplifier that charges and discharges the capacitor is process supply voltage and temperature dependent. Furthermore if multiple DACs of such type are embodied in one integrated circuit multiple external pins are needed to connect external capacitances resulting in a higher pin count and thereby higher cost not to mention the additional capacitances themselves increasing the overall component count of the electronic system.

Thus for at least the aforementioned reason there exists a need in the art for a DAC with selectable output range granularity and offset and controlled slew rate of its output voltage during transition. Additionally slew rate for multiple DACs in one IC should be controlled by the user with one external pin.

The present invention is related to a multi mode digital to analog converter DAC and more particularly to a multi mode DAC with selectable output range granularity and offset and controlled slew rate.

Various apparatuses methods and systems for a multi mode DAC with selectable output range granularity and offset and controlled slew rate are disclosed herein. For example some embodiments of the present invention provide an apparatus for supplying a reference signal including a digital to analog converter a counter and a clock. The digital to analog converter has a digital input and an analog output that supplies a reference signal based on the digital input. The counter has a digital control word input a clock input a clock enable output and a count output connected to the digital input of the digital to analog converter. The counter is adapted to assert the clock enable output when the digital control word input is different from an actual output state of the counter. The clock has an enable input connected to the clock enable output of the counter and a clock output connected to the clock input of the counter. The clock is adapted to produce clock pulses on the clock output while the enable input is asserted. The counter has a comparator which compares the target state of the counter to its present state and decides if the counter should move up or down. In some embodiments the counter changes state based on an internal clock that is based on an XOR combination of the clock enable output of the counter and the clock input to the counter. Thus the response time of the counter and therefore the DAC to changes on the digital control word input are minimized.

In other instances of the aforementioned apparatus a control word processor is included having a digital control word input a mode indicator input and a digital control word output. The digital control word output of the control word processor is connected to the digital control word input of the counter. The control word processor is adapted to produce a translated digital control word at the digital control word output based on the digital control word at the digital control word input depending on which mode it is programmed or configured to operate in. One of a plurality of translation configurations is selected based on the state of the mode indicator input.

In various cases the apparatus further includes a mode detector having an input and a mode indicator output. The mode indicator output is connected to the mode indicator input of the control word processor. The mode detector is adapted to assert the mode indicator output when a voltage level at the input is greater than a predetermined reference voltage level that is greater than a normal operating voltage of the most significant bit of the digital control word input when asserted. The mode detector may have multiple comparators with multiple thresholds which can be used separately or with a combination of thereof to select various modes of operation for the DAC. The input to the mode detector can be supplied by user via a separate pin if all the bits from input control word are needed for the DAC.

Other embodiments of the present invention provide methods for supplying a reference signal including reading a digital control word specifying a desired level for a reference signal comparing the digital control word with a digital value representing the reference signal enabling a clock while the digital value is not in accordance with the digital control word counting at least one pulse of the clock to change the digital value and converting the digital value into an analog value for the reference signal. The number of times the counter counts up or down depends on the difference of input digital control world and current digital value of the reference.

Yet other embodiments of the present invention provide electronic systems including a digital to analog converter counter clock control word processor mode detector digital to analog reference generator and a slew rate bias generator. The digital to analog converter has a digital input and an analog output that supplies a reference signal based on the digital input. The counter has a digital control word input a clock input a clock enable output and a count output connected to the digital input of the digital to analog converter. The counter is adapted to assert the clock enable output when the digital control word input requests an output count that is different from an actual count at the count output of the counter. The clock has an enable input connected to the clock enable output of the counter and a clock output connected to the clock input of the counter. The clock is adapted to produce clock pulses on the clock output while the enable input is asserted. The control word processor has a digital control word input a mode indicator input and a digital control word output that is connected to the digital control word input of the counter. The control word processor is adapted to produce a translated digital control word at the digital control word output based on the digital control word at the digital control word input. One of a plurality of translation configurations is selected based on a state of the mode indicator input. The mode detector has an input and a mode indicator output that is connected to the mode indicator input of the control word processor. The mode detector is adapted to assert the mode indicator output when a voltage level at the input is greater than a predetermined reference voltage level. The input of the mode detector is connected to a most significant bit of the digital control word input of the control word processor. The predetermined reference voltage level is greater than a normal operating voltage of the most significant bit of the digital control word input when asserted. The digital to analog reference generator has a mode indicator input and a digital to analog reference output. The mode indicator input is connected to the mode indicator output of the mode detector. The digital to analog reference output is connected to a reference input on the digital to analog converter. The digital to analog reference generator is adapted to generate one of a plurality of levels at the digital to analog reference output based on a state of the mode indicator input to set a maximum value of the reference signal from the analog output of the digital to analog converter. The slew rate bias generator has an output connected to a bias input on the clock. The slew rate bias generator sets a speed of the clock by a current level on the bias input of the clock. The slew rate of the digital to analog converter is adjusted by the current level on the bias input of the clock.

This summary provides only a general outline of some embodiments according to the present invention. Many other objects features advantages and other embodiments of the present invention will become more fully apparent from the following detailed description the appended claims and the accompanying drawings.

The drawings and description in general disclose various embodiments of a multi mode digital to analog converter DAC which may be used to provide a configurable analog reference voltage or current for an electronic circuit based on a digital control word . The multi mode DAC may be configured in one of multiple modes for example with configurable digital control word formats output ranges granularity and offsets. The multi mode DAC also provides a controlled slew rate to avoid sudden large changes on the analog output while remaining rapidly responsive to changes to the digital control word at the input. The multi mode DAC may be used wherever an analog reference signal is needed by an electronic circuit. In some particular embodiments of the present invention the multi mode DAC is used in a power supply controller integrated circuit to supply the analog reference voltage for a power supply. In particular in some embodiments the multi mode DAC may be used in the power supply controller for a notebook computer. For example Intel s mobile voltage positioning IMVP standard for notebook power supply controllers defines separate input voltage identification VID tables for its central processing unit CPU and graphics processing unit GPU . This invention describes a programmable digital to analog converter DAC architecture that supports both VID codes which can be configured by the user without any additional pins thereby enabling the flexibility of using the same controller for both applications.

In a VID controlled power supply upward and downward transition timing of the DAC output is needed to support various modes sleep mode C4 entry exit 1 ph 2 ph and engage different ways of output voltage monitoring blanking for OVP UVP etc. to ensure reliable and efficient operation of power supply. Slew rate control of conventional DAC systems to achieve the desired transition timing is accomplished using a buffer amplifier driving an external capacitor to add a longer time constant to the DAC output. The slew rate can be manually adjusted in conventional DAC systems by changing the value of the external capacitor. Conventional power supplies using a current source sink and a capacitor also require analog monitoring circuitry to determine DAC output transitions. In the multi mode DAC according to various embodiments of the present invention the output is changed using an up down logic counter with the slew rate being set by a clock whose frequency may be controlled by current source sink via an external resistor for user programmability. Transitions on the output of the multi mode DAC in the up or down direction are easily monitored through digital control signals using combinational logic circuit which is not only accurate but also less power hungry.

Turning now to a multi mode DAC includes a control word processor that processes the digital control word to determine the level of the analog reference signal on the output of the multi mode DAC and to determine the mode in which the multi mode DAC is to operate. For example in one particular embodiment of the invention the digital control word carries the VID codes specifying the desired output level and one or more of the bits in the digital control word can serve a dual purpose to specify the desired mode as will be described in more detail below. The control word processor processes the digital control word and depending on the selected mode generates actual target codes also referred to herein as a translated digital control word that feed an up down counter . The up down counter incorporates additional combinational logic circuitry that compares the translated digital control word with the DAC code at the output of the up down counter . The up down counter determines if the present DAC code is different from the translated digital control word and changes the DAC code provided as the input to a DAC . The combinational logic in the up down counter also generates a clock enable signal that enables a DAC clock for the up down counter when the digital control word changes to a new target value. The up down counter depending on the DAC clock transitions from its present state to the target value through intermediate DAC codes . As the up down counter traverses from its initial state to the target state the output of the DAC changes as well as the analog reference signal at the output of a DAC buffer connected to the DAC .

The control word processor is a combinational logic circuit that maps input digital control word bits to actual input codes for the DAC to generate analog voltage levels that represent the specific input code in a given operational mode. Consequently the actual DAC or DAC buffer need not be redesigned for supporting multi mode operation. As a result not only can one controller can support dual mode operation but also circuit blocks can be reused in different controllers without changing the analog blocks. Note that the multi mode DAC may be adapted to produce either an analog reference voltage signal or current signal as desired.

The mode is detected by a mode detector which examines a mode input and produces a mode indicator output . In one particular embodiment the mode input is the most significant bit MSB of the digital control word . In other embodiments a dedicated mode signal may be included rather than using a bit of the digital control word . In the particular embodiments using the MSB of the digital control word the voltage level of the mode input is examined to determine the mode for the multi mode DAC as illustrated in . The mode input is compared with a threshold voltage by a comparator . The threshold voltage is set at a higher voltage than the normal operating voltage of the mode input when asserted. Thus the mode input can serve a dual purpose. In one mode it carries the MSB of the digital control word . In another mode it is tied to a fixed voltage that is higher than the normal operating voltage when used to carry the MSB of the digital control word . For example in a 5V system if the digital control word normally varies between about 0.7 volts when off and 4.3 volts when asserted the mode input may be tied to a 5V source to place that the multi mode DAC in the second mode. In this case the threshold voltage in the mode detector could be set at about 4.6 volts so the comparator will place the multi mode DAC in the first mode when the mode input carries the MSB of the digital control word between about 0.7V and 4.3V and in the second mode when the mode input is tied to 5V. Again note that these voltage levels are purely exemplary. In one particular embodiment the first mode uses a 7 bit digital control word or VID code and the second mode uses a 5 bit digital control word . If the MSB of the digital control word bit the mode input is tied to a relatively high fixed voltage source such as the analog power supply the multi mode DAC is placed in the second mode. The second most significant bit of the digital control word bit is ignored and unused and bits of the digital control word are used to specify the target output of the analog reference . Note that in some particular embodiments the mode detector may include multiple comparators e.g. with different threshold voltages e.g. enabling the multi mode DAC to function in more than two modes.

The multi mode DAC also includes a DAC reference that generates a reference voltage for the DAC setting the maximum level of the output . For example if the DAC is an R ladder or R 2R ladder DAC the reference voltage is used as a voltage supply that is divided by a resistive ladder to form the possible output voltage levels. The DAC reference provides an adjustable reference voltage for the DAC so that the maximum output voltage of the output of the DAC is also adjustable. The DAC reference selects one of several possible voltage levels for the reference voltage based on the state of the mode indicator output from the mode detector . Turning now to the DAC reference comprises a differential amplifier that compares a fixed reference voltage with a feedback voltage based on the reference voltage . For example a voltage divider made up of two resistors and between reference voltage and ground can be used to divide the reference voltage to generate the feedback voltage . A switch may be used to switch in another resistor in parallel with the lower resistor in the voltage divider under the control of the mode indicator output from the mode detector thereby changing the voltage of the feedback voltage and thus the reference voltage from the differential amplifier . Note that the DAC reference may be adapted to generate two reference levels for the DAC as shown in or may be adapted to generate more than two reference levels for multi mode DACs with more than two modes of operation. In one particular embodiment the first mode requires a granularity of 12.5 mV that is a 12.5 mV LSB on the digital control word while the second mode requires a granularity of 25.75 mV with an offset. Thus in the first mode if the digital control word is set to zero the analog reference will be at zero volts whereas in the second mode if the digital control word is set to zero the analog reference will be at a non zero offset voltage. This offset can be provided by the control word processor by mapping a zero value in the digital control word to a non zero value in the DAC code provided to the DAC . The desired granularity from the DAC can be provided by the mapping of the digital control word in the control word processor or by varying the reference voltage in the DAC reference or by a combination of the two. For example given a DAC with a fixed design and a fixed number of output levels the output granularity is increased by providing a lower reference voltage so that when divided in the DAC the output steps are smaller. Conversely output granularity is decreased by providing a higher reference voltage so that when divided in the DAC the output steps are larger. The output granularity can also be affected by the mapping of the digital control word in the control word processor even for a fixed R ladder or R 2R ladder DAC by mapping consecutive input values to non consecutive output values for example skipping every other possible output value to halve the granularity. Note that because the DAC is driven by the up down counter each possible output value will still be used so this type of mapping to decrease the granularity will increase the time needed to move between selected output levels. 

Turning now to the up down counter includes a counter circuit that counts either up or down whenever a counter clock signal cycles. The clock enable signal is generated in the up down counter by a comparator that compares the DAC code output from the counter circuit with the translated digital control word provided to the up down counter by the control word processor . If the DAC code and the translated digital control word are different the digital control word has requested a different analog reference and the comparator asserts the clock enable signal . This enables the DAC clock to being transitioning so that the clock signal from the DAC clock cycles causing the counter circuit to change values. The direction of the counter circuit may also be controlled by a signal from the comparator with the counter circuit set to count up if the output DAC code is less than the translated digital control word and to count down if the DAC code is greater than the translated digital control word . In one particular embodiment the analog reference must respond rapidly to changes in the digital control word . Whenever there is a change in input control word the clock takes some time to start. To minimize the response time of the DAC the counter clock is generated by combining the clock enable signal with the clock signal from the DAC clock in an XOR gate . As illustrated in the timing diagram of the counter clock signal thus begins to cycle as soon as the clock enable signal is asserted and continues to cycle when the clock signal is enabled and running. Thus the clock enable signal from the logic is used as the first edge of the counter clock signal .

Turning back to the slew rate of the analog reference from the multi mode DAC can be precisely controlled by changing the speed of the DAC clock . When the digital control word changes the output of the DAC and the analog reference each transition through a series of voltage or current level steps and to get from an initial value to a target value. In contrast a conventional DAC would simply jump from the initial value to the target value potentially causing a sudden large change in the analog reference that might require an RC filter to control. The speed at which the multi mode DAC transitions through the steps and is controlled by the speed of the DAC clock which is controlled by a DAC slew rate bias circuit . The DAC slew rate bias circuit provides a reference current or voltage to the DAC clock to control the speed of the DAC clock . For example the DAC clock may comprise a voltage controlled oscillator which is charged by the current from the DAC slew rate bias circuit . The level of the current from the DAC slew rate bias circuit may be controlled by a resistor external to an IC in which the multi mode DAC may be contained. Note that the clock signal from the DAC clock may also be divided in a fixed or configurable fashion in a clock divider .

Turning now to multiple DAC reference circuits e.g. may share a common clock source providing a common slew rate control system for multiple multi mode DACs. Each DAC reference circuit may contain a programmable clock divider e.g. to allow the clock frequency and hence the slew rate of each DAC reference circuit and to be controlled independent of each other. The clock dividers e.g. may be individually programmable for example using an EEPROM or one time programmable OTP circuit either during manufacture and test or by the user. Each DAC reference circuit generates its own clock enable signal and which are combined in an OR gate to produce a common clock enable signal used to enable the shared DAC clock . Thus if any DAC reference circuit receives a change in digital control word the DAC clock is enabled. The up down counter in each DAC reference circuit may have an internal counter enable signal in this embodiment based on its own clock enable signal or so that it only counts when it receives a change in its digital control word . Because the up down signal for each counter and its clock are not synchronized which means if there is an external digital control word transition right at the same time that the counter is transitioning its state there might be set up or hold time violation resulting in improper transition. To overcome this problem the up down signal for the counter may be blanked appropriately before and after the positive clock edge which is when transition occurs.

Turning now to a method of providing a reference signal will be summarized. In one particular embodiment the method includes reading a digital control word specifying a desired level for a reference signal. Block The digital control word may be provided in any suitable fashion and format such as in a multi bit parallel or serial data word from an electronic system using the reference signal. The method also includes comparing the digital control word with a digital value representing the reference signal. Block For example the input digital control word may be compared with an internal digital word provided to a DAC e.g. by an up down counter e.g. to determine whether the output e.g. needs to be changed to provide the level requested by the input digital control word. The method also includes enabling a clock while the digital value is not in accordance with the digital control word Block and counting at least one pulse of the clock to change the digital value. Block The method also includes converting the digital value into an analog value for the reference signal. Block 

In conclusion the present invention provides novel systems devices methods and arrangements for a multi mode DAC with selectable output range granularity and offset and controlled slew rate and rapid response to an input control word change. While detailed descriptions of one or more embodiments of the invention have been given above various alternatives modifications and equivalents will be apparent to those skilled in the art without varying from the spirit of the invention. Therefore the above description should not be taken as limiting the scope of the invention which is defined by the appended claims.

