---

title: Open area maps based on vector graphics format images
abstract: Systems and methods corresponding to an open area map are disclosed. For example, one method includes receiving an image of a layout corresponding to a real-world area in which a person moves about. The image is in a vector graphics format. A reference region is determined using the image of the layout. A grid is combined with the reference region to generate a routable map. The routable map is configured to provide point-to-point routing within the layout.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08339417&OS=08339417&RS=08339417
owner: Navteq B.V.
number: 08339417
owner_city: Veldhoven
owner_country: NL
publication_date: 20080725
---
The present patent application is related to the copending patent applications filed on the same date Ser. No. 12 179 635 entitled OPEN AREA MAPS Ser. No. 12 179 668 entitled COST BASED OPEN AREA MAPS Ser. No. 12 179 676 entitled OPEN AREA MAPS WITH RESTRICTION CONTENT Ser. No. 12 179 680 entitled END USER IMAGE OPEN AREA MAPS Ser. No 12 179 692 entitled POSITIONING OPEN AREA MAPS and Ser. No. 12 179 713 entitled OPEN AREA MAPS WITH GUIDANCE the entire disclosures of which are incorporated by reference herein.

The present invention relates to navigation and more particularly to a method and system for generating an open area map that may be used for routing.

As the world population increases more and more infrastructure buildings exterior and interior development and other features to support human growth are being generated. Also existing infrastructure buildings parks and other environments are being adapted to accommodate more people and traffic. The increase and adaptation of environments impacts travel and how people go from one place to another.

Navigation systems and or devices are used to aid travel. For example vehicle navigation devices may assist a person driving on a road network. Such devices may provide routing and guidance to a desired destination based on existing roads or pathways.

However there are areas in which people move about that do not have set roads tracks or paths or in which such paths are not needed to travel from one point to another within the area. For example floors of a building parks or other exterior or interior areas are treaded upon on a daily basis. People are able to move about in such areas in any number of patterns to get from one place to another. However some movement or patterns of movement in these areas may be inefficient or unnecessary based on confusion lack of knowledge of the layout of an area or other factors. Also a person may not know how to get from one point to a desired destination in such areas.

According to one aspect a method of generating an open area map is provided. The method includes receiving an image of a layout corresponding to a real world area in which a person moves about. The image is in a vector graphics format. A reference region is determined using the image of the layout. A grid is combined with the reference region to generate a routable map. The routable map is configured to provide point to point routing within the layout.

The present invention is defined by the following claims and nothing in this section should be taken as a limitation on those claims. Further aspects and advantages of the invention are discussed below in conjunction with the preferred embodiments.

The image source is a website an application a program a workstation or computer a file a memory a server a beacon or map beacon a depository and or any other hardware and or software component or database that can store or include images or data associated with images. Alternatively the image source is one or more images.

In one embodiment the image source includes one or more images of a layout. The images are raster or pixel based images such as a JPEG Bitmap Pixmap Tiff or other pixel or raster based file format. The images may be raster or pixilated scanned copies of paper or hard layouts. Alternatively the images may be vector based images vectorized images or images in a vector graphics format. Layouts may correspond to real world areas in which a person pedestrian or people walk and or move about. The layouts may also correspond to future real world areas that have not been built yet. Alternatively the layouts may correspond to imaginary locales settings or areas.

The layouts may represent an unorganized or unconstrained geographic area. For example the layout is an area in which a pedestrian is not limited to travel only on a set road or path network. Rather the pedestrian may walk through public plazas parks buildings corridors lobbies or hallways having no associated road or path network or pattern. Additionally the pedestrian does not have direction restrictions as a vehicle on a road. Moreover the pedestrian has a greater degree of freedom of motion in the layout and may chose from a plethora of self determined paths in any given open area.

The images of the layouts may include images of a real world building floor plan a parking lot a park an indoor or outdoor recreation area and or other interior and exterior area plans corresponding to places where a person can walk or move e.g. via a wheel chair a bicycle or other mobile assistance device . The images are pre existing or publicly available images. For example the images are originally formed or created for purposes other than generating a routable map. The pre existing images may be generated by an entity separate from a developer of a routable open area map and or its end user. The pre existing images are available to the public or an entity for free or for a purchase price e.g. online . Alternatively self generated images images originally generated for creating a routable map or non public images may be used.

The image source is in communication with the device via the network . The network is the Internet an intranet a local area network LAN a wide area network WAN a virtual private network VPN a local wireless or wired connection e.g. a USB connection or other device connection and or any known or future network or connection.

The device receives images of layouts from the image source for generating routable open area maps. The device is a workstation computer editing device beacon or map beacon and or other computing or transmitting device. For example the device is an editing workstation. The device includes but is not limited to a display a processor a memory an application and an input device . Additional fewer or different components may be provided. Audio components may be provided. For example a speaker audio jacks and or other components for outputting or receiving audible or sound signals are provided.

The display is any mechanical and or electronic display positioned for accessible viewing in on or in communication with the device . For example the display is a touch screen liquid crystal display LCD cathode ray tube CRT display or a plasma display. The display is operable to display images such as images of layouts floor plans maps or other areas. The input device is a button keypad keyboard mouse trackball rocker switch touch pad voice recognition circuit or other device or component for controlling or inputting data in the device . The input device may be used to perform functions such as modifying received images e.g. adding doors or openings or using eraser tools.

The processor is in communication with the memory the application the display and the input device . The processor may be in communication with more or fewer components. The processor is a general processor application specific integrated circuit ASIC digital signal processor field programmable gate array FPGA digital circuit analog circuit or combinations thereof. The processor is one or more processors operable to control and or communicate with the various electronics and logic of the device . The processor the memory and other circuitry may be part of an integrated circuit.

The memory is any known or future storage device. The memory is a non volatile and or volatile memory such as a Random Access Memory RAM electronic a Read Only Memory ROM electronic or an Erasable Programmable Read Only Memory EPROM or Flash memory . A memory network may be provided. The memory may be part of the processor . The memory is operable or configured to store images of layouts received by the image source . The memory may also store images or data generated by the processor .

The processor is operable or configured to execute the application . The application is a software program used to generate open area maps that are routable based on pre existing images such as the images received from the image source . For example the processor runs the application and creates or generates or assists in generation of a routable map via input from the input device and or automated commands. The application may be stored in the memory and or other memory.

The device is operable or configured to send or transmit one or more generated routable open area maps to the user device or the user device may request a routable open area map via a network or connection . The connection is the Internet an intranet a local area network LAN a wide area network WAN a virtual private network VPN a local wireless or wired connection e.g. a USB connection or other device connection and or any known or future network or connection.

Alternatively the device may store upload or send one or more generated routable open area maps or data thereof to the database . The database may be a database a memory a website a server a beacon or other device used for storing receiving and or transmitting data corresponding to the routable open area maps. For example the database may store data entities that represent different layers of the open area map such as data corresponding to reference regions cost restrictions a grid or array image data and or other content. The user device may obtain a routable open area map or data thereof from the database via the network such as without communicating with the device . The network is the Internet an intranet a local area network LAN a wide area network WAN a virtual private network VPN a local wireless or wired connection e.g. a USB connection or other device connection and or any known or future network or connection.

Also routable open area maps may be pushed onto the user device . For example beacons map beacons or other devices can transmit or send routable open area maps or related content to the user device based on the location or position of the user device . In one embodiment a beacon can be placed at an entrance or passageway of a building or other area and once the user device comes within a certain range of the beacon a routable open area map associated with the area and or other related areas is sent to the user device .

The user device is used to operate one or more routable maps to allow a user to navigate in or on respective layouts or areas. The user device is a cellular telephone a mobile phone a personal digital assistant PDA a watch a personal navigation device PND a computer a digital floor plan device a portable or non portable navigation device a kiosk and or other fixed removable or transportable digital device. The user device includes but is not limited to a display a processor and a memory . Additional fewer or different components may be provided. For example audio and or application components may be provided. The display the processor and the memory may be similar to or different than the display the processor and the memory respectively.

In one embodiment a user such as a person working on a building floor may want to be able to route or navigate about his or her building floor. Accordingly an image of the layout or floor plan of the user s floor which is stored in the image source is transmitted and received at the device . Another entity such as a map developer operates the device . The map developer may be a person company or entity that develops maps for navigation or obtains and maintains map data and or a geographic database such as NAVTEQ North America LLC located in Chicago Ill. The map developer views the pre existing image of the layout on the display and generates a routable map based on the pre existing image via the input device and the software application . Automated commands and or processes may be used in development of the routable open area map. Alternatively the creation or generation of the routable open area map may be substantially entirely automated. The user may download or receive the routable map of his or her floor on the user device . For example the user uses the user device to download the routable map from the device or a storage site or component associated with the device e.g. via the connection such as a USB connection a wireless connection or other connection . Alternatively the user may download the routable map on a device e.g. a computer or a jump thumb drive different than the user device and then transfer the data associated with the routable map to the user device or other user device. The user then uses the device to display the routable map for routing guidance and or navigation purposes regarding the building floor.

The image also includes an image representation of an open space a walking grounds a common or public area and or a hall area for people to walk or move about to get from one place to another on the floor. Walls or barriers are depicted by corresponding associated or contiguous pixels or lines e.g. a heavy line of substantially the same or similar color. Entrances and or exits are depicted as openings or gaps in the walls or barriers that allow access between the interior area and an exterior area . The exterior area may represent an outer hallway an outside of the building e.g. a sidewalk street or road or other exterior environment.

The grid or mesh includes areas sections blocks or tiles . Alternatively the grid mesh or array may include unconnected dots or points corresponding to areas or sections similar to the tiles e.g. the dots or points replace or act as a substitute for the tiles . The tiles have a substantially rectangular or square shape and are substantially uniform in size. Alternatively the tiles may have a circular triangular or other geometric or polygon shape and the tiles may be different sizes at different locations rather than being uniform.

The grid may be applied over certain areas of the layout rather than the entire image or entire ground area. For example the grid may be applied only in hallway areas such as the interior area . In such as case the grid has a shape that corresponds to a pedestrian accessible contiguous sub area within the real world area in which the shape has a boundary that corresponds to the walls in the pre existing image. The grid or portions thereof may also be applied to areas designated within an image reference object e.g. the inner area of a room . Also tiles may automatically fill into contiguous open areas. For example a hallway or corridor area may be selected to automatically fill the area with tiles or sections of a grid or mesh.

The tiles may be assigned or designated coordinates such as local or global map coordinates. For example each center of a tile or other part of the tile is given a x y latitude and longitude or other coordinate designation. One of the tiles such as at a corner of the image may be designated as an origin point 0 0 for reference and positioning purposes. The coordinates allows items features or regions to be searchable. However for routing purposes the coordinates may not be used.

The non navigable tiles may be or represent tiles or dots or points removed from the grid or may be tiles or dots or points designated with a non navigable status. The non navigable tiles or the lack thereof may be represented as blank spaces in which spaces that are free of the grid or tiles are not navigable for routing purposes. Alternatively the non navigable tiles may be colored differently than the navigable tiles .

Navigable or non navigable tiles dots or points may be sub classified. For example each or some tiles may be associated with a feature or location related to the layout. In one embodiment tiles may be linked or correspond to a washroom area a narrow area a windowed area a dimly lit area a high traffic area a low traffic area or other area or feature. By classifying or sub classifying the tiles one can input preferences for routing purposes. For example a user may want to avoid high traffic areas and accordingly the user may input his or her preference before or during routing.

A wrap or boundary feature may be used regarding the grid . In certain cases a person may want to route from one point in the interior area to another point in the interior area but a path is generated that routes the person out into the exterior area and back into the area . Such routes may occur when it is optimum to route outside and back inside e.g. when having multiple openings between interior and exterior areas . However to avoid any routing to tiles in the exterior area a wrap or boundary feature may be used that bounds all routing within the area and associated areas. For example a boundary line or designation may be allocated along the circumference of the inner area. However the boundary feature will allow routing to the exterior area when a user selects a destination point to be in the exterior area or outside an inner area. Alternatively the tiles of the exterior area may be designated as non navigable or openings to the exterior area may be associated with non navigable tiles .

A connection point is also provided. The connection point may be generated or provided in a spatial or data layer separate from the grid or mesh . The connection point is represented as a tile or a subset of tiles within an area. The connection point may encompass the entire area of the elevators or a portion thereof. Alternatively the connection point may not be associated with a reference image object or reference region. The connection point represents or acts as a link to another map such an open area map that is routable for routing and navigation purposes. For example the connection point may correspond to one or more elevators a stairwell an escalator a ladder or other feature for moving a person to another floor or area. A plurality of connection points may correspond to respective individual elevators or features. In one embodiment the connection point is used to route between an area or point from the image to another point or area on another map or floor plan such as another map or floor plan representing another floor of the building e.g. a second floor a third floor or Nth floor . Alternatively the connection point may represent a connection for moving or transferring a person from one point to another point on the same floor or ground area. For example the connection point may correspond to a moving walkway or other transportation device. Also the connection point may represent a connection to another routable open area map associated with the same level or area. For example in one open area map a route may be generated to an area that is represented by a blank unspecific or general polygon or shape that represents a reference area such as a food court. A connection point can be placed at by or on the general polygon that represents the reference area in which the connection point corresponds to or directs one to another routable open area map that has detailed features and or reference regions within the original reference area e.g. the food court .

After graphics text separation the image reference objects go through vectorization to form the polygons reference regions or areas . The reference regions correspond to the different areas rooms or spaces in the image . The reference regions are associated with or correspond to respective navigable tiles and respective non navigable tiles represented by the grid on a different spatial layer.

Instead of or in addition to generating the reference regions from a raster image reference regions or areas may be generated based on a vectorized or vector graphics format image. is an example of a vector based image . The image may be a PDF PS SVG or other vector graphics format image. All or some features components or graphical representations in the image are represented by vectors or line segments rather than pixels. For example references image reference objects or areas conference room office and office may include or be represented by vector components as well as searchable text. Alternatively raster pixilated graphics or icons may be used in conjunction with vector based components to form an image.

In one embodiment the conference room may include a gradient filled color in which strength type or shading of the color changes along the area representing the conference room . The office and the office may have a flat color in which the color is constant or consistent about the area representing the offices and . Alternatively the offices and or may include a complex dynamic patterned or gradient color.

The image includes image reference objects and that correspond to the areas and respectively. The image reference object has a flat or constant color that replaces the gradient fill of the area . The image reference objects and may have the same or different color or flat color of the respective offices and . A toolbar menu or editor box may be provided to assist a developer in generating reference regions. For example the menu may include buttons or selection bars and . The buttons and correspond to the different colors in the image and the image reference objects having a certain color may be highlighted or color filtered by selecting the button with the respective color.

The grid or mesh layer may be compiled with the reference region layer a connection layer and or other spatial or data layers such as a cost layer or restriction layer to form or generate an open area map that can be used for navigation and or routing. Layers may also be combined at a runtime.

In one embodiment a user may want to use the open area maps and to route from an office on one floor to the gym on another floor of the building. Referring to the user searches for the office using a text search to designate an origin point . The text for the particular office is associated with the respective reference region which is associated with respective tiles and . Alternatively the user physically touches or selects the origin point on the display. Or the origin point is determined based on a global positioning satellite GPS system or device an indoor location system e.g. WiFi based or the fact that the location of the origin point is fixed e.g. a kiosk or a floor plan device on a wall . The origin point may correspond to one or more tiles within or associated with the reference region or reference image object of the office or may correspond to the entire area. Referring to the user then searches for the gym using a text search to designate a destination point . The text for the gym is associated with the respective reference region for the gym which is associated with respective tiles. Alternatively the user physically touches or selects the destination point on the display. The user may switch to the open area map or may view both open area maps and on the same screen or window.

After the origin point and destination point are selected various routes are calculated and or compared based on the underlying compiled grid. The routes may be calculated based on a Dijkstra method an A star algorithm or search and or other route exploration or calculation algorithms. Various aspects such as distance non navigable areas costs and or restrictions are considered to determine an optimum route. A path is generated based on the calculation. The path is displayed for the user to view and follow. The path shows a path that starts from the origin point in the office passes the conference room and uses the elevators via a connection point such as the connection . Then the open area map shows a path that starts from elevators at a connection point and leads to the gym at the destination point .

The calculation and determination of the routes and or the paths and are based on or formed of adjacent continuous or connected tiles. For example navigable tiles that border or touch each other are considered for point to point routing in which any area in the layout or any point associated with adjacent tiles can be routed to based on calculation regarding the grid or mesh i.e. not solely pre determined routes . Adjacent tiles forming a route may be connected or linked by their center points or other parts.

In one embodiment a graphical representation or an image of a layout such as the image or is obtained or received Step . For example a map developer using a workstation computer or other device such as the device downloads or requests a pre existing image of a layout such as a building floor plan via the Internet or other network or connection such as the network . The graphical representation of the image may be stored or located at a website server file another computer or other device or any other storage device or area such as the image source . The image of the layout may be received wirelessly and or through a wired connection. The received image may be modified. For example eraser or drawing tools or functions may be provided so that the map developer can add or remove image features. In some cases doors or openings may need to be added for routing purposes.

A grid mesh or array such as the grid or array is applied or overlaid on or over the image of the layout a copy of the image of the layout or a modified image of the layout Step . The map developer assigns a scale by designating a distance measurement within the layout. For example using a mouse or other input device such as the input device the map developer selects a space or distance between image objects such as the image objects and representing a width or length of a hallway or area. The map developer then assigns a value to that space or distance such as 1 meter or 3 meters. Alternatively designating a distance measurement may be entered via a pop up screen or a fill in box or the distance measurement may be automatically implemented based on pre existing distance markers in the image or pre determined parameters. By assigning a scale an understanding of distances between objects and areas within the layout is achieved.

The grid or mesh is then applied on the image of the layout or the grid or mesh is applied before assigning the scale. For example a grid covering substantially the entire image of the layout is provided. Alternatively certain or specific portions are chosen for applying the gird. In one embodiment the grid may be applied to only areas designated for walking between reference objects such as hallways or other ground or open areas. Therefore the grid or mesh does not intersect borders barriers and or walls within the image. Also the grid or mesh may be applied on internal areas such as areas within a room or image reference object. The map developer may choose where to apply the grid portions of the grid or multiple grids that may be joined via the input device. For example the map developer may click on or select a hallway area within the layout to apply a grid throughout the hallway area. In alternate embodiments a grid or a portion thereof is automatically overlaid over substantially the entire image of the layout or portions of the layout based on color image recognition or other parameters.

The grid mesh or array is composed of tiles blocks sections or areas such as the tiles or similar or corresponding dots or points as mentioned above. Based on the scaling the tiles are assigned or correspond to a measurement value. For example each tile may have a measurement value of about 1 square meter square meter or other value. Alternatively each tile may have any other measurement value or different values from each other. The resolution or number of tiles or points may be adjusted by the map developer or automatically. For example for a finer resolution the grid or mesh may be adjusted or changed to include more tiles or points and for a lower resolution the grid or mesh may be adjusted to include fewer tiles or points. The adjustment of the number of tiles or points may be based on the number or positioning of image reference objects within the layout and or other factors. For example the size of the tiles may be selected to match a human or pedestrian scale so that at least one navigable tile may fit in narrow or narrowest passages in the real world environment. A maximum tile size e.g. at most about 15 20 or 30 inches in length and or width or other length width dimensional and or area value may be chosen or be pre determined to allow for navigable tiles to be placed in the narrowest or smallest areas hall or corridors for routing. An appropriate tile or area size is chosen to avoid the lack or inability of routing in some suitable areas of the layout. Also non uniform sized tiles and or shapes may be used for different areas. For example larger areas may use larger sized tiles and smaller or narrow areas may use finer or smaller sized tiles.

Local or global map coordinates are assigned or designated. For example center of the tiles or other parts of the tiles or points or dots of an array or grid are given a x y latitude and longitude or other coordinate designation. An origin is selected by assigning a 0 0 or origin point to one of the tiles e.g. a corner tile . The coordinates can be used for searching or identifying reference image objects reference regions or other features or vice versa. Point to point routing may however be based on adjacent or contiguous tiles and therefore the coordinates may not be needed for routing calculations. Alternatively the coordinates may be used for distance and cost determinations when calculating a route.

A routable map such as the map or is generated or created based on or as a function of the grid array or mesh Step . is a flowchart showing an example of a method for generating the routable map including steps that may be wholly or partially encompassed by Step . A non navigable area is designated in the grid or mesh Step . For example the map developer clicks on or selects areas within the layout of the image to convert them to non navigable tiles or areas such as the non navigable tiles or areas . The map developer may select images of walls or barriers that cannot be walked through in the real world as non navigable areas. The selection may assign tiles with a non navigable status or may remove tiles. The designation of non navigable areas may also be automated. For example instead of selecting multiple areas in the image to be non navigable the map developer may click on or select a wall or barrier to be non navigable and all other features or image objects with the same or similar color or pixel level of the selected wall or barrier may automatically be associated with non navigable areas or tiles. Alternatively pre determined color or pixel levels or image recognition factors may be entered so that non navigable tiles or areas are automatically generated once a grid is overlaid without involvement of a map developer or other entity. In such automated cases graphical representations of text or descriptions of image objects in the layout may be removed or separated prior to designation of non navigable areas. This is so because the descriptions may be mistakenly assigned as non navigable areas. Alternatively a non navigable area may be designated by originally not applying a grid or a portion thereof to areas intended to be non navigable.

A plurality of reference regions or areas are generated Step . The generation of the reference regions occurs on a different spatial layer than the grid or mesh. The grid or mesh may or may not be viewed when creating the plurality of reference regions. In one embodiment the plurality of reference regions are automatically or semi automatically generated based on a raster image. For example a plurality of reference image objects are identified or determined in the raster image such as the image . The raster image of the layout is binarized. Binarization of the image allows for logically comprehending the layout by using digital 1 s and 0 s. For example a Trier Taxt binarization is used. The Trier Taxt binarization provides for edge preservation. Alternatively other binarization techniques or methods may be used. The binarization may depend on three parameters or factors such as a sigma an activity threshold and a pruning factor. Alternatively more or less factors may be considered.

The sigma is a larger sigma rather than a lower sigma that may correspond to noise sensitivity. Activity at a pixel may be proportional to a local average of a gradient magnitude and pixels with lower activity than the activity threshold may be set to zero. The pruning factor is used for removing small connected components. In one embodiment the sigma is set to about 1 the activity threshold is set to about 2 and the pruning factor is set to about 1. Alternatively the factor values may be set to any other value and may be adjustable.

Regarding identification of the reference image objects a text graphics separation is performed after binarization. For example the graphical description or text corresponding to each of the reference image objects is separated from the respective image objects. Any future or past graphics text separation may be used. The separated text is linked to or identified with the respective image object. For example a text region may be designated in each of the reference image objects. After the separation OCR is performed on all or some of the graphical descriptions to convert them into searchable text such as the text or text that can be recognized as having meaning or a definition rather than a graphical representation of text. Separation of the graphical descriptions may facilitate or improve the OCR. Alternatively the OCR may be performed without the separation. Text aliasing may be reduced by doubling or increasing resolution of the original image of the layout such as by using Lanczos re sampling before applying OCR. In alternate embodiments other text recognition methods functions or algorithms may be used.

The plurality of reference regions such as the reference regions are generated by forming borders or boundaries corresponding to the respective reference image objects. For example after binarization and or graphical description separation the reference image objects are vectorized. Lines or vectors are generated or created between the digital or binarized data points to form shapes corresponding to the image objects within the layout. For example the Rosin and West vectorization algorithm is used. Alternatively other future or past vectorization algorithms may be utilized.

Closed polygons are identified to determine the reference regions associated with the original reference image objects. For example based on the vectorization closed polygons or other shapes are determined. The closed polygons may be determined via planar curve vertices edge and or face techniques. Any future or past computational geometry algorithms or methods may be used. A closed polygon may correspond to an office a room or other area.

Some reference image objects may include gaps or symbols of doors such as the gaps or symbols and . For the purpose of determining reference regions all line segments identified in the vectorization may be visited to determine or identify gaps that can be closed to form a closed polygon. The gaps are closed to identify the respective reference regions. Regarding symbols of doors the map developer may identify or provide information that links a unique symbol such as the symbol to a door opening entrance and or exit. The association may be stored in a memory or look up table. After or during vectorization the symbols of the doors can be identified based on matching and replaced with gaps. The gaps are then closed to identify the respective reference regions. Alternatively a line or vector replaces the symbol of the door to close the polygon rather than forming a gap and then closing the gap. Multiple gaps or symbols of doors for a given image object may be visited or closed to form a closed polygon for determining a reference region. The gaps or symbols of doors correspond to navigable tiles on the grid that is in a separate spatial layer relative to the reference image objects. The doors or openings may be inferred by comparing the navigable tiles of the grid with respective reference regions.

In another embodiment reference regions are generated based on a received vector graphics format or vectorized image such as the image or . is a flowchart showing an example of a method for determining one or a plurality of reference regions including steps that may be wholly or partially encompassed by Step .

The vectorized or vector based image is modified or altered Step . For example the vector based image may be converted to a SVG format. Alternatively the vector based image may already be in a SVG format. The SVG format corresponds to an XML in which graphics content may be manipulated changed or removed using XML tags queries and or other features.

Text corresponding to or associated with the vector based image may be removed Step . Text within references or areas such as the areas or in the vector based image may be removed from the SVG format. For example XPath queries e.g. text may be used to obtain or identify text corresponding to certain areas in the vector based image. The text and or corresponding tag may be deleted or removed in the SVG format. A bounding box or text area may be saved or stored such as in a look up table or other memory to associate the removed text with the respective region of the image.

Color corresponding to or associated with the vector based image may be replaced or changed Step . For example the original vector based image may include complex color shading such as gradient fills that may make it difficult to generate respective reference regions. Accordingly using XPath queries e.g. fill one may replace a gradient fill with a flat or consistent color for areas in the image. For example a tag in the SVG format may be changed to include instructions or data representing a flat color. Alternatively color may be provided to areas that did not have color to aid in generating reference regions.

The modified or altered vector based image is rasterized or pixilated Step . For example after the SVG format is changed pixels are created or burned to generate a raster based image such as the image . Any known or future rasterization techniques or processes may be used. The raster image includes reference image objects such as the objects and with removed text as well as flat or consistent color.

Boundaries of one or more objects are generated to form respective reference regions Step . For example specific or certain objects in the raster image are highlighted or color filtered. In one embodiment a menu or toolbar such as the toolbar is provided to select from any of the colors in the raster image. Using the toolbar or other selection feature a desired color is highlighted or identified. For example a color of a certain type of reference object such as the objects and is selected. Based on the selection all other colors are blacked out hidden removed or filtered to show the outlines of the selected objects such as shown in the image . Alternatively the respective objects that have been selected based on color may be highlighted with or without filtering the other colors. After the objects such as the objects and have been identified by the color filtering or highlighting boundaries borders or lines are formed or outlined around the perimeter of the objects to generate respective reference regions such as the reference regions . For example a vectorization process may be used to connect lines to form a polygon that represents a reference region.

The removed text may be bound or replaced in the generated reference regions. For example based on the bounding boxes the text that was removed is associated with regions of the image. The text may be aligned with the generated reference regions for appropriate association. Alignment or association of text may include using geometric techniques such as looking at a maximum or greatest area in which the text overlaps to determine the appropriate or correct generated reference region for the text.

Alternatively instead of or in addition to converting the vector based image into a SVG format modifying the image generating a raster image and or using color filtering or highlighting to generate the reference regions the original vectors or polygons in the received vector based image may be determined and used. For example the original vector graphics image such as the image may be used to determine or identify polygons or vector objects. In one embodiment the lines or vectors associated with the office are identified and used as a reference region such as one of the reference regions . However identifying determining and or using the original vector components may be difficult or may require more processing because the original vectorized image may include a complex data structure. For example PDFs or other vector graphics format images may include clipping masks layered vector data and other components or features that may make it difficult to identify or determine reference regions or polygons in a form desired for use in the routable open area map.

The names or text associated with each of the reference image objects are populated in a name attribute corresponding to the generated reference regions. For example the text generated from the OCR or vector based process is associated with text regions of the generated reference regions. A look up table database or other memory feature links the text descriptions to each respective reference region. A question and answer feature or a verification function may be implemented so that the map developer can correct errors in the generated text or association of text with reference regions. A reference region may be searchable based on the associated text and vice versa.

The reference regions may also be associated with a reference type. For example each reference region may correspond to or be designated a type such as a restaurant office department store grocery store bathroom or other designation based on the associated text function purpose and or other factors of the reference region. These types or keywords may be stored in a database or look up table and may be linked or associated with respective reference regions. The type or tag may be more specific such as particular names of stores or areas e.g. McDonalds restaurants that may or may not be different than the generated text or name. Also logos and or respective websites may be associated with the reference regions. A reference region may be associated with one or more types or tags and may be searchable based on the types or tags.

The reference regions and associated text and type may be generated manually instead of or in addition to being automatically generated. For example the map developer using program or application tools may outline or replicate the reference image objects in the original image of the layout to generate the reference regions such as the reference regions in a spatial layer separate from the grid or mesh. Also the map developer may read or view the original descriptions of the reference image objects and enter input or type in equivalent text such as the text and or types to be associated with the generated reference regions.

The generated data or data layers associated with a digital open area map such as the grid or array and the reference regions are stored such as in the database . Separate data or spatial layers may be stored as individual XML files or other data. For example data corresponding to the underlying image the grid cost restrictions and or the reference regions are saved or stored. Position or location information or data corresponding to the grid or respective tiles such as regular sized tiles as well as the reference regions or other data are also saved and or provided in the data structure. The position information is used as a spatial reference regarding appropriate location of the different data entities. The position information may be based on an original scale a reference or coordinates such as relative to the underlying image. The database may compile the separate data layers to form a routable open area map. Accordingly the database may stream or send the compiled open area map data to the end user device. Alternatively separate data layers may be sent to the end user device for compilation on the end user device. Also a compiled open area map file or data may be stored in the database rather than storing separate data layers.

Referring back to different spatial or data layers are compiled or combined to form an open area map such as the open area map or that is routable Step . For example the plurality of reference regions including the associated text and tags are compiled with the grid or mesh. The compilation links or associates respective tiles to the generated reference regions such as tiles that are to be within a reference region substantially adjacent to the reference region and or touching or intersecting a border of the reference region for search navigation routing and other purposes. Also connections or connections points which may be generated on a separate spatial layer may be compiled with the grid and the plurality of reference regions. Other components or features such as restrictions or cost features that may be on separate or different spatial layers may also be compiled with the grid or mesh. Any future or past compilation technique or method may be used. Also data layers may be combined at a runtime. Alternatively the grid reference regions and or connection points as well as other features may be generated and exist on the same spatial or data layer rather than different layers. Accordingly a final compilation may not be required. Also some spatial layers may not be compiled or may not be used. For example routing may be accomplished using navigable and non navigable tiles without associating the tiles with generated reference regions.

Referring back to another or second graphical representation or image of a layout such as an image similar to the image or is obtained Step . For example the second image may be an image of a floor plan of another floor of the building e.g. the image obtained at Step represents one floor of a building and the image obtained at Step represents another floor of the building . The second image may be obtained or received by the map developer in a similar manner as the first image was obtained at Step .

Another grid mesh or array is applied to the second image Step such as applying the grid at Step . Another or second routable map is generated based on or as a function of the second grid Step such as generating the first routable map at Step . The first and second routable maps are linked or associated with each other such as via one or more connections or other features Step . For example a connection point in the first routable map is associated with a connection point on the second routable map for routing purposes. The connection points may correspond to an elevator connection such as the connection points and or other connection linking two floors of a building or other areas. Alternatively one or the same connection point is used to link the two routable maps. Any number of routable maps may be linked together via one or more connection points or other features e.g. 1 to an Nth number of routable maps corresponding to different floors of a building or other areas may be generated and linked or associated together .

In one embodiment an end user such as a pedestrian uses a device such as the device for point to point routing or navigation in an open area. For example one or more routable open area maps such as the open area map or are downloaded or sent to the user device such as via the connection or other connection. Alternatively one or more routable open area maps are pushed onto the user device via a proximity beacon or transmitter or other device based on location or position.

The user views one or more open area maps such as via the display . An origin or origin point such as the origin point is selected. For example the user types in or enters an area or point of origin that acts as a starting location for routing. The user may enter a name or text describing a reference region and the respective area in the open area map may be allocated as the origin point based on searching or accessing a look up table linking reference regions with names or text. Alternatively the user may click on select or physically touch an area on the open area map i.e. touch the display screen to choose the origin point.

The origin selected in the open area map is identified. For example one or more tiles associated with the origin point or reference region associated with the origin point is determined considered recognized targeted focused upon and or highlighted for route calculation.

A destination or destination point i.e. the place or area the user wants to be routed to such as the destination point is selected by the user in a similar manner to selecting the origin point or through different methods. The destination selected in the open area map is identified in a similar manner to identifying the origin point or through different methods.

A route from the selected origin to the selected destination in the open area map is calculated. For example adjacent or connected tiles that are navigable such as the tiles are assessed to determine an optimum or preferred route from the origin point to the destination point. Non navigable areas or tiles such as the tiles are avoided or routed around. One or more possible routes may be calculated using geometric and or mathematical functions or algorithms. For example centers or other locations of each of the tiles are connected or associated with each other to form potential routes. An optimum route is chosen based on distance as well as other factors such as cost restrictions or user preferences that may be inputted e.g a user may want a route to avoid or pass by a desired area . The user preferences may be based on classification or sub classification of tiles. For example each or some tiles are associated with a feature related to position location and or type of area e.g. major intermediate or minor corridor hallway pathway or area high or low traffic area unpopular or popular area scenic area narrow area isolated area sloped area flat area carpeted area or size length or width of an area . The tiles may also be sub classified based on what reference regions or areas they are linked to proximate to or pass by. Different tiles may be ranked or ordered based on the sub classification. In one embodiment the user may input or choose to avoid high traffic areas or major corridors when routing.

A Dijkstra method an A star algorithm or search and or other route exploration or calculation algorithms may be used to form lines curves or routes between the points of the connected tiles. A Douglas Peucker method or algorithm may be used to smooth or simplify the calculated lines or routes. For example by connecting the center of adjacent tiles together jagged sharp or triangular edges may be formed in the route from the origin point to the destination point. To minimize distance and provide a smooth line or curve for the route the Douglas Peucker algorithm can find or provide an averaged route from the origin to the destination. The Douglas Peucker algorithm is modified to avoid non navigable tiles and may be adjusted to change threshold levels for line smoothing or averaging. Alternatively other line smoothing algorithms or methods may be used.

Calculated routes and generated paths may be saved or stored for future use. For example once a path is generated it may be saved as a pre determined path that can be reused when a user desires to be routed from the same origin to the same destination. Some rather than all paths or routes may be saved. For example routes or paths between major or popular reference regions may be stored while paths regarding less traveled or minor reference regions may not be stored. Also partial routes or paths may be stored in which some parts of the path not the entire path are saved. Additionally routes or paths between connections or connection points may be pre calculated or predetermined and stored for routing. For example a user may want to route from one point to another in which one or more connections may be used. In this case a route is calculated from an origin to a connection as well as from the other connection to the destination and the route between the connections has already been calculated which saves time and processing. Routes may be stored saved ranked or ordered in multiple data layers. For example higher layers may include main major or more important routes. Alternatively routes and paths are always recalculated and regenerated.

A path from the selected origin to the selected destination is generated based on the calculation of the route. After or during calculation and selection of one or more routes all of the tiles associated with an optimum or preferred route are identified or determined as the path. For example the Douglas Peucker algorithm or other algorithm may form a line and or curve that passes over certain navigable tiles. Those tiles are then identified entered stored or highlighted as the path for the user to take to go from the origin point to the destination point. The determined path then is displayed such as the displayed path or to the user in the open area map for routing purposes.

In one embodiment the user may receive partitioned data when using the open area maps for routing and or navigation. User devices such as the device may include resource constrained components in which processing speeds memory or other features may not be as high fast or large as other devices. Accordingly instead of downloading or executing all the data associated with multiple open area maps at the same time data may be received or executed on an as needed basis. For example a user may download or initiate one open area map or a portion thereof when beginning navigation e.g. a first floor or a part of the first floor including the origin is displayed or loaded for routing . Then when the user enters or is routed to a connection or connection point e.g. to go to a second or other floor or area the connected open area map data is then downloaded or initiated for continuing the routing process. Also different spatial layers or features of an open area map may be downloaded or executed on a partitioned basis or at different times.

The open area maps discussed above may or may not include navigation related attributes or nodes and road or path segments that are collected and organized into a geographic database such as used for in vehicle navigation systems portable navigation devices real world vehicle navigation maps and or real world pedestrian navigation maps. The navigation attributes may include turn restriction content speed limit information optimal or popular path data footpath content sign information and or other attributes for performing navigation related functions such as route calculation destination time calculation route guidance and or other real world navigation functions.

The open area maps may be connected or in communication with real world vehicle and or pedestrian maps or map data that are based on or include collected and organized navigation attributes and or nodes and links or road path segments. For example an open area map of a floor of a building a building or other open area map may connect to a road network map for routing and navigation purposes. A user may use a device to route within a building floor to navigate him or her to an outside area such as the area . Once the user reaches the outside area the user may want to use a set road network to navigate to another part of a city or other location. The user s device or other device that can communicate with the user s device may execute bring up or show a vehicle navigation map that performs navigation related functions regarding the road network. Any combination of open area maps and navigation maps or data based on collected attributes may be connected with each other for routing and or navigation purposes.

In the description above the open area maps used for routing focus on building floors or floor plans. However the features described may be used for any number of open areas. For example images of layouts of parks and outdoor environments may be obtained and used to generate routable maps as described above. Different sections of a park such as picnic areas jungle gyms slides restrooms and other areas may be defined as separate reference regions. Therefore routing can be generated over grassy areas similar to routing between offices mentioned above. Parks may have walking paths that may be incorporated in routing. Alternatively pre determined walking paths or routes may be avoided in routing. Also non navigable tiles may be used or implemented for borders or barriers. For example lakes ponds or other water areas in the park may be bordered with non navigable tiles so that one is not routed through water. Other barriers or desired boundaries such as hazardous areas train tracks or rocks may be associated with non navigable tiles. Alternatively navigable tiles may be used if there is a reason to pass through some of these boundaries. For example if a boat exists to take a person from one side of a lake to another then a boat area may be associated with navigable tiles.

The tiles or objects associated with the image of a park or outside area may be sub classified. For example some tiles may be associated with grass areas and some tiles may be associated with sidewalks. A user or other entity may input a preference such as grass only sidewalk only or other designation for routing purposes. Accordingly routes may be generated by avoiding or using certain specified tile types e.g. generating a route over only grass areas and avoiding sidewalks or vice versa .

In another embodiment a pre exiting image of a parking lot may be obtained and used to generate a routable open area map. Each of the individual parking spaces may correspond to different reference regions. The outlines of the parking spaces may be considered barriers that may or may not be associated with non navigable tiles. For example the outlines of the parking spaces may be designated as non navigable areas so that a route is not generated through parking spaces e.g. for safety to pedestrians cyclists or others and also for practicality because the spaces may be filled with cars . However certain areas of the outlines of the parking spaces may be designated as navigable to simulate the concept that pedestrians may walk or navigate between parked cars. The parking lot may have multiple levels of parking floors which may be associated with each other via a connection such as the connection or representing an elevator stairs or other connection.

Other areas or environments may be used to generate routable open area maps. For example pre existing images of amusement parks malls museums and other indoor or outdoor areas may by obtained and used for generating routable maps or plans. In one embodiment an image of a trade show area or floor plan or other temporary layout may be obtained. For example the layout setup for a trade show may last or exist for only about a week less than about 3 months or other time periods. The image of the temporary layout may be obtained and used to generate a routable open area map as described above. Therefore after a certain time period such as less than about 3 months or other temporary time period the generated routable map may no longer be applicable for the location or area. Also the generated open area map may be time boxed based on the time period of the temporary layout. For example the open area map or portions thereof such as reference regions or other features may disappear be erased or be inoperable when the actual layout is changed or taken down after the allocated time period. The open area map or features thereof may be erased by the executing device based on a timer within the device or a communication or signal from an outside source. Also events or features associated with certain reference regions may be time boxed or used to time box the specific reference regions. For example a speech show or activity may occur at a specific area e.g. reference region for a certain time period. Accordingly the reference region may be only routable or may only exist for the specific time period associated with the speech show or activity. In another alternate embodiment reference regions may be mobile such as a mobile truck or moveable store which makes the reference regions temporary for a specific location. Or reference regions may be routable for a temporary time period based on how long an item is on sale for a given reference region store or stall.

In the description above the application of the grid or mesh focuses on but is not limited to a two dimensional format. The grid or mesh may be a three dimensional grid or mesh including points or coordinates in an x y and z direction e.g. the coordinates may include longitude latitude and altitude information or local coordinates . For example the image of the layout obtained may include three dimensional features. For example a floor plan may have floor ramps steps or stairs a bi level area or other features that are displayed or designated in three dimensional space. Also a hill or peaks and valleys in a park area may be displayed or provided in a three dimensional space. Therefore a three dimensional grid or mesh may be applied on or over the image to generate a routable open area map as described above. The addition of the z direction may require additional calculation for determining a route and or path. For example height may be a factor in determining an optimum or preferred route. Instead of using square tiles triangular sections or tiles may be used for the three dimensional grid or mesh. Alternatively other geometrical shapes may be utilized.

A three dimensional grid or mesh may be used for routing a person from one point to another in addition to helping a person find an object. For example images of layouts of a grocery store or retail store having vertical shelves of products and goods may be obtained. A three dimensional grid may be applied in which the floor area is overlaid with two or three dimensional tiles and the vertical shelving areas are overlaid with a grid or mesh as well. Different products or goods on the shelves may be designated as reference regions. Accordingly an open area map may be generated that can route a shopper or user to one place in the store to another place where a product can be found on a proximate or nearby shelf. Then a route can be calculated on the grid over the shelf or vertical area pointing to the specific or selected product. The shopper or user may not walk on the shelf but the route may be useful in showing the shopper or user where exactly the product is on the shelf. Or a route can be calculated to end at a ground or floor tile that is nearest to the shelf.

In another embodiment instead of and or in addition to using a grid mesh or array as described above color may be used to designate navigable and non navigable areas. For example the color white may be associated with navigable areas and the color black may be associated with non navigable areas. Any number and types of colors may be used. Accordingly routes may be calculated based on the placement of respective navigable and non navigable colors. For example paths or routes may be generated within navigable colored areas and around non navigable colored areas based on distance algorithms. Also different shades of color or gradation of color may be used as factors or cost for calculating or generating routes.

Furthermore as described above a map developer obtains an image and uses a workstation computer and or device such as the device to generate a routable open area map. The open area map is then received by an end user or at an end user device such as the user device . However an end user or other entity separate from a map developer may obtain an image of a layout and generate a routable open area map automatically and or manually. For example an end user may obtain and or purchase a software application for creating open area maps from a map developer or other entity.

The device may be operated by an end user such as a personal computer. Alternatively instead of using the device to generate a routable open area map and sending the open area map to the user device for use the user device may be used to generate and use a routable open area map bypassing the device . Or the device and the device may be combined into one device or system.

The logic software or instructions for implementing the processes methods and or techniques discussed above are provided on computer readable storage media or memories or other tangible media such as a cache buffer RAM removable media hard drive other computer readable storage media or any other tangible media. The tangible media include various types of volatile and nonvolatile storage media. The functions acts steps or tasks illustrated in the figures or described herein are executed in response to one or more sets of logic or instructions stored in or on computer readable storage media. The functions acts or tasks are independent of the particular type of instructions set storage media processor or processing strategy and may be performed by software hardware integrated circuits firmware micro code and the like operating alone or in combination. Likewise processing strategies may include multiprocessing multitasking parallel processing and the like. In one embodiment the instructions are stored on a removable media device for reading by local or remote systems. In other embodiments the logic or instructions are stored in a remote location for transfer through a computer network or over telephone lines. In yet other embodiments the logic or instructions are stored within a given computer central processing unit CPU graphics processing unit GPU or system.

It is intended that the foregoing detailed description be regarded as illustrative rather than limiting and that it is understood that the following claims including all equivalents are intended to define the scope of the invention.

