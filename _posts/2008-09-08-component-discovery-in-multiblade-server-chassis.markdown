---

title: Component discovery in multi-blade server chassis
abstract: An I/O module includes a switch module, a redundant array of independent disks (RAID) controller and a baseboard management controller (BMC). A first address for a first component of the plurality of components is received. The first address is provided by a user. The switch module is queried for additional addresses for additional components of the plurality of components. The switch module obtains the additional addresses for the additional components from a first persistent storage location associated with the switch module. The first and additional addresses for the first and additional components are stored in a second persistent storage location accessible by the BMC, the switch module, and the RAID controller. Synchronization of the first and additional addresses for the first and additional components in the second persistent location is controlled by the BMC.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08082391&OS=08082391&RS=08082391
owner: International Business Machines Corporation
number: 08082391
owner_city: Armonk
owner_country: US
publication_date: 20080908
---
The present invention relates in general to computers and more particularly to a method system and computer program product for discovering components in a multi blade server chassis.

Multiple blade servers are computers that consolidate high density server boards blades in a single blade chassis server blade chassis . Typically a blade chassis accommodates multiple hot swappable blades.

Server blades are widely used in datacenters to save space and improve system management. Either self standing or rack mounted the blade chassis provides the power supply. Each blade may have its own central processing unit CPU memory and hard disk. Server blades generally provide their own management systems and may include a network or storage switch.

Most computer systems require storage and a means of accessing the storage. Storage may be accessed by means of redundant array of independent disks RAID controllers either singular or redundant. The RAID controllers in turn provide connectivity to the fundamental storage such as hard disk drives.

A multi blade server chassis may include various components such as the aforementioned switch RAID subsystem including the RAID controllers and individual server blades. Each of these components resides in a physical location and are dependent upon each other. When setting up the chassis each of the components has its own internet protocol IP address. The RAID subsystem for example has two IP addresses one for each controller.

Without a discovery mechanism a user must manually add each individual component including such information as an IP address and additional information needed to create and establish the relationship between components in the chassis. For one embodiment this includes adding a total of four IP addresses two for the RAID subsystem and one for each switch. In addition without a verification mechanism there is no way to verify the user based input of component relationships is accurate.

In light of the foregoing a need exists for a discovery and verification mechanism to assist a user in adding components and verifying component relationship in a multi blade server chassis. Accordingly in one embodiment by way of example only a method for discovering components on a multi blade server chassis having an input output I O module in communication with a plurality of components managed by an advanced management module AMM is provided. The I O module includes a switch module a redundant array of independent disks RAID controller and a baseboard management controller BMC . A first address for a first component of the plurality of components is received. The first address is provided by a user. The switch module is queried for additional addresses for additional components of the plurality of components. The switch module obtains the additional addresses for the additional components from a first persistent storage location associated with the switch module. The first and additional addresses for the first and additional components are stored in a second persistent storage location accessible by the BMC the switch module and the RAID controller. Synchronization of the first and additional addresses for the first and additional components in the second persistent location is controlled by the BMC.

In another embodiment again by way of example only a system for discovering components on a multi blade server chassis having a plurality of components managed by an advanced management module AMM is provided. An input output I O module is in communication with the AMM. The I O module includes a switch module a redundant array of independent disks RAID controller and a baseboard management controller BMC . The I O module is adapted for receiving a first address for a first component of the plurality of components wherein the first address is provided by a user querying the switch module for additional addresses for additional components of the plurality of components wherein the switch module obtains the additional addresses for the additional components from a first persistent storage location associated with the switch module and storing the first and additional addresses for the first and additional components in a second persistent storage location accessible by the BMC the switch module and the RAID controller. Synchronization of the first and additional addresses for the first and additional components in the second persistent location is controlled by the BMC.

In still another embodiment again by way of example only a computer program product for discovering components on a multi blade server chassis having an input output I O module in communication with a plurality of components managed by an advanced management module AMM is provided. The I O module includes a switch module a redundant array of independent disks RAID controller and a baseboard management controller BMC . The computer program product comprises a computer readable storage medium having computer readable program code portions stored therein. The computer readable program code portions comprise a first executable portion for receiving a first address for a first component of the plurality of components wherein the first address is provided by a user a second executable portion for querying the switch module for additional addresses for additional components of the plurality of components wherein the switch module obtains the additional addresses for the additional components from a first persistent storage location associated with the switch module and a third executable portion for storing the first and additional addresses for the first and additional components in a second persistent storage location accessible by the BMC the switch module and the RAID controller. Synchronization of the first and additional addresses for the first and additional components in the second persistent location is controlled by the BMC.

The present description and claimed subject matter describe exemplary system method and computer program product embodiments for simplifying and automating the discovery and verification process of components in a multi blade server chassis. The illustrated embodiments facilitate communication between an advanced management module AMM and other components within the multi blade server chassis. Such facilitation may be made possible for example using an application programming interface API to perform such functionality. This functionality simplifies the configuration process of components in the multi blade server chassis. In one embodiment for example the user need only enter a single IP address for a component while the mechanisms of the present invention obtain remaining IP addresses and component information for the remaining components. All network port IP information needed to manage the components may be persistently stored on switch RAID controller and media tray components residing in the chassis and synchronization between the components may be controlled by a baseboard management controller BMC residing in or otherwise associated with an input output I O module operational on the chassis.

Server blade chassis has one or more advanced management modules AMM . In the depicted embodiment server blade chassis has a primary advanced management module and a back up advanced management module . Each management module is capable of managing multiple server blades . During normal operations one of the local management modules or are coupled to server blades via a Local Area Network LAN a midplane and a plurality of Baseboard Management Controllers BMCs each server blade having a BMC to form an in band management pathway. LAN and BMC are discussed in further detail below.

Midplane is a backplane mounted in the middle of server blade chassis that contains circuitry and sockets into which additional electronic devices or cards including server blades may be inserted. Midplane contains at least one bus for secure in band internal communication between management module and server blades as well as between and among server blades themselves via respective BMCs 

When a server blade is inserted into a specific socket a physical address is established for that server blade . For example consider server blade being inserted into socket . A control logic detects the presence of server blade in socket . Logic may comport with the Electronics Industry Association EIA RS485 Standard for data communication. In other embodiments Logic may be compliant with the Phillips Inter IC Inter Integrated Circuit standard incorporated by reference in its entirety herein and commonly referred to as IC or with an Ethernet network standard. Logic operating in conjunction with management module assigns a physical address on a bus in midplane to server blade when server blade is inserted into socket . Each server blade may be associated with a unique logic that is connected to midplane as depicted in . Alternatively all server blades may use a single logic .

Each server blade may have a unique Internet Protocol IP address on midplane . That is midplane may support intercommunication using IP addressing protocol in which each device connected or coupled to midplane contains an IP address assigned by logic not shown that is either within or outside server blade chassis . For example a Dynamic Host Configuration Protocol DHCP server may be used to assign an IP address to server blade . Communication with server blade is thereafter via a Network Interface Card NIC that is associated with server blade

In accordance with the illustrated embodiment an I O module is connected to NIC . Module may be used in pairs e.g. module to provide redundancy. I O module includes an integrated switch module such as a serial attached SCSI SAS switch module. Switch modules provide connectivity to Ethernet or SAS for example. RAID controllers and are incorporated into the I O modules and . The RAID controllers do not take up a blade slot. RAID controller is interconnected to RAID devices such as storage devices in a RAID configuration. The RAID devices located within one or more blades . The RAID controllers and attached RAID devices may collectively be thought of as a RAID subsystem of the server blade chassis.

A baseboard management controller BMC is also integrated into the I O module . BMC may be adapted to store IP addresses of various components of chassis in several locations. A copy may be stored in a persistent storage location of each switch module . A copy may be stored in a persistent storage location of RAID controller . A copy may be stored in persistent storage of a media tray not shown . Similarly a copy may be stored in switch module and RAID controller . The BMC in cooperation with the I O module controls the process of synchronizing the various copies. In addition to controlling synchronization of component addresses the BMC and I O module may be adapted to perform additional functionality as will be described following.

Each server blade may have at least one central processing unit CPU and a non volatile memory NVM . NVM is a Flash Read Only Memory Flash ROM or Flash Memory that can be erased and reprogrammed in units of memory referred to as blocks. NVM may also include non volatile Electrically Erasable Programmable Read Only Memory EEPROM that is similar to Flash Memory except that EEPROM is erased and rewritten at the byte level and is usually smaller in capacity. The server blade may be oriented as a storage blade with a number of integrated storage devices such as disk drives or a processor blade with one or more processing devices for performing computing processing.

When a server blade is shipped from a manufacturer the NVM may be pre burned with firmware including a BIOS as well as software for monitoring the server blade . Such monitoring may include controlling Direct Access Storage Devices DASD s monitoring and controlling voltages throughout the system determining the power on status of the server blade requesting access to a shared keyboard video mouse Compact Disk Read Only Memory CD ROM and or floppy disk drives as well as monitoring the Operating System OS running on the server blade .

Advanced management modules are capable of detecting the presence quantity type and revision level of each server blade power module and midplane in the system. Management modules may also directly control the operation of each server blade and the power module and may directly without using the BIOS in the server blades or indirectly using the BIOS control the operation of cooling fans and other chassis components.

Each server blade has a BMC that provides local supervisory control of the server blade to which the BMC is associated. Each BMC is able to communicate with a local management module by either using communication path in band network or alternatively by using switches and NICs out of band network . The local management modules may utilize a variety of communications paths such as an RS485 path a LAN path and an IC path to communicate with each blade .

LAN is an in band network also comporting with the Electronics Industry Association EIA RS485 Standard for data communication. Management modules either primary management module or back up management module if management module is down communicate via LAN with BMC which includes logic for coordinating communication with server blades via sockets .

LAN may be configured to allow communications between server blades and the management modules relating to the remote BIOS settings and BIOS management. The blades may leverage BMCs as proxies to communicate with the management modules through the RS485 protocol. Similarly the management modules may leverage BMCs as proxies to communicate with the blades through the RS485 protocol. In an alternative embodiment an RS485 connection may be separately made between each blade and the management modules Additionally other communications protocols and paths may be utilized such as the aforementioned IC channel or the aforementioned TCP IP and or Ethernet channel over switches .

Chassis may follow a predetermined policy upon setup in which addresses of various components in the chassis are propagated throughout. For example in one embodiment the AMM notifies the switch module of any IP address changes. The switch module in turn notifies the BMC . Once the BMC is notified of an IP address change the BMC queries the IP address information from the switch persistent storage and updates the component IP address list in another area of the switch persistent storage. The BMC also updates the component IP address list in an area of persistent storage resident in the RAID controller . The BMC then notifies the partner I O module BMC to update its component IP address list. The partner BMC then updates the persistent storage in its associated switch module and RAID controller .

In chassis both switch modules and have access to the management modules and including information stored within the modules and . The RAID subsystem including RAID controllers and does not have this access. Since the RAID subsystem is managed via a different interface the subsystem has no way of knowing which chassis the subsystem belongs to which switch or it is packaged with or what other switches are in the same chassis . The relationship among switches and and their respective RAID subsystems is necessary in order to configure host access to the RAID subsystem and to perform service and maintenance operations.

To simplify the user experience in managing chassis an API may be implemented as previously described that allows switches to access and persist all network information such as port IP addresses of the devices. For example in one embodiment the API may be operational as software firmware hardware or a combination thereof operable on a particular blade . In this way CPU and NVM may be utilized to execute and store processing instructions relating to the operation of the API. The API may be configured to maintain a relationship between the management modules and switches . As a result the API may be adapted to determine information such as port IP addresses from the switches and provide the information as an intermediary to other chassis components such as the BMCs .

The API may be adapted to query the switch es for the address or other information based on initial information provided by a user such as an initial address. For example in one embodiment based on an IP address provided by a user the API may then query switch es for additional addresses of additional components e.g. remaining 3 IP addresses . The switches may obtain the information from their persistent storage this storage having been populated by BMCs . The API may then validate the information perhaps notifying the user the additional addresses and that the addresses are valid. The API may then persistently store the addresses in locations accessible by the BMCs the switches and the RAID controllers .

Turning first to method begins step with a user entering information such as a port IP address for a component of the chassis step . A switch is queried for additional information for other interconnected components in the chassis such as additional remaining IP addresses step . Based on the first information the switch module is instructed to obtain the additional information from a persistent storage location associated with the switch module step . For example the switch module may cross reference a provided IP address with remaining addresses in an address table to obtain the additional addresses. The information and additional information obtained is validated step . The user is notified of the additional information and the fact that the information is valid step . Method then ends step .

Turning to method begins step with a user updating address information such as updating one or more of the component IP addresses in the AMM step . The AMM writes the new IP information to one area of persistent storage in the switch and the switch notifies its corresponding BMC to obtain updated IP information step . The BMC reads the updated information from the switch and updates the component IP address list in the corresponding RAID controller persistent storage step .

Control then moves to step where the BMC notifies its partner BMC to update its own respective persistent storage. The partner BMC then accesses the initiating BMC s RAID controller s persistent storage to obtain the updated IP address list information step . Both BMCs then update their corresponding switch persistent storage to reflect the updated IP address list information step . The method then ends step .

Control moves to step where the information is then persistently stored on either or both of the switch and a BMC in the chassis step . At a later time a user may update the information such as update one or more of the IP addresses in the AMM step . The updated information is updated to the BMC and or the switch as a result step . In this way any application that wishes to manage the entire chassis may have the necessary information to create relationships between the devices in the chassis by accessing the switch and or the BMC in which the information is stored. Control then moves to step as the method ends.

Reference throughout this specification to one embodiment an embodiment or similar language means that a particular feature structure or characteristic described in connection with the embodiment is included in at least one embodiment of the present invention. Thus appearances of the phrases in one embodiment in an embodiment and similar language throughout this specification may but do not necessarily all refer to the same embodiment.

Some of the functional units described in this specification have been labeled as modules in order to more particularly emphasize their implementation independence. For example a module may be implemented as a hardware circuit comprising custom VLSI circuits or gate arrays off the shelf semiconductors such as logic chips transistors or other discrete components. A module may also be implemented in programmable hardware devices such as field programmable gate arrays programmable array logic programmable logic devices or the like.

Modules may also be implemented in software for execution by various types of processors. An identified module of executable code may for instance comprise one or more physical or logical blocks of computer instructions which may for instance be organized as an object procedure or function. Nevertheless the executables of an identified module need not be physically located together but may comprise disparate instructions stored in different locations which when joined logically together comprise the module and achieve the stated purpose for the module.

Indeed a module of executable code may be a single instruction or many instructions and may even be distributed over several different code segments among different programs and across several memory devices. Similarly operational data may be identified and illustrated herein within modules and may be embodied in any suitable form and organized within any suitable type of data structure. The operational data may be collected as a single data set or may be distributed over different locations including over different storage devices and may exist at least partially merely as electronic signals on a system or network.

While one or more embodiments of the present invention have been illustrated in detail the skilled artisan will appreciate that modifications and adaptations to those embodiments may be made without departing from the scope of the present invention as set forth in the following claims.

