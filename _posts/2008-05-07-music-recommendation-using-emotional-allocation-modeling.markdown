---

title: Music recommendation using emotional allocation modeling
abstract: An exemplary method includes defining a vocabulary for emotions; extracting descriptions for songs; generating distributions for the songs in an emotion space based at least in part on the vocabulary and the extracted descriptions; extracting salient words from a document; generating a distribution for the document in an emotion space based at least in part on the vocabulary and the extracted salient words; and matching the distribution for the document to one or more of the distributions for the songs. Various other exemplary methods, devices, systems, etc., are also disclosed.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08650094&OS=08650094&RS=08650094
owner: Microsoft Corporation
number: 08650094
owner_city: Redmond
owner_country: US
publication_date: 20080507
---
The growth of music resources on personal devices and Internet radio has altered the channels for music sales and increased the need for music recommendations. For example store based and mail based CD sales are dropping while music portals for electronic distribution of music bundled or unbundled like iTunes MSN Music and Amazon are increasing.

To further increase music sales techniques to generate recommendations are now being used to help consumers find more interesting songs. Many commercial systems such as Amazon.com Last.fm http www.last.fm and Pandora http www.pandora.com have developed particular approaches for music recommendation. For example Amazon.com and Last.fm adopt collaborative filtering CF based technologies to generate recommendations. For example if two users have similar preferences for some music songs then these techniques assume that these two users tend to have similar preferences for other songs e.g. song that they may not already own or are aware of . In practice such user preference is discovered through mining user buying histories. Some other companies such as Pandora utilize content based technologies for music recommendations. This technique recommends songs with similar acoustic characteristics or meta information like composer theme style . . . .

Although the aforementioned techniques have shown some degree of effectiveness in practice however most conventional techniques for generating music recommendations operate in a passive mode. For example such passive techniques require consumers to first log on some portal sites and then take some actions to get suggestions. In other words these recommendation services are passive and need to be triggered by users.

As described herein various exemplary methods devices systems etc. generate music recommendations and optionally buying options for consumers. Various exemplary techniques operate actively to enhance user experience especially when applied to Web browsing.

An exemplary method includes defining a vocabulary for emotions extracting descriptions for songs generating distributions for the songs in an emotion space based at least in part on the vocabulary and the extracted descriptions extracting salient words from a document generating a distribution for the document in an emotion space based at least in part on the vocabulary and the extracted salient words and matching the distribution for the document to one or more of the distributions for the songs. Various other exemplary methods devices systems etc. are also disclosed.

Various exemplary methods devices systems etc. generate music recommendations based at least in part on information that describes emotion. In the field of psychology so called coding systems associate terms with human behavioral states. For example a coding system may associate the word happy with a behavioral state that exhibits smiling and laughter. As described herein the word happy would be an example of information that describes emotion.

An exemplary technique relies on probabilistic modeling referred to at times as emotional allocation to characterize songs and Web pages as distributions in a common emotion space. This modeling approach leverages both the statistics from a large scale Web corpus and guidance from psychological studies. This approach can also maintain the inference ability of generative models.

An exemplary technique for relevance matching includes representing songs and Web documents by a collection of word terms based on which corresponding emotion distribution parameters are optimized. In various examples the optimization occurs in an iterative manner. This technique then compares distributions based on the parameters using Kullback Leibler KL divergence. In turn the closest document song pairs can be selected and used directly or indirectly to recommend music. Alternatively a reverse approach may recommend documents for music.

As discussed in more detail below an exemplary modeling approach assumes that given a language and its vocabulary different emotions should have different distributions over the terms in this vocabulary. In other words the frequencies of a term under different emotions are also different. Hence given a collection of terms e.g. a document the approach makes the supposition that the collection is generated by sampling a mixture of various emotions as terms in this collection can be considered as controlled by different emotions. The parameters of such a sampling can be computed in a maximum likelihood manner. In such a way a term collection can have a certain allocation of emotions in form of a probability distribution. Consequently this modeling approach is referred to as emotional allocation .

Emotional allocation modeling also refers to knowledge of psychology to get a relatively complete and well structured emotion vocabulary i.e. coding system . To achieve more accurate model estimation learning can be performed for term emotion relations through analysis of a very large scale of documents e.g. Web pages noting that other techniques for selecting a training set may be used.

In various examples an exemplary approach adopts Web based information to describe music songs as current content based music analysis technologies are quite limited in handling classifications on the order of tens of moods. As described herein it is recognized that on the Web there exists a relatively abundant amount of information such as lyrics and reviews to describe the semantic of a song. Thus an exemplary approach can use search engines to retrieve more information from the Web to characterize songs.

Consider an example with two queries in the form of title lyrics and title reviews respectively. In this example the first page returned by the first query and the top 20 pages returned by the second query can be used to generate descriptions. That is these retrieved pages can be merged as a virtual document for example after removing HTML tags and stop words. Then for each term in this virtual document the well known term frequency inverse document frequency tf idf can be computed as its weight e.g. the idf can be estimated based on a Web scale corpus . Next the top N terms with the highest weights can be selected as a description for the song see two queries . Various trials presented herein set N equal to 100 in an effort to keep the most informative terms and to balance computational complexity in further probability inference. Other numbers of top terms may be used.

Various techniques exist for processing of documents e.g. Web documents which may have some similarities. Various examples and trials presented herein focus on Weblogs where bloggers write about their feelings opinions and emotions. In various examples for each blog post the top 100 terms with the highest tf idf can be kept as salient words for further inference.

Various exemplary techniques described herein offer opportunities for Web based businesses. For example existing systems may lose lots of chances for providing music recommendations when users surf the Web and in turn they may also lose potential music sales. An exemplary system based on an emotion allocation approach operates in an active mode to grasp a wide array of opportunities for music recommendations and optionally associated sales.

An exemplary system operates to deliver music recommendations matched to website content to increase the possibilities music and optionally associated sales e.g. music music books videos shirts etc. . Such a system may automatically deliver music or its thumbnail which is relevant to the context of a Web page when users read it. Such a system can operate in an integrated manner with websites of forums or Weblogs such as WINDOWS LIVE SPACES website services. WINDOWS LIVE SPACES technology now supports users manually tagging their favorite songs as backgrounds of their blog posts to show their personal tastes or feelings. Some readers may find interest in such background songs when reading the blogs and they may want to know more information of these songs or even buy them. In this way such background songs can act as a special advertisement. Further mechanisms may be implemented to support sales. Such a recommendation system can benefit many parties for example readers can obtain new songs music manufactures can sell their products and bloggers and WINDOWS LIVE SPACES website services or other service providers can also share some revenue.

Various efforts have been reported on either music or text emotion classification. For example a Gaussian mixture GM model was utilized to classify music songs into four emotion categories using acoustic content features like intensity timbre and rhythm. For text documents some studies exist for various supervised classifiers to classify online product reviews into positive and negative opinions. Some researchers have also tried to categorize Weblogs into a number of most frequently used moods with support vector machine SVM . As described herein however these approaches have some limitations. First they can handle only a few mood categories which may be insufficient and inflexible. Second they utilize supervised algorithms for mood classification and their effectiveness thus relies heavily on the quality of training data. For various scenarios presented herein it can be quite difficult to collect enough high quality training data for a reasonable number of possible emotions. Moreover cross modal emotion mapping is still an open problem.

As described herein a particular system is referred to at times as MusicSense. The MusicSense system can operate to help users find out which songs are most suitable to an article where the songs are provided for example from a music collection of one or more music distributors e.g. individual artists companies etc. . The MusicSense system operates to properly measure the context relevance between one or more music songs and typically a single Web page. As discussed in more detail below the MusicSense system uses emotion as a bridge for relevance matching as music is often about conveying a composer s emotions and lots of Web pages such as Weblogs also express writer sentiment. As mentioned an exemplary probabilistic modeling approach referred to as emotional allocation can characterize songs and Web pages as distributions in a common emotion space. Such an approach leverages both the statistics from a large scale Web corpus and guidance from psychological studies and can also keep the inference ability of generative probabilistic models. In operation given an article one or more songs with the closest emotion distributions to the article can be selected and presented to a user as contextual music advertisements.

As described herein various exemplary techniques provide a contextual approach to music recommendation. When implemented as an exemplary system such techniques can automatically suggest music when users read Web documents such as Weblogs. In such a contextual approach the system matches music to a document s content in terms of the emotions expressed by both the document and songs. As mentioned a generative model referred to as an emotional allocation model considers a collection of word terms as having been generated with a mixture of emotions. This model can integrate knowledge discovering from a Web scale corpus and guidance from psychological studies of emotion. Songs are also described using textual information extracted from their metadata and relevant Web pages. Thus both music songs and Web documents can be characterized as distributions over the emotion mixtures through the emotional allocation modeling. For a given document the songs with the most matched emotion distributions are can be selected and recommended.

In practice a framework for performing the method would normally define an emotional allocation model e.g. based on a coding system and a corpus perform Web based music description extraction and Web document analysis generate distributions using the model and then perform similarity matching using for example probability inference and relevance matching. In turn given a particular document the framework can recommend one or more songs as matching the emotional context of the document.

As shown in the example of the extracting phase includes an extraction block for extracting descriptions for input music . The extraction block may connect to the Internet to locate relevant information for example based on one or more identifiers for the input music e.g. title artist composer label genre etc. . Hence the extraction block relies on one or more identifiers for input music e.g. metadata to extract additional relevant information from a rich information source e.g. the Internet . The extraction phase also includes an extraction block for extracting salient words and or other content from input weblogs . In turn the extraction blocks provide input to a modeling block for the modeling phase of the method .

The modeling block further receives model specific inputs which for the example of are in the form of emotion vocabulary and a web page corpus . The modeling block relies on the inputs and information received from the extraction blocks to generate distributions. In a matching phase of the method a matching block matches characteristics of the generated distributions to output the one or more results based on a matching criterion or criteria.

As described herein an exemplary method includes an extracting phase that extracts information a modeling phase that generates distributions based at least in part on the extracted information and a matching phase that matches similarities between characteristics of the generated distributions. In the context of a document as input an exemplary method includes extracting salient information about the document generating distributions based at least in part on the extracted document information information about a collection of songs an emotion vocabulary and a document corpus and matching similarities between characteristics of the generated distributions to identify one or more songs that can be output as a recommendation or recommendations. As described in some examples below a recommended song or songs match the emotion of a document.

The recommendation service computing device includes a data store for storing data where the data may be organized in a database format . The device further includes an instruction module referred to in the example of as a music match module. The module may be in the form of computer executable instructions for an emotional allocation model to generate distributions for documents and distributions for songs in a common emotional space and a Kullback Leibler divergence algorithm to compare the generated distributions for documents and the generated distributions for songs.

According to the timeline at time A a reader requests a blog page which is shown in the form of a Web document. In the example of the blogger machine the reader machine or both may subscribe to the recommendation service of the machine . At time B the blog page i.e. blog information is received by the recommendation service machine . In turn at time C the machine relies on the module to select some music e.g. one or more songs based at least in part on the blog information. The machine at time D then sends the music and or information about the music to the reader machine . In the example of the reader machine receives the blog page and some selected music e.g. at time E where the music matches some emotional context of the blog page. The route for the blog page to the reader machine may be via the machine direct from the blogger machine or via some other intermediate machine e.g. a server .

In a reception block a document or information about a document is received i.e. document information . In a match block the document information is matched with music for example a song selected from a collection of songs. In turn a provision block provides the music as associated with the document. As mentioned a provision block may provide information about the music in association with the document. For example the information about the music may be an advertisement and a control URL etc. to enable a reader of the document to buy or otherwise access the music. In other examples the provision block may provide a sample of the music e.g. a segment of a song or a segment for each song in a group of songs . As shown in the music is associated with metadata where the metadata includes information for associating the music with the document. For example the metadata may be a URL or other information germane to the document.

As described herein an exemplary method can be implemented at least in part by a computing device and include defining a vocabulary for emotions extracting descriptions for songs generating distributions for the songs in an emotion space based at least in part on the vocabulary and the extracted descriptions extracting salient words from a document generating a distribution for the document in an emotion space based at least in part on the vocabulary and the extracted salient words and matching the distribution for the document to one or more of the distributions for the songs. In various examples the emotion space of the distributions for the songs and the emotion space of the distribution for the document is a common emotion space. As discussed in more detail below such a method can perform matching of distributions based at least in part on Kullback Leibler divergence. In general various methods can recommend one or more songs that include emotional characteristics that match emotional characteristics of a particular document.

As discussed herein a method may include extracting salient words from a plurality of documents generating distributions for a plurality of documents and matching closest document song pairs based on distributions for the documents and distributions for songs in a common emotion space. For example a common emotion spaces may include more than approximately 10 emotions which allows for mixed emotion mapping.

In various examples a method can provide information for purchasing one or more songs. In various examples a method can include comparing one or more songs to a personal collection of songs. In this latter instance purchasing may not be required noting that performers may differ consider cover versions of popular songs or the many different versions of old and classical songs in the public domain .

While emotional allocation modeling has been mentioned in some detail the description that follows provides an example with additional detail. In particular the example is described with respect to model construction parameter inference and relevance matching.

In the model it is assumed that there are K emotions each of which can be represented as a multinomial distribution over all the terms from a vocabulary W w . . . w as Equation 1 11 Where for each k there is 1 as shown in . In other words conditioned on an emotion e each term wcan be generated with the probability k. In addition to characterize the generation process of a series of terms the emotion variable e is considered as continually sampled from another multinomial distribution p e e which is controlled by a hyper variable . Similar with the assumption in the latent Dirichlet allocation LDA here it is also assumed that follows a Dirichlet distribution as it is the conjugate prior of the multinomial distribution in Bayesian statistics . The probability density of a K dimensional Dirichlet distribution is defined as Equation 2 

In this modeling approach the K emotions e . . . e can be manually selected according to the suggestions from psychology studies. For example there are forty basic emotions defined in the Basic English Emotion Vocabulary which are also adopted for trials presented herein. In such a situation it becomes very difficult to collect and appropriately label sufficient training data for learning the emotion term relations i.e. and . Thus is estimated through stating a Web scale corpus around 100 million Web pages were used in trials . Here the main assumption is kshould be proportional to the co occurrence frequency of the term wand the emotion e when the corpus is large enough.

1. Expand each emotion with its synonyms looked up from the WordNet. For example the emotion happy is expanded with words like blessed blissful glad and so on. Such Mtypical synonyms of the emotion eare noted as w 1 i M for efficiency Mwas less than 10 in the trials .

2. For each pair w w state its co occurrence Nw won the whole corpus. Here the two terms are considered to have one co occurrence if they are in a same paragraph. This is because a paragraph is a block with relatively consistent semantics and proper length while a sentence can be too short to provide sufficient statistics and a whole document can be too long and may contain multiple semantics.

3. Define the co occurrence of the term wand emotion eas where idf wand idf ware inverse document frequencies estimated on the same corpus and are used here to punish those popular terms. 4. 

As introduced above the goal of the modeling is to predict the essential emotion allocation of a set of terms which is controlled by the variable in this model. From the graph structure in the conditional probability of a collection of N terms w given is as Equation 3 

In the first step in Table 1 is by default uniformly initialized assuming each mood has equal prior probability on this word collection. However as mentioned above can also be particularly initialized if other knowledge like the results of acoustic analysis is available to achieve a more reasonable inference result. For example if a song is classified as sad with content based analysis the corresponding element in could be initialized with a higher prior weight.

Through the inference each term collection is finally represented as a Dirichlet distribution over the mixture of emotions with the optimized posterior parameter .

With respect to relevance modeling two term collections are considered to be relevant if they have similar distributions i.e. similar allocations of emotions. In a so called MusicSense example songs most relevant to a Weblog should be selected as its recommendations.

The most natural way to measure the similarity of two distributions is the Kullback Leibler divergence KLD or KL divergence . The KL divergence of two K dimensional Dirichlet distributions Dir and Dir is Equation 5 

Evaluation of music recommendation is not a trivial task. In various trials recommendation results were compared with subjective preference to find out how close the approach can reach an ideal system.

In the trials 100 songs and 50 Weblogs were collected. These songs and Weblogs were selected from various themes and aimed to cover as many emotions as possible. The descriptions of all the songs were retrieved from the Web. Five subjects were then invited to label the ground truth includes 

Accordingly the following evaluations consist of two parts i emotion allocation and ii music recommendation.

As to effectiveness of the proposed modeling on music emotion allocation each song is represented with a Dirichlet distribution parameterized by . According to the properties of a Dirichlet distribution there is which can be taken as the weight of the iemotion in this song. For manually labeling such a weight for each emotion on each song can be approximated through averaging the tag counts of all the labeler. shows a plot of model versus subjective results for the famous song My Heart Will Go On .

From it is still satisfied that the trial result is agreed with the ground truth on the first two major emotions loving and sad and the weights on these two emotions are also close. Moreover the rest three emotions estimated using the model are also somewhat related to the song s semantics. Further measurements of the correlation coefficient between the two weight vectors generated by the model approach and human labeling reached around 0.71 on this song. The average correlation coefficient over the whole 100 songs is about 0.48. The evaluation of emotion allocation of blogs was carried out in the same way and the average correlation coefficient was about 0.42. These results indicate that for emotion allocation there does exist a positive correlation between the model approach results and the ground truth.

To evaluate the recommendation performance for each blog post the suggestions from all the labelers as the ground truth were merged. On average there were around 5.75 such suggestions for each post. Here the labeling consensus is somewhat large because of the small scale of the music collection in the trials. Then the distances between all the songs and blog posts were computed and sorted in ascending order for each post. The algorithm was very efficient in practice i.e. the computational time was less than one second to go through the whole 100 songs using a PC with 3.2 GHz Intel Pentium 4 CPU and 1 GB memory. At last those top N ranked songs were selected as recommendations and the average recalls and precisions over all the blogs are shown in a plot of for N 1 3 5 10 respectively.

For each blog post and a given N the recall and precision are defined as recall N Nand precision N N. Here Nis how many songs from the subjective suggestions have been covered in the top N candidates ranked by the exemplary approach and Nis the total number of subjective suggestions for that blog. From it is notable that when N increases the precisions are relatively stable at around 45 while the recalls increase from below 10 N 1 to above 70 N 10 . This indicates that about half of the candidates recommend by the exemplary approach in the trials are consistent with the subjective opinions and when N becomes large enough most preferred songs can be retrieved within the scope of the modeling approach.

As described herein various techniques for contextual music recommendation allow for matching music with context extracted from a document or otherwise associated with a document. An exemplary technique uses a probabilistic model referred to as an emotional allocation model. With such a model trials demonstrated that one could reasonably consider each song or a Weblog as generated with a distribution over a mixture of emotions effectively integrate knowledge discovering from a Web scale corpus and guidance from psychological studies and also keep the inference ability of a generative model. In such a manner emotion acts as a bridge for relevance matching between blogs and songs. Again trials indicate that the model operates effectively both the emotion estimation and the music recommendation match subjective preference closely.

While various examples discuss emotion emotion may be used in conjunction with one or more other measures to determine relevance between music and documents. As mentioned recommendations may be presented via a graphical or other user interface e.g. audio alone audio with graphics graphics alone etc. where a user may be provided one or more controls to buy download listen mark as a favorite etc. one or more recommended songs. Further feedback may be acquired for a user for example where a favorites library is generated. Such a library may be configured to store subjective information provided by a user which in turn may be collected from time to time by a recommendation service to improve a model for that user and or for multiple users.

While the examples discussed herein generally pertain to some external collection of music a user may have a personal library or subscription library where matching occurs between a model library i.e. model collection and a personal collection. For example if the recommendation service recommends the song I Love Rock and Roll the service may include an option of searching the personal library of the user for that song. In turn the service may alert or immediately activate a player to play the song from the user s library.

While some examples are shown or described with respect to the English language exemplary techniques may be applied in other languages or cross language. Further a system may include one or more translation modules to provide for translations from text in one language to song matching in another language or culture. For example consider an English blog about Spain. A recommendation service may provide a control that allows a reader to select a Spanish music collection for recommendations where salient emotion queues are extracted from the English blog.

Various techniques statistically use emotion to bridge other information e.g. text and song . As described herein various techniques can expand a list of words for an emotion see e.g. for example using a thesaurus e.g. to provide synonyms . Words may also be weighted as being associated with a single emotion or multiple emotions optionally in varying degrees. As already mentioned the concept of punishment may be used e.g. negative weighting .

In various examples the concept of mixed emotions was presented. For example a document may be 6 happy 30 surprising and 35 exciting. A document may be classified in an emotional space with multiple dimensions. Further the concept of mapping music to an emotional space may be used. For a given music piece a recommendation service may use the title lyric or reviews for emotional space mapping. Such information may be collected from the Internet using a search engine. For example a search on Beethoven Op. 49 No. 1 returns notes that state 

As mentioned a web document may be any type of document. For example a web document may be text a picture with associated text a video with associated text. Further a recommendation may be more than a music recommendation. For example a recommendation service may provide a movie recommendation a book recommendation etc. where the recommendation is based at least in part on emotion.

As described herein a service may be turned on or off. For example a user may be presented with an option setting for activating background music. In general the time introduced by a recommendation service is not significant. For example upon accessing a blog the user receives a recommendation within seconds. As mentioned a user may control aspects of a library or emotional space. For example a user may select filters that limit the library to certain artists composer genres cultures emotions etc.

As mentioned a recommendation service may operate to generate revenue and or allow for revenue sharing. A blogger an advertiser or other web site owner operator may participate in a system where a collection of music is limited to a musician recording company etc. and where sales of music from the collection generate revenue for some amount of sharing with the blogger advertiser or other web site owner operator. For example if someone clicks the recommended background music and buys it the revenue can be shared.

In another example a person or entity may pay to put music in library that will be used for recommendations. Such an example may be considered a front loaded model where the recommendation service collects money up front. In turn the recommendation service may receive no revenue from sales or may operate according to a mixed model that includes up front money and some additional revenue from sales.

In yet another example a recommendation service presents one or more recommendations to a user and a link. If the user clicks on the link a space opens for display of additional information. For example the link may be to a major record company where yet additional songs from an artist or collection are recommended and optionally available for purchase.

As shown in the exemplary computing device may be a server or other service provider machine and include a network interface one or more processors memory and instructions stored in memory to generate distributions for documents and distributions for songs in a common emotional space to match a generated distribution for a document to at least one generated distribution for a song and to output via the network interface at least some information about a song that has a distribution that matches a distribution of a document. Such a device may also include instructions stored in memory to receive a document via the network interface. Such a computing device may include instructions stored in memory to distribute revenue from sales of the song that has a distribution that matches a distribution of a document.

In a very basic configuration computing device typically includes at least one processing unit and system memory . Depending on the exact configuration and type of computing device system memory may be volatile such as RAM non volatile such as ROM flash memory etc. or some combination of the two. System memory typically includes an operating system one or more program modules and may include program data . The operating system include a component based framework that supports components including properties and events objects inheritance polymorphism reflection and provides an object oriented component based application programming interface API such as that of the .NET Framework manufactured by Microsoft Corporation Redmond Wash. The device is of a very basic configuration demarcated by a dashed line . Again a terminal may have fewer components but will interact with a computing device that may have such a basic configuration.

Computing device may have additional features or functionality. For example computing device may also include additional data storage devices removable and or non removable such as for example magnetic disks optical disks or tape. Such additional storage is illustrated in by removable storage and non removable storage . Computer storage media may include volatile and nonvolatile removable and non removable media implemented in any method or technology for storage of information such as computer readable instructions data structures program modules or other data. System memory removable storage and non removable storage are all examples of computer storage media. Computer storage media includes but is not limited to RAM ROM EEPROM flash memory or other memory technology CD ROM digital versatile disks DVD or other optical storage magnetic cassettes magnetic tape magnetic disk storage or other magnetic storage devices or any other medium which can be used to store the desired information and which can be accessed by computing device . Any such computer storage media may be part of device . Computing device may also have input device s such as keyboard mouse pen voice input device touch input device etc. Output device s such as a display speakers printer etc. may also be included. These devices are well known in the art and need not be discussed at length here.

Computing device may also contain communication connections that allow the device to communicate with other computing devices such as over a network e.g. consider the aforementioned network of . Communication connections are one example of communication media. Communication media may typically be embodied by computer readable instructions data structures program modules etc.

Although the subject matter has been described in language specific to structural features and or methodological acts it is to be understood that the subject matter defined in the appended claims is not necessarily limited to the specific features or acts described above. Rather the specific features and acts described above are disclosed as example forms of implementing the claims.

