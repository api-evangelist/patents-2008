---

title: System and method for communicating data using efficient fast fourier transform (FFT) for orthogonal frequency division multiplexing (OFDM) modulation
abstract: A communications device includes at least one memory device for storing complex exponential functions as approximations of sine and cosine basis waveforms. A logic circuit adds and subtracts the complex exponential functions to generate an Orthogonal Frequency Division Multiplexed (OFDM) communications signal as a plurality of N data subcarriers that carry communications data. The logic circuit provides efficient and accurate implementation of the IFFT for use as an OFDM modulator using additions of stored complex exponentials and modulation of the integer-valued QAM data symbols using logic shifts and sign changes (2's complement).
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08229009&OS=08229009&RS=08229009
owner: Harris Corporation
number: 08229009
owner_city: Melbourne
owner_country: US
publication_date: 20080401
---
The present invention relates to communications systems and more particularly this invention relates to multiple carrier communications systems including but not limited to orthogonal Frequency Division Multiplexing OFDM communications systems.

In OFDM communications systems the frequencies and modulation of a frequency division multiplexing FDM communications signal are arranged orthogonal with each other to eliminate interference between signals on each frequency. In this communications system low rate modulations with relatively long symbols compared to the channel time characteristics are less sensitive to multipath propagation issues. OFDM transmits a number of low symbol rate data streams on separate narrow frequency subbands using multiple frequencies simultaneously instead of transmitting a single high symbol rate stream on one wide frequency band on a single frequency. These multiple subbands have the advantage that the channel propagation effects are generally more constant over a given subband than over the entire channel as a whole. A classical In phase Quadrature I Q modulation can be transmitted over individual subbands. Also OFDM is typically used in conjunction with a Forward Error Correction scheme which in this instance is sometimes termed Coded Orthogonal FDM or COFDM.

As known to those skilled in the art an OFDM signal can be considered the sum of a number of orthogonal subcarrier signals with baseband data on each individual subcarrier independently modulated for example by Quadrature Amplitude Modulation QAM or Phase Shift Keying PSK . This baseband signal can also modulate a main RF carrier.

OFDM signals are generally created by performing the inverse Fourier transform on the data with the Inverse Fast Fourier Transform IFFT becoming the preferred method since it is numerically efficient. Additionally OFDM demodulation requires use of the Fourier Transform. This is typically implemented with a Fast Fourier Transform FFT requiring complex multiplications in an OFDM receiver that decodes a packet of k symbols requiring complex multiplications.

An algorithm s efficiency such as the FFT or IFFT is typically measured by the number of required multiplications and additions. The hardware implementation complexity is usually determined by the number of multiplications per second since multipliers typically take up more real estate and clock cycles on processors and VLSI designs. Direct evaluation of the N point discrete Fourier Transform DFT requires Ncomplex multiplications and N N 1 complex additions or 4 Nreal multiplications and N 4 N 2 real additions. The DFT of a finite length sequence of length N is 

As known to those skilled in the art the fast Fourier Transform FFT is a set of algorithms that substantially reduce the number of computations required to compute the DFT. The radix R FFT algorithms operate by splitting the N point DFT into v stages where v is an integer and N R. The well known radix 2 algorithm N 2 is based on decomposing the sequence x n into successively smaller sub sequences for processing by smaller DFT s and is referred to as a decimation in time algorithm. Accordingly the radix 2 algorithm that decomposes the Fourier coefficients into smaller sub sequences is called a decimation in frequency algorithm. These algorithms exploit both the periodicity and symmetry of the twiddle factor matrix. The radix 2 algorithm requires

Since these calculations are performed on data blocks of length N the number of multiplications per sample is log N for the IFFT. A 1024 point IFFT will require 5120 multipliers or 5 multiplications per input sample. The OFDM symbol can be seen as a sum of carriers f k according to

The number of multiplications using the FFT or IFFT greatly impact hardware complexity and increases gate count. Also there is significant implementation loss due to fixed point rounding error.

Additionally the problems associated with the Peak to Average Power Ratio PAPR using OFDM is further motivation to generate techniques for simplifying the FFT and IFFT techniques used in generating OFDM communications signals. Commonly assigned U.S. Patent Publication No. 2005 0089116 the disclosure which is hereby incorporated by reference in its entirety discloses a system that reduces peak to average power ratio. There is still a need however to simplify the IFFT and FFT.

A communications device includes at least one memory device for storing complex exponential functions as frequency approximations of sine and cosine basis waveforms. A logic circuit adds and subtracts the complex exponential functions to generate an Orthogonal Frequency Division Multiplexed OFDM communications signal as a plurality of N data subcarriers that carry communications data.

The communications device includes a logic circuit as a shift register circuit that adds and subtracts complex exponential functions. The logic circuit also includes a summer operative with the shift register circuit for summing shifted values of the complex exponential functions. This logic circuit can be operative for modulating N data subcarriers. The logic circuit is also operative for modulating data subcarriers using quadrature amplitude modulation QAM and quadrature phase shift keying QPSK or binary phase shift keying BPSK modulation.

In yet another aspect the logic circuit can be formed as a field programmable gate array FPGA or digital signal processor DSP for performing logical shifts and additions. The logic circuit is operative for logically shifting and adding cosine nk N and sine nk N . The logic circuit is also operative for adding and subtracting as multiples of type 2n.

In yet another aspect the communications device includes a circuit for oversampling using multilevel basis functions for placing harmonics of the square type waveforms outside the bandwidth of the OFDM signal. A circuit can also add scaled and time expanded versions of the original waveform to form harmonics of the square type waveform outside the bandwidth of the OFDM signal. At least one memory element can be formed as a plurality of memory elements each corresponding to a different frequency.

The present invention will now be described more fully hereinafter with reference to the accompanying drawings in which preferred embodiments of the invention are shown. This invention may however be embodied in many different forms and should not be construed as limited to the embodiments set forth herein. Rather these embodiments are provided so that this disclosure will be thorough and complete and will fully convey the scope of the invention to those skilled in the art. Like numbers refer to like elements throughout.

Before explaining in detail aspects of the system and method in accordance with a non limiting example of the present invention a technical explanation is set forth of the theory followed by a practical explanation of basic components used in such system and method. Other details of such OFDM systems are found in commonly assigned and copending U.S. patent application Ser. Nos. 11 464 877 11 464 857 11 464 854 11 464 861 11 464 868 the disclosures which are hereby incorporated by reference in their entirety.

Orthogonal Frequency Division Multiplexing OFDM is also termed Multicarrier Modulation MCM because the signal uses multiple carrier signals that are transmitted at different frequencies. Some of the bits or symbols normally transmitted on one channel or carrier are now transmitted by this system on multiple carriers in the channel. Advanced Digital Signal Processing DSP techniques distribute the data over multiple carriers subcarriers at predetermined frequencies. For example if the lowest frequency subcarrier uses a base frequency the other subcarriers could be integer multiples of that base frequency. The particular relationship among the subcarriers is considered the orthogonality such that the energy from one subcarrier can appear at a frequency where all other subcarrier s energy equal zero. There can be a superposition of frequencies in the same frequency range. This results in a lower symbol rate on each subcarrier with less Inter Symbol Interference ISI due to adverse effects of multipath. In many OFDM communications systems a Guard Interval GI or Cyclic Prefix CP is prefixed or appended to the OFDM symbol to mitigate the effects of ISI.

The drawings in show that OFDM is based on a frequency division multiplexing FDM system where each frequency channel is modulated. The frequencies and modulation of an FDM system are now orthogonal to each other to eliminate interference between channels. Because low rate modulations with relatively long symbols compared to the channel time characteristics are less sensitive to multipath an OFDM communications system allows a number of low rate symbol streams to be transmitted simultaneously on multiple carriers rather than having one high rate symbol stream transmitted on a single carrier. Thus the frequency spectrum in an OFDM communications system is divided into multiple low bandwidth subbands. Since each subband covers a relatively narrow section of the frequency spectrum channel propagation effects are more constant or flat over a given subband compared to channel variations over the entire occupied spectrum. Any type of in phase and quadrature I Q modulation can be used to modulate any subcarrier for example Binary Phase Shift Keying BPSK Quadrature Phase Shift Keying QPSK or Quadrature Amplitude Modulation QAM or any of the numerous and different derivations of these modulation schemes. Different signal processing techniques for example channel coding power allocation adaptive modulation encoding and similar schemes can be applied to one or more subbands. Multi user allocation is also possible for example using time coding or frequency separation.

In an OFDM communications system using a transmitter and receiver such as shown in one transmitter will transmit a signal on dozens or thousands of different orthogonal frequencies that are independent with respect to the relative amplitude and phase relationship between the frequencies. Each subcarrier signal typically will have space for only a single narrowband signal because the signals are closely spaced and it is important to prevent signals on adjacent subcarriers from interfering with each other. In an OFDM system the symbols on each subcarrier are constructed such that energy from their frequency components are zero at the center of every other subcarrier enabling a higher spectral efficiency for OFDM symbols than is possible in classic FDM.

The conventional OFDM system as shown in includes channel coding as a Forward Error Correction FEC technique using a Forward Error Correction encoder to create a coded orthogonal FDM COFDM signal. Channel State Information CSI techniques can also be employed including continuous wave CW interferer and or selective channel systems.

An OFDM signal is typically the sum of each of the orthogonal subcarriers. Baseband data is independently modulated onto each of the orthogonal subcarriers using some type of modulation such as Quadrature Amplitude Modulation QAM or Phase Shift Keying PSK schemes as discussed before. Because the spectrum of each subcarrier overlaps it can be considerably wider than if no overlap were allowed. Thus OFDM provides high spectrum efficiency. Because each subcarrier operates at a low symbol rate the duration of each symbol in the subcarrier is long. For clarity symbol rate is equal to the inverse of symbol duration . By using Forward Error Correction FEC equalization and modulation there can be an enhanced resistance against a link dispersion b slowly changing phase distortion and fading c frequency response nulls d constant interference and e burst noise. Further the use of a Guard Interval GI or cyclic prefix provides enhanced resistance against multipath in the transmission channel.

Typically in an OFDM communications system a subcarrier and somewhat rectangular pulse can be employed and operative by an Inverse Discrete Fourier Transform IDFT using an Inverse Fast Fourier Transform IFFT circuit within the transmitter. At a receiver a Fast Fourier Transform FFT circuit reverses this operation. The rectangular pulse shape results in a Sin x x spectrum in the subcarriers.

The spacing of subcarriers can be chosen such that the received subcarriers can cause zero or acceptably low Inter Carrier Interference ICI when the receiver and transmitter are synchronized. Typically OFDM communications systems split the available bandwidth into many narrow band subbands from as little as a few dozen to as many as eight thousand to ten thousand. Unlike the communications system providing multiple channels using classical FDM as in the subcarriers for each subband in OFDM are orthogonal to each other and have close spacing and little overhead. In an OFDM communications system there is also little overhead associated with any switching that may occur between users as in a Time Division Multiplexing Access TDMA communications system. Usually the orthogonality of subcarriers in an OFDM communications system allows each carrier to have an integer number of cycles over a symbol period. As a result the spectrum of a subcarrier has a null at the center frequency of its adjacent subcarriers.

Usually in an OFDM communications system the spectrum required for transmitting data is chosen based on the input data and a desired modulation scheme to be used with each carrier that is assigned the data to transmit. Any amplitude and phase of the carrier is calculated based on the modulation for example BPSK QPSK or QAM as noted before. Any required spectrum is converted using the IFFT circuit to ensure carrier signals are orthogonal.

It should be understood that a FFT circuit transforms a cyclic time domain signal to an equivalent frequency spectrum by finding an equivalent waveform that is generated as a sum of orthogonal sinusoidal components. The frequency spectrum of the time domain signal is usually represented by the amplitude and phase sinusoidal components. The IFFT circuit performs the reverse process and transforms the spectrum of the amplitude and phase into a time domain signal. For example an IFFT circuit can convert a set of complex data points into a time domain signal of the same number of points. Each complex input point will result in an integral number of sinusoid and cosinusoid cycles represented by the same number of points as were input to the IFFT. Each sinusoid known as the in phase component and cosinusoid known as the quadrature component will be orthogonal to all other components generated by the IFFT. Thus orthogonal carriers can be generated by setting an amplitude and phase for each frequency point representing a desired subcarrier frequency and performing the IFFT.

It should be understood that a Guard Interval GI also termed a cyclic prefix often is added to an OFDM symbol. The guard interval reduces the effects of the wireless channel on Inter Symbol Interference ISI and contains redundant transmission information. Referring to the IEEE 802.11a standard as a non limiting example if a carrier spacing is 312.5 KHz and the Fourier Transforms are performed over 3.2 microseconds then a 0.8 microsecond guard interval can be applied for ISI rejection. The guard interval could be the last Tseconds of an active symbol period that is prefixed to an OFDM symbol making it a cyclic prefix. It is kept short for a fraction of TV corresponding to the total length of the active symbol yet longer than the channel impulse response. This helps reduce the ISI and Inter Carrier Interference ICI and maintains subcarrier orthogonality. In this example a time waveform appears periodic to the receiver over the duration of the FFT.

To reduce ICI the OFDM symbol can be cyclically extended in the guard time to ensure that delayed replicas of the OFDM symbol can have an integer number of cycles within the FFT interval as long as the delay is smaller than the guard time. As a result multipath signals with delays smaller than the guard time would not produce ICI.

Multipath interference is caused when multiple copies of the transmitted signal arrive at the receiver at different times. It should be understood that an OFDM communications system reduces the effect of multipath interference by providing the ability to add signal redundancy in both frequency and time by the use of various coding algorithms. For example with the IEEE 802.11a standard using OFDM 48 subcarriers can be transmitted simultaneously. The coding gain can be provided using a one half convolutional encoder at the transmitter and later a Viterbi decoder. Data bits can be interleaved across multiple symbols and subcarriers. Lost data often is recoverable because of interleaving across the frequency and time space.

Increasing the data rate requires an increase in the symbol rate for a fixed number of carriers fixed modulation scheme and fixed sample rate. For a single carrier system complex equalizers and adaptive filters are required at the receiver to compensate for the magnitude and time distortions caused by the channel. The accuracy and dynamic range required of such equalizers and filters increases markedly as symbol times are decreased. However in an OFDM system for example when 48 subcarriers are transmitted simultaneously the symbol rate is effectively reduced by 48 times significantly reducing the requirements of channel equalizers and filters. The reduced symbol rate of an OFDM system enables a robust communication link resistant to ISI.

It should be understood that an OFDM receiver receives a sum of the different signals as subcarriers. The addition of a guard interval can further enhance performance in an OFDM system by ensuring that no symbol transitions occur during each received symbol time. For example if an OFDM subcarrier is BPSK modulated there would be a 180 degree phase jump at symbol boundaries. By choosing a guard interval that is longer than the largest expected time difference between the first and last multipath signals such phase transitions can occur only during the guard time meaning there are no phase transitions during the FFT interval. If the phase transitions of a delayed path occur within the FFT interval of the receiver then the summation of the subcarriers of the first path with the phase modulated waves of the delayed path would no longer produce a set of orthogonal subcarriers resulting in a certain level of interference.

For purposes of general technical understanding of the OFDM system as will be explained later basic components of a conventional OFDM transmitter and receiver are explained. illustrates a high level block diagram of a prior art transmitter for the IEEE 802.11a OFDM modem described above and includes a Forward Error Correction FEC Coder circuit that receives a signal representing the data to be communicated and encodes the signal with a forward error correction code as described above. The signal passes to an interleaving and mapping circuit in which interleaving and frequency mapping occurs. An IFFT circuit receives the interleaved and frequency mapped signal and creates multiple time domain carriers summed in a single in phase quadrature time domain sequence known as a symbol. A guard interval circuit adds a guard interval. A symbol wave shaping circuit for example a raised cosine filter shapes the symbol waveform to limit its spectral content. Afterward an In phase Quadrature I Q modulator processes the baseband I Q signal producing I Q modulation and also receiving a Local Oscillator LO signal from LO signal generator . Signal up conversion to the final transmit carrier frequency occurs at mixer which receives a local oscillator signal generated by LO signal generator . Afterward the signal is amplified by a High Power Amplifier HPA and the OFDM signal is transmitted through an antenna on its carrier wave into the RF channel . Various stages of frequency filtering for example between the I Q Modulator and mixer and between the mixer and HPA and at the output of the HPA are not shown in the block diagram.

As discussed above OFDM communications systems can use FEC techniques and known interleaving and mapping techniques before IFFT processing as shown in and demapping and deinterleaving techniques followed by FEC decoding after FFT processing as shown in .

These interleaving coding e.g. convolutional codes including puncturing and deinterleaving and decoding and related techniques often are integral parts of OFDM communications systems. As an example a rate 1 2 K 7 convolutional code can be used as an industry standard code for forward error correction FEC during encoding. For purposes of understanding a more detailed description of these basic system components now follows. A convolutional code is an error correcting code and usually has three parameters n k m with n equal to the number of output bits k equal to the number of input bits and m equal to the number of memory registers in one non limiting example. The quantity k n could be called the code rate with this definition and is a measure of the efficiency of the code. K and n parameters range typically from 1 to 8 m ranges typically from 2 to 10 and the code rate typically ranges from 1 8 to 7 8 in non limiting examples. Sometimes convolutional code chips are specified by parameters n k L with L equal to the constraint length of the code. Thus the constraint length can represent the number of bits in an encoder memory that would affect the generation of n output bits. Sometimes the letters may be switched depending on the definitions used.

The transformation of the encoded data is a function of the information symbols and the constraint length of the code. Single bit input codes can produce punctured codes that give different code rates. For example when a rate 1 2 code is used the transmission of a subset of the output bits of the encoder can convert the rate 1 2 code into a rate 2 3 code. Thus one hardware circuit or module can produce codes of different rates. Punctured codes can be used also which allow rates to be changed dynamically through software or hardware depending on channel conditions such as rain or other channel impairing conditions.

An encoder for a convolutional code typically uses a Linear Feedback Shift Register LFSR or look up table LUT for encoding which usually includes an input bit as well as a number of previous input bits known as the state of the encoder the table value being the output bit or bits of the encoder. It is possible to view the encoder function as a state diagram a tree diagram or a trellis diagram.

Decoding systems for convolutional codes can use 1 sequential decoding or 2 maximum likelihood decoding such as Viterbi decoding in one non limiting example which typically is more desirable. Sequential decoding allows both forward and backward movement through the trellis. Viterbi decoding as maximum likelihood decoding examines a receive sequence of given length computes a metric for each path and makes a decision based on the metric. Turbo codes are another example of a forward error correction scheme that can be used.

Puncturing convolutional codes is a common practice in some OFDM systems and can be used in accordance with non limiting examples of the present invention. It should be understood that in some examples a punctured convolutional code is a higher rate code obtained by the periodic elimination of specific logic bits or symbols from the output of a low rate encoder. Punctured convolutional code performance can be degraded compared with original codes but typically the data rate increases.

Some of the basic components that could be used as non limiting examples of the present invention include the transmitter as described before that incorporates a convolutional encoder which encodes a sequence of binary input vectors to produce the sequence of binary output vectors and can be defined using a trellis structure. An interleaver for example a block interleaver can permute the bits of the output vectors. The interleaved data would also be modulated at the transmitter by mapping to transmit symbols and transmitted. At a receiver a demodulator demodulates the signal.

A block deinterleaver recovers the bits that were interleaved. A Viterbi decoder could decode the deinterleaved bit soft decisions to produce binary output data.

Often a Viterbi forward error correction module or core is used that would include a convolutional encoder and Viterbi decoder as part of a radio modem or transceiver as described above. For example if the constraint length of the convolutional code is 7 the encoder and Viterbi decoder could support selectable code rates of 1 2 2 3 3 4 4 5 5 6 6 7 7 8 using industry standard puncturing algorithms.

Different design and block systems parameters could include the constraint length as a number of input bits over which the convolutional code is computed and a convolutional code rate as the ratio of the input to output bits for the convolutional encoder. The puncturing rate could include a ratio of input to output bits for the convolutional encoder using the puncturing process for example derived from a rate 1 2 code.

The Viterbi decoder parameters could include the convolutional code rate as a ratio of input to output bits for the convolutional encoder. The puncture rate could be the ratio of input to output bits for the convolutional encoder using a puncturing process and can be derived from a rate 1 2 mother code. The input bits could be the number of processing bits for the decoder. The Viterbi input width could be the width of input data i.e. soft decisions to the Viterbi decoder. A metric register length could be the width of registers storing the metrics. A trace back depth could be the length of path required by the Viterbi decoder to compute the most likely decoded bit value. The size of the memory storing the path metrics information for the decoding process could be the memory size. In some instances a Viterbi decoder could include a First In First Out FIFO buffer between depuncture and Viterbi function blocks or modules. The Viterbi output width could be the width of input data to the Viterbi decoder.

The encoder could include a puncturing block circuit or module as noted above. Usually a convolutional encoder may have a constraint length of 7 and take the form of a shift register with a number of elements for example 6. One bit can be input for each clock cycle. Thus the output bits could be defined by a combination of shift register elements using a standard generator code and be concatenated to form an encoded output sequence. There could be a serial or parallel byte data interface at the input. The output width could be programmable depending on the punctured code rate of the application.

A Viterbi decoder in non limiting examples could divide the input data stream into blocks and estimate the most likely data sequence. Each decoded data sequence could be output in a burst. The input and calculations can be continuous and require four clock cycles for every two bits of data in one non limiting example. An input FIFO can be dependent on a depuncture input data rate.

Also turbo codes could be used as high performance error correction codes or low density parity check codes that approach the Shannon limit as the theoretical limit of maximum information transfer rate over a noisy channel. Thus some available bandwidth can be increased without increasing the power of the transmission. Instead of producing binary digits from the signal the front end of the decoder could be designed to produce a likelihood measure for each bit.

There now follows a more detailed description of the system and method in accordance with a non limiting example of the present invention which reduces the computations for the IFFT and FFT in OFDM communications systems. There are total of N subcarriers in the typical IFFT case where N is a power of 2. In most practical OFDM signals xonly takes values from a discrete alphabet such as 1 1 for BSPK 1 i 1 i 1 i 1 i for QPSK and similar modulations. If the functions f k are pre stored in a memory and modulation schemes such as BPSK QPSK 64 QAM and similar processes are used the modulation process can be implemented without using any multipliers. The modulation process adds or subtracts complex exponential functions i.e. the basis functions in accordance with a non limiting example of the present invention.

A block diagram showing a OFDM modulation demodulation system that can be used in accordance with a non limiting example of the present invention is shown in generally at and shows a plurality of processing and memory modules arranged in parallel columns each having a feedback loop and output into a shift circuit which could be a shift register or similar structural device. These shift circuits output into an adder or summer .

Each column as a separate memory module corresponds to a specific frequency with the complex exponentials as shown such that no multipliers are used in the system. The modulation process occurs by adding or subtracting complex exponential functions as the basis functions with the changing frequency in each column corresponding to each subcarrier. At the output of each column before the shift circuit a digital constellation symbol such as shown in B and is input to modulate each subcarrier. The shift register can change the sign of the complex exponential corresponding to a subcarrier and operate by multiplying by 2in order to generate a modulated complex exponential with amplitude and phase corresponding to the input digital constellation symbol. Advantageously a sign change can be performed using a simple two s complement and a multiply by 2operation using a shift register in accordance with a non limiting example of the present invention. For example if the input symbol is 1 1 from a QSPK constellation the real part of the complex exponential is added and the imaginary part is two s complemented and added. The feedback is operative for creating the next OFDM symbol and corresponds to that process. It is possible to use the same circuit structure at the receive side for a demodulator and thus the circuit is operable for transmit or receive by changing the sign of the exponential from negative to positive and positive to negative for the switch. The shift circuit has the ability to accomplish a sign change by performing a two s complement operation. A shift left or shift right is used to generate a multiply by 2. The value p represents the number of shifts left or right. For example to multiply by 4 the value p 2 which corresponds to two left shifts. A positive value for p corresponds to a left shift multiply and a negative value of p corresponds to a right shift divide when the left most bit is the most significant bit. It is possible to change the sign to negative because it is a minus and accomplish logical shifts as a multiply by 2 which is then summed from each column as illustrated.

This circuit shows a number of counters that are operative with the memory module as a single column in which the frequency at each of the modules for the complex exponential function can be changed in frequency by skipping samples. For example to double the frequency it is possible to skip every other sample which can be accomplished through the use of the multiple processing counters as illustrated. If the system skips every other sample the system returns back through the memory to complete the approximation of the sine wave. Instead of storing each one of the different frequency sine waves that is a complex exponential function it is possible to use that first column as a memory module for a low frequency sine wave that is oversampled and skip every other sample for doubling the frequency. It is possible to use every third sample to triple the frequency.

The efficiency and required memory storage as illustrated can be reduced even further by exploiting the symmetry and periodicity of the transform 

It should also be understood that the twiddle factor matrix W is also nonsingular and unitary. If A is a unitary matrix then

It should be understood that the FFT requires storage of the N complex input sequence and twiddle factor matrix W with Nelements. Due to the symmetry and periodicity the storage of the complete twiddle factor matrix is not necessary. There is no requirement to store all the functions when f k eand N 2. In this case it suffices to store h k cos k2 N and to use the fact that 

N 2 is an integer since N is a power of two. This is accomplished in order to evaluate sin nk2 N find g mod nk N 4 N N where the operation mod m n adds or subtracts n k times to from m until m nk is between 0 and m 1 and use h g . The sine value can be obtained by a 90 degrees phase shifts of cosine. Depending on the needed resolution and available memory it is possible to use various interpolation schemes to keep the memory size down. In particular linear interpolation can be implemented efficiently without using any multiplies. Symmetry occurs between n such that one read of memory is used for two carriers. This follows from the observation cos 2 sin 2 Symmetry between k generally the index k is assumed to be between 0 and N 1 but seeing it as an index between N 2 the expression

The system and method as described can be used with different basis functions other than the sine nk2 N and cosine nk2n N such as Welch functions or even Chebychev polynomials. It helps the receiver if the basis functions are orthogonal but these basis functions do not need to be orthogonal.

Since the FFT requires multiplications significant implementation loss can occur because of fixed point rounding error. For example when an N Point FFT uses the radix 2 algorithm to compute the result the DFT is computed in v log N stages.

At each multiplication with inputs of m m bit the output grows from m bits to m m bits in size where as an addition result only grows by m 1 bits in size. Thus without rounding the result of 6 stages of multipliers with 16 bit inputs to the FFT grows to 16 2 1024 bits whereas 6 stages of adders grows to 16 6 22 bits. Therefore greater rounding is required for multipliers than adders. Also the additional output of bit widths contributes greatly to the hardware implementation complexity gate count on VLSI circuits of multipliers versus adders.

Assuming the multiplication result is rounded and not truncated and the effect of each fixed point multiplication in the FFT can be modeled as an additive white noise generator each error source has a variance of

It should be understood at the receiver of an OFDM communication system an FFT is performed. There is no prior knowledge of which symbols were transmitted. Therefore most OFDM systems use the FFT as an IFFT at the transmitter and save hardware resources gates by reusing the FFT and performing the complex conjugate and transpose of the twiddle factors.

It should be understood that the system and method as described is advantageous because the increasing demand of wireless communications requires systems with reliability and high spectral efficiency. Many emerging wireless standards taking a large share in the market place are using OFDM for their physical layer such as IEEE 802.11a and 802.11g Local Area Networks and 802.16 Wide Area Networks . OFDM is also used as the global standard for asymmetric digital subscriber line ADSL and for digital audio broadcasting DAB in the European market. A disadvantage of the OFDM waveform is large peak to average power ratio PAPR that results from the addition of multiple sinusoids with random amplitude and phases. Due to the central limit theorem the dynamic range of the signal approaches a time distribution with a Gaussian distribution. These large peaks will cause intermodulation distortion if compressed by a power amplifier resulting in an increase in the error rate. The average signal power must be kept low in order to operate the power amplifier in its linear region and prevent compression or clipping of the signal. The power consumption for a communication system is typically bound by the requirements of the final power amplifier. It is therefore important to minimize the Peak to Average Power Ratio PAPR .

A system and method for reducing the PAPR is the PN Scrambler technique used by Harris Corporation of Melbourne Fla. which takes advantage of the fact that the probability of low PAPR OFDM symbols occurring is frequent. The PAPR of the OFDM signal can be reduced by transmitting low PAPR symbols which requires a search using multiple IFFT s. The system and method in accordance with a non limiting example of the present invention speeds up the generation of OFDM symbols by eliminating multiplications. The technique however still requires

For a 1024 point FFT this results in 100 more complex additions. For a 64 point FFT however this results in 10 more complex additions and no multiplications compared to 192 complex multiplications. Furthermore in accordance with a non limiting example of the present invention it is not necessary to perform all Nadditions. Only D additions are required where D is the number of carriers. For example if there are only 52 carriers used 64 52 3328 complex additions are required instead of 64 4096 complex additions.

The PN Scrambling technique as described before is a distortion less way of reducing PAPR in OFDM systems. Since it is distortion less it is suitable for cascading with other methods commonly used for PAPR reduction such as soft clipping peak windowing peak cancellation or companding. This improvement in PAPR reduction can be described mathematically. If each time domain OFDM symbol has a probability p of having a PAPR x dB then k scrambling sequences reduces the probability to p. Therefore a packet consisting of n symbols has a probability for PAPR x dB of n p.

For example with k 3 iterations and a probability of p 0.05 of PAPR 6 dB for each OFDM symbol the symbol scrambling method reduces the probability to 10 0.05 3 0.0013.

There now follows a code example implementing an algorithm for the system and method in accordance with a non limiting example of the present invention.

An efficient FFT approximation is also operable in an OFDM demodulator in accordance with a non limiting example of the present invention. The system and method requires no multiplications and less storage space. For example a 1024 FFT in accordance with a non limiting example of the present invention stores a 2 bit by 1024 2048 bits in memory.

A high level block circuit diagram of part of a demodulator in accordance with a non limiting example of the present invention is shown in and includes a processing and memory module containing a period of a sine cosine approximation which inputs into a plurality of Read Address Circuits and Mixers which output into Summers and Result Processing Block circuits as illustrated with appropriate feedback and mixer input as illustrated.

At the receive stage the system and demodulator do not know the phase value and amplitude that is transmitted. The channel corrupts the amplitude and phase that is transmitted. It is possible to use 1 s and 1 s or multilevel values with the exponentials. The signal Y t enters the system and a memory contains a period for example one period of the sine cosine approximation. The signal Y t is the signal that is transmitted over the air with the sine wave approximation stored in memory. If the process begins at the far left it is a sine wave but if the process begins a couple of samples forward then it is a cosine wave. Thus the Y t signal enters when it is multiplied by values from the sine and cosine and sums together to accomplish the FFT. The sine wave at the top can represent the 1 and 1 s. It is possible to operate at three level or five level and reduce down to simple logical shifts instead of multiplies. Subtractions can be simple two s complement additions.

There now follows further description relating to the modulation and demodulation of the OFDM signal in accordance with a non limiting example of the present invention.

Both the modulation and demodulation of the OFDM signal involves a Fourier transform as noted before. This generally requires multiplications which in turn requires significant hardware resources in the FPGA ASICs or DSPs. The system and method uses several parts that are somewhat independent of each other. It should be understood that in one part the description is based on the modulation being QAM including QPSK and BPSK.

Another part is the approximation of the sine cosine basis waveforms by square type pulses. This transforms the multiplications by sine cosine to simple additions. Also in another part the oversampling of the signals places the harmonics of the square type pulses outside the bandwidth of the oversampled OFDM signal. Limiting the scope to QAM signals has the benefit of the input signal being essentially N level signals that can be decomposed into binary pulses. As a result the Fourier transform can be transformed into simple multiplies of type 1 which are simple additions. Since all known OFDM systems use QAM modulation this restriction is of no practical concern. The system and method as described can be used to approximate any OFDM modulation to any degree of precision.

Since the OFDM signal will be approximated it is necessary to know how much distortion is acceptable. The most common forms of OFDM modulation are QPSK 16 QAM and 64QAM. Since QPSK has 2 bits per symbol 16QAM has 4 bits per symbol 64QAM 8 bits per symbol the BER s are approximately 

For about the same BER as QPSK 16QAM requires 7 dB and 64QAM 13 dB higher SNR. The Required SNR for the ARIB STD B31 Version 1.5 Japanese Digital TV standard agrees with these figures. Table 1 illustrates basic standards.

Using the figures from the ARIB standard the Bit Error Rates BERs with Signal to Noise Ratios SNRs of QPSK 10.4 dB 16QAM 16 dB and 64QAM 22 dB SNR are around 0.1 0.4 and 0.6 . Besides the inner code for Japanese standard there is also a 188 204 Reed Solomon code which can correct for up to 8 204 4 BER. In order for the distortion in the OFDM generation not to add to more than 0.5 dB to the overall noise it typically will be 9 dB below the noise as shown in Table 1. If a receiver requires 20 dB S N or better the distortion in the OFDM signal should be around 30 dB carrying a 0.5 dB noise penalty. As a result the receiver will require a 20.5 dB S N. If a 1 dB noise penalty is acceptable the distortion should be around 6 dB below the noise level as shown in the graph of showing the total power in dB on the vertical axis and power of a second signal in dB on the horizontal axis.

It should be apparent that a QPSK system typically has an inherent error of less than 20 dB 16QAM better than 26 dB and 64 QAM better than 32 dB. If a 1 dB degradation is acceptable the inherent error could be less than 16 dB 22 dB and 28 dB i.e. 4 dB less .

As noted above an OFDM signal is a complex linear combination of the basis function sin n t and cos n t . If the length of the symbol is T 1 the basis functions becomes orthogonal. In order to provide resistance to multipath propagation the actual transmitted OFDM symbols are generally longer than T.

The requirements on the basis functions t are that they form a basis i.e. are linearly independent. In order to make the detection more simple they are also orthogonal over some time interval T but do not necessarily have to span the space. It is not difficult to add more functions so that they do.

An example of functions t are hard limited versions of the sin n t and cos n t t sign sin n t Hadamar sequences or even Chebychev polynomials etc. If the system has two sets of basis function t and g t both span the space and basic linear algebra such that one can represent a signal using either basis function. If the two basis functions do not span the space it is possible to obtain a good approximation of one signal using the other set of basis functions.

This can be the result of the choice of basis functions and the assumed band limitation. This is shown in the graphs of the frequency domain in . Within the bandwidth 

The spectra for the FFT of these signals is shown in . They decay as 1 N. The two level signal however lacks some of the harmonics of the hard limited signal such as at 3 and 9 etc. The three level signal s strongest harmonics is at 11 . Using the two level signal instead of the hard limited signal as the basis functions simplifies the Fourier transform even further since some of the multiply by 1 operations are replaced by multiply by 0. Because the harmonics at 3 are gone a lower sampling rate is possible without causing more folding or making the filtering after A D conversion easier by providing more separation between the signal and its images.

The three level signal which takes the values 0 1 2 and 1 requires the Fourier transform demodulation modulation process to multiply with one half in addition to 1. Another approach is to split the signal f t into two functions each taking on the values 1.

One skilled in the art can make the tradeoff between the amount of oversampling and the number of levels to use in the waveform. An optimum tradeoff will depend on the available hardware. By doubling the sample rate increased oversampling the system can gain around 3 dB. By adding an extra bit the system gains about 6 dB. This is a similar tradeoff as with A D converters for example a 3 dB noise gain when doubling the sampling rate and a 6 dB gain when adding an extra bit.

There now follows description of various results obtained in simulations. A QPSK OFDM system with three different signals functions was used in one simulation to demodulate. Three cases with no oversampling and three times and five times oversampling were simulated. The bandwidth was set according to 

The simulations in show that it is possible to obtain SNRs from about 11 dB to 20 dB 2 level no oversampling 3 level 2 oversampling . To obtain a signal with 30 dB distortion which would suit 64 QAM a signal with one more bit will work. This signal will have 3 bits and a sign bit. Another alternative is to use the 3 level signal and oversample by 6. This system as described is suited for QPSK 16 QAM possibly for 64 QAM.

It should be understood from the preceding that the present invention describes an efficient IFFT for use as an OFDM modulator and an efficient FFT for use as an efficient OFDM demodulator. Advantageously the invention describes techniques to perform the IFFT modulation and FFT demodulation without using any multipliers. Thus the modulator and demodulator can be implemented using only logical shifts two s complement and adders. Since the implementation complexity is determined by the number of multipliers the invention provides significantly less implementation complexity lower number of gates and lower system power consumption.

On the transmitter side the complex exponentials can be accurately stored in memory using full precision and the subcarriers modulated using logical shifts and two s complements operations corresponding to the input digital constellation symbol value to be transmitted. This technique takes advantage of the simple digital constellation integer values. Multipliers present much more rounding error due to significant bit growth as discussed in the preceding. Since this technique does not require multiplications significant rounding error is avoided and the invention presented allows more accuracy in the transmitter than the conventional IFFT OFDM modulators. Thus the present invention describes a IFFT modulator that is distortion less and does not require multiplications.

On the receiver side the input into the FFT is no longer simple integer digital constellation symbols. Instead the input to the receiver s FFT consists of the output of the transmitter plus random amplitude and phase perturbations added to the signal by the transmission channel. A separate technique was described in the preceding to allow removal of multiplications for an efficient FFT implementation in an OFDM receiver. This technique uses approximations of complex exponentials in order to convert the FFT operations into simple logical shifts two s complement and adders. The disadvantage of this technique is that it is not distortion less like the transmitter IFFT OFDM modulator described above. It will be appreciated that the presented FFT demodulator uses oversampling and multilevel sinusoidal approximations in order to reduce the in band harmonic distortion in accordance with the present invention.

Efficient storage of the complex exponentials was discussed in the preceding and is applicable to both the IFFT modulator and the FFT demodulator in accordance with the present invention. The complete storage of the complex exponentials would normally require both the real cosine and imaginary sine components to be stored in memory or generated as needed for each subcarrier. Since the sine can be derived from the cosine only the real part needs to be stored. Secondly since each frequency is an integer multiple of the lowest frequency sinusoid only the lowest frequency sinusoid needs to be stored. Thus all of the complex exponentials can be generated from one sinusoid. Advantageously use of this invention does not restrict the number of subcarriers N to a power of 2.

An example of a radio that can be used with such system and method is a Falcon III radio manufactured and sold by Harris Corporation of Melbourne Fla. The Falcon III can include a basic transmit switch and other functional switches and controls known to those skilled in the art. It should be understood that different radios can be used including but not limited to software defined radios that can be typically implemented with relatively standard processor and hardware components. One particular class of software radio is the Joint Tactical Radio JTR which includes relatively standard radio and processing hardware along with any appropriate waveform software modules to implement desired communication waveforms. JTR radios also use operating system software that conforms to the software communications architecture SCA specification see www.jtrs.saalt.mil which is hereby incorporated by reference in its entirety. The SCA is an open architecture framework that specifies how hardware and software components are to interoperate so that different manufacturers and developers can readily integrate the respective components into a single device.

The Joint Tactical Radio System JTRS Software Component Architecture SCA defines a set of interfaces and protocols often based on the Common Object Request Broker Architecture CORBA for implementing a Software Defined Radio SDR . In part JTRS and its SCA are used with a family of software re programmable radios. As such the SCA is a specific set of rules methods and design criteria for implementing software re programmable digital radios.

The JTRS SCA specification is published by the JTRS Joint Program Office JPO . The JTRS SCA has been structured to provide for portability of applications software between different JTRS SCA implementations leverage commercial standards to reduce development cost reduce development time of new waveforms through the ability to reuse design modules and build on evolving commercial frameworks and architectures.

The JTRS SCA is not a system specification as it is intended to be implementation independent but a set of rules that constrain the design of systems to achieve desired JTRS objectives. The software framework of the JTRS SCA defines the Operating Environment OE and specifies the services and interfaces that applications use from that environment. The SCA OE comprises a Core Framework CF a CORBA middleware and an Operating System OS based on the Portable Operating System Interface POSIX with associated board support packages. The JTRS SCA also provides a building block structure defined in the API Supplement for defining application programming interfaces APIs between application software components.

The JTRS SCA Core Framework CF is an architectural concept defining the essential core set of open software Interfaces and Profiles that provide for the deployment management interconnection and intercommunication of software application components in embedded distributed computing communication systems. Interfaces may be defined in the JTRS SCA Specification. However developers may implement some of them some may be implemented by non core applications i.e. waveforms etc. and some may be implemented by hardware device providers.

For purposes of description only a brief description of an example of a communications system that would benefit from the present invention is described relative to a non limiting example shown in . This high level block diagram of a communications system includes a base station segment and wireless message terminals that could be modified for use with the present invention. The base station segment includes a VHF radio and HF radio that communicate and transmit voice or data over a wireless link to a VHF net or HF net each which include a number of respective VHF radios and HF radios and personal computer workstations connected to the radios . Ad hoc communication networks are interoperative with the various components as illustrated. Thus it should be understood that the HF or VHF networks include HF and VHF net segments that are infrastructure less and operative as the ad hoc communications network. Although UHF radios and net segments are not illustrated these could be included.

The HF radio can include a demodulator circuit and appropriate convolutional encoder circuit block interleaver data randomizer circuit data and framing circuit modulation circuit matched filter circuit block or symbol equalizer circuit with an appropriate clamping device deinterleaver and decoder circuit modem and power adaptation circuit as non limiting examples. A vocoder voice encoder decoder circuit can incorporate the encode and decode functions and a conversion unit which can be a combination of the various circuits as described or a separate circuit. A transmit key switch is operative as explained above. These and other circuits operate to perform any functions necessary for the present invention as well as other functions suggested by those skilled in the art. The circuits referenced here may include any combination of software and or hardware elements including but not limited to general purpose microprocessors and associated software specialized microprocessors for digital signal processing and their associated software Application Specific Integrated Circuits ASICs Field Programmable Gate Arrays FPGAs logic circuits or other kinds of devices and or software or firmware known to those skilled in the art. Other illustrated radios including all VHF mobile radios and transmitting and receiving stations can have similar functional circuits.

The base station segment includes a landline connection to a public switched telephone network PSTN which connects to a PABX . A satellite interface such as a satellite ground station connects to the PABX which connects to processors forming wireless gateways . These interconnect to the VHF radio or HF radio respectively. The processors are connected through a local area network to the PABX and e mail clients . The radios include appropriate signal generators and modulators. The packetized or non packetized digital voice information transmitted within the network using the techniques of the present invention can originate at or be delivered to a handset connected to one of the radios a telephone or other interface device attached to a wireless gateway device such as the RF 6010 Tactical Network Hub or a subscriber telephone connected to the PABX or within the public switched telephone network.

An Ethernet TCP IP local area network can operate as a radio mail server. E mail messages can be sent over radio links and local air networks using STANAG 5066 as second generation protocols waveforms the disclosure which is hereby incorporated by reference in its entirety and of course preferably with the third generation interoperability standard STANAG 4538 the disclosure which is hereby incorporated by reference in its entirety. An interoperability standard FED STD 1052 the disclosure which is hereby incorporated by reference in its entirety can be used with legacy wireless devices. Examples of equipment that can be used in the present invention include different wireless gateway and radios manufactured by Harris Corporation of Melbourne Fla. This equipment includes RF5800 5022 7210 5710 6010 5285 and PRC 117 and 138 series equipment and devices as non limiting examples.

These systems can be operable with RF 5710A high frequency HF modems and with the NATO standard known as STANAG 4539 the disclosure which is hereby incorporated by reference in its entirety which provides for transmission of long distance HF radio circuits at rates up to 9 600 bps. In addition to modem technology those systems can use wireless email products that use a suite of data link protocols designed and perfected for stressed tactical channels such as the STANAG 4538 or STANAG 5066 the disclosures which are hereby incorporated by reference in their entirety. It is also possible to use a fixed non adaptive data rate as high as 19 200 bps or higher with a radio set to ISE mode and an HF modem set to a fixed data rate. It is possible to use code combining techniques and ARQ.

The system and method in accordance with non limiting examples of the present invention can be used in multiprocessor embedded systems and related methods and also used for any type of radio software communications architecture as used on mainframe computers or small computers including laptops with an added transceiver such as used by military and civilian applications or in a portable wireless communications device as illustrated in . The portable wireless communications device is illustrated as a radio that can include a transceiver as an internal component and handheld housing with an antenna and control knobs . A Liquid Crystal Display LCD or similar display can be positioned on the housing in an appropriate location for display. The various internal components including dual processor systems for red and black subsystems and software that is conforming with SCA is operative with the illustrated radio. Although a portable or handheld radio is disclosed the architecture as described can be used with any processor system operative with the transceiver using SCA and the efficient FFT circuit in accordance with non limiting examples of the present invention. An example of a communications device that could incorporate the efficient FFT circuit in accordance with non limiting examples of the present invention is the Falcon III manpack or tactical radio platform manufactured by Harris Corporation of Melbourne Fla.

This application is related to copending patent applications entitled SYSTEM AND METHOD FOR COMMUNICATING DATA USING EFFICIENT FAST FOURIER TRANSFORM FFT FOR ORTHOGONAL FREQUENCY DIVISION MULTIPLEXING OFDM DEMODULATION and SYSTEM AND METHOD FOR COMMUNICATING DATA USING EFFICIENT FAST FOURIER TRANSFORM FFT FOR ORTHOGONAL FREQUENCY DIVISION MULTIPLEXING OFDM which are filed on the same date and by the same assignee and inventors the disclosures which are hereby incorporated by reference.

Many modifications and other embodiments of the invention will come to the mind of one skilled in the art having the benefit of the teachings presented in the foregoing descriptions and the associated drawings. Therefore it is understood that the invention is not to be limited to the specific embodiments disclosed and that modifications and embodiments are intended to be included within the scope of the appended claims.

