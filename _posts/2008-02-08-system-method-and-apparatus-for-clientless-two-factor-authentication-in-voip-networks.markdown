---

title: System, method and apparatus for clientless two factor authentication in VoIP networks
abstract: The present invention provides a system, method and apparatus for authenticating an Internet Protocol (IP) phone and a user of the IP phone by determining whether the IP phone is an authorized device, and whenever the IP phone is authorized and a trigger condition occurs, determining whether the user of the IP phone is authorized. The user authorization process initiates a call to the IP phone, sends a request for a passcode to the IP phone, sends a message to disable the IP phone whenever the passcode is invalid, and terminates the call. The user authentication process uses an in-band channel and the IP phone does not run a two factor authentication client application during the authentication process.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08705720&OS=08705720&RS=08705720
owner: Avaya Inc.
number: 08705720
owner_city: Basking Ridge
owner_country: US
publication_date: 20080208
---
The present invention relates generally to the field of telecommunications and more particularly to a system method and apparatus for clientless two factor authentication in voice over Internet Protocol VOIP networks.

This patent application is a non provisional application of U.S. provisional patent application 60 888 765 filed on Feb. 8 2007 and entitled System Method and Apparatus for Two Factor Authentication in VOIP Networks which is hereby incorporated by reference in its entirety.

The combination of device and user authentication is called Two Factor authentication. Enterprises already have this mechanism in place for remote users connecting through computers. RSA SecurID or similar mechanism is the de facto way of enabling two factor authentication. Two Factor authentication requires a user to key in a special pass phrase or key that is displayed on a Secure Token. This token is typically issued by the company and is carried by the employee all the time. The token is linked back to token authentication server in the company. When the employee wants to login to corporate services he she must supply the pass phrase or key which changes periodically to ensure that only the employee is requesting the service. The supplied input data is validated against the authentication server and if the match occurs the employee is granted the service. RSA tokens and RSA server are widely deployed two factor authentication mechanisms in corporations.

This above mentioned technique works well for computer terminals as there are client applications built to accept the two factor authentication. There is however no client or the user interface to allow two factor authentication on phones. Unlike traditional phones that are always tied to a physical wire connected to PBX Switch the new breed of phones are Internet Protocol IP enabled and thus provide portability and mobility. For example an employee can carry an IP Phone from his work and plug it into Ethernet connector at home and can access an entity s network. This flexibility enables businesses or other entities to deploy these phones to tele workers road warriors consultants partners and other. On the other hand it makes these entities vulnerable to theft attacks and abuse. As a result there is a need for a clientless two factor authentication for IP based phones.

The present invention when applied in conjunction with deeper security threat mitigation creates a highly secure telephony that can be provided anywhere outside the corporation. As a result entities can realize business continuity and the benefits of pervasive communications. The two factor authentication must be carried out in a secure channel between the phone and the entity as the phone is typically on the Internet. In addition the voice conversation must be encrypted for privacy. With new IP Phone terminals and soft phones this is achieved through encrypted transport. Other techniques such as Virtual Private Network VPN based access require clients on the phone or additional VPN devices to maintain that restrict the IP Phone support and the usage. The present invention leverages the same control messages and voice prompts used for setting up calls to the phone to provide two factor authentication. Thus neither a client on the phone nor an out of band channel is necessary to complete two factor authentication.

The present invention provides a method for authenticating an IP phone and a user of the IP phone by determining whether the IP phone is an authorized device and whenever the IP phone is authorized and a trigger condition occurs determining whether the user of the IP phone is authorized. The user authorization process initiates a call to the IP phone sends a request for a passcode to the IP phone sends a message to disable the IP phone whenever the passcode is invalid and terminates the call. The user authentication process uses an in band channel and the IP phone does not run a two factor authentication client application during the authentication process.

The present invention also provides an apparatus for authenticating an IP phone and a user of the IP phone that includes a communications interface a memory and a processor communicably coupled to the communications interface and the memory. The processor is configured to determine whether the IP phone is an authorized device and determine with the user is authorized whenever the IP phone is authorized and a trigger condition occurs. The processor authenticates the user of the IP phone by initiating a call to the IP phone via the communications interface sending a request for a passcode to the IP phone via the communications interface sending a message to disable the IP phone via the communications interface whenever the passcode is invalid and terminating the call. The user authentication process uses an in band channel and the IP phone does not run a two factor authentication client application during the authentication process.

In addition the present invention provides a system that includes one or more IP phones a security server and an Internet Protocol network communicably coupling the one or more IP phones to the security server. The security server includes a communications interface a memory and a processor communicably coupled to the communications interface and the memory. The processor is configured to determine whether the IP phone is an authorized device and determine with the user is authorized whenever the IP phone is authorized and a trigger condition occurs. The processor authenticates the user of the IP phone by initiating a call to the IP phone via the communications interface sending a request for a passcode to the IP phone via the communications interface sending a message to disable the IP phone via the communications interface whenever the passcode is invalid and terminating the call. The user authentication process uses an in band channel and the IP phone does not run a two factor authentication client application during the authentication process.

While the making and using of various embodiments of the present invention are discussed in detail below it should be appreciated that the present invention provides many applicable inventive concepts that can be embodied in a wide variety of specific contexts. The specific embodiments discussed herein are merely illustrative of specific ways to make and use the invention and do not delimit the scope of the invention. The discussion herein relates primarily to clientless two factor authentication using RSA SecurID and Cisco CallManager CCM but it will be understood that the concepts of the present invention are applicable to any clientless two factor authentication of IP phones or similar devices using any suitable authentication and IP call agent platform.

The present invention when applied in conjunction with deeper security threat mitigation creates a highly secure telephony that can be provided anywhere outside the corporation. As a result entities can realize business continuity and the benefits of pervasive communications. The two factor authentication must be carried out in a secure channel between the phone and the entity as the phone is typically on the internet. In addition the voice conversation must be encrypted for privacy. With new IP Phone terminals and soft phones this is achieved through encrypted transport. Other techniques such as VPN based access require clients on the phone or additional VPN devices to maintain that restrict the IP Phone support and the usage. The present invention leverages the same control messages and voice prompts used for setting up calls to the phone to provide two factor authentication. Thus neither a client on the phone nor an out of band channel is necessary to complete two factor authentication.

Now referring to two network configurations in accordance with the present invention are illustrated. represents the present invention in Internet Protocol Communication Security IPCS demilitarized zone DMZ mode . represents the present invention in an IPCS in a tunnel mode . In either case the present invention provides infrastructure and endpoint protection. The two factor authentication for remote users must be provided in the DMZ of enterprise. The security server in the DMZ must be able to handle near end and far end firewall issues. The secrurity server must a provide authentication connectivity to the authentication server not shown e.g. SecurID server or other suitable authentication server b terminate and inspect signaling and media and c be a secure box. The security server IPCS is communicably coupled to various IP phones and call servers via an Intranet or other IP based communications network internal private or secure . Note that the security server in is communicably coupled to another security server which is communicably coupled to the call servers to establish a secure tunnel through the Intranet .

The security server can be communicably coupled to various external IP phones via the Internet or other IP based communications network external less secure or public . In addition the security server is protected by an internal firewall and an external firewall . Similarly external IP phones are protected by a firewall . The security server includes a communications interface a memory and a processor communicably coupled to the communications interface and the memory. The processor is configured to perform the authentication processes described below. The IP phone can be a dual mode phone a wireless phone a soft phone a web phone a personal data assistant or other IP based telecommunications device that does not run a client based authentication application during the authentication process described herein. Note that IP Private Branch Exchange PBX systems are not built to address the above requirements.

Referring now to is a flow chart illustrating a two factor authentication process in accordance with one embodiment of the present invention is shown. The authentication process begins in block . If the IP phone is authorized as determined in decision block and a trigger condition occurs as determined in decision block the security server initiates a call to the IP phone in block . A white list or other type of commonly used device authentication can be used to authenticate the IP phone. The trigger condition can be a time based condition an event based condition or a combination thereof. The time based condition can be a requirement to authenticate the IP phone daily weekly bi weekly monthly quarterly yearly or some other specified time. The event based condition can be receiving a registration request from the IP phone a switch over to standby a challenge from an authentication manager a request for a specified service or a request for access to a specified device. If however the IP phone is not authorized as determined in decision block or the trigger condition is not met as determined in decision block the process ends in block .

After the call is initiated the secure server sends a request for the user s passcode to the IP phone in block . The request for the passcode may include one or more display prompts one or more voice prompts or a combination thereof. The passcode can be a personal identification code a token code a physical key an electronic key a biometric identifier a magnetic signature an electronic signature one or more numbers one or more symbols one or more alphabet characters one or more keystrokes or a combination thereof. If the passcode is valid as determined in decision block the call is terminated in block and the process ends in block . If however the passcode is not valid the security server sends a message to the IP phone that will disable the IP phone in block . Thereafter the call is terminated in block and the process ends in block . After the authentication process is successfully completed the IP phone will be allowed to access resources or connect to devices protected by the security server . Note that this process can be implemented using a computer readable medium executed by the secure server wherein the steps are executed by one or more code segments.

Now referring to a flow chart illustrating a two factor authentication process in accordance with another embodiment of the present invention is shown. The authentication process begins in block . If the IP phone is not authorized as determined in decision block a security incidence is generated in block and the process ends in block . A white list or other type of commonly used device authentication can be used to authenticate the IP phone. If however the IP phone is authorized but a trigger condition does not occur or is not satisfied as determined in decision block the process ends in block . The trigger condition can be a time based condition an event based condition or a combination thereof. The time based condition can be a requirement to authenticate the IP phone daily weekly bi weekly monthly quarterly yearly or some other specified time. The event based condition can be receiving a registration request from the IP phone a switch over to standby a challenge from an authentication manager a request for a specified service or a request for access to a specified device If however the trigger condition is satisfied the security server initiates a call to the IP phone in block .

After the call is initiated the secure server sends a request for the user s passcode to the IP phone in block . The request for the passcode may include one or more display prompts one or more voice prompts or a combination thereof. The passcode can be a personal identification code a token code a physical key an electronic key a biometric identifier a magnetic signature an electronic signature one or more numbers one or more symbols one or more alphabet characters one or more keystrokes or a combination thereof. If the call is not answered as determined in decision block and request retries are allowed as determined in decision block the process waits in block and a new request is sent in block . If however retries are not allowed the call is terminated in block and the process ends in block . If however the call is answered as determined in decision block and the passcode is valid as determined in decision block the call is terminated in block and the process ends in block . If however the passcode is not valid and the maximum number of attempts to enter the passcode have not been exceeded as determined in decision block the user may try to enter the correct passcode. If however the maximum number of attempts has been made the security server sends a message to the IP phone that will disable the IP phone in block the user is notified that the IP phone has been disabled in block . The notification may include one or more display messages audio messages voice mail messages electronic mail messages text messages or a combination thereof. Thereafter a security incidence is generated in block the call is terminated in block and the process ends in block . After the authentication process is successfully completed the IP phone will be allowed to access resources or connect to devices protected by the security server .

The security server can block any messages from the IP phone until the IP phone and the user are authenticated. In addition the security server can initiate another call to the IP phone and send another request for a passcode to the IP phone after the IP phone has been disabled for a specified period of time. The security server can delay registration of the IP phone with a call manager until the IP phone and the user are authenticated. Moreover the IP phone can be enabled after the IP phone has been disabled by using a clearing process executed by the user a technician a security person a supervisor or a combination thereof. Note that this process can be implemented using a computer readable medium executed by the secure server wherein the steps are executed by one or more code segments.

Referring now to a RSA SecurID authentication network in accordance with one embodiment of the present invention is illustrated. The system includes a security server IPCS communicably coupled to one or more protected resources devices or phones and an authentication server . The security server is also communicably coupled to an IP phone . The user of the IP phone has a RSA SecurID that provides a PIN Token Number or RSA SecurID with pinpad that provides a Pass Code. The communication protocol used between the IP phone and the security server is SIP Skinny over TLS and SRTP. The communication protocol used between the security server and the protected phones is SIP Skinny over TCP. The communication protocol used between the security server and the authentication server RSA Authentication Manager RSA Radius Server is PAP over RADIUS EAP GTC over RADIUS and or EAP POTP over RADIUS. The security server can request authentication of the received passcode from the authentication server .

Now referring to a call flow diagram in accordance with another embodiment of the present invention is illustrated. The solution is described using the SKINNY protocol but it can also apply to other protocols that are used to setup VoIP Voice over IP calls.

Referring now to a screen shot of a virtual IP configuration table in accordance with one embodiment of the present invention is illustrated. For example the following rules can be used 

Now referring to a state machine diagram in accordance with one embodiment of the present invention is illustrated.

It will be understood by those of skill in the art that information and signals may be represented using any of a variety of different technologies and techniques e.g. data instructions commands information signals bits symbols and chips may be represented by voltages currents electromagnetic waves magnetic fields or particles optical fields or particles or any combination thereof . Likewise the various illustrative logical blocks modules circuits and algorithm steps described herein may be implemented as electronic hardware computer software or combinations of both depending on the application and functionality. Moreover the various logical blocks modules and circuits described herein may be implemented or performed with a general purpose processor e.g. microprocessor conventional processor controller microcontroller state machine or combination of computing devices a digital signal processor DSP an application specific integrated circuit ASIC a field programmable gate array FPGA or other programmable logic device discrete gate or transistor logic discrete hardware components or any combination thereof designed to perform the functions described herein. Similarly steps of a method or process described herein may be embodied directly in hardware in a software module executed by a processor or in a combination of the two. A software module may reside in RAM memory flash memory ROM memory EPROM memory EEPROM memory registers hard disk a removable disk a CD ROM or any other form of storage medium known in the art. Although preferred embodiments of the present invention have been described in detail it will be understood by those skilled in the art that various modifications can be made therein without departing from the spirit and scope of the invention as set forth in the appended claims.

