---

title: Structured coauthoring
abstract: A system is presented for structured coauthoring of a document, the system comprising a server. The server includes one or more documents organized into sections, a document permissions module that stores user access permissions for each section of a document, a document update processing module that processes requests from a user to share document updates with other users and that processes requests from a user to receive document updates from other users and a document rendering module that renders a document for display on a client so that sections of the document are updated with shared document updates made by users. The user access permissions determine the extent to which a user can modify each section of the document.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08417666&OS=08417666&RS=08417666
owner: Microsoft Corporation
number: 08417666
owner_city: Redmond
owner_country: US
publication_date: 20080625
---
In multi user environments it may be desirable for multiple users be able to edit the same document at the same time. Often when multiple users are editing the document confusion can exist as to how the various edits are added to the document. For example sometimes multiple versions of the document are edited making it difficult to merge the edits into a single complete document.

Even in systems that support multi user editing of a document users typically cannot control when the users edits are shown to others editing the document. Further it can be difficult to define which user is working on which particular part of the document thereby resulting in possible conflicts in the changes made to the document.

According to one aspect a system for structured coauthoring of a document comprises a server including one or more documents each document being organized into sections a document permissions module that stores user access permissions for each section of a document a document update processing module that processes requests from a user to share document updates with other users and that processes requests from a user to receive document updates from other users and a document rendering module that renders a document for display on a client the document being rendered so that sections of the document are updated with shared document updates made by users the shared document updates being requested by the user on the client. The user access permissions determine the extent to which a user can modify each section of the document permitting different user access permissions to be stored for one or more sections of the document. The system permits two or more users to coauthor one or more of the sections of the document so that each user has specific access rights to one or more of the sections of the document so that the user can specify whether updates made by the user to the one or more sections of the document can be displayed to other users and so that the user can view the names of other users accessing the one or more sections of the document and can selectively obtain updates to the document from those users.

According to another aspect a method for structured coauthoring of a document comprises opening a document on a client by a user the document organized into sections each section representing a part of the document the document displaying user access permissions for one or more sections of the document and the document displaying the names of users who are editing one or more of the sections of the document performing operations on one or more sections of the document the operations being consistent with the user access permissions granted for the one or more sections of the document identifying updates to the document that can be shared with other users so that the updates to the document are shared with other users and identifying one or more users from which document updates to one or more of the sections of the document are to be obtained the one or more users selected from the names displayed on the document so that the document updates are obtained from the document server and displayed in the appropriate sections of the document.

According to yet another aspect a method for coordinating the structured coauthoring of a document at a document server comprises dividing a document into a plurality of sections each of the sections including a paragraph of the document storing user access permissions to each of the sections of the document for a plurality of users of the document the user access permissions defining an extent to which each of the plurality of users can view edit and comment on the sections of the document storing the names of users who are accessing each of the sections of the document rendering an instance of the document to the users of the document the rendered document including access controls that indicate user access permissions for each of the sections of the document the rendered document including the names of the users who are editing each of the sections of the document the rendered document including action controls providing actions including requesting updates to the sections from the users and designating that updates a user made to the sections are made available to users storing updates to the document made by the users of the document receiving a request from a first user to share updates to the document made by the first user with other users in response to the request from the first user enabling the document updates made by the first user to be shared with other users receiving a request from a second user to receive updates to the sections of the document made by other users and in response to the request from the second user rendering an instance of the document for the second user that includes the shared updates to the sections requested by the second user the shared updates being rendered in new document sections located directly above the requested document sections.

This Summary is provided to introduce a selection of concepts in a simplified form that are further described below in the Detailed Description. This Summary is not intended to identify key features or essential features of the claimed subject matter nor is it intended to be used to limit the scope of the claimed subject matter.

In examples described herein a document is organized into sections and users are assigned specific access permissions to one or more sections of the document. The access permissions define the extent to which a user can view edit or comment on a section of the document. Structured coauthoring also permits users to share document updates. A user can make changes to the document and decide which if any of these changes are shared with other users. In addition a user can request to see shared updates to the document made by one or more other users.

In example embodiments the clients are computing devices such as desktop computers laptop computers personal data assistants or cellular devices. The clients can include input output devices a central processing unit CPU a data storage device and a network device.

Typical input output devices include keyboards mice displays microphones speakers disk drives CD ROM drives and flash drives. Other types of input output devices can also be used.

Computer readable media such as the data storage device provides for data retention. By way of example computer readable media can include computer storage media and communication media. Computer storage media includes physical volatile and nonvolatile removable and non removable media implemented in any method or technology for storage of information such as computer readable instructions data structures program modules or other data. Communication media typically embodies computer readable instructions data structures program modules or other data in a modulated data signal such as a carrier wave or other transport mechanism and includes any information delivery media. The term modulated data signal means a signal that has one or more of its characteristics set or changed in such a manner as to encode information in the signal.

Among the plurality of information stored on the data storage device is a client operating system OS and client applications. The client OS is a program that manages the hardware and software resources of the client system. The client applications utilize the resources of the clients to directly perform tasks specified by the user. For example the clients include one or more software applications such as word processing programs that are used to create and edit document files. One example of such an application is Microsoft Word from Microsoft Corporation of Redmond Wash. Other examples of such applications are also applicable.

The network device enables the clients to send and receive data to from the server through a network such as a LAN or the Internet. Other configurations for the clients are possible.

The document server is a file server that is accessible through a network. The document server stores a plurality of files. These files can include both software applications and documents as described further herein. The document server controls access to the documents stored by the server .

In example embodiments the document server can be located within an organization or can be part of an Internet based shared document system. An example Internet based shared document system is a SHAREPOINT team services portal server services provided by Microsoft Corporation. An example shared document server is Microsoft Office SharePoint Server 2007 provided by Microsoft Corporation. Other configurations can be used.

In the example shown the document is organized into a plurality of sections designated as sections through respectively. A section corresponds to an editable piece of a document. Typically a section can be any subpart of a document for example paragraphs headings drawings tables etc. A document may contain only one section for example a table or a single paragraph or sentence.

Alongside each section of the example document are example user controls that display the names of users who are currently coauthoring the section. The example document also includes example access controls that display the access permissions of each user for the document section and example action controls that permit the user to take one or more specific actions for the document section. The specific actions may include assigning the document section to another user marking the document section reviewed marking the document section completed etc. In addition the example document also includes example dynamic controls that define rules for dynamically changing the access permissions for a section of the document. Other functionality for the controls is possible. The controls may include text boxes list boxes pull down list boxes icons or any other user interface control types that may be appropriate.

In the example shown the user controls list the names of the user or users who are currently editing the note section of the documents. For example if user A and user B are currently editing section of the document the names of user A and user B are listed in the user control so that everyone that has the document open can see that user A and user B are currently editing the section . A user is considered to be editing a document section when the user makes changes to the document section for example by typing in the document section.

The access permissions of the access controls indicate the extent to which a user may edit a section of the document . Example user access permissions include full control read write review only comment only read only and no access. Other user access permissions may be possible.

In example embodiments the names of all users with any level of access permission to the document section are displayed via user controls . In example embodiments the names of users with read only access may not be displayed for example if the list of such users is long.

When a user is assigned full control the user has full read write access to the section of the document and in addition the user can use any aspect of the user interface. For example with full control the user can change the formatting of the document. When a user has read write control the user has read write permission to a section of the document but cannot make formatting changes. With review only permission a user can make changes to the document that are tracked via a technology like Track Changes in Microsoft Word. With comment only permission the user can insert comments to a section of the document but cannot alter the text within the section of the document. With read only permission the user can view the section of the document but cannot make any changes to it and cannot insert any comments.

With no access permission certain sections of a document may not be viewable to users. For example there may be confidential information in a document that one or more users are not permitted to view. Therefore when presented to a user one or more sections of a document may be redacted to prevent a user from viewing it. This is illustrated by shaded sections and in which have been defined as no access for some of the users. In some embodiments confidential sections may not be displayed at all to a user that is not permitted to view them. In example embodiments sections of a document may be redacted if a user is not permitted to edit them. For example in a document that includes both engineering and financial sections the financial sections may be redacted when an engineer is viewing the document and the engineering sections may be redacted when a financial person is viewing the document.

In example embodiments user access permissions and rules may be assigned and edited by an owner of the document i.e. the person or persons having ownership permission for the document . This may be done on a section by section basis or globally for the entire document. The user access permissions and rules are stored on a document server.

The user access permissions described can also be enforced without network connectivity. Assigned user permissions to sections of a document can be cached in the client s software application or stored within the document. In this way the access permissions can be used if the client is disconnected from the network or working on the document from a different computer.

The action controls permit the user to take a specific action regarding the document section. For example the user may wish to obtain updates to the document section from one or more other users that may be editing the document section or the user may wish to share updates that the user made to the document section with one or more other users. Other example actions that the user may make include sending an email to a user or instant messaging a user to find out status. Other actions are possible.

The dynamic controls are used to define rules that permit the access permissions for a section of the document to dynamically change when a user completes a task. For example one or more users may be designated reviewers but a user may not want the document to be reviewed until it is completed. In an example embodiment when a user marks a section of a document as complete the access permission for a reviewer dynamically changes from read only to review only.

When a user opens and begins editing the document the user can view the corresponding example coauthoring control to determine who else is currently editing the various sections of the document. Typically the user may know one or more other users and may want to see any changes that the other users have made before the user makes any additional changes. The user can indicate via example action controls that the user wants to view the changes of one or more other users and if those users have designated that their changes can be shared the changes made by the one or more other users will be displayed on the document shown to the user.

In example embodiments the user also has the flexibility to decide when to share edits with other users. When editing a document the user may not want to share changes until those changes are in a state with which the user feels comfortable. In one example embodiment as discussed above the user selects an example action control to specify a user with which changes can be shared. In another example embodiment when the user wishes to share changes with other users the first user highlights the section of the document to be shared and clicks example Share button on the user interface. This notifies the document server that changes to the document section document are to be shared. In example embodiments clicking the example Share button may bring up a list of users with which the document section changes may be shared. Other implementations are possible.

In addition to example Share button the example user interface also includes an example Save button and an example Assign button . The example Save button operates as a standard save button allowing the user to save changes into client or server memory. However the save operation does not result in sharing updates with others. The example Assign button permits the owner of the document to assign access permissions to other users.

The example action controls permit the user to select one or more actions to be taken regarding the document section. In an example embodiment when the user moves a mouse over an action control for example the action control for Heidi Craig a list of available actions is presented. In this example embodiment if the user selects the example action for obtaining updates the user will obtain updates to the document section from Heidi Craig that Heidi has designated for sharing. If the user selects the example action to share updates the changes the user made to the document section will be shared with Heidi Craig. If the user selects example action the user can send an email to Heidi Craig. Moving the mouse over the example action control for user Tom Anderson provides the same set of action options for Tom Anderson.

In another embodiment the action control is a pull down list box that provides a list of choices for the user. Other embodiments for action controls are possible.

Also shown in is an example dynamic control . The example dynamic control allows the user to dynamically change access permissions to the document section and to specify conditional access permissions. In this example the dynamic control is a pull down list box. When expanded the example dynamic control displays an example list of users that have access permissions for the example document section . When one of the example users is selected the access permission for that user is shown. For example if example user Sara White is selected the dynamic control is further expanded to shown example access permission list . In example access permission list example access permission No Access is shaded indicating that Sara White currently has no access to this document section. For this example if access permission is clicked the dynamic control is further expanded to provide a means to dynamically change access permissions. A list of Until options is displayed providing the option of maintaining the current access permission until a specific action occurs. For example the user may select the Section Shared option to specify that the current No Access permission for Sara White is to be maintained until the document section is designated for sharing by the user. When the example Section Shared option is clicked the dynamic control is further expanded to provide an example list of Then options indicating access permissions that can be set once the Section Shared action occurs. In the example the Comment Only option is selected indicating that the access permission for user Sara White will dynamically change from No Access to Comment Only when the document section is designated for sharing.

Referring now to in an example embodiment changes may be displayed above the document section so the user may see them before making any additional edits as shown in the example document . In the example document the user via action control makes a request to receive updates to document section from Tom Anderson. The updates are displayed above document section . The user may observe that Tom Anderson changed the last sentence in document section and may make additional changes to the document section as a result.

Other example embodiments for the selection and display of coauthoring changes are possible. For example the coauthoring changes may be displayed adjacent to the current section below the current section or simply incorporated into the current section. In example embodiments deletions and additions may be shown by strikethroughs and underlining.

In example embodiments the user can select the one or more other users for which changes are to be displayed. The user may also globally select changes from all other users. In example embodiments the changes can be received on a per section basis or for the entire document.

The example document permissions module stores the access permissions for each section of each document for each user. In some embodiments the access permissions are stored within each document. In other embodiments the access permissions are stored separately from each document for example on a server or in a database and are linked to the document. As noted above different user access permissions can include full control read write review only comment only read only and no access. Other user access permissions are possible.

The example document permissions module also enforces access permissions without network connectivity. The document permissions module achieves this enforcement by caching the access permissions on the client. The access permissions are cached for the user and for all other users who have accessed the document. The document permissions module updates the client cache dynamically when the access permissions change. When the user goes offline the client cache is checked to determine the extent to which the user can edit sections of the document.

The example document update processing module keeps track of all changes saved to a document by users. The document update processing module also keeps track of which of these changes are designated by a user to be shared with other users. Typically a user saves changes made to a document by clicking a button on the user interface representing saving. However these saved changes are not made available to other users until a user designates the changes to be shared. In example embodiments a user can make such a designation by highlighting one or more sections of a document and clicking a button on the user interface representing sharing. In other example embodiments the user may designate that a document section is to be shared via an action control button adjacent to the document section. The user may also designate that the entire document is to be shared. The use of buttons representing saving and sharing are examples only. Other implementations are possible.

The example document update processing module also processes requests from a user to obtain changes made to the document from other users. The user requests may be made for each document section via an action control or they may be made for the entire document. The example document update processing module determines which sections of the document can be updated and provides the updated changes to the example document rendering module . The user requests are manually generated so that the user can be in control of when the document is updated. This prevents the situation where a document section is updated while a user is editing it possibly overriding changes the user made.

The example document rendering module renders the document for display to a user on a client. The document rendering module may use standard user interface controls such as text boxes list boxes and pull down list boxes to display user access permissions for each section of the document and to display the names of users accessing sections of the document. In alternate embodiments custom designed controls may be used. User interface controls may also be used to define rules for each section of the document that are used to dynamically change access permissions depending on the user operation being performed.

The example document rendering module also incorporates any shared updates from users into the document. These are updates made by users that were saved at the document server and designated to be shared with other users. The updates may include edited changes to sections of the document tracked review changes or comments. The example document rendering module typically renders text edits above the section of the document in which the edits were made so that the current user can easily see them. Comments are typically rendered adjacent to sections of the document. However in example embodiments the updates may be positioned differently.

At operation the user performs operations consistent with the access permissions for a section. For example if the user has full control for a section the user can make full edits to a section of a document including changing formatting for the section. By contrast if a the user has comment only access the user can only insert comments for a section of the document but can not edit any text in the section.

When the user has completed the operation appropriate to the access permission for a section the user may wish to share the changes made to one or more sections of the document with other users. At operation the user identifies the updates to the document that can be shared. For example the user may highlight the sections that can be shared. In another example the user can choose to share all updates.

At operation the user notifies the document server that the identified updates are available for sharing. This can be done for example by clicking a button on the user interface representing sharing. As another example the user may click a button indicating that all changes made to the document are to be shared. Other ways to designate sections to be shared and to notify the document server are possible.

As the user is editing the document the names of other users who are also editing the document are displayed for each section of the document. If the user wishes to view the edits from one or more other users the user identifies the one or more other users at operation . For example the user may highlight the name of another user or double click on the name of another user. Other implementation methods are possible.

At operation the updates from the identified other users are obtained and displayed on the document. The updates are typically displayed above the section the user is editing along with the name of the other user. Other implementations are possible.

At operation the contents of the document the user access permissions for each section of the document and the names of users coauthoring sections of the document are used to render the document for display to a user on a client. The user access permissions and the names of users coauthoring sections of the document are typically displayed using standard user interface controls such as text boxes list boxes or pull down list boxes. Other implementations are possible.

As users make changes to the document those changes are stored in the document server at operation . However the changes are not available for sharing until designated as such by a user who made the changes.

When a user determines that changes to the document are available for sharing at operation the document server receives a notification from the client that identifies the updates to be shared and to make those updates available to other users who may request them.

At operation the document server receives a request from a user for updates to the document made by one or more other users. The document is then rendered at operation to incorporate the shared changes requested.

Although the subject matter has been described in language specific to structural features and or methodological acts it is to be understood that the subject matter defined in the appended claims is not necessarily limited to the specific features or acts described above. Rather the specific features and acts described above are disclosed as example forms of implementing the claims.

