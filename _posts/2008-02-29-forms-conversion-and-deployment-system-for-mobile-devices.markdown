---

title: Forms conversion and deployment system for mobile devices
abstract: A method and system for automatically converting forms generated using a desktop forms development tool to be compatible with mobile devices, for deploying the converted forms to the mobile devices, and for running converted forms on the mobile devices is provided. A forms system provides a conversion component, a deployment component, and a device component. A forms file is generated to be processed by a forms display program on a variety of devices. The forms system transforms the forms file to a target form file designed for execution by a target forms display program on a device of the target device type.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08464211&OS=08464211&RS=08464211
owner: Formotus, Inc.
number: 08464211
owner_city: Bellevue
owner_country: US
publication_date: 20080229
---
This application claims the benefit of U.S. Provisional Patent Application No. 60 892 493 entitled FORMS CONVERSION AND DEPLOYMENT SYSTEM FOR MOBILE DEVICES filed Mar. 1 2007 which application is hereby incorporated by reference in its entirety.

Many organizations have developed extensive forms for desktop computers to support the functions of the organizations. For example medical service providers have developed and use forms to support virtually every aspect of medical services including forms to support patient registration medical record keeping insurance claim processing inventory control appointment scheduling and so on. Many products are available to facilitate the process of creating a form for a desktop computer. One popular forms development tool is InfoPath by Microsoft Corporation. An organization can use a forms development tool to generate forms that include various form controls such as radio buttons textboxes and drop down lists. The forms development tools may allow validation and allow an organization to provide business logic to be performed as a user interacts with the form. The forms development tools also allow rules and conditional formatting to guide the user in completing a form including the ability to show or hide optional form sections based on information entered. The forms development tools also allow forms to access various data sources such as a database server or a web service provider.

After a form is created forms development tools create a forms file that contains the information needed to run the form on virtually any desktop computer. For example InfoPath creates a forms file in an XSN format that contains a manifest file a view file a template file and a schema definition file. The manifest file contains a listing of all other files in the forms file and several other details including metadata information on toolbars and menus associated with each view information on external data sources and error messages. A view file is an eXtensible Stylesheet Language Transformation XSLT transform that presents an editable view of a portion of data in an eXtensible Markup Language XML format. Each view file accepts XML data as input and produces an output format similar to a HyperText Markup Language HTML format. The schema file is an XML Schema Definition XSD file that defines the XML format of the XML data that can be processed by the view file. If the XML data does not conform to the schema the view file will not process the form. The template file contains initial data for the form in XML format. A forms file may also include a script file that contains scripts specified by the form developer for performing business logic and other validation.

The workforces of organizations are increasingly using mobile devices e.g. smart phones and PDAs to collect and access the data of the organization. For example a medical service provider may carry a handheld device to collect physiological information about the patient. Unfortunately mobile devices may not have the software to directly execute forms generated for a desktop computer may not have the computation power to effectively process the forms and may not be able to effectively display such forms on their small screens. It can be very expensive however to port desktop forms to mobile devices. It is expensive to support the manpower to develop and maintain the forms for the mobile devices and the infrastructure to support the deployment of such forms to the mobile devices.

A method and system for automatically converting forms generated using a desktop forms development tool to be compatible with mobile devices for deploying the converted forms to the mobile devices and for running converted forms on the mobile devices is provided. In one embodiment a forms system provides an administrative component a conversion component a deployment component and a device component as described below. The administrative component the conversion component and the deployment component execute on a mobile forms server and the device component executes on a mobile device. In the following the forms system is described with reference to the forms definition files forms files generated by Infopath. One skilled in the art however will appreciate that the forms system can be adapted to the forms files of other desktop form development tools. A forms developer defines the data e.g. schema to be used by a form defines one or more views for display of the data defines rules and data validation and defines where the data of the form is to be submitted for storage. Some views of the form are adapted for the screen characteristics of the mobile devices and other views may be adapted for the screen characteristics of desktop devices. The forms file is generated by the desktop form development tool to be processed by a forms display program on a variety of devices. The forms system transforms the forms file to a target form definition file designed for execution by a target forms display program on a device of the target device type.

The mobile forms server deploys the converted forms to mobile devices so that the forms can be used to collect data from users of the mobile devices. The data collected by the mobile devices however are not set to the mobile forms server. Rather the forms developer designates where the collected data is to be submitted for storage. For example the forms developer may designate that the data is to be sent via an electronic mail message to a designated address sent to a server using a web services interface or sent via a short message services SMS . Since the submitted data is sent as designated by the forms developer the forms system does not serve as a bottleneck for receiving storing and or routing the submitted data.

In some embodiments the administrative component of the forms system allows forms generated using a desktop forms development tool to be uploaded to the mobile forms server for conversion and deployment. The administrative component may upload forms from a desktop computer or from a desktop form server such as Microsoft s Sharepoint system. For example a forms developer can design a form using InfoPath and store the form on a Sharepoint server. The administrative component can then upload the form from the Sharepoint server to the mobile forms server and convert it for use by a mobile device. After a form is uploaded the administrative component may periodically and automatically check the desktop forms server to determine whether a new version of a form is available. If so the administrative component uploads the new version for conversion and deployment. As discussed below the device component of a mobile device may itself periodically check the mobile forms server to determine whether a new version of form that has been installed at the mobile device is available. If so the device component provides the user with the option of downloading the new version.

In some embodiment a form that is uploaded from a desktop forms server may be configured to submit data entered by a user of a mobile device to the desktop forms server for storage. Once data from a mobile device is stored on the desktop forms server a user at the desktop forms server can use the form that was converted and deployed to the mobile device to display the stored data. Thus the forms system allows for a seamless integration between the desktop forms server the mobile forms server and the mobile devices with the device component. One skilled in the art will appreciate that the desktop forms server and the mobile forms server may be implemented on the same computer system or different computer systems.

The conversion component of the forms system transforms the files of the forms file so that the form can be processed by a mobile device. Typical mobile devices provide web browser components that support only a subset of the functionality supported by web browser components of desktop computers. For example Pocket Internet Explorer does not support all the functionality of Internet Explorer for desktop computers. The conversion component inputs a forms file generated by a desktop forms development tool and transforms the view file of the forms file so that it uses only the functionality supported by the web browser component of a mobile device. In addition a forms file may contain multiple view files that are each tailored to a particular type of device. For example a smart phone may have a very small screen while a custom developed handheld device may have a significantly larger screen. In such a case the forms file may contain two view files one for the smart phone and one for the custom developed handheld device. The conversion may also preprocess certain features of a form to reduce the computation needed when the form is processed by the device. For example the conversion system may add menu items and items of a drop down list directly to the converted view file to avoid the overhead of locating and retrieving such items by the device. The conversion system may transform the view file so that whenever a field is changed the controls affected by the change are incrementally updated. The conversion system also creates an information file that collects into a single place information such as mapping of controls to fields and data source connection information. The conversion system then generates a forms package for each view file. A forms package contains the transformed view file the information file and the schema file in a format that is suitable for distribution to the type of device for which the view file was generated.

The conversion component may allow a forms developer to add features not made available by the desktop forms development tool to the form for a mobile device. For example many mobile devices have global positioning system GPS capabilities through which GPS coordinates of the mobile device can be obtained via an application programming interface. However a typical desktop forms development tool provides no support for GPS coordinates. The conversion component may provide custom controls that can replace placeholder controls specified by a forms developer. The custom controls provide the functionality to access features of a mobile device. For example a forms developer may add a placeholder GPS control to a form. When the conversion component process that GPS control it replaces the functionality of the control with functionality to retrieve the GPS coordinates and display the coordinates as specified by the control. The forms system may also allow a forms developer to define their own custom controls to override the corresponding placeholder controls. In this way the forms system allows forms developers to take advantage of features of a mobile device that are not supported by the desktop forms development tool.

The conversion component may provide support allowing a form to input data via electronic ink strokes. For example a forms developer may want add a signature field to a form so that the user can enter their signature. Although some desktop forms development tools provide controls for capturing and storing electronic ink strokes as part of a form the tools typically store the ink strokes in a proprietary format. Because the format is proprietary most mobile devices do not support the storing of ink strokes in that format. The conversion system provides a custom ink control that provides the functionality to collect and store electronic ink in a format that is compatible with the desktop forms development tools and desktop forms servers e.g. a Sharepoint server . In some embodiments the ink control collects the electronic ink as strokes provided by an application programming interface of the mobile device. The ink control then converts the ink strokes to an image file e.g. JPEG and stores the image file as part of the data of the form. When the data of the form is re displayed the image file is displayed to show the electronic ink. When the user submits the form to a desktop forms server the desktop form can also display the image file to show the electronic ink. Thus by using an image file to store electronic ink the forms system allows for collection and display of ink strokes in a way that is compatible with both the desktop and mobile forms without having to use a proprietary form.

In some embodiment the forms system may also allow a forms developer to designate a default view for a form. Some desktop forms development tools allows the forms developer to designate a default view for the form. The default view is the view that is initially displayed when the form is displayed. The forms developer may designate as a default view a view that is appropriate for display on a desktop. For example if the form is uploaded to a desktop forms server the forms developer would want the user to see a view that is appropriate for a desktop. Such a view however may not an appropriate initial view for a mobile device. To overcome this problem the forms system allows the forms developer to name a view with a distinguished name that the forms system recognizes. For example the distinguished name of a view may mobile default. The forms system ensures that the view with such a distinguished name will be the default view on the mobile device. In this way the forms system allows a different default view on a desktop device and a mobile device without having to modify the desktop forms development tool or the desktop forms server. Alternatively the conversion component may give a user the option of selecting a default view at conversion time rather than or in addition to allowing a forms developer to specify the default view at design time.

The deployment component of the forms system controls the distribution of forms packages to the devices. The deployment component maintains a collection of forms packages along with their associated device types. For example the deployment component may have one forms package for a form for a smart phone and another forms package for that same form for a PDA. The deployment component may also have one forms package for another form for a smart phone and another forms package for that other form for a PDA. When the deployment system receives a request for a form update from a user s device the deployment system identifies the device type e.g. by checking the user to device mapping or directly from the device identifies the forms that the user has permission to access e.g. by checking the user to forms mapping and retrieves the forms package for each accessible form for which the user s device does not have an up to date version. The deployment system then transmits the retrieved forms to the device. The deployment system may also allow a user to register to receive forms. As part of the registration process the deployment system may provide the device of the user with a package installation component that allows the device to request receive and install forms on the device. The package installation component may also include the device component which processes the forms at the device. The device component includes a manager component that is responsible for downloading the forms packages.

The device component of the forms system controls the display of the forms on the device and the accessing of the data sources described by a forms package. In one embodiment the device component includes a runtime component that interacts with a web browser component e.g. HTML control to display the form of a forms package. When a user selects to display a form that has been installed on a device the runtime component is launched. The runtime component then launches a web browser component to process the form of the transformed view file of the forms package. The runtime component registers to receive various events from the web browser component. For example each form may include a save or submit button. When a user selects the submit button the web browser component notifies the runtime component that the submit button was selected. In such a case the runtime component may save the data of the form to a data source defined by the forms package. The runtime component may also persistently store the data of a form locally. Because the data is stored locally a user can access the data of a form even when a connection cannot be established with a data source. When a connection with the data source is eventually established the runtime component can then save the data to the data source. Once the save to the data source is confirmed the device component may automatically delete the data from the mobile device. Each forms package may include a launch component that is executed when a form is selected. The launch component is responsible for launching the runtime component to process the selected form. The user may select a form by selecting an icon representing the form that may be included in the forms package for the form. If the runtime component is already running the launch component may direct the runtime component to start processing the new forms package. In such a case the runtime component stores the data for the previous form locally so that it can be available when the user returns to the previous form. The runtime component may also track various information on the use of the forms packages and report that information to the mobile forms server system or a reporting system. The collected information may include statistics on usage of forms error logs and so on.

In some embodiments the device component may maintain a list of data that has been submitted by the user but that has not been successfully sent to the data source designated by the form through which the data was collected. When a user submits data it may not be possible for the device to send the data to the data source immediately for various reasons. One reason may be that the mobile device is in an area where connectivity is unreliable. Another reason may be that the data source may currently not be available. Yet another reason may be that the user has entered the wrong authentication information for the data source e.g. an expired password . The device component stores each submission in submission list where it waits until it can be successfully sent to its data source. The device component periodically processes each entry in the list to see if the data can be sent. If the data for an entry can be sent the device component removes the entry from the list.

The device component may allow a user to store the data of a form locally at the mobile device until the user is ready to submit the data for a data source. For example a user may have most but not all of the information needed to complete a form. In such a case the user may want add the currently available data to the form and store that data at the mobile device so that the remaining data can be added at a later time. Since a user may want to store multiple instances of the data of a form the user needs some way to distinguish one instance from another. Although the device component could prompt the user to enter an instance name for each instance of the data of a form the user of mobile devices often find it difficult to entry alphanumeric characters. Some desktop forms servers allow a forms designer to specify a rule for automatically generating unique names for instances of data. For example one rule may specify to concatenate the content of a last name field a first name field and a middle initial field of a form to give a unique instance name and another rule may specify to concatenate the content of a customer identifier field and a service representative field of a form to give the unique instance name. The desktop forms server can store the instance data in a file with the automatically generated instance name. When a form has such a rule the device component may use that rule to generate instance names to store instances of data on the mobile device. If a certain form however has no such rule the device component may automatically generate an instance name based on the concatenation of an identifier of the form e.g. form name and a sequence identifier e.g. time stamp or sequentially generated number . The device component may display a list of the instance names for the instances of data of a form so that a user can identify the instance to be displayed by the form. Thus the device component uses a rule associated with the form if available to generate an instance name otherwise it generates an instance name from an identifier of the form and a sequence identifier.

The device component may allow a user to access data that has already been stored on a data source and deleted from the mobile device. The device component may retrieve from the data source a list of the instances of the data stored on the data source and display that list to the user. Once the user selects an instance the device component downloads the data from the data source and allows the user to view and possibly modify the data using the form. When the user later submits the data then the device component sends the modified data to the data source as described above to overwrite the previously submitted instance of the form data at the data source. In some embodiments the forms system may automatically add during conversion of a form the functionality to download a list of instances of data of the form and the data itself from a data source. This functionality may be added as menu items to a standard menu that is automatically provided by the forms system when a form is displayed. During conversion the conversion component may detect that a form has the functionality to submit data for a desktop forms server with an overwrite option and the functionality to send a query to the same desktop forms server. If so the conversion component can add a menu item to the form to view a list of instances of data stored on the desktop forms server. The conversion component can simply add another menu item e.g. See List to the menu. When the user selects the menu item the device component uses the query connector to submit a request to the desktop forms server. Upon receiving the list the device component displays the list to the user so that the user can select one more instances of the data to download. Once the instances are downloaded the user can select which instance to view and possibly modify using the form.

In one embodiment the conversion component initially expands the forms file into the manifest file schema files views files and template files. The conversion component then creates the information file by extracting and converting data from the expanded files. The conversion component extracts menu items mappings of controls to underlying data fields submit and query information schema information web services information views rules custom validation and so on. The extraction of this data at conversion time rather than runtime reduces the computational power needed by the device. Transformations of the conversion component are implemented using XSLT transforms that operate successively to transform a view file to a transformed view file and to generate the information file. The XSLT transforms perform various specific transformations on the body elements textboxes checkboxes radio buttons hyperlinks and buttons and performs general transformations on all controls. To the body elements the conversion component adds an element to reference the script file adds a language attribute for the script file adds a form element with a form identifier adds hidden fields under the forms element to store state information at runtime and adds onload and onunload attributes. The conversion component then generates a forms package that may contain the original files of the forms file along with the transformed view file and the created information file. The conversion component may also add a launch executable component to the forms package to launch the form when an icon representing the form is selected by a user of the device. The conversion component then stores the forms package in a forms package store along with an indication of the type of device that each forms package supports.

The following tables illustrate example transformations performed by the conversion system to generate the transformed view file and the information file. The following table illustrates an example script element that references the script file that is added to a body element.

The following table illustrates a form element with a form identifier that is added to a body element.

The following table illustrates an example hidden field used by the runtime component in processing errors that is added to a body element.

The conversion component transforms textboxes by transforming span elements to input elements and when text wrapping is used as a style attribute converting span elements to textarea elements. Also if any maxlength value is given the conversion component adds a maxlength attribute. The conversion component also adds a rows attribute to textarea elements. The following table illustrates the transformation of a span element to a textarea element.

The conversion component transforms a checkbox by adding on Value and offValue attributes. The following table illustrates the transformation of a checkbox element.

The conversion component transforms a radio button by adding a value and an onClick attribute. The following table illustrates the transformation of a radio button.

The conversion component converts a hyperlink by adding an href attribute if it does not exist. The following table illustrates the transformation of a hyperlink.

The conversion component transforms a button by adding an onClick attribute. The following table illustrates transformation of a button.

The conversion component transforms controls by adding name and id attributes adding a disable attribute when a disableEditing attribute is yes converting an xsl when element to an xsl if element adding onchange attributes depending on validation rules adding an xsl if element inside the control for highlighting the control e.g. displaying a red border on occurrence of an error and adding an onFocus attribute. The following table illustrates the transformation of a control by adding a name and an id attribute.

The following table illustrates the transformation of a control for highlighting the control upon occurrence of an error.

The conversion component also extracts data from the various files of the forms file and stores them in the information file in a format that allows the device component to retrieve more efficiently at runtime. The conversion component converts web services related information from the manifest file. The following table illustrates the extraction and transformation of a default query for a web service.

The following table illustrates the extraction and transformation of a query for a secondary data source.

The following table illustrates the extraction and transformation of a default submission for a web service.

When a registered user is authorized to use an account an electronic mail message is sent to the user with instructions on downloading the device component of the forms system onto their mobile device and the forms of the account. The administrative system tracks the device identifier that the user uses to access the mobile forms server. Thus the mobile forms server has a mapping for each account of the users who are using the account e.g. identified by their electronic mail address and their device identifier. In some embodiment the forms system may charge an account on a per user device combination. For example if a user uses an account using two different devices then the account would be charged for two uses. Similarly if two different users with different user identifiers e.g. electronic mail addresses use the account with the same device then the account would also be charged for two uses. If however two different people used the same user identifier to access the account with the same device then the account would be charged for only one use. One skilled in the art will appreciate that other billing models may be used. For example the forms system may charge an account on a per device or per user basis on a fixed fee and so on.

The conversion component includes a transform component a create information file component a create forms package component and a forms package store . The transform component controls the transforming of the received forms files and creating of the forms packages. The create information file component is invoked by the transform component to create the information file for a forms package. The create form package component is invoked by the transform component to package the files of the forms packages. The transform component also stores the form packages in the forms package store. The forms packages are then available to be distributed to user devices by the deployment component.

The deployment component includes a send device component component a send forms component a maintain mapping component a user to device mapping and a user to forms mapping . The send device component component sends device component to mobile devices for installation. Once a user is registered with the deployment system the user can download to their device forms packages that the user has permission to access. The send forms component receives a request from a device for a form identifies the forms to send to the device and downloads the forms to the device. The forms system may also maintain various auxiliary data structures such as those to track activity of registered users check date of last update of a forms file check date of last download by a user and so on. The forms system may also receive and store information describing activity of users at their mobile devices such as forms usage frequency of data submissions and so on.

The device includes various device components such as a package installation component a runtime component a web browser component a launch executable component a forms package store and a forms data store . The package installation component is provided to the device when the device registers with the deployment system. The package installation component is responsible for downloading forms packages and installing the forms on the device. The runtime component provides the overall control of the device component. The runtime component is passed an indication of an installed form and displays the form in accordance with the forms package by invoking the web browser component. The runtime component receives event notifications from the web browser component such as submit and query requests and controls the submission and querying based on information of the information file. The device component includes a launch executable component for each installed forms package. When an icon associated with a form is selected by a user the launch executable component for that form directs the runtime component to display the form. The forms package store contains the form packages that have been downloaded to the device. The forms data store contains the data of the forms that have not yet been submitted for storage. The device component sends forms data to and retrieves data from the desktop forms server or other data source . The data sources may include web services electronic mail message servers SMS servers and so on. The device component may also request services of various service providers .

In some embodiments the device component may include an uninstall component. When a user selects to uninstall the device component e.g. by selecting to uninstall the runtime component the device component automatically uninstalls all components of the device component all forms and all forms data. The uninstall component may display the name of each component form and instance data that is being deleted. In this way the uninstall component ensures that mobile device will have all resources of the device component removed.

The computing device on which the forms system is implemented may include a central processing unit memory input devices e.g. keyboard and pointing devices output devices e.g. display devices and storage devices e.g. disk drives . The memory and storage devices are computer readable media that may be encoded with computer executable instructions that implement the forms system which means a computer readable medium that contains the instructions. In addition the instructions data structures and message structures may be transmitted via a data transmission medium such as a signal on a communication link. Various communication links may be used such as the Internet a local area network a wide area network a point to point dial up connection a cell phone network and so on.

Embodiments of the forms system may be implemented in various operating environments that include personal computers server computers hand held or laptop devices multiprocessor systems microprocessor based systems programmable consumer electronics digital cameras network PCs minicomputers mainframe computers cell phones personal digital assistants smart phones personal computers programmable consumer electronics distributed computing environments that include any of the above systems or devices and so on.

The forms system may be described in the general context of computer executable instructions such as program modules executed by one or more computers or other devices. Generally program modules include routines programs objects components data structures and so on that perform particular tasks or implement particular abstract data types. Typically the functionality of the program modules may be combined or distributed as desired in various embodiments. For example the conversion component and the deployment component may be implemented on the same or separate servers.

Although the subject matter has been described in language specific to structural features and or methodological acts it is to be understood that the subject matter defined in the appended claims is not necessarily limited to the specific features or acts described above. Rather the specific features and acts described above are disclosed as example forms of implementing the claims. Accordingly the invention is not limited except as by the appended claims.

