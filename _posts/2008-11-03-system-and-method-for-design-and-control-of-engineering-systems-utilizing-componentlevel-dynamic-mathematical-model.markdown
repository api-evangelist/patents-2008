---

title: System and method for design and control of engineering systems utilizing component-level dynamic mathematical model
abstract: A control system comprises a controller for positioning an actuator in a working fluid flow and a model processor for directing the controller as a function of a model feedback. The model processor comprises an output module, a comparator and an estimator. The output module generates the model feedback as a function of a constraint, a model state and a model input describing fluid parameters measured along the working fluid flow. The comparator generates an error by comparing the model feedback to the model input. The estimator generates the constraint and the model state, such that the error is minimized.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08090456&OS=08090456&RS=08090456
owner: United Technologies Corporation
number: 08090456
owner_city: Hartford
owner_country: US
publication_date: 20081103
---
Subject matter disclosed in this application was produced with U.S. Government support under Contract No. N00019 02 C 3003 awarded by U.S. Navy. The U.S. Government may have certain rights in this invention.

The subject matter of this application relates generally to the design and control of engineering systems. Across a broad range of industries modern engineering systems are characterized by marked increases in complexity and simultaneous decreases in component tolerances. As a result engineering control systems are subject to greater operational demands which require more sophisticated and detailed modeling techniques.

Fluid based engineering systems provide a range of relevant examples. These include gas turbine engines for aviation and power generation HVAC R heating ventilation air conditioning and refrigeration fuel cells and other more generalized fluid processing systems for hydrocarbon extraction materials processing and manufacture. These systems contain any or all of the following components turbo machinery fuel cell stacks electric motors pipes ducts valves mixers nozzles heat exchangers gears chemical apparatuses and other devices for generating or modifying a fluid flow.

Each of these applications places different operational demands on the engineering control system. In gas turbine engine applications for example the relevant cycle is typically a Brayton turbine or first Ericsson cycle and the basic thermodynamic parameters or process variables are the pressure temperature and flow rate of the working fluid at the inlet compressor combustor turbine and exhaust. The parameters are related to the overall thrust rotational energy or other measure of power output. In order to precisely control this output while maintaining safe reliable and efficient engine operation the engineering control system must be fast accurate and robust and provide real time control capability across all required performance levels. While the relevant process variables vary depending on the system type and configuration the need for precise efficient and reliable engineering control remains the same as do the economic constraints on overall cost and operational maintenance requirements.

This disclosure concerns a system and a method for design and control of an apparatus. The system utilizes a control law to control actuators that position control elements of the apparatus as a function of a model output vector generated by a component level physics based mathematical model of the apparatus. The system also includes diagnostics and fault detection accommodation software modules.

The model comprises mathematical descriptions of interconnected components and constraints that combine to produce the output vector and a physics state derivative as a function of a constraint input and an external input vector. The constraint output is related to internal system and the external input vector is related to effector actuator states and boundary conditions of the apparatus. A comparator checks a subset of the output vector against a truth vector represented by measured or high fidelity modeled data in order to generate an error vector. The discrete model state estimator synthesizes estimates next time step values of the state vector including both constraint and physics subsets such that the error vector is minimized.

In the case of a gas turbine or other flow processing apparatus the method provides means for controlling physics states including rotational states for given working fluid flow conditions at an inlet and an outlet. The method also provides means for adjusting the position of control elements along the working fluid flow using actuation mechanisms and a digital control system built around the dynamic component level mathematical model.

In general system includes at least some of the following software S W modules system parameter on board synthesis SPOS module control law CLW on board diagnostics OBD module sensor fault detection and accommodation SFDA module output conditioning module OCM and input conditioning module ICM . These modules are incorporated in a black box type processor assembly mounted proximate apparatus or in a number of individual processors. SPOS is build around a component level mathematical model of apparatus also referred to as closed loop model CLM such that CLM is a subset of SPOS . System also incorporates at least some of the following hardware H W elements digital to analog D A converter analog to digital A D converter actuator s system sensor s actuator sensor s .

As shown in CLW obtains control feedbacks from CLM SPOS and control commands the desired values of outputs from apparatus from operator interface UF . CLW generates control requests in engineering units which are transformed into actuator requests compatible with D A converter by OCM . D A converter generates electrical signals that operate on actuators . Actuators use control hardware to position various control elements of apparatus in accordance with the control request resulting in quick and accurate control of apparatus .

System sensors measure operational parameters associated with apparatus . For example fluid based systems often include system sensors that measure the working fluid pressure temperature and flow at various axial and radial locations in the flow path. Actuator sensors measure the state of actuators where the actuator states or positions are related to the physical configuration of the various control elements in apparatus . For example fluid based systems often include actuators whose linear or angular positions are sensed by actuator sensors and which are related to the physical position of control surfaces or other control devices located proximate a compressor combustor turbine or nozzle exhaust assembly.

Sensor hardware modules and send electrical signals to A D converter which converts the electrical signals into a digital format compatible with the software and hardware architecture of control system . ICM filters the raw signals and transforms them into engineering units compatible with the control system software architecture. In some embodiments CLM also communicates with CLW via one or more SFDA module and OBD module .

Apparatus comprises an engineering system such as a gas turbine engine an environmental control system or a fluid processing system. In various embodiments the physical components of apparatus include but are not limited to compressors combustors turbines shafts spools fans blowers heat exchangers burners fuel cells electric motors and generators reactor vessels storage vessels fluid separators pipes ducts valves mixers and other fluid processing or flow control devices.

CLM comprises elements designed to provide a component level dynamic mathematical model of apparatus utilizing a mixture of physics based and data derived descriptions of the individual physical components of apparatus . CLM also models relationships among these components including operational constraints based on physics and engineering considerations. That is CLM models not only the engineering components of apparatus but also the physical laws that govern their behavior.

Operator I F comprises a real time interface such as a cockpit navigation system or operator workstation. Alternatively operator I F comprises another more generalized process control interface which is suitable for logging control commands to CLW .

CLW converts the control demands to control requests for actuators which satisfy the control requests by changing the operational configuration of apparatus . Some actuators for example change the configuration of a fuel flow controller a variable vane surface or another control surface positioned along a fluid flow inside apparatus . Other actuators change the state position or configuration of additional devices for controlling the operation of apparatus including but not limited to fuel pumps variable compressor or turbine vanes variable area nozzle inlet or bypass duct elements and variable area orifice elements.

System sensors comprise a variety of different sensing devices including but not limited to temperature sensors pressure sensors flow sensors vibration sensors debris sensors current sensors voltage sensors level sensors altitude sensors and blade tip sensors. System sensors are positioned to measure operational parameters related to the function of apparatus in particular as related to control commands submitted to CLW and control requests generated by CLW in order to direct actuators to control apparatus .

In some embodiments CLM communicates with CLW both directly and via one or more of OBD module and SFDA module . Modules and monitor the state of system hardware including actuators sensor modules and and apparatus . For example the health of apparatus and system sensors is assessed based on a comparison of sensor values with the predictions of CLM . The health of actuators and actuator sensors is assessed based on the difference between requested and sensed actuator positions.

Under some conditions OBD module and SFDA module allow CLW to compensate for operationally dependent changes in actuator response including changes due to variations in temperature pressure and power input or output. Modules and also utilize system parameters synthesized by CLM to correct or recalibrate aberrant sensor signals in order to provide more accurate and stable input to CLW . Alternatively modules and replace failed sensor signals with synthesized values from CLM or allow CLW to deploy one actuator or set of actuators in order to compensate for another actuator or set of actuators that has failed. In these embodiments SFDA module typically generates a real time alarm signal or other fault indicator such as a fuel status warning a damage report a temperature alarm or a maintenance request.

Typically apparatus performs a thermodynamic cycle on a working fluid in order to generate rotational energy electrical power or reactive thrust to provide heating ventilation air conditioning and refrigeration or to perform other fluid processing functions. The range of available cycles includes but is not limited to the following cycles and their derivatives Otto cycles Diesel cycles Brayton turbine or first Ericsson cycles Brayton jet Barber Joule cycles Bell Coleman reverse Brayton cycles Ericsson second Ericsson cycles Lenoir pulse jet cycles and Carnot Stoddard and Stirling cycles.

Alternatively apparatus performs a number of individual thermodynamic processes for heating cooling flow control or for processing applications in agriculture transportation food and beverage production pharmaceutical production or manufacturing or for the extraction transportation or processing of a hydrocarbon fuel. The range of available thermodynamic processes includes but is not limited to adiabatic isothermal isobaric isentropic and isometric isochoric or isovolumetric transformations exothermic reactions endothermic reactions and phase changes.

In operation of system CLW receives a control command from real time operator I F and a control feedback or model output from CLM . The control command is related to the operation of apparatus and the feedback is related to the control command. In one embodiment for example apparatus comprises a gas turbine engine and the command comprises an operator generated demand for increased engine power or thrust output. Alternatively the request is automatically generated by system or by another control system in response to changing ambient conditions or operational demands.

Control signals are transmitted in either digital or analog form depending upon the characteristics of control system . For example CLW typically generates a digital control request in engineering units. OCM converts the digital request into units compatible with D A converter which in turn generates an electrical signal such as voltage or current for actuator . Typical examples include analog voltage signals for a fuel pump analog current signals for a valve controller and pulsed digital signals for a stepper motor or other mechanical actuator. The actuator is attached to a variable position control device located within apparatus such as a variable position blocker door for a bypass duct a variable position vane or a variable geometry exhaust nozzle. Compound signals are sometimes utilized for more complex actuator systems such as fuel oxidant and cooling fluid flows through a thrust augmentor afterburner assembly counter rotating fan thrust and attitude control signals for STOVL short takeoff or vertical landing operations or flow management through a regenerator heat exchanger reaction vessel catalytic converter or other component of a fluid processing system.

Actuators address the control request by manipulating or adjusting one or more control devices or control elements within apparatus . Apparatus responds to the action of actuators such that the control command provided to CLW is satisfied. For the case of a gas turbine these manipulations take a variety of forms including changes in the fuel flow or other fluid flow rate changes in vane bypass duct or nozzle configurations and other changes in the configuration of apparatus . The typical responses of apparatus include an increase or decrease in total thrust or power output changes in a cooling flow or fluid processing rate and on off switching of supplementary systems such as counter rotating fans regenerators and heat exchangers.

System sensors sense parameters related to the operation of apparatus . In particular these parameters are related to the control requests raised by CLW and the response of actuators . Typical sensor parameters include but are not limited to positions velocities acceleration currents and voltages rotational speeds of spools or shafts fuel flow rates working fluid flow rates power input power output and pressures and temperatures proximate various components of apparatus such as inlets outlets compressors combustors turbines exhaust systems reaction or storage vessels and flow conduits. Additional sensors such as altimeters air speed indicators or accelerometers are sometimes utilized to determine higher order operational parameters such as thrust climb or Mach number. In some embodiments these higher order parameters are directly measured by a particular sensor or sensor group. In other embodiments including virtual sensor embodiments higher order parameters are calculated as a function of lower order directly measured parameters.

The conditions of actuators and apparatus are represented by sensors and in software form and made available to any of CLM CLW OBD and SFDA via ICM providing an accurate assessment of the control influences acting on apparatus . In the case of an increased thrust request for a gas turbine engine for example CLM directs CLW to control actuators in order to increase the fuel flow rate and to change the position of various vane and nozzle components along the working fluid flow path through apparatus . Apparatus responds with faster spool rotation higher flow and increased exhaust temperature and pressure which is sensed by system sensors and reflected by synthesized system parameters generated by CLM .

In operation of system CLW receives control demands from operator I F and converts them into control requests for OCM as described above. CLM directs CLW to dynamically adjust the control requests as a function of feedback or model output that represents the real time operational condition of apparatus . The feedback signals include operational parameters related to specific control commands such as commands related to shaft speeds and fuel flow rates. This allows system to satisfy each control demand and control request quickly and accurately without overshooting or oscillating about the target value. In some embodiments CLM also generates diagnostic and fault outputs for OBD and SFDA .

System and CLM provide fast accurate and robust response to real time control commands. In particular CLM utilizes nonlinear functions to provide faster convergence and lower response time than other highly iterative techniques or that rely on linear piecewise linear and lightly non linear estimates rather than fully non linear state variable functions. This allows system to provide greater operating efficiency particularly when apparatus is subject to highly variable loads and unstable operational configurations.

In general CLM is comprised within a black box processor mounted proximate apparatus as described above. CLM communicates with CLW system sensors actuator sensors and the other elements of system as shown in and estimates model states non iteratively with execution speed sufficient to provide stable and responsive control of apparatus .

In gas turbine engine embodiments system is applicable to a range of FADEC full authority digital engine control or fly by wire aviation applications including STOVL operations for high performance military aircraft. In these embodiments apparatus typically comprises a low bypass turbofan engine having a core flow length on the order of a few meters. In further embodiments the turbofan is configured for afterburning operations and operates under conditions of choked inlet flow and substantially transonic or sonic core flow.

Closed loop model receives external inputs from sensor modules and via the A D converter and ICM . Inputs comprise effecter vector U truth vector Yand boundary conditions U which are combined to form external input vector U.

Effector vector Udescribes the configurations positions and states of various control elements in apparatus . In a gas turbine engine for example individual elements of effector vector Udescribe fuel flow rates nozzle areas variable vane angles flow path orifice areas and other control element parameters.

In real time execution of control system truth vector Ydescribes the actual sensed values of parameters related to the operation of apparatus . The elements of truth vector Yare based on measurements by sensors and or alternatively a well understood and trusted model of sensed parameters such as a flow rate model based on a differential pressure drop across a Pitot tube or Venturi tube. For gas turbine engines typical truth vector elements describe spool speeds and gas path temperatures or pressures proximate engine components such as compressors combustors and turbines. In the context of non real time applications including calibration truth vector Ycorresponds to high fidelity data which can either be physical tested or is model based.

The elements of boundary vector Udescribe boundary conditions related to the operation of apparatus . Some boundary conditions are directly measured by system sensors such as fluid temperatures pressures and flow rates at physical boundaries of apparatus . In fluid based applications the boundary conditions include boundary flow conditions at inlet and outlet locations. Other boundary conditions specific to aircraft applications include but are not limited to flight velocity altitude and bleed or power extractions parameters.

In addition to external inputs OLM also operates on states of CLM . These states include two major subsets which are referred to as constraint input states U and physics states X . Constraint input states U comprise corrector subset Uand solver subset U. Constraint corrector states Uare used to correct subset Yof outputs Y and constraint solver states Uare used to minimize solver errors E. Physics states X comprise a subset of dynamic states of apparatus whose elements are determined based on their impact on the dynamic fidelity of CLM . Physics states X typically exhibit relatively slow dynamics with respect to the execution speed of CLM which is limited by the digital control system hardware that is the capability of the black box processor or other computing platform .

Compared to physics states X constraint input states Uare generally characterized by a faster time scale for example the time scale associated with inter component fluid volumes in a gas turbine engine or other fluid processing system. In particular the latency time for elements of constraint input states Uis by definition less than the execution speed of CLM outside the dynamic range of physics states X and does not affect the fidelity of model outputs from CLM that impact the quality of control system .

Constraint corrector states Uform a vector of adjustable model parameters utilized to correct a subset of model outputs Yfrom COM such that they match corresponding elements of truth vector Y. The model parameters include both physics and engineering considerations and empirical relationships based on actual operating conditions. Corrector outputs Yand truth vector Yare compared within a particular tolerance defined by comparator CMP which outputs the difference by generating error corrector vector E. Corrector errors Eare combined with solver errors Eto produce error vector E. Essentially CLM seeks constraint vector Uthat drives both subsets of error vector E to zero.

Constraint solver states Uimpose both system and component constraints on CLM . In contrast to physics states X these constraints often but not always are based on physical laws of flow continuity thermodynamics and other engineering limitations. This also contrasts with constraint corrector states U which are model adjustable parameters meant to compensate for incorrectly modeled and or omitted physics phenomena and not always based on physics and engineering principles.

In the case of gas turbine based systems the elements of physics state vector Xdescribe important states such as spool speeds which directly affect the transient fidelity of the CLM through their direct impact on outputs corresponding to control commands such as thrust commands. There is also a subset of physics states Xthat is not directly sensed but nevertheless is modeled in CLM such as metal temperatures along a hot gas flowpath. The relatively long response time for physics model states Xcontrasts with the relatively short latency time of constraint corrector states Uand corrector outputs Y which correspond to faster dynamical variables including flowpath temperatures and pressures.

Additional outputs Y do not necessarily correspond to parameters that are directly measured or controlled for example gas path parameters in locations where it would be difficult expensive or dangerous to place physical sensor devices. Further outputs Y are generalized outputs which do not necessarily correspond to any particular physical quantity at all. Some generalized outputs are nonetheless empirically useful as inputs to CLW because they allow system to more quickly and accurately satisfy particular control commands.

CMP compares Yto the corresponding elements of truth vector Y generating corrector errors E. Corrector errors Eare combined with solver errors Eto generate error vector E which is minimized via MSE . Model parameters from OLM are adjusted by corrector vector Uin order to minimize the difference between corrector outputs Yand truth vector Y reducing errors between the output of CLM and the actual condition of apparatus as sensed by system sensors and actuator sensors .

CLM operates in both an on board or online mode for real time control of apparatus and an off board or offline mode. Off board applications include system plant representation in control hardware testing environments transient and steady state simulations to support design activities for system and apparatus and off board hardware diagnostics to support field maintenance activities. Consequently the particular pairing of constraint corrector states Uand corrector outputs Ydepends upon whether system is operating in on board or off board mode. In particular on board and off board sensor configurations often vary. Corrector subset Yof model output vector Y varies accordingly in order to compare with the appropriate suite of sensors corresponding to truth vector Y.

As defined above MSE synthesizes physics state vector Xand constraint input state vector Ufrom error vector E and physics state vector derivative dot over X . Specifically MSE advances vectors Xand Uby the CLM cycle time producing time advanced physics state vector Xand time advanced constraint input state vector U. The time advanced vectors are fed back into OLM completing the closed loop structure of CLM .

Vectors Xand Uprovide complementary utility. Constraint input state vector Uallows CLM to explicitly predict the elements of state vector Xin a feed through non iterative fashion and to converge on time advanced physics state vector Xwithin a reasonable processing time. This provides a high fidelity model that accurately represents engineering system apparatus so that control system operates in a reliable efficient and effective manner.

In general MSE seeks time advanced vectors Xand Uthat minimize error vector E that is drive the error toward zero . Typically MSE also minimizes physics state vector derivative dot over X . Thus MSE generates outputs that minimize its inputs such that CLM more accurately describes the physical condition of apparatus and such that CLW more quickly accurately and reliably satisfies the control commands raised by operator I F .

OLM performs a non iterative single pass or feed through analysis in order to generate Y dot over X and Eon a short time scale appropriate for a range of highly responsive dynamical embodiments of apparatus . In general vectors dot over X E and Y are functions of vectors X Uand U that is 2 3 and 3 where vector Y is the output or feedback from CLM . Feedback vector Y is used by CLW to direct actuators to position various control elements of apparatus in order to achieve desired behavior. In a fluid based system such as gas turbine engine for example the desired result is safe and efficient steady state and transient operation which satisfies operational requirements for aircraft propulsion or power generation.

While vectors U U X E and Y perform different functions within CLM in some cases the individual vector elements are related. In particular for some elements of output vector Y transformation function takes on a relatively simple one to one form such that output vector Y comprises one or more elements of physics state vector X. Alternatively output vector Y is a function of one or more elements of external input vector U. This allows CLM to perform additional fidelity checks based on truth vector Y as described above and below.

MSE generates time advanced physics state vector Xand time advanced constraint input state vector Uin order to minimize error vector E physics state vector derivative dot over X or both. In particular vector Xis directed toward minimization of state vector derivative dot over X and vector Uis directed toward minimization of error vector E. Furthermore vector Uis directed toward minimization of corrector error vector E and vector Uis directed toward minimization of solver error vector E.

Since vector Xtypically has relatively slow dynamic response with respect to the execution speed of CLM the time advanced form X can be estimated using an appropriate numerical approximation such as the forward rectangle rule. That is 5 where T is the step time.

A more general result without assuming any particular numerical integration algorithm is . . . 6 where the k 1 superscript denotes time retarded forms of state vector Xand state vector derivative dot over X that is forms derived in a finite number of previous executions of CLM . The ellipses indicate that any number of additionally retarded forms can be utilized.

The additional requirements imposed on vector Umake the determination of time advanced form Ua difficult technical problem. The process is best described by considering a small region around a particular operational point or base point BP where a linear representation holds to sufficient accuracy. In this region changes or differences in external input vector U constraint state vector Uand physics state vector Xare defined by 7 8 and 9 where the subscript indicates evaluation at the location of base point BP.

In a linear approximation the differences in physics state vector derivative dot over X error vector E and output vector Y are linear combinations of the differences in vectors X Uand U. That is 10 11 and 12 Note that Eqs. 10 12 utilize a generalized tensor form in which the product of tensors Aand vectors X Uand Utend to mix or cross couple contributions from different vector elements. This contrasts with Eqs. 2 6 which are vector equations in which particular scalar functions f fare applied to individual components of vectors X dot over X E and Y. Eqs. 7 9 are similarly interpretable in terms of individual vector elements.

In linear models the change in constraint vector Ucan be explicitly calculated for example by setting the change in the error vector E in Eq. 11 to zero. Provided that the inverse of tensor Ais sufficiently definable over the relevant parameter space this yields 13 

For some embodiments of apparatus the number of parameters is relatively small and constraint vector Ucan be directly approximated as a nonlinear function of state vector Xand input vector U. For many practical engineering systems however the complexity of apparatus limits applicability of Eq. 13. The accuracy of linear representations also decreases with distance from base point BP and the required execution speed is often impractical because the computational load increases exponentially.

In larger scale practical engineering systems where the model cycle time the step size must be increased to keep up with the processing rate of apparatus nonlinearities must be addressed in a more sophisticated way which does not yield an impractical processing load. This is accomplished via a combined feed forward and feedback based approach to error correction where feed forward term Fis based on time advanced state vector Xand time advanced external input vector U and feedback term Fincludes contributions from the accumulated error. That is 14 where error integral E dt is performed over a number of control system time steps. The more general approach of Eq. 14 allows CLM and MSE to address non linear couplings among the various elements of input vector U state vector Xand error vector E which affect constraint vector Uand thus determine overall performance.

As shown in external inputs describe a number of actuator based and sensor based parameters that are variously categorized as elements of effector vector or actuator vector U boundary condition vector U or truth vector Y. Some of these categorizations overlap. At compressor module for example inputs include elements of effector vector Uthat describe vane angle Vand other variable inlet parameters and elements of boundary condition vector Udescribe inlet pressure Pand inlet temperature T where the inlet forms an external flow boundary upstream of the compressor. For combustor module and turbine module inputs include components of truth vector Ythat describe turbine exhaust case TEC or turbine exit temperature T. For nozzle module inputs include elements of actuator vector Uthat describe nozzle area Aand other variable nozzle parameters.

As described above constraint input states comprise vectors Uand U which are combined to form constraint input state vector U. In for example vector Uincludes component specific elements such as compressor outlet pressure P as determined at an intermediate location between the compressor corresponding to software module and the combustor corresponding to software module . Additional constraint vector components are generated within downstream component modules for example TEC pressure or turbine exit pressure P as determined within a transition flow duct between the physical turbine corresponding to software module and the physical exhaust nozzle corresponding to software module .

In the example of physics state vector X contains an element corresponding to shaft speed N. Shaft speed N is utilized by compressor module and turbine module in order to calculate corresponding module outputs for the model. As with other elements of physics state vector X shaft speed N is determined by engineering principles has relatively slow response time compared to the model time step and reflects system dynamics that are accurately modeled by CLM .

Component modules and produce model outputs A B and C which are a representative subset of the model outputs used to form relationships between vectors Xand dot over X and between vectors Uand E. Compressor module output A for example includes compressor flow rate Wand power demand S. Turbine module output B includes turbine flow rate Wand power output S and nozzle output C includes nozzle flow rate W. Additional outputs include various gas path temperatures gas path pressures and specific corrector outputs Y such as turbine exit temperature T. Corrector outputs Yare compared to specific elements of truth vector Y in order to generate errors specifically corrector errors E and CLM reduces the errors to enhance model fidelity and response.

The elements of constraint vector Uare divided into constraint corrector states U which are utilized to correct subset Yof outputs Y that is to minimize corrector error E and constraint solver states U which are used to minimize solver errors E. Vector Uincludes adjustable empirical parameters while constraint solvers Uare based on established rules of engineering and essentially inviolable laws of physics.

Applying control volume mass conservation law it can be shown that the time rate of change in turbine module exit pressure P for example depends upon ideal gas constant R temperature Tand rate of flow into W and out of W volume V as defined between the physical turbine and nozzle components corresponding to software modules and respectively 

In general corrector errors Edepend upon the difference between the elements of corrector output vector Yand the corresponding elements of truth vector Y. For turbine temperature T for example the appropriate element is . 18 That is the corrector error element corresponding to temperature Tis the difference between the turbine exit temperature as modeled by turbine module and the corresponding element of truth vector Y. Depending on application this element is sometimes an actual measurement from a physical sensor located in the core flow proximate the turbine exit assembly and sometimes a high fidelity model output which is accepted as accurate.

In general particular constraint state parameters are utilized in a number of different forms including both physics engineering relationships and empirical associations in order to minimize error corrector Eand error solver E. Further Eqs. 16 18 are not limited in application to the turbine nozzle interface but can be applied to any control volume at any flow transition including transitions between the physical components corresponding to compressor module combustor burner module and turbine module or between an exhaust nozzle and an augmentor or afterburner assembly. At the same time changes in one constraint parameter will necessarily influence a number of different errors state vectors and model outputs. This makes stable error correction a high priority for fast accurate and robust modeling and control systems.

As shown in inputs to CLM describe boundary conditions such as inlet pressure Pand inlet temperature T and control states of apparatus such as variable vane and nozzle configurations Vand A. These are input directly to OLM while truth states such as turbine exit temperature Tare also input to CMP .

Typically the inputs to OLM are delivered to one or more individual component level software modules such as compressor module combustor burner module turbine module and exhaust nozzle module of above. In turn each of the component level software modules utilizes processor components that perform the module level functions of OLM COM CMP and MSE .

Constraints comprise vectors Uand U which are combined to form vector U. Constraint state vector Uincludes component specific elements such as compressor outlet pressure P as determined at an intermediate location between the compressor and combustor. Additional constraint vector components are generated by downstream component modules for example turbine exit pressure P as determined within a transition flow duct between the turbine section and the exhaust nozzle.

The elements of constraint vector Udescribe component specific elements such as compressor outlet pressure Pand turbine outlet pressure P. Constraint correctors Uare utilized to improve the accuracy of corrector outputs modeled values Yat COM which correspond to truth measured or high fidelity modeled values Y for instance the true value of turbine exit temperature T. This minimizes corrector errors E as determined by CMP . Constraint solver states Uare utilized to minimize solver errors E including the error in turbine flow parameters as described above.

Physics state vector X comprises elements describing physics states of the apparatus including spool speed N. OLM determines the time rate of change in spool speed dot over N and other state vector elements based on physics and engineering principles such as moment of inertia and net power delivered to the shaft.

Model state estimator MSE generates time advanced physics state vector Xand time advanced constraint vector Ufor feedback into OLM such that state vector derivatives dot over X and error vector E are driven toward zero that is minimized . This allows CLM to quickly accurately and reliably model the physical apparatus ensuring fast response and high fidelity control.

In order to achieve these goals MSE must predict or estimate future model state values with some degree of accuracy in order to reduce the magnitude of error vector E. In particular MSE must be able to accurately formulate the feedback term Fin Eq. 14 and must employ a gain design scheme that addresses cross dependencies among the different elements of constraint vector Uand error vector E.

There are two basic approaches to gain design depending upon how strong the cross dependencies are. In the single input single output SISO approach distinct elements of error vector E are closely associated with distinct elements of constraint vector U and not substantially cross correlated so gain formulation can be decoupled for each individual element. In the multiple input multiple output MIMO approach error vector E and constraint vector Uare substantially cross correlated with one another and the problem is not decoupled. The MIMO approach is further divided into control and observer formulations as described below.

The SISO approach applies when distinct components of error vector E are closely associated or paired with distinct components of constraint vector U. In this case tensors Ain Eqs. 10 12 take on substantially diagonal form with relatively small magnitude off diagonal elements. Alternatively the SISO approach applies when there is one way coupling. In this case tensors Ahave substantially triangular form in which the elements on one side of the diagonal are zero or at least small as compared to elements on the other side of the diagonal.

In SISO embodiments the feedback contribution in Eq. 14 is approximated by the following single input single output model state estimator equation 19 Essentially Eq. 19 provides a difference equation or a set of difference equations for obtaining time advanced constraint vector U. The difference equations define the change in time advanced constraint vector Ufrom its value at base point BP in terms of the tensor product of gain matrix S and error vector E scaled by time step T.

In the decoupled case gain tensor S is substantially diagonal that is each element of time advanced constraint vector Uis associated with exactly one element of error vector E and is not closely associated with the others. In this case the estimation process for time advanced constraint state vector Uis simply repeated for each set of paired elements. Because the mapping from constraint vector Uto error vector E is substantially one to one the computations are independent and can be performed in any order.

CLM utilizes non linear approximations such that the particular form of gain tensor S varies as a nonlinear function of input vectors X U Uand Y. In addition the gain design process is repeated over a rich set of inputs representing the full operational envelope of each individual vector element. The elements of gain tensor S are then determined on the basis of model fidelity control response and stability over the entire operational range.

During the gain design process additional correlations typically appear between elements of constraint vector Uand elements of error vector E. To the extent that these additional cross couplings are small the SISO estimator approach holds and it is sufficient to approximate gain tensor S with a substantially diagonal or substantially triangular form. To the extent that these additional cross couplings are not small the SISO approximation does not hold and multiple input multiple output MIMO design approach is employed.

In the MIMO embodiment MSE utilizes a twofold design approach in which a linear analysis is used to formulate initial gain parameters that is to estimate the gain tensor elements followed by derivation of a model state estimator difference equation analogous to Eq. 19 above but using a gain integral to accommodate additional cross couplings. There are two basic approaches to the MIMO gain design equation which are known as control formulation and observer formulation.

In the control formulation approach the elements of error vector E are assumed to depend upon the time derivative of an unknown state vector X. That is 

The control formulation views constraint vector Uas a control input. The change in Udepends upon augmented state vector X through a multiple input multiple output MIMO gain function which is expressed in matrix form as gain tensor M. That is 23 where M is the MIMO gain tensor in the control formulation. Note that this approach also requires augmentation of constraint vector Uand MIMO gain tensor M for example 24 where submatrices Mand Mare associated with physical state vector Xand solution vector X respectively.

Gain design seeks gain tensor M that allows MSE to direct solution state vector Xtoward quick and reliable minimization of error vector E which in turn achieves stability and fidelity for CLM and facilitates stable and accurate control response for system . A general form for estimating time advanced augmented state vector Xis based on the forward rectangular rule for integral approximation 25 In this expression the augmented state vector derivative

MIMO gain tensor M is defined as a function of the time rate of change in the augmented state vector 

Time advanced constraint vector Uis defined analogously . 30 In some embodiments solution states Xare decoupled from physical states X such that the solution vector and physical state vector are well separated in terms of the bandwidth the respective bounds in the frequency domain . In these embodiments independent forms are obtained for solution states X 

In the observer formulation approach an assumption is made that constraint vector Uis the unknown or solution state X and that its time derivative is zero. That is 34 and 0. 35 Applying linear observer methodology the following estimator is constructed to drive error vector E to zero 

Optimum scheduling parameters are determined on the basis of unique criteria including base point field coverage independence surface smoothness variability validity and gain margin statistics. The criteria are evaluated both with respect to the gain parameters themselves and with respect to vector derivatives such as dE dU.

Typical candidate scheduling parameters include elements of external input vector U constraint vector U state vector X output vector Y or error vector E that sufficiently define the apparatus to allow effective gain scheduling. Alternatively the scheduling parameters incorporate elements of augmented vectors such as augmented state vector X or other parameters not contained in the augmented vectors but which nonetheless provide for effective gain scheduling.

Plot illustrates a bi variant or two dimensional approach with two arbitrary scheduling parameters Pand P plotted against each other with first parameter Pon the horizontal and second parameter Pon the vertical. Typically engineering complexity requires at least two scheduling parameters and no more than two parameters are used when sufficient to effectively design the gain in order to reduce computational requirements. Alternatively a one dimensional univariant approach is used or a multi variant multi dimensional approach.

Scheduling parameters Pand Pare defined for steady state and transient operational conditions spanning a rich data set of design off design and failure conditions. A linear space representation is obtained at each design point applying various linearization techniques to accurately predict system behavior in the vicinity of each data point triangles . Linearization is verified by a step response time domain analysis or other validation process which is applied to a subset of the design data points.

Linear system variables are scaled by maximum values to improve accuracy of numerical tensor operations during gain design. Correcting linear system variables improves effectiveness of MSE when operating at non standard boundary conditions. Scaled and corrected linear models are then used in the gain design process.

The linear representation and gain size vary between points of the design data set. An optimum base point system is synthesized where each base point circles contains a complete specification of the linear system. The operating envelope is covered by a finite number of base points each defined with scheduling parameters Pand P or another set of scheduling parameters. This results in a rectangular grid of base points forming a base point field than spans the relevant scheduling parameter range.

A linear state space representation is synthesized at each base point from a finite number of design data points located in close proximity to the base point. Proximity is defined by base point cloud with radius r selected as an optimization parameter. One approach utilizes a weighted average of data points located within base point cloud . The weighting factor is defined for example as a function of the non dimensional distance between base point and data point .

The gain is sized for each system of base points and the discrete model state estimator obtains values of the gain at each time step by interpolating between the base points. That is the field of optimized base points provides a lookup table from which the gains can be interpolated so that the elements of gain matrices S M and L can be rapidly and effectively determined as functions of scheduling parameters Pand P.

The present invention has been described with reference to preferred embodiments but the terminology used is for the purposes of description not limitation. Workers skilled in the art will recognize that changes may be made in form and detail without departing from the spirit and scope of the invention.

