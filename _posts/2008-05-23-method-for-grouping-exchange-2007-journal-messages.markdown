---

title: Method for grouping exchange 2007 journal messages
abstract: During an initial scan of a journal inbox, journal reports are modified so that the Internet Message ID in the text body appears as a custom message ID value in a new custom message ID MAPI property created on the journal reports. Further, the message class value of the message class MAPI property on the journal reports is modified to a journal part. During a secondary scan of the journal inbox, related journal parts are grouped together based on the custom message ID value and message content. Also, the message class value is modified to prevent the journal reports from being considered in subsequent initial or secondary scans. One of the journal reports of each group is selected as a master copy. A new custom related journal parts MAPI property is created on the master copy that includes a related journal parts value which is a list of identifiers that can be used to locate the other related journal parts of the group.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07836139&OS=07836139&RS=07836139
owner: Symantec Corporation
number: 07836139
owner_city: Mountain View
owner_country: US
publication_date: 20080523
---
This application is a continuation in part of U.S. patent application Ser. No. 12 050 333 filed Mar. 18 2008 entitled METHOD FOR GROUPING EXCHANGE 2007 JOURNAL MESSAGES and naming Andrew Gilbert and Stewart Waldie as inventors the entire disclosure of which is incorporated herein by reference.

The present invention relates to the automatic grouping of journal messages associated with electronic mail messages.

Journaling is the recording of communications such as electronic mail messages for retention or archiving purposes. In some instances journaling is required to comply with regulatory requirements.

Electronic mail e mail journaling applications such as Microsoft Exchange Server 2007 can generate several journal messages called journal reports or envelope journal reports for each e mail message that is sent from a mailbox. For example a journal report can be generated for each different recipient of an e mail message. Consequently multiple journal reports related to a single e mail message can be present in a journal mailbox.

According to one embodiment a method for grouping journal messages includes determining each journal report in an inbox of a journal mailbox to be processed for identification each journal report having a message content creating a custom message ID MAPI property on each journal report having an Internet Message ID the custom message ID MAPI property including a custom message ID value based on the Internet Message ID firstly modifying a message class value of a message class MAPI property on each journal report to indicate the journal report is a journal part determining each journal part in the inbox to be processed for grouping grouping each journal part to be processed for grouping into a Current Set of related journal parts based on the custom message ID value each of the related journal parts in a Current Set having a same custom message ID and grouping each journal part in a Current Set into a group of related journal parts based on the message content each of the related journal parts in a group having a same message content each group having one journal part selected as a master copy for the group each master copy having a related journal parts MAPI property including a related journal parts value identifying the other related journal parts in the group. In some embodiments the method further includes submitting each master copy for further processing such as by a compliance or e discovery application.

Embodiments in accordance with the invention are best understood by reference to the following detailed description when read in conjunction with the accompanying drawings.

Common reference numerals are used throughout the drawings and detailed description to indicate like elements.

Embodiments in accordance with the invention group related journal reports so that the journal reports can be processed at one time for example to reduce duplication in compliance or e discovery applications.

Referring generally to in one embodiment an inbox of a journal mailbox is queried to obtain journal reports to be processed for identification operation . For each journal report identified in a returned response to the query the journal report is processed to obtain the Internet Message ID if present from the text body operations .

A custom message ID MAPI property is created on the journal report and in one embodiment the Internet Message ID from the text body of the journal report is used as the custom message ID value for the custom message ID MAPI property operation . Additionally the message class value of the message class MAPI property of the journal report is modified so that the journal report is excluded from subsequent identification processing of journal reports in the inbox operation . In one embodiment the message class value of the message class MAPI property is modified to a journal part.

Referring now generally to the inbox of the journal mailbox is queried to obtain journal parts to be processed for grouping operation . For each journal part identified in the returned response to the query the journal part is processed for grouping with related journal parts utilizing the custom message ID value. When each journal part in a group of related journal parts has a last modification time before a specified time threshold the journal parts of that group are deemed ready to group operation .

Referring now generally to in grouping the message class value of each journal part in the group is modified so that it is excluded from subsequent identification processing and grouping processing of journal reports in the inbox operations . Additionally one journal part of the group is selected as a master copy and a new custom related journal parts MAPI property is created on the journal part. The custom related journal parts MAPI property includes a related journal parts value which includes a list of identifiers that identify each of the other related journal parts in the group operations . Thus the master copy can serve as a single representative journal report for the group of related journal reports. Accordingly duplicative processing of the journal reports by applications such as compliance or e discovery applications can be reduced. If so desired all the related journal reports of the group can be located utilizing the related journal parts value present on the master copy. Grouping of the journal parts continues until all the returned journal parts have been grouped operations .

Referring more particularly now to is a diagram of a computer system including a journal message grouping application executing on a host computer system e.g. a first computer system in accordance with one embodiment of the present invention. Host computer system sometimes called a client or user device typically includes a central processing unit CPU hereinafter processor an input output I O interface a memory and an operating system . In one embodiment memory of host computer system further includes an e mail journaling application such as Microsoft Exchange Server 2007 and a journal mail box having an inbox A for receiving journal messages such as journal reports. In one embodiment journal message grouping application is stored in memory of host computer system and executed on host computer system .

In one embodiment memory includes storage media not shown for permanent storage of files sometimes called non volatile memory non temporary storage memory non temporary storage media or permanent storage memory. For example in one embodiment the storage media is a hard drive e.g. a magnetic hard drive a floppy disk a CD ROM and or a DVD. Generally files stored in permanent storage memory e.g. a magnetic hard disk a floppy disk a CD ROM a DVD are unaffected and maintained i.e. are not lost upon powering down turning off of host computer system .

In various embodiments memory further includes volatile memory for non permanent storage of files sometimes called temporary storage memory non temporary storage media or non permanent storage memory. Generally files stored in non permanent storage memory are lost upon powering down turning off of host computer system .

Host computer system may further include standard devices like a keyboard a mouse a printer and a display device as well as one or more standard input output I O devices such as a compact disk CD or DVD drive floppy disk drive or other digital or waveform port for inputting data to and outputting data from host computer system . In one embodiment journal message grouping application is loaded onto host computer system via I O device such as from a CD DVD or floppy disk containing journal message grouping application .

In one embodiment host computer system is coupled to a server computer system of system by a network . Server computer system typically includes a processor a memory and a network interface .

Host computer system can also be coupled to other computer systems of system such as a computer system by network . In one embodiment computer system is similar to host computer system and for example includes a central processing unit an input output I O interface and a memory. Computer system may further include standard devices such as a keyboard a mouse a printer a display device and an I O device s . The various hardware components of computer system are not illustrated to avoid detracting from the description of the invention.

Network can be any network or network system that is of interest to a user. In various embodiments network interface and I O interface include analog modems digital modems or a network interface card. The particular type and configuration of host computer system computer system and server computer system are not essential to the present invention.

In one embodiment e mail journaling application e.g. Microsoft Exchange Server 2007 supports journaling and generation of journal reports. Typically in journaling each e mail communication sent from host computer system generates one or more journal reports which are sent to a designated mailbox such as journal mailbox . In one embodiment inbox A receives and stores journal messages such as journal reports. In one embodiment e mail journaling application maintains a current time.

Herein a journal report is an item generated as part of the journaling process which records details of an e mail communication. Journal reports are also known as envelope reports or envelope messages. A journal report is itself an e mail which is sent to a journal mailbox.

Referring back to a journal report typically includes a Messaging Application Programming Interface MAPI including one or more MAPI properties which is part of the header of the journal report and thus not usually visible to a reader of the journal report. Applications can utilize the MAPI to access data stored by a journaling application such as Microsoft Exchange Server 2007. Applications can also add custom properties to journal messages such as journal reports using MAPI.

Conventionally the Message Class MAPI property indicates the type of journal message. For example a standard e mail message has a message class of IPM.NOTE while a calendar appointment has a message class of IPM.Appointment. A journal report can be identified by the presence of the specific MAPI property x ms journal report . An example of some MAPI properties utilized on a conventional journal report is illustrated in . It can be understood by those of skill in the art that other MAPI properties not shown can also be present but are not further detailed herein to avoid detracting from the description of the invention.

In QUERY FOR JOURNAL REPORTS operation a query is generated and sent requesting journal reports present in the journal inbox. This initial query of the inbox also called herein an initial scan is to locate journal reports to be processed for identification. For example in one embodiment inbox A is opened and queried for journal reports. In one embodiment the query specifies journal reports and excludes journal parts.

For example in one embodiment the query specifies journal messages having a x ms journal report MAPI property and excludes journal messages having a message class MAPI property with .part e.g. excludes journal parts. As is further detailed herein excluding journal parts from this initial query prevents returning query results having journal reports already identified in accordance with the invention. From QUERY FOR JOURNAL REPORTS operation processing transitions to a RECEIVE QUERY RESULTS operation .

In RECEIVE QUERY RESULTS operation the results of the query of operation are received. For example in one embodiment a listing of journal reports in inbox A that meet the search criteria i.e. are not journal parts is received. Herein in one embodiment this listing of journal reports is termed a Journal Report listing. From RECEIVE QUERY RESULTS operation processing transitions to a JOURNAL REPORT TO ID check operation .

In JOURNAL REPORT TO ID check operation a determination is made whether there is a journal report to process for identification. For example a determination is made whether the query results i.e. the Journal Report listing includes at least one journal report to process for identification.

If there are no journal reports to process NO processing transitions from JOURNAL REPORT TO ID check operation to a QUERY FOR JOURNAL PARTS operation further described later herein. Alternatively if there is a journal report to process YES processing transitions from JOURNAL REPORT TO ID check operation to a SELECT JOURNAL REPORT operation .

In SELECT JOURNAL REPORT operation a journal report is selected from the query results to process. Thus for example initially a first journal report from the Journal Report listing is selected for processing. In subsequent processing of remaining journal reports if any a next journal report is selected. From SELECT JOURNAL REPORT operation processing transitions to a SEARCH TEXT BODY FOR MESSAGE ID operation .

In SEARCH TEXT BODY FOR MESSAGE ID operation the text body of the currently selected journal report is searched for the Internet Message ID. From SEARCH TEXT BODY FOR MESSAGE ID operation processing transitions to a MESSAGE ID FOUND check operation .

In MESSAGE ID FOUND check operation a determination is made whether an Internet Message ID is found in the text body of the currently selected journal report. If the Internet Message ID is not found NO the journal report is considered invalid for identification and processing returns to JOURNAL REPORT TO ID check operation where a determination is made whether a next journal report to process is present in the Journal Report listing.

Referring back again to MESSAGE ID FOUND check operation alternatively if an Internet Message ID is found YES the journal report is valid for identification and processing transitions from MESSAGE ID FOUND check operation to a CREATE CUSTOM MESSAGE ID MAPI PROPERTY operation .

In CREATE CUSTOM MESSAGE ID MAPI PROPERTY operation a new custom message ID MAPI property is created on the journal report. In one embodiment the custom message ID MAPI property includes the Internet Message ID of the currently selected journal report as the custom message ID value.

More particularly the custom message ID MAPI property has a custom message ID field which includes the Internet Message ID of the currently selected journal report as the custom message ID value in the field. In this way the Internet Message ID which is internal to the journal report is now promoted to a MAPI property on the journal report that can be later used for grouping related journal reports. From CREATE CUSTOM MESSAGE ID MAPI PROPERTY operation processing transitions to a MODIFY MESSAGE CLASS operation .

In MODIFY MESSAGE CLASS operation the message class value of the message class MAPI property of the journal report is modified to exclude the journal report from subsequent processing for identification. In one embodiment the message class value of the message class MAPI property is modified to a journal part. By modifying the message class to journal part e.g. to include .part the journal report will not be returned in subsequent initial scan queries of inbox A for journal reports as journal parts are excluded in the initial scan query of operation . This prevents the same journal report from being reprocessed. From MODIFY MESSAGE CLASS operation processing transitions to JOURNAL REPORT TO ID check operation as earlier described.

Journal Report MAPI properties B includes a new custom message ID MAPI property UniqueMessageID of type PR STRING including a custom message ID value of which for purposes of example is the Internet Message ID from the body of the journal report e.g. Internet message ID . Those of skill in the art can recognize that although UniqueMessageID is used in the example to identify custom message ID MAPI property in other embodiments identifiers other than UniqueMessageID can be used.

Additionally the initial message class value IPM.Note of is now modified as shown in to the message class value of IPM.Note.EnterpriseVault.PendingArchive.Part a journal part. Also as the journal report has been modified the last modification time of is automatically modified by e mail journaling application to reflect an updated last modification time . Thus in the journal report now includes a custom message ID value and is identified as a journal part and has an updated last modification time indicating the time it was processed in the initial scan. The journal report has now been processed for identification as previously described.

Referring back again to the above operations e.g. operations are repeated until there are no journal reports present in the query results e.g. in the Journal Report listing to process. Thus at JOURNAL REPORT TO ID check operation when no journal reports are present to process NO the processed journal reports present in inbox A each now has a new custom message ID value identifying an associated Internet Message ID and a message class value identifying the journal report as a journal part. Subsequently the custom message ID value can be used to group related journal parts.

In one embodiment following the completion of the identification of the returned journal reports in inbox A grouping of related journal parts is automatically begun as further described herein. However in other embodiments repeated identification processing of journal reports in inbox A can be performed for example such as when there are very few journal reports prior to initiating the grouping processing. For example identification processing of journal reports in inbox A can be performed repeatedly until a specified journal report count is reached or until a specified time period is reached.

Referring now to in one embodiment subsequent to completion of the identification processing described with reference to grouping of related journal reports which are now journal parts is automatically performed as further described herein. Thus in one embodiment when there are no more journal reports in the Journal Report listing to process NO from JOURNAL REPORT TO ID check operation processing transitions to QUERY FOR JOURNAL PARTS operation .

In QUERY FOR JOURNAL PARTS operation the inbox of the journal mailbox is queried for journal parts. This second query of the inbox also called herein a secondary scan is to locate related journal reports to group. For example in one embodiment inbox A is opened and queried for journal parts.

More particularly in one embodiment inbox A is queried for a result listing each journal part present in inbox A having a message class value that is a journal part e.g. .part . Further in one embodiment the query also specifies that the search be sorted by the custom message ID value. From QUERY FOR JOURNAL PARTS operation processing transitions to a RECEIVE QUERY RESULTS operation .

In RECEIVE QUERY RESULTS operation the results of the query of operation are received. For example in one embodiment a listing of journal parts in inbox A that meet the search criteria i.e. are journal parts is received. Herein in one embodiment this listing of journal parts is termed a Journal Part listing. Further in one embodiment the Journal Part listing is sorted by the custom message ID. From RECEIVE QUERY RESULTS operation processing transitions to a SET GROUP ELIGIBLE FLAG TO TRUE operation .

In SET GROUP ELIGIBLE FLAG TO TRUE operation a group eligible flag maintained and utilized by journal message grouping application is set to true. In one embodiment the group eligible flag is stored in a memory structure of journal message grouping application such as in a temporary memory structure. In other embodiments the group eligible flag is stored in a memory structure accessible by journal message grouping application such as in a memory structure located on host computer system .

In one embodiment the group eligible flag is used to optimize processing when an ineligible journal part is found so that other journal parts with the same ID are not examined. In one embodiment the group eligible flag is initially set to a default setting of true for example a value of 0. From SET GROUP ELIGIBLE FLAG TO TRUE operation processing transitions to a JOURNAL PART TO GROUP check operation .

Referring now to in JOURNAL PART TO GROUP check operation a determination is made whether there is a journal part to process for grouping. For example a determination is made whether the query results i.e. the Journal Part listing includes at least one journal part to process for grouping. If there are no journal parts to process for grouping NO processing transitions from JOURNAL PART TO GROUP check operation to a JOURNAL PART IN CURRENT SET check operation further described later herein. Alternatively if there is a journal part to process for grouping YES processing transitions from JOURNAL PART TO GROUP check operation to a SELECT JOURNAL PART operation .

In SELECT JOURNAL PART operation a journal part is selected from the query results to process. Thus for example initially a first journal part from the Journal Part listing is selected. In subsequent processing of remaining journal parts if any a next journal part is selected. From SELECT JOURNAL PART operation processing transitions to a READ CUSTOM MESSAGE ID operation .

In READ CUSTOM MESSAGE ID operation the custom message ID value of the custom message ID MAPI property of the journal part is read. From READ CUSTOM MESSAGE ID operation processing transitions to a MATCH PREVIOUS CUSTOM MESSAGE ID check operation .

In MATCH PREVIOUS CUSTOM MESSAGE ID check operation a determination is made whether the custom message ID value read in operation matches a previous custom message ID value. Initially a previous custom message ID value is not present as no journal parts have been processed. If there is no previous custom message ID value the custom message ID value of the currently selected journal part does not match.

In subsequent operations in which a previous custom message ID value is present when the custom message ID value of the currently selected journal part matches the previous custom message ID value it is assumed the currently selected journal part is related to the previous journal part and is therefore part of a same group associated with the same e mail. Alternatively in subsequent operations where there is not a match it is assumed the currently selected journal part is not related to the same message group as the previous journal part.

Thus if the custom message ID value of the currently selected journal part does not match the previous custom message ID value NO from MATCH PREVIOUS MESSAGE ID check operation processing transitions to a JOURNAL PART IN CURRENT SET check operation of further described later herein. Alternatively if the custom message ID value of the currently selected journal part matches the previous custom message ID value YES from MATCH PREVIOUS CUSTOM MESSAGE ID check operation processing transitions to a GROUP ELIGIBLE FLAG TRUE check operation .

In GROUP ELIGIBLE FLAG TRUE check operation a determination is made whether the group eligible flag is set to true. If the group eligible flag is not set to true NO the group is not mature enough to be grouped and processing transitions from GROUP ELIGIBLE FLAG TRUE check operation to a SET GROUP ELIGIBLE FLAG TO FALSE operation .

In SET GROUP ELIGIBLE FLAG TO FALSE operation the group eligible flag is set to false. From SET GROUP ELIGIBLE FLAG TO FALSE operation processing transitions to a RESET CURRENT SET operation .

In RESET CURRENT SET operation the Current Set is reset. More particularly the Current Set listing is cleared to begin building a different Current Set. From RESET CURRENT SET operation processing transitions and returns to JOURNAL PART TO GROUP check operation and a determination is made whether there is a journal part in the Journal Part listing to be processed for grouping e.g. a next journal part to be processed for grouping as earlier described.

Referring back again to GROUP ELIGIBLE FLAG TRUE check operation alternatively if the group eligible flag is set to true YES from GROUP ELIGIBLE FLAG TRUE check operation processing transitions to a MOD TIME

For example in one embodiment the last modification time value of the journal part is compared against the specified time threshold. If the last modification time value of the journal part is before or equal to the calculated time threshold the journal part qualifies as being ready for grouping otherwise the journal part is too recent and does not qualify for grouping. In one embodiment when a journal report fails to qualify for grouping due to its age any other possible members of the group are also disqualified.

As the last modification time value is updated automatically when a journal report is modified in one embodiment the last modification time value records the time the journal report was processed for identification. Thus in one embodiment last modification time value is compared against the time threshold. In one embodiment when the last modification time value of the currently selected journal part is not before the time threshold NO the group is not mature enough to be grouped and processing transitions from MOD TIME

In ADD JOURNAL PART TO CURRENT SET operation the currently selected journal part is added to the Current Set. Herein a Current Set is a listing of a group of related journal parts. In one embodiment the Current Set is stored in a memory structure of journal message grouping application such as in a temporary memory structure. In other embodiments the Current Set is stored in a memory structure accessible by journal message grouping application such as in a memory structure located on host computer system .

Thus each journal part selected in operation for addition to this Current Set is part of a group having the same custom message ID and having a last modification time value before the time threshold. From ADD JOURNAL PART TO CURRENT SET operation processing transitions to an IDENTIFY JOURNAL PART AS THE PREVIOUS JOURNAL PART operation .

In IDENTIFY JOURNAL PART AS THE PREVIOUS JOURNAL PART operation one or more parameters of the currently selected journal part are identified as the previous journal part. In one embodiment the previous journal part is stored in a memory structure of journal message grouping application such as in a temporary memory structure. In other embodiments the previous journal part is stored in a memory structure accessible by journal message grouping application such as in a memory structure located on host computer system .

Storing the previous journal part information allows journal message grouping application to remember the attributes of the most recently processed journal report for later comparison in check operation . In particular in one embodiment the custom message ID value of the currently selected journal part is stored as the previous custom message ID value. From IDENTIFY JOURNAL PART AS THE PREVIOUS JOURNAL PART operation processing transitions t and returns to JOURNAL PART TO GROUP check operation and a determination is made whether there is a journal part in the Journal Part listing to be processed for grouping e.g. a next journal part to be processed for grouping.

Referring now to in JOURNAL PART IN CURRENT SET check operation a determination is made whether there is a journal part present in the Current Set listing to process. If there is no journal part present in the Current Set listing to process NO processing transitions from JOURNAL PART IN CURRENT SET check operation to a NEXT JOURNAL PART TO GROUP check operation further described later herein. Alternatively if there is a journal part present in the Current Set listing to process YES processing transitions from JOURNAL PART IN CURRENT SET check operation to a SELECT JOURNAL PART operation .

In SELECT JOURNAL PART operation a journal part in the Current Set listing is selected for processing. Thus for example initially a first journal part in the Current Set listing is selected. In subsequent processing of remaining journal parts in the Current Set if any a next journal part in the Current Set is selected for processing. From SELECT JOURNAL PART operation processing transitions to a MODIFY MESSAGE CLASS operation .

In MODIFY MESSAGE CLASS operation the message class value of the selected journal part in the Current Set is modified to prevent reprocessing. In one embodiment the message class value is modified to prevent reprocessing for identification and to prevent reprocessing for grouping.

In NEXT JOURNAL PART IN CURRENT SET check operation a determination is made whether there is a next journal part in the Current Set to process. In one embodiment if there is a next journal part in the Current Set listing to process YES processing transitions and returns to SELECT JOURNAL PART operation earlier described. Alternatively if there is not a next journal part in the Current Set to process NO from NEXT JOURNAL PART IN CURRENT SET check operation processing transitions to a SELECT MASTER COPY operation .

In SELECT MASTER COPY operation one of the journal parts in the Current Set is selected for designation as a master copy. For example in one embodiment the last journal part processed in the Current Set is selected for designation as the master copy. In other embodiments a different journal part in the Current Set can be selected. From SELECT MASTER COPY operation processing transitions to a CREATE CUSTOM RELATED JOURNAL PARTS MAPI PROPERTY operation .

In CREATE CUSTOM RELATED JOURNAL PARTS MAPI PROPERTY operation a new custom related journal parts MAPI property is created on the journal part selected as the master copy in operation . In one embodiment the custom related journal parts MAPI property includes a related journal parts MAPI field including a related journal parts value.

In one embodiment the related journal parts value is a multi value binary property that is a list of identifiers that identify each of the related Journal Parts in the group. In one embodiment the related journal parts value is a list of Exchange Server Entry IDs that identify each of the related Journal Parts in the group e.g. in the Current Set. Exchange Server Entry IDs are well known to those of skill in the art and not further described herein to avoid detracting from the description of the invention. In this way the related journal parts value can be used to access the other related journal parts if needed.

In subsequent processing if any the master copy can be used as a single journal report reference to an e mail and each of the related journal parts does not have to be duplicatively processed. However if so desired the other related journal parts can be accessed utilizing the related journal parts value on the master copy. From CREATE CUSTOM RELATED JOURNAL PARTS MAPI PROPERTY operation processing transitions to NEXT JOURNAL PART TO GROUP check operation .

In NEXT JOURNAL PART TO GROUP check operation a determination is made whether there is a remaining journal part e.g. a next journal part to process for grouping in the Journal Part listing. If there is a next journal part to process YES from NEXT JOURNAL PART TO GROUP check operation processing transitions to a SET GROUP ELIGIBLE FLAG TO TRUE operation .

In SET GROUP ELIGIBLE FLAG TO TRUE operation the group eligible flag is set to true and processing transitions from SET GROUP ELIGIBLE FLAG TO TRUE operation to a RESET CURRENT SET operation .

In RESET CURRENT SET operation the Current Set is reset. In one embodiment resetting the Current Set deletes any journal parts from the listing of the Current Set. From RESET CURRENT SET operation processing transitions to SELECT JOURNAL PART operation with a next journal part in the Journal Part listing being selected for grouping as earlier described.

Referring back again to NEXT JOURNAL PART TO GROUP check operation alternatively if there is no remaining journal part in the Journal Part listing to process for grouping NO processing exits method at an EXIT operation or optionally returns to operation .

The above embodiment has been described to allow subsequent processing of the grouped journal parts such as by compliance or e discovery applications or another selected application. However in an alternate embodiment the journal parts in the Current Set can be further processed by another application during processing of the Current Set.

For example in one alternate embodiment subsequent to operation each journal part can be processed in accordance with a specified method not shown such as a compliance or e discovery application and following the specified method processing returned to operation . As another example in another alternate embodiment subsequent to operation or operation the master copy journal part can be processed in accordance with a specified method and following the specified method processing returned to operation or check operation respectively.

In some instances the message content of messages having a common Internet Message ID can differ. This can happen for a number of reasons. For example a journaling application such as Microsoft Exchange Server 2007 may run a filter that adds disclaimers to messages destined for external recipients. Consequently where a message is sent to both an internal and external recipient two journal reports will be generated both sharing the same Internet Message ID yet having different message content.

Thus in another embodiment when grouping journal parts that share a common Internet Message ID i.e. have the same custom message ID the message content of the journal part is analyzed to determine if the content is the same. Journal parts are then sub grouped in accordance with the message content such that journal parts having the same custom message ID and the same message content are grouped together. Further a master copy for each sub group is created the master copy identifying the other journal parts of the sub group.

Referring now to in SELECT JOURNAL PART AS MASTER COPY operation a first journal part in the Current Set listing is selected for processing. In this embodiment the selected journal part is now designated a master copy. From SELECT JOURNAL PART AS MASTER COPY operation processing transitions to a REMOVE FROM CURRENT SET operation .

In REMOVE FROM CURRENT SET operation the selected journal part is removed from the Current Set listing. This prevents reprocessing of this journal part in the Current Set listing. From REMOVE FROM CURRENT SET operation processing transitions to a MODIFY MESSAGE CLASS operation .

In MODIFY MESSAGE CLASS operation the message class value of the selected journal part is modified. In one embodiment the message class value is modified to prevent reprocessing for identification and to prevent reprocessing for grouping as earlier described with reference to operation .

In one embodiment as earlier described with reference to the journal report MAPI properties are modified to include a further modified message class value. For example the message class value IPM.Note.EnterpriseVault.Pending Archive.Part is modified to IPM.Note.EnterpriseVault.Pending Archive . Also as the journal report has been modified the last modification time is automatically modified by e mail journaling application to reflect an updated last modification time. From MODIFY MESSAGE CLASS operation processing transitions to a DETERMINE RELATED JOURNAL PARTS operation .

In DETERMINE RELATED JOURNAL PARTS operation the remaining journal parts present in the Current Set listing are evaluated to determine those journal parts having the same message content as the currently selected master copy. In one embodiment the related journal parts in the Current Set listing having the same message content as the currently selected master copy are identified and removed from the Current Set listing. One embodiment of a method for determining related journal parts operation is further described later herein with reference to a method and . From DETERMINE RELATED JOURNAL PARTS operation processing transitions to a CREATE CUSTOM RELATED JOURNAL PARTS MAPI PROPERTY operation .

In CREATE CUSTOM RELATED JOURNAL PARTS MAPI PROPERTY operation a new custom related journal parts MAPI property is created on the journal part selected as the master copy. As earlier described with reference to operation in one embodiment the custom related journal parts MAPI property includes a related journal parts MAPI field including a related journal parts value.

In one embodiment the related journal parts value is a multi value binary property that is a list of identifiers that identify each of the related Journal Parts in the group. In one embodiment the related journal parts value is a list of Exchange Server Entry IDs that identity each of the related Journal Parts in the group.

More particularly in this embodiment the related journal parts value is a list of Exchange Server Entry IDs that identify each of the related Journal Parts having the same custom message ID value and the same message content as the current master copy. From CREATE CUSTOM RELATED JOURNAL PARTS MAPI PROPERTY operation processing transitions to a SUBMIT MASTER COPY FOR PROCESSING operation .

In SUBMIT MASTER COPY FOR PROCESSING operation the master copy is submitted for processing. For example the master copy is submitted for subsequent processing such as by a compliance or e discovery application or another selected application. From SUBMIT MASTER COPY FOR PROCESSING operation processing transitions to a NEXT JOURNAL PART IN CURRENT SET check operation .

In NEXT JOURNAL PART IN CURRENT SET check operation a determination is made whether there is a next journal part in the Current Set listing to process. In one embodiment if there is a next journal part in the Current Set listing to process YES processing transitions from NEXT JOURNAL PART IN CURRENT SET check operation and returns to SELECT JOURNAL PART AS MASTER COPY operation earlier described. Alternatively if there is not a next journal part in the Current Set listing to process NO from NEXT JOURNAL PART IN CURRENT SET check operation processing transitions to NEXT JOURNAL PART TO GROUP check operation earlier described. Thus in method each of the journal reports in the Current Set listing which have the same custom message ID are now sub grouped by message content with a corresponding master copy which identifies each of the related journal reports in the sub group.

In NEXT JOURNAL PART IN CURRENT SET check operation a determination is made whether there is a next journal part in the Current Set listing to process. In one embodiment if there is not a next journal part in the Current Set listing to process NO from NEXT JOURNAL PART IN CURRENT SET check operation processing transitions to operation earlier described. Alternatively in one embodiment if there is a next journal part in the Current Set listing to process YES processing transitions from NEXT JOURNAL PART IN CURRENT SET check operation to a SELECT JOURNAL PART operation .

In SELECT JOURNAL PART operation a journal part in the Current Set listing is selected for processing. Thus for example initially a first journal part in the Current Set listing remaining after removal of the master copy from the Current Set listing is selected. In subsequent processing of remaining journal parts in the Current Set listing if any a next journal part in the Current Set listing is selected for processing. From SELECT JOURNAL PART operation processing transitions to a COMPARE MESSAGE CONTENT operation .

In COMPARE MESSAGE CONTENT operation the message content of the selected journal part is read and compared to the message content of the master copy selected in operation .

In one embodiment the message content read of the journal report is compared to the message content of the master copy to determine whether or not the message contents match e.g. are substantially the same. Any of a variety of content comparison techniques can be utilized to determine whether or not the message content of the journal report is the same as the message content of the master copy.

For example if content is present in the message content of the master copy that is not present in the message content of the journal report the message contents do not match. As another example if content is present in the message content of the journal report that is not present in the message content of the master copy the message contents do not match. It can be appreciated by those of skill in the art that determination of whether or not content matches e.g. is substantially the same can be evaluated in accordance with a variety of methodologies. From COMPARE MESSAGE CONTENT operation processing transitions to a MATCH MASTER COPY check operation .

In MATCH MASTER COPY check operation a determination is made whether the message content of the journal report matches the message content of the currently selected master copy based on the comparison of operation . In one embodiment if the message content of the journal report does not match the master copy message content NO from MATCH MASTER COPY CONTENT check operation processing transitions and returns to NEXT JOURNAL PART IN CURRENT SET check operation . Alternatively if the message content of the journal report matches the master copy message content YES the journal report can be grouped with the master copy. From MATCH MASTER COPY check operation processing transitions to a RECORD EXCHANGE ENTRY ID operation .

In RECORD EXCHANGE MESSAGE ID operation the Exchange message ID for the journal part selected in operation is recorded. For example the Exchange message ID is recorded in a memory structure such as log or database. From RECORD EXCHANGE MESSAGE ID operation processing transitions to a REMOVE FROM CURRENT SET operation .

In REMOVE FROM CURRENT SET operation the journal part is removed from the Current Set listing. The journal part is now grouped with the master copy and is removed from the Current Set listing to prevent reprocessing. From REMOVE FROM CURRENT SET operation processing transitions to a MODIFY MESSAGE CLASS operation .

In MODIFY MESSAGE CLASS operation the message class value of the journal part is modified to prevent reprocessing. In one embodiment the message class value is modified to prevent reprocessing for identification and to prevent reprocessing for grouping as earlier described with reference to operation . From MODIFY MESSAGE CLASS operation processing transitions to NEXT JOURNAL PART IN CURRENT SET check operation earlier described.

Referring again to in one embodiment of the invention journal message grouping application is in memory . As used herein a computer memory refers to a volatile memory a non volatile memory or a combination of the two.

Although journal message grouping application is referred to as an application this is illustrative only. Journal message grouping application should be capable of being called from an application or the operating system. In one embodiment an application is generally defined to be any executable code. Moreover those of skill in the art will understand that when it is said that an application or an operation takes some action the action is the result of executing one or more instructions by a processor.

Embodiments in accordance with the present invention may be carried out using any suitable hardware configuration or means involving a personal computer a workstation a portable device or a network of computer devices. Other network configurations other than client server configurations e.g. peer to peer web based intranet internet network configurations are used in other embodiments.

Herein a computer program product comprises a medium configured to store or transport computer readable code in accordance with an embodiment of the present invention. Some examples of computer program products are CD ROM disks DVDs ROM cards floppy disks magnetic tapes computer hard drives and servers on a network. In another embodiment a computer program product comprises a tangible storage medium configured to store computer readable code including CD ROM disks DVDs ROM cards floppy disks magnetic tapes computer hard drives and servers on a network.

As illustrated in this medium may belong to the computer system itself. However the medium also may be removed from the computer system. For example journal message grouping application may be stored in memory that is physically located in a location different from processor . Processor should be coupled to the memory . This could be accomplished in a client server system or alternatively via a connection to another computer via modems and analog lines or digital interfaces and a digital carrier line.

More specifically in one embodiment host computer system and or server computer system is a portable computer a workstation a two way pager a cellular telephone a digital wireless telephone a personal digital assistant a server computer an Internet appliance or any other device that includes components that can execute the functionality of journal message grouping application in accordance with at least one of the embodiments as described herein. Similarly in another embodiment host computer system and or server computer system is comprised of multiple different computers wireless devices cellular telephones digital telephones two way pagers or personal digital assistants server computers or any desired combination of these devices that are interconnected to perform the methods as described herein.

In view of this disclosure the functionality of journal message grouping application in accordance with one embodiment of present invention can be implemented in a wide variety of computer system configurations. In addition the functionality of journal message grouping application could be stored as different modules in memories of different devices.

For example journal message grouping application could initially be stored in server computer system and then as necessary a portion of journal message grouping application could be transferred to host computer system and executed on host computer system . Consequently part of the functionality of journal message grouping application would be executed on processor of server computer system and another part would be executed on processor of host computer system . In view of this disclosure those of skill in the art can implement various embodiments of the present invention in a wide variety of physical hardware configurations using an operating system and computer programming language of interest to the user.

In yet another embodiment journal message grouping application is stored in memory of server computer system . Journal message grouping application is transferred over network to memory in host computer system . In this embodiment network interface and I O interface would include analog modems digital modems or a network interface card. If modems are used network includes a communications network and journal message grouping application is downloaded via the communications network.

This disclosure provides exemplary embodiments of the present invention. The scope of the present invention is not limited by these exemplary embodiments. Numerous variations whether explicitly provided for by the specification or implied by the specification or not may be implemented by one of skill in the art in view of this disclosure.

