---

title: System and method for approximating an editable surface
abstract: A system and methods are disclosed for automatically approximating an editable surface from a 3D data set or a 3D point set, which may be imaged in the form of a NURBS surface.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07576743&OS=07576743&RS=07576743
owner: Landmark Graphics Corporation, a Halliburton company
number: 07576743
owner_city: Houston
owner_country: US
publication_date: 20080122
---
This application is a continuation of U.S. patent application Ser. No. 11 118 027 filed on Apr. 29 2005 which claims the benefit of U.S. Provisional Patent Application Ser. No. 60 566 574 filed on Apr. 29 2004 which are both incorporated herein by reference. This application therefore claims the benefit of both applications.

The present invention generally relates to systems and methods for automatically approximating an editable surface from a 3D data set or 3D point set which may be imaged in the form of a NURBS surface.

Non Uniform Rational B Splines NURBS are industry standard tools for the representation and design of geometry. NURBS as explained by Markus Altmann in About Nonuniform Rational B Splines NURBS are used for a variety of reasons. They offer one common mathematical form for both standard analytical shapes e.g. conics and free form shapes. NURBS provide the flexibility to design a large variety of shapes and can be evaluated reasonably fast by numerically stable and accurate algorithms. They are invariant under affine as well as perspective transformations and are generalizations of non rational B Splines and non rational and rational Bezier curves and surfaces.

However one of the drawbacks of NURBS is the need for extra storage to define traditional shapes e.g. circles . This results from parameters in addition to the control points but will allow the desired flexibility for defining parametric shapes. NURBS shapes are not only defined by control points weights associated with each control point are also necessary. A NURBS curve C u for example which is a vector valued piecewise rational polynomial function may be defined as 

The knot vector uniquely determines the B Splines as demonstrated above relative to equation 2 . The relation between the number of knots m 1 the degree k of Nand the number of control points n 1 is given by m n k 1.

For NURBS the relative parametric intervals not spans need not be the same for all shape segments i.e. the knot spacing is non uniform leading to a non periodic knot vector of the form . . . 3 where a and b are repeated with multiplicity of k 1. The multiplicity of a knot affects the parametric continuity at this knot. Non periodic B Splines like NURBS are infinitely and continuously differentiable in the interior of a knot span and k M 1 times continuously differentiable at a knot where M is the multiplicity of the knot. In contrast a periodic knot vector U 0 1 . . . n is everywhere k 1 times continuously differentiable. Considering the knot vector for NURBS the end knot points t t with multiplicity k 1 coincide with the end control points P P.

Since the knot spacing could be non uniform the B Splines are no longer the same for each interval t t and the degree of the B Spline may vary. Considering the whole range of parameter values represented by the knot vector the different B Splines build up continuous overlapping blending functions N as defined in equation 2 over this range of parameter values which are illustrated in . These blending functions have the following properties 

The first and fourth properties as illustrated in together result in a convex hull. The polyline of control points build up to a shape defined by a NURBS curve. The second and third properties illustrate that k 1 successive control points define a shape segment and a control point is involved in k 1 neighboring shape segments. Therefore changing a control point or weight influences just k 1 shape segments defined over the interval given in equation 2 .

The previous definition of a NURBS curve in equation 1 may be rewritten using rational basis functions 

The rational basis functions have the same properties as the blending functions. One point to emphasize is their invariance under affine and even perspective transformations. Therefore only the control points have to be transformed to get the appropriate transformation of the NURBS shape.

NURBS can be evaluated effectively by using homogeneous coordinates. The following steps demonstrate one method to perform the evaluation 

As mentioned above changing the weight wof a control point Paffects only the range t t in case of a curve . The geometric meaning of the weights is illustrated in .

Defining the points 0 u w 1 and u wnot 0 1 . N and Bcan also be expressed as 1 1 where 1 . The following identity is obtained from the expression of a and b 1 1 which is called the cross or double ratio of the four points P B N B. From these expressions the effect of shape modification can be derived 

Various techniques have been attempted for creating a NURBS surface in different fields of art. For example International Publication No. WO 02 37422 and U.S. Pat. No. 6 765 570 incorporated herein by reference propose various techniques for the manual generation of editable NURBS surfaces used in analyzing and interpreting seismic events. Other conventional applications propose creating an editable NURBS surface using interpolation techniques well known in the art. Such techniques may be referred to as an exact fit approach to determining the editable surface. An exact fit approach is more likely to render a less uniform if not non uniform editable surface as compared to a best fit approximation of the editable surface. Moreover the exact fit approach to defining an editable NURBS surface may be impractical if not cost prohibitive for large 3D data sets often encountered in the analysis of seismic data.

Other conventional methods for converting unordered points to surfaces are generally described in Shepard D. A two dimensional interpolation function for irregular spaced data 1968 pp. 517 524 Proceedings 23ACM National Conference. One well known method for interpolating scattered points defines a surface value based on given points and weight functions. Although the result is relatively rough the fundamental idea has inspired many other methods.

Another well known method generally referred to as the Thin Plate Spline method has been incorporated in medical imaging applications and is capable of precisely guiding the target surface such that it passes through all given points. See Hardy R. L. Desmarrais R.N. Interpolation using surface spline 1972 pp. 189 197 Journal of Aircraft 9 and Dyn N. Interpolation in Scattered Data by Radial Functions 1987 pp. 47 61 In Chui C. K. Schumaker L. L. Ultreres F. I. ed Topics in Multivariate Approximation. However this technique requires the inversion of large matrices which is computationally expensive and generally impractical for a large number of input points that may only require a best fit approximation.

Another conventional method for converting a point cloud to a surface is described in Hoppe H. et al. Surface Reconstruction from Unorganized Points 1992 pp. 71 78 Comput. Graph. 26. However this method assumes that the input points are evenly distributed over the entire domain which is also impractical for input points that are densely populated in some areas and non existent in other areas.

A need therefore exists for automatically approximating an editable surface from a 3D data set or 3D point set comprising a large volume of unordered and or unstructured data points which may be imaged in the form of an editable NURBS surface.

The present invention meets the above needs and overcomes one or more deficiencies in the prior by providing systems and methods for automatically approximating an editable surface from a 3D data set or a 3D point set that may comprise a large volume of unstructured and or unordered data points.

In one embodiment the present invention includes a system for approximating an editable surface from a 3D data set comprising a computer readable memory medium configured to store a program of instructions capable of being executable to implement i selecting a point set from the 3D data set ii determining a best fit plane for the point set iii projecting at least a portion of the point set on to the best fit plane iv determining a boundary for the best fit plane according to the projected point set v projecting a grid on to the best fit plane within the boundary the grid containing a plurality of grid points vi initializing the grid points vii determining a value for at least a portion of the grid points viii selecting at least a portion of the grid points with a value and ix imaging the editable surface using at least a portion of the selected grid points.

In another embodiment the present invention includes a system for approximating an editable surface from a 3D point set comprising a computer readable memory medium configured to store a program of instructions capable of being executable to implement i determining a best fit plane for the point set ii projecting the point set on to the best fit plane iii determining a boundary for the best fit plane according to the point set iv projecting a grid on to the best fit plane within the boundary the grid containing a plurality of grid points v initializing the grid points to zero vi determining a value for the grid points vii refining the value for at least a portion of the grid points viii selecting at least a portion of the grid points based on one of the value and the refined value and ix imaging the editable surface using the selected grid points the editable surface representing a best fit approximation of the point set to the editable surface.

In another embodiment the present invention includes a method for approximating an editable surface from a 3D data set comprising the steps of i selecting a point set from 3D data set ii determining a best fit plane for the point set iii projecting at least a portion of the point set on to the best fit plane iv determining a boundary for the best fit plane according to the projected point set v projecting a grid on to the best fit plane within the boundary the grid containing a plurality of grid points vi initializing the grid points vii determining a value for at least a portion of the grid points viii selecting at least a portion of the grid points with a value and ix imaging the editable surface using at least a portion of the selected grid points.

In yet another embodiment the present invention includes a method for approximating an editable surface from a 3D point set comprising the steps of i determining a best fit plane for the point set ii projecting a point set on to the best fit plane iii determining a boundary for the best fit plane according to the point set iv projecting a grid on to the best fit plane within the boundary the grid containing a plurality of grid points v initializing the grid points to zero vi determining a value for the grid points vii refining the value for at least a portion of the grid points viii selecting at least a portion of the grid points based one of the value and the refined value and ix imaging the editable surface using the selected grid points the editable surface representing a best fit approximation of the point set to the editable surface.

These and other objects features and advantages of the present invention will become apparent to those skilled in the art from the following description of the various embodiments and related drawings.

The subject matter of the present invention is described with specificity however the description itself is not intended to limit the scope of the invention. The claimed subject matter thus might also be embodied in other ways to include different steps or combinations of steps similar to the ones described herein in conjunction with other present or future technologies. Moreover although the term step may be used herein to connote different elements of methods employed the term should not be interpreted as implying any particular order among or between various steps herein disclosed unless and except when the order of individual steps is explicitly described.

The present invention provides an improved system and method for analyzing 3D data sets and or 3D point sets. The invention may be described in the general context of a computer executable program of instructions such as program modules being executed by a computer. Generally program modules include routines programs objects components data structures etc. that perform particular tasks or implement particular abstract data types. Moreover those skilled in the art will appreciate that the invention may be practiced with a variety of computer system configurations including hand held devices multiprocessor systems microprocessor based or programmable consumer electronics minicomputers mainframe computers and the like. Any number of computer systems and computer networks are acceptable for use with the present invention. The invention may be practiced in distributed computing environments where tasks are performed by remote processing devices that are linked through a communications network. In a distributed computing environment program modules may be located in both local and remote computer storage media including memory storage devices. The computer useable instructions form an interface to allow a computer to react according to a source of input. The instructions cooperate with other code segments to initiate a variety of tasks in response to data received in conjunction with the source of the received data.

The present invention may therefore be implemented using hardware software or a combination thereof in a computer system or other processing system. is a block diagram illustrating one embodiment of a software program for implementing the present invention. At the base of program is an operating system . A suitable operating system may include for example a Windows operating system from Microsoft Corporation or other operating systems as would be apparent to one of skill in the relevant art.

Menu and windowing software overlays operating system . The menu and windowing software are used to provide various menus and windows to facilitate interaction with the user and to obtain user input and instructions. As would be readily apparent to one of skill in the relevant art any number of menu and windowing software programs could be used in conjunction with the present invention.

A basic graphics library overlays the menu and windowing software . The basic graphics library is an application programming interface API for computer graphics. The functions performed by the basic graphics library may include for example geometric and raster primitives RGBA or color index mode display list or immediate mode viewing and modeling transformations lighting and shading hidden surface removal alpha blending translucency anti aliasing texture mapping feedback and selection stencil planes and accumulation buffer.

A rendering application overlays basic graphics library . As will be understood by those skilled in the art the rendering application may include a suite of tools for 2D 3D seismic data interpretations including interactive horizon and fault management 3D visualization and attribute analysis. For example Landmark Graphics Corporation s SeisVision platform is a seismic rendering application appropriate for use with the present invention.

Overlaying the other elements of program is an approximation module . The approximation module is configured to interact with 3D data sets representing predetermined objects such as for example horizons and faults or 3D point sets comprising arbitrary and or unstructured data points. In a manner generally well known in the art the approximation module interfaces with and utilizes the functions carried out by the rendering application the basic graphics library the menu and windowing software and the operating system . The approximation module may be written in an object oriented programming language such as for example C to allow the creation and use of objects and object functionality.

The program illustrated in may be executed or implemented through the use of a computer system incorporating the program and various hardware components. The hardware components may include for example a processor memory e.g. random access memory and or non volatile memory devices one or more input devices one or more display devices and one or more interface devices. These hardware components may be interconnected according to a variety of configurations. Non volatile memory devices may include for example devices such as tape drives disk drives semiconductor ROM or EEPROM. Input devices may include for example devices such as a keyboard a mouse a digitizing pad a track ball a touch sensitive pad and or a light pen. Display devices may include for example devices such as monitors projectors and or head mounted displays. Interface devices may be configured to require digital image data from one or more acquisition devices and or from one or more remote computers or storage devices through a network.

Any variety of acquisition devices may be used depending on the type of object being imaged. The acquisition device s may sense various forms of mechanical energy e.g. acoustic energy displacement and or stress strain and or electromagnetic energy e.g. light energy radio wave energy current and or voltage .

A processor may be configured to reprogram instructions and or data from RAM and or non volatile memory devices and to store computational results into RAM and or non volatile memory devices. The program instructions direct the processor to operate on 3D data sets and or 3D point sets based on the methods described herein. The input data may be provided to the computer system through a variety of mechanisms. For example the input data may be acquired into non volatile memory and or RAM using one or more interface devices. As another example the input data may be supplied to the computer system through a memory medium such as a disk or a tape which is loaded into onto one of the non volatile memory devices. In this case the input data will have been previously recorded onto the memory medium.

It is noted that the input data may not necessarily be raw sensor data obtained by an acquisition device. For example the input data may be the result of one or more processing operations using a set of raw sensor data. The processing operation s may be performed by the computer system and or one or more other computers.

The method of the present invention may be realized in one or more software programs or modules which are stored onto any of a variety of memory media such as CD ROM magnetic disk bubble memory semiconductor memory e.g. any of a various types of RAM or ROM . Furthermore the software program s and or their results may be transmitted over a variety of carrier media such as optical fiber metallic wire free space and or through any of a variety of networks such as the internet.

In for example a 3D data set may comprise any predetermined object such as for example geoanomalies geobodies horizons faults and or other surfaces or any 3D point set comprising arbitrary and or unstructured data points. The 3D data set may be converted to a 3D point set if necessary. The entire 3D point set or a portion thereof may be selected from the converted 3D data set before being processed by the approximation module to yield an image of an editable surface.

Referring now to a method for approximating an image of an editable surface from a 3D data set or a 3D point set is illustrated.

In step a 3D data set may be used to input predetermined objects or 3D point sets comprising arbitrary and or unstructured data points.

In step an object may be selected from the 3D data set such as for example geoanomalies geobodies horizons faults and or other surfaces. Such objects may be predetermined using a number of imaging techniques well known in the art.

In step the selected object is converted to a 3D point set using conversion techniques well known in the art. The converted 3D point set comprises arbitrary and or unstructured data points corresponding with the initial data points comprising the initial input 3D data set. The 3D point set therefore may comprise arbitrary and or unstructured data points forming an arbitrary surface.

In step a 3D point set may be selected from the initial input 3D data set step or the converted 3D point set step which may comprise all of the data points from the initial input 3D data set or a portion thereof. Thus the selected 3D point set comprises arbitrary and or unstructured data points corresponding with at least a portion of the initial data points comprising the initial 3D data set.

In step the 3D point set selected in step is analyzed to determine if it contains a dominant long axis. If a dominant axis can be determined for the 3D point set then the next step is unnecessary. For certain predetermined objects selected in step a dominant axis may be readily apparent to one skilled in the art.

In step an ellipsoid is fit to the 3D point set point cloud illustrated in by programming means well known in the art. The 3D point set is represented by data points . The ellipsoid includes three cardinal axes which may be denoted by the long axis the middle axis and the short axis . In the case of a perfect circle however all three of the cardinal axes will have the same length. The short axis vector of the ellipsoid is compared against the world coordinate axes x y z to determine the primary direction of a best fit plane and therefore which of the following three representations should be used for determining a best fit plane in step 

In step the best fit plane is determined by using a least squares approximation to achieve a best fit plane equation. For example let The matrix of n data points comprising the 3D point set such that 

In step at least a portion of the data points comprising the 3D point set are projected onto the best fit plane illustrated in by programming means well known in the art. The more data points that are projected onto the best fit plane the more accurate the results will be. Nevertheless the number of data points projected onto the best fit plane may be determined as a matter of preference. The data points projected onto the best fit plane are illustrated as projected data points . The projected data points may be represented in a parametric form z f x y where x y z denote the orthogonal coordinate system of the best fit plane wherein x and y are aligned with the best fit plane and z is perpendicular to the best fit plane .

In step boundaries for the best fit plane are determined according to data point extremes meaning the outermost projected data points . In the best fit plane is illustrated with boundaries that are evident from the outermost projected data points .

In step a grid is projected onto the bounded best fit plane illustrated in by programming means well known in the art. The grid projected onto the best fit plane may be represented by N M where N and M are predetermined grid parameters. The predetermined grid parameters N M may be the same N M or different N M .

In step each grid point defined by an intersection on the grid illustrated in is initialized preferably to zero. In this manner a grid point value may be determined for each grid point illustrated in .

In step the value for each grid point illustrated in may be determined by scanning for projected data points within a predetermined area A. The more grid points that are valued the more accurate the results will be. Nevertheless the number of grid points to be valued may be determined as a matter of preference. The predetermined area A may comprise the entire set of projected data points in the best fit plane or a subset thereof. The predetermined area A may be represented by a preferred cell node count corresponding with the spaces on the grid. For example a preferred cell count of 16 may be represented as the 4 4 predetermined area A in . Alternatively a preferred cell count of 16 may be represented as a 2 8 predetermined area.

For each projected data point within the predetermined area A a data point value E is identified and recorded with a corresponding distance d to the grid point illustrated in . The grid point value G for the grid point may be determined by the following normalized contribution formula 

In step the grid point values may be refined in the manner described in reference to steps through once all of the grid point values G have been determined.

In step the grid density is increased e.g. doubled and new grid point values G for the new grid points are linearly interpolated between the former grid points using the former grid point values G and interpolation techniques well known in the art.

In step multiple new best fit planes are determined using the equations described in reference to step and a predetermined area which may be the same predetermined area A illustrated in . In other words at each projected data point a new best fit plane is determined calculated to fit the projected data points and the new grid points within the surrounding predetermined area. In for example x represents the incremental increase in grid density compared to previous grid spacing. A new best fit plane therefore passes through the projected data point A and new grid point A within the surrounding predetermined area. A new best fit plane likewise passes through projected data point B and new grid point B within the surrounding predetermined area. This step improves the accuracy of the interpolation performed in step and determines a new best fit plane for each projected data point .

In step the interpolated new grid point values G may be reevaluated by replacing each interpolated new grid point value within the predetermined area with a reevaluated new grid point value based on the weighted average of the value for all new grid points that intersect a new best fit plane that passes through the predetermined area and a projected data point within the predetermined area. In for example the reevaluated value for new grid point may be determined by replacing its previously interpolated new grid point value with the weighted average of the value for new grid points A B that intersect the new best fit planes respectively that pass through the predetermined area and contain the projected data points A B respectively.

In step a Gaussian kernel may be applied to each of the reevaluated new grid point values in order to smooth the resulting reevaluated new grid point values so that they have a more natural continuity. The Gaussian smoothing of the reevaluated new grid point values may be performed in a manner well known in the art. Various modifications to the Gaussian process of smoothing may be apparent to those skilled in the art and applied as necessary to improve the smoothing process described herein.

In step at least a portion of the reevaluated new grid point values may be further refined by returning to step and repeating some or all of the steps described thus far. Upon reiterating step however the predetermined area A is incrementally reduced by a factor of one such that the surrounding predetermined area to be considered may be represented as 4 1 4 1 . If however the reevaluated new grid point values are not refined then the process proceeds to step . Likewise if the grid point values are not refined according to step the process may proceed directly to step .

In step the grid point values and or reevaluated new grid point values may be sampled for control points. The sampling process simply selects the last iteration of the process described in reference to step such that the last value determined may be selected as a control point. In for example the best fit plane may include multiple values for grid point that may be represented as G G G. . . G. Similarly grid points and for example may have multiple values. Accordingly the last determined value for each grid point may be sampled selected in whole or in part to produce a set of control points for approximating an editable NURBS surface at any arbitrary resolution.

In step the editable surface may be imaged rendered using at least a portion of the selected control points and the rendering techniques generally known for creating a NURBS surface. The more control points that are used to image the editable surface the more accurate the results will be. In other words a more accurate best fit approximation of the editable surface is possible based on the number of selected control points that are used. Nevertheless the number of control points that are used to image the editable surface may be determined as a matter of preference.

In for example the input data points and editable surface are simultaneously imaged to illustrate the spatial relationship between the data points that may be used as input at step to approximate the editable surface . The data points comprise seismic data that represent a predetermined object editable surface curves which may be manually generated in the manner described generally in International Publication No. WO 02 37422 and or U.S. Pat. No. 6 765 570. The output resolution may be refined according to various well known seismic rendering techniques as necessary or preferred.

In the image in has been edited to illustrate a portion of the data points and the corresponding editable surface which may be used for interpreting seismic events.

In the data points have been removed to reveal only the editable surface which may also be used for interpreting seismic events.

The present invention therefore may be applied to the geophysical analysis of seismic data. Moreover the present invention may be integrated with one or more system components described in reference to International Publication No. WO 02 37422 and or U.S. Pat. No. 6 765 570 for creating an editable surface from a plurality of seismic data points that may include for example x y z coordinates and a data value representing a predetermined object such as for example a horizon or a fault. The seismic image automatically rendered as a result of the present invention represents an editable NURBS surface which may be interactively edited and manipulated and which may lower the signal to noise ratio represented by the input data points compared to conventional techniques used to generate a NURBS surface.

The present invention however may also be applied to other types of 3D data sets such for example medical data and engineering data. It is therefore contemplated that various situations alterations and or modifications may be made to the disclosed embodiments without departing from the spirit and scope of the invention by defined by the appended claims and equivalents thereof.

