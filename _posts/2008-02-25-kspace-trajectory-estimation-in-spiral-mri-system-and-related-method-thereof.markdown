---

title: K-space trajectory estimation in spiral MRI system and related method thereof
abstract: First, benchmark data are collected on two thin slices of an object to get measured k-space trajectories. To find delays on different physical gradients, the root mean square error between estimated and measured k-space trajectories is minimized for different delays. To reduce the error further, an eddy current compensation is introduced along each physical gradient axis. A more accurate estimation of the k-space trajectory can be obtained to image the object.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07888935&OS=07888935&RS=07888935
owner: University of Virginia Patent Foundation
number: 07888935
owner_city: Charlottesville
owner_country: US
publication_date: 20080225
---
The present application claims the benefit of U.S. Provisional Patent Application No. 60 903 143 filed Feb. 23 2007 whose disclosure is hereby incorporated by reference in its entirety into the present disclosure.

The work leading to the present invention was supported by NIH Grant No. R01 HL079110. The government has certain rights in the invention.

The present invention is directed to magnetic resonance MR imaging and more specifically to k space trajectory estimation using an anisotropic gradient delay model.

For non 2DFT data acquisition in MRI k space trajectory infidelity due to eddy current effects and other hardware imperfections will blur and distort the reconstructed images. Even with the shielded gradients and eddy current compensation techniques of current scanners the deviation between the actual k space trajectory and the requested trajectory remains a major reason for image artifacts in non Cartesian MRI. Techniques have been proposed to measure the k space trajectory in order to correct for gradient imperfections. However it is usually not practical to measure the k space trajectory for each imaging slice.

In MR data acquisition eddy currents introduced by gradient coils produce an additional field that tends to prevent the gradient field from changing. To reduce the eddy current effect manufacturers have active shielding and pre emphasis filters in current scanners to eliminate most of the errors. However the residual error can still cause severe image artifacts especially in non Cartesian scanning such as radial and spiral imaging. Eddy currents are typically classified as Beddy currents or linear eddy currents based on their spatial dependence. Beddy currents cause unwanted phase modulation while linear eddy currents distort the k space trajectory. There are many ways to measure the linear term including using the phase difference of two measurements measuring the current through the gradient coil directly and using a special phantom to measure the k space trajectory. Aside from uncompensated eddy current effects leading to distortions of the gradient waveform shape another significant problem is small timing delay errors arising in the hardware. These anisotropic timing delays exist between the application of a gradient waveform to the gradient amplifiers and the subsequent response of the gradient coils. There are also frequency demodulation delays.

Here we introduce a simple and effective model to estimate the k space trajectory in spiral image reconstruction with the measured k space trajectory as the goal. The root mean square error RMSE and peak error in phantom images reconstructed using the proposed method are reduced substantially compared to the results achieved by only tuning delays.

In order to get better quality reconstructions in spiral MRI we introduce a k space trajectory estimation method based on an anisotropic gradient delay model with additional eddy current compensation. The phantom images reconstructed using this method in two datasets collected 48 days apart have a much smaller RMSE and peak error compared with the results using delay only model.

A preferred embodiment of the present invention will now be set forth in detail with reference to the drawings.

First we collect data on two thin slices offset symmetrically around isocenter for coronal sagittal and transverse views. The Beddy currents are then measured using the method proposed by Gurney et al. P. Gurney J. Pauly D. G. Nishimura a simple method for measuring B0 eddy currents Proc. ISMRM 13 866 2005 and deducted from the corresponding phase term. Dividing the corrected signal phase by the slice distance we get the measured k space trajectories Kin each view for calibration purposes. Dividing the corrected signal phase by the slice distance we get the actual k space trajectories Kon each physical gradient axis in each view as follows for calibration purposes 4 

where P are the phase terms in two symmetrical slices g are the gradient waveform to be tested and its inverted version D is the distance between the offset slice and isocenter. Using these measured k space trajectories we perform gridding reconstruction to get the benchmark images. A second dataset on some oblique slices was collected after 48 days in order to test the proposed method.

To find the delays on different physical gradients we conduct a 2D search for the minimum RMSE between the images reconstructed using different delays and the benchmark for each view. With the optimum delays on each physical gradient axis we have the first guess of the k space trajectory K. For an arbitrary imaging slice we can compensate the isotropic delay with the knowledge of the rotation matrix similar to the equations in Peters D C Derbyshire J A McVeigh E R. Centering the projection reconstruction trajectory reducing gradient delay errors. Magn Reson Med 50 1 6. 2003 as the following. 1 

where Gis the final logical gradients for image reconstruction program to calculate the k space trajectory. R is the rotation matrix transforms a logical gradients vector into a physical gradient vector. T is the delay operator that applies different delays on each physical gradient axis. G ggg is the physical gradient vector associated with the requested logical gradient vector G ggg i.e. G RG. With the delayed logical gradient vector G we can integrate it on each axis to get the k space trajectory K.

However the k space trajectory difference K K Kis still large and the images using this delay model have significant residual error. In order to reduce the deviation between the modeled k space trajectory and the actual measured k space trajectory we introduce an additional eddy current compensation term on each physical gradient axis. In a simple eddy current model the eddy current g t can be estimated by the convolution of the slew rate s t dG dt of the desired gradient waveform and the system impulse response function H t as the following.

where u t is the unit step function. Therefore we can treat the difference between the measured k space trajectory and the k space trajectory from the delay model as the residual eddy current to be accounted for using the simple model. For each exponential term e t au t exp t b in H t if we only consider the first order Taylor expansion i.e. e t au t 1 t b the convolution can be simplified to the following expression.

Using the discretized version of the above equation we can get a 3 by N vector K cumsum G for each physical gradient where G G t G t t s t t and N is the number of k space samples in one spiral interleaf cumsum is a Matlab function The MathWorks that calculates the cumulative sum of array elements. Then we can get a vector a a1 bc b by using weighted least squares WLS to fit the k space difference K to Kon each physical gradient axis where c is a constant related to the sampling time. In fact you can also fit the derivative of K to Gif you are more interested in the actual gradients. It is also interesting to note that we have many choices here to use the fitting result for future calibration. The first choice would be to use an impulse function H t with only one exponential term ignoring any additional exponential terms. The second choice would be to combine the last two parameters together since they are only different by a constant scale. The last option is to use is the full correction to give the system more freedom. Though the last two methods should lead to the same result theoretically it turned out they do not because of noise. So we chose the last one here for simplicity though we might return to the first one with a different fitting target function in the future. Thus no matter how many exponential terms are in H t we should be able to get rid of the first order eddy current effect by applying these parameters on each physical axis. For an arbitrary scan slice the logical k space trajectory vector for image reconstruction can be derived as the following. 5 

The above will be summarized with reference to the flow charts of for model estimation using calibration data from coronal sagittal and transverse views and for k space trajectory estimation for an arbitrary imaging slice using the proposed model. The calibration of and the imaging of can be done on the same object or on different objects. Usually one can calibrate once for a given scanner and the object in the scanner at the time of the calibration is a phantom e.g. a bottle of water . A person could be used as well. Then the model is calculated and the parameters are stored. The model is then applied each time the scanner is used for imaging subsequently.

In step calibration data are taken on coronal sagittal and transverse views. In step theoretical k space trajectories with different delays are determined and then gridded to produce bench images Iin step . In parallel in step an actual k space trajectory Kis measured and then gridded to produce a goal image I. In step the RMSE between the bench and goal images is determined. Through a 2D search for a minimum RMSE the delay model Kis determined. In step a residual error in the k space trajectory is calculated as a difference between the measured trajectory and the delay model. A least square fit is used to derive the eddy current model in step and the delay model and the eddy current model are summed in step to yield the estimated k space trajectory.

In step data are taken on any oblique slice with a rotation matrix. In step the theoretical k space trajectories are determined on each physical axis. The delays are applied to yield the delayed trajectory on each physical axis Kin step . In step the theoretical slew rate is determined and in step the eddy current model is derived in step . In step the delayed trajectory and the eddy current model are added to provide the estimated k space trajectory. In step the estimated trajectory on each logical axis is determined. In step the final image is determined.

We applied our algorithm and related method and system to two data sets acquired using a gradient echo spiral scan with field map correction. The first dataset is used for calibration which was acquired more than one month before the second dataset on the same Siemens Avanto 1.5 T scanner Siemens Medical Solutions . The readout for each slice was done with 16 interleaved spirals each of 16.38 ms readout duration. The samples within the first two interleaves of the readouts were used to estimate the field map. The reconstructed image matrix was 512 by 512. The distance between the slice to the isocenter in the first dataset is 50 mm and the field of view FOV is 280 mm with slice thickness 0.9 mm. The delays and additional gradient compensation parameters were estimated on the first dataset and applied to the second dataset.

In we show the reconstruction results using the same delay 29.5 s on all axes. These figures show the coronal view results using a single delay on both axes RMSE 21.142 for a phantom image and a difference image respectively. The residual error is surprisingly high and has to be corrected. So we perform a 2D search for the minimum RMSE on each slice the results are in Table 1 below. The delays on the same physical gradient from different slices are exactly the same by this method except the physical Y gradient.

In we show the RMSE in the k space trajectory for kx and ky respectively by using the proposed method and the delay only model in the coronal view. The RMSE is reduced to less than 85 on X axis and 55 on Y axis.

In the difference between the benchmark and images reconstructed using both models are shown in three different views from the calibration data set. are for the delay model for an RMSE of 9.671 12.204 and 13.452 respectively. are for the preferred embodiment for an RMSE of 7.914 9.454 and 9.410 respectively.

In difference images on three oblique slices from the second dataset are shown. These figures are difference images between benchmark and reconstruction using the delay model and the preferred embodiment on three oblique slices oriented 30 45 and 60 degrees between transverse and sagittal orientations. The RMSE for is 12.432 11.694 10.711 9.216 8.988 and 8.286 respectively. It is very clear the preferred embodiment yields a more accurate reconstruction with smaller RMSE and peak error compared with the delay only model.

We measured significant gradient delay asymmetry causing severe image artifacts as in . In order to reduce the artifacts from the k space trajectory infidelity we proposed an estimation method which combines tuning the delays on different physical gradient axis and an additional eddy current compensation model. We tested the method on phantom image reconstruction using two data sets acquired with a spiral gradient echo sequence. From the difference images in and we can see the residual errors around the phantom edges are much smaller using the preferred embodiment. The RMSE and peak difference have been reduced substantially as well. Furthermore there is little time penalty for using this method after the one time system calibration.

An example of hardware on which the present invention can be implemented is shown in . The hardware includes a scanner a processor and an output such as as a display.

While a preferred embodiment of the present invention has been set forth in detail above those skilled in the art who have reviewed the present disclosure will readily appreciate that other embodiments can be realized within the scope of the invention. For example numerical values are illustrative rather than limiting as are examples of specific technologies and sources. Therefore the present invention should be construed as limited only by the appended claims.

