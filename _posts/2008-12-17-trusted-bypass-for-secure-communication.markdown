---

title: Trusted bypass for secure communication
abstract: A device having an encryption module in communication with first and second communication ports may facilitate connecting to an access network, without requiring a non-secure hard drive to initiate the network access. The encryption module may define a normal mode and a bypass mode. In normal mode, data from the first port may be sent encrypted to the second port, for communicating securely in an encrypted environment. In bypass mode, data from the first port may be sent unencrypted to the second port. The data being sent may be intercepted and presented to the user for approval in a human readable format. The user may confirm that the data is appropriate for being sent unencrypted. This data may be sent unencrypted in response to a request for information (e.g., an assent to terms and conditions) from the access network, such as at a hotel or public wireless hotspot, for example.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08316228&OS=08316228&RS=08316228
owner: L-3 Communications Corporation
number: 08316228
owner_city: New York
owner_country: US
publication_date: 20081217
---
The present invention was supported by the National Security Agency under Contract Numbers MDA 904 02 C 1152 and CCEP 056 04. The government may have certain rights in the invention.

Network access providers often present terms and conditions that a user must accept prior to gaining access to a network. For example a user may wish to connect to a Wireless Fidelity Wi Fi hot spot or an Ethernet access point. Initially the user may request a webpage via Hyper Text Transport Protocol HTTP . Instead of providing the requested webpage the network access provider may respond with a terms and conditions webpage that presents the requirements for accessing the network. The requirements may include clicking a checkbox that indicates that the user agrees to the terms and conditions and clicking a submit button to send the data to the network access provider. The requirement may include payment of a service fee or provision of a username password combination. Once the user has satisfied the requirements the network access provider may allow subsequent access to the network.

This process presents a problem to users that wish to access a virtual private network VPN via the network access provider. The VPN may follow a security policy that does not allow for the initial insecure transaction with the network service provider. For example the user s VPN software or hardware may not allow the transfer of the unencrypted data necessary to meet the requirements of the terms and conditions.

For example the user s device may be a Type 1 product. A Type 1 product may include cryptographic equipment assemblies or components classified or certified by the National Security Agency NSA for encrypting and decrypting classified and sensitive national security information. Generally Type 1 products may be used to protect systems requiring the most stringent protection mechanisms. To securely accept the terms and conditions the user may have to first boot with an unclassified hard drive accept the terms and conditions shutdown the device and then reboot with the classified hard drive to connect to the VPN. This cumbersome technique is inefficient because it requires booting the device more than once and physically swapping computer hardware. Moreover the technique may be completely ineffective if the user does not have the unclassified hard drive available.

The device disclosed herein may facilitate efficient and secure network access. This approach may enable network access with a secure hard drive and or laptop without requiring a non secure hard drive and or laptop to initiate the network access.

The device may include an encryption module in communication with a first port and a second port. The encryption module may be a Type 1 encryption module. The encryption module may define a first mode e.g. normal mode and a second mode e.g. bypass mode . In the first mode data from the first port may be sent encrypted to the second port. Thus in the first mode the device may communicate securely in an encrypted environment.

In the second mode data from the first port may be sent unencrypted to the second port. The data being sent may be intercepted and presented to the user for approval. The presented data may be converted to a human readable format. The presented data may be shown without hidden characters and or data fields. Accordingly the user may be confident that the data being displayed is what will be sent unencrypted. The user may confirm that the data is appropriate for being sent unencrypted e.g. that no sensitive information is improperly included in the data . The user may approve or decline the presented data.

Thus the second mode may facilitate connectivity to an access network such as a wireless network access point for example. To illustrate the user may place the encryption module into the bypass mode. The encryption module may initiate a dummy Hyper Text Transfer Protocol HTTP session. Data indicative of a request for assent to conditions for network access may pass from an access network via the second port to the first port. In response the user may consider the conditions and or indicate assent. For example the user may enter information select an option click a submit or accept button and or the like. Data associated with the user s indication may made be made ready to be sent to the access network. The encryption module may intercept the data and present it to the user. If the user approves the data may be sent unencrypted a record of the transaction may be logged and or the transaction may result in network connectivity with the access network. The user may place the device into a normal mode in which data may be encrypted for secure communication.

The resource may be in communication with the private network . The private network may be a local area network LAN a metropolitan area network MAN a wide area network WAN a wireless LAN WLAN and or the like. Access to and use of the private network may be restricted to authorized users. For example the private network may be administered by a private organization or a public entity such as a government agency. Also for example the private network may support the transfer of classified or sensitive information.

A VPN server may be in communication with the private network . The VPN server may provide a gateway between the VPN and the private network . The VPN server may be in communication with a public network . The public network may be any system subsystem or component suitable for transferring data. The public network may be the internet core network service provider wide area network and or the like. The VPN server may include security policies that may define the characteristics of the VPN . The VPN server may be in communication with a encryption device to establish the VPN .

The VPN may be a secure connection established between an encryption device and the VPN server . The VPN may enable secure communication between the computer and the resource . In one embodiment the VPN may define a information systems link utilizing tunneling security controls and endpoint address translation that may give the impression of a dedicated line. In one embodiment the VPN may use security protocols to provide confidentiality authentication and data integrity. For example the security protocols may include IP security IPsec protocol Secure Sockets Layer Transport Layer Security SSL TLS OpenVPN Point to point tunneling protocol PPTP High Assurance Internet Protocol Encryptor HAIPE Internet Security Association and Key Management Protocol Internet Key Exchange ISAKMP IKE and the like. The security protocol may include tunneling that encapsulates the data communicated between the VPN server and the encryption device .

The encryption device may access the public network via an access network . The access network may provide communications between the Encryption device and the public network for communications to the VPN server . Like the public network the access network may be any system subsystem or component suitable for transferring data. For example the access network may be wired or wireless. The access network may be a LAN MAN WAN WLAN Global System for Mobile Communications GSM personal area network PAN dial up modem access and the like. The access network may employ network technologies such as Ethernet WiFi Bluetooth and the like. The access network may be administered by an administrator. For example the access network may be administered by a hotel a business center an airport a public library a network service provider a coffee shop and or the like.

The administrator may define an access policy related to the access network . The access policy may include one or more conditions for access. The conditions for access may require that a user of the access network assent to legal terms and conditions. For example the legal terms and conditions may provide a description of the network access service to be provided general use restrictions details about charges billing and payment a statement of the operational limits of the service a statement regarding registration customer information and password security a third party content disclaimer a disclaimer of warranties a statement of limited liability a statement concerning local laws and export controls contractual clauses such as choice of law force majeure and severability an acceptable use policy a statement regarding trademarks digital millennium copyright notices contact information and or the like.

The conditions for access may require that the user create an account with the administrator and provide payment for use of the access network . For example the conditions may require a username password combination that corresponds to an existing account. Also for example the conditions may require a form of payment such as a credit card account deposit account escrow account and the like. Also for example the conditions may require some identification or demographic information from the user such as a name address room number birth date e mail address and the like.

The access policy may be enforced by a gatekeeper . The gatekeeper may grant or deny the availability of the access network to a user in accordance with the access policy. The gatekeeper may be a computer server router network appliance and the like. The gatekeeper may provide authorization and network access functions associated with the access network . The gatekeeper may include a web server that redirects an initial Hyper Text Transport Protocol HTTP request from the computer . The gatekeeper may provide an entry webpage that presents the conditions for access. Once the user has satisfied the conditions the gatekeeper may allow use of the access network .

To illustrate the user of the computer may be in a hotel and may wish to use the LAN owned and administered by the hotel to establish a VPN between the Encryption device and the VPN server . When the user connects to the hotel s LAN the gatekeeper may present the user with a webpage that includes the hotel s terms and conditions of use associated with the access to public network via access network . The user may assent to these terms and conditions before being granted access to the public network via access network . For example the user may submit a form in connection with the webpage to the gatekeeper . The gatekeeper may determine that the user s submission satisfies the conditions and may allow the computer to communicate with the access network . Via the access network the encryption device may establish a VPN between the encryption device and the VPN server .

In a classified environment the secure side may be may be known as the red side and the non secure side may be known as the black side. The red designation may apply to systems devices areas circuits components equipment and the like in which unencrypted national security information is being processed. The black designation may apply to systems devices areas circuits components equipment and the like in which national security information is encrypted or is not processed.

Generally user data originating on the secure side of the encryption device may pass to the non secure side in an encrypted form. Encrypted and unencrypted user data originating on the non secure side of the encryption device may pass to the secure side of the encryption device . Thus the information stored in connection with the computer s operating system i.e. in communication with the secure side See may be prevented from disclosure in an unencrypted form.

When assenting to terms and conditions presented by the gatekeeper the encryption module may pass the unencrypted data relating to the terms and conditions from the second communications port to the first communications port . The encryption module may define a normal mode and a bypass mode. In the normal mode user data from the first communications port may be encrypted and sent to the second communications port . The normal mode may represent typical operation of the encryption device . The normal mode may provide secure communications of encrypted data over a VPN . In bypass mode user data from the first communications port may be unencrypted and sent to the second communications port . The bypass mode may provide limited unencrypted communications. The bypass mode may be used to facilitate reviewing and or responding to conditions for network access.

When the VPN connection is established between the encryption device and the VPN server information associated with the secure side may pass through the encryption device via the VPN to the VPN server . Encrypted data may pass from the secure side to the non secure side via the encryption device . Likewise unencrypted data originating at or behind the VPN server may pass via the VPN and the encryption device from the non secure side to the secure side .

The encryption device may define a demarcation between a secure side and a non secure side of the device . The encryption device may be any component system or subsystem suitable for enforcing data transfer rules and establishing a secure connection with the VPN server . The device may include one or more processors for handling logic and data manipulation. The processors may be microprocessors digital signal processors application specific integrated circuits and the like. For example the encryption device may implement an IP Sec connection with the VPN server . Also for example the encryption device may be a Type 1 encryption device. The encryption device may generate keys used to encrypt data sent between the encryption device and the VPN server . When establishing a VPN between the device and the VPN server the encryption device may coordinate the VPN with the VPN server via the second processor the communications module and the network .

The device may include a communications module to provide data communications between the device and the network . The communications module may include an IEEE 802.11x Wireless adapter an Ethernet adapter a Bluetooth adapter a modem a mobile wireless adapter and the like.

The device may include a datastore not shown in communication with the encryption module . The datastore may be any component system or subsystem suitable for storing data. In one embodiment the datastore may be volatile memory such as random access memory RAM . In one embodiment the datastore may be nonvolatile memory such as read only memory ROM flash memory magnetic storage and the like. The datastore may have stored therein computer executable instructions to direct the operation of the encryption module as disclosed herein.

The device may communicate with a computer operating system . The operating system may include a secure mode and a non secure mode. For example when the computer is booted with a classified hard drive the operating system may be in a secure mode. When the computer is booted with an unclassified hard drive the operating system may be in a non secure mode.

The operating system may provide a platform for a VPN client . The VPN client may serve as an endpoint in a VPN connection. The VPN client may include secure communications protocol functions. The VPN client may provide an interface to other applications running on the computer. The interface may include an interface to a secure communications channel. The VPN client may include one or more configurable settings associated with the secure channel.

The VPN client may include a VPN user interface UI . The VPN UI may include a graphical user interface a command like interface and or both. The VPN UI may server to present information to the user and to receive data from the user. For example the VPN UI may present data to the user indicative of an intercepted message being sent unencrypted from the secure side to the non secure side .

The VPN client may provide an platform interface for the browser . The browser may include a software application suitable for navigating the world wide web. For example the browser may include software for displaying internet pages for interacting with user forms JAVA scripts and the like and for sending information and or requests to web.

The encryption module may process the request to enter bypass mode. One or more limitations may be placed on entry into bypass mode. For example a limit on the number of bypass mode entries such as that in a 24 hour period for example may be set. For example limit on the overall duration of time in bypass mode such as that in a 24 hour period for example may be set. To illustrate the encryption module may limit bypass mode to a three minute duration. For example a limit on the number of messages associated with the bypass mode may be set. For example a limit on overall byte volume in bypass mode may be set. For example a limit on the number of HTTP messages may be set. If it is determined that the limit on bypass mode use has been met the request to enter bypass mode may be denied.

Bypass mode limitation processing may be done by the encryption module and or a processor of the computer . This processing may be directed by software firmware or the like associated with the encryption module. This processing may be directed by software such as a driver running on the computer . The software may be associated with the Encryption device .

At the encryption module may respond to the VPN UI . The encryption module may place the device into bypass mode. The encryption module may indicate to the VPN UI that the device is in bypass mode.

The user may open a browser . At the browser may initiate an initial a Hyper Text Transport Protocol HTTP request. The initial HTTP request may be a website defined as the browser s start page. For example the browser may have a start page configured and may request that start page when the browser is opened. The initial request may include a request made responsive to an action by the user such as clicking a link typing a Uniform Resource Locator URL and or the like.

The encryption module may intercept the initial HTTP request and launch a dummy request at . The dummy request may include an HTTP request to a website and or search engine. The HTTP request may be made to a popular website. The encryption module may store the dummy HTTP request locally on a non secure side of the encryption module . The encryption module may cycle through one or more dummy requests such that the dummy request itself is not a signature of a connection from the encryption module .

The dummy request may return the intended webpage which may be passed to the browser . The appearance of the intended webpage may indicate connectivity to the access network and the user may terminate the bypass mode.

The dummy request may return data associated with the gatekeeper . For example the gatekeeper may intercept the dummy HTTP request. At the gatekeeper may respond with a request for assent to conditions for network access. For example the request from the gatekeeper may include use restrictions legal requirements a request for information such as username username password room number student code and or the like. The request from the gatekeeper may require that the user check an accept checkbox and or click a submit button.

The request from the gatekeeper may pass via the encryption module from the non secure side to the secure side and to the browser . The browser may present the request to the user and the user may interact with the request as appropriate to establish to assent to the conditions for network access. If the user disagrees with the conditions for network access the user may close the browser and terminate bypass mode.

If the user decides to assent to the conditions for network access such as by clicking an accept button displayed in the browser a response may be sent at . The response may include information indicating assent to the conditions for network access.

This response may be an HTTP response a JAVA based communication a middleware communication using simple object access protocol SOAP for example or the like. The response may include information embedded in the response that corresponds to the information provided by the user in response to the gatekeeper . For example the response may include an HTTP GET message with data encoded in a Uniform Resource Identifier URI . The response may include an HTTP POST message with data encoded in the body of the message.

The encryption module may intercept the response. The encryption module in bypass mode may intercept any unencrypted data being sent from the secure side to the non secure side .

At the encryption module may present intercepted response to the VPN UI for inspection by the user. This presentation may enable the user to check that the information being sent unencrypted from the secure side to the non secure side is suitable for being sent unencrypted. For example the user may confirm that no sensitive information has been improperly included in the response to the gatekeeper . The VPN UI may display a pop up window to the user including the presentation of the data being sent from the browser to the gatekeeper.

The information may be converted to a human readable format. For example the information may be converted to display any hidden data to the user. Printable American Standard Code for Information Interchange ASCII characters may be displayed as ASCII characters. Linefeeds and carriage returns may be applied to the data for proper formatting. Printable hexadecimal encoded characters may be displayed as ASCII characters. Nonprintable hexadecimal encoded characters may be displayed as character names for example control alt escape and the like . Further the conversion may support extensions to ASCII such as ISO 8859 UTF 8 Unicode Multi Byte encodings and the like.

The information may include a identifier associated with the intended destination of the information. For example the identifier may include an Internet Protocol IP address. To illustrate the IP address of the gatekeeper may be presented. The IP address may be accompanied by a reverse Domain Name Server DNS look up to provide additional information about the intended recipient.

The information may be presented with a request for approval and or disapproval. The user may approve or disapprove that the data be sent unencrypted. For example the human user may analyze the presented data for any sensitive information.

The user may approve the message and an indication of the approval may be sent from the VPN UI to the encryption module at . At the encryption module may forward the response to the gatekeeper as formatted by the browser to the gatekeeper . The message at may serve as a response to the gatekeeper s request at .

The gatekeeper may analyze the response which includes the user s assent to the conditions for network access. The response may be approved by the gatekeeper. The gatekeeper may send a response indicating that approval at . The gatekeeper may allow network access and enable network connectivity.

The response may require follow up information. For example the response may be part of a multi page set of conditions for network access. The gatekeeper may send a subsequent part to the initial network access transaction and the process at through may repeat. The response may be disapproved by the gatekeeper . The gatekeeper may indicate the disapproval in a message to the browser .

The user may respond to a follow on request or a disapproval. The encryption module may again check that one or more limitations associated with the bypass mode have not yet been met before allowing any subsequent interaction.

At the user may terminate the bypass mode and enter normal mode. The user may indicate the mode change via the VPN UI to the encryption module . At the encryption module may respond to the VPN UI indicating that the bypass mode has been terminated and or that the encryption module is in normal mode. In normal mode unencrypted data from the secure side to the non secure side may be blocked by the encryption module .

At the encryption module may send a request to the VPN server . Conditions for network access have been met so the gatekeeper may allow connectivity between the encryption module and the VPN server . The VPN server may respond to the request as appropriate and may establish secure communications at . The secure communications at may include an encrypted VPN channel between the encryption module and the VPN server . The browser or other applications on the computer may communicate securely via the encryption module and the VPN server .

At unencrypted data may be blocked. For example unencrypted data may be blocked from traversing from a secure environment to a non secure environment. At an indication from a user may be received to enter bypass mode. The indication may include an indication from a user interface such as a graphical user interface UI and or a command line interface CLI . For example the user may click a graphical menu option indicating entry into bypass mode.

At this request may be considered in light of bypass mode limitations. If the bypass mode limits have already been met and or exceeded the process may continue to block unencrypted data at . If the bypass mode limits have not yet been met the process may proceed to intercept any unencrypted data being sent from the secure environment to the non secure environment as . The unencrypted data may include a response indicative of an assent to conditions for network access.

At when the data is intercepted it may be presented for examination. For example it may be presented in a pop up window to the user. It may be converted to a human readable format. For example hidden data may be presented in a human readable format.

The user may consider the presented data to determine whether the unencrypted data is acceptable for being sent from the secure environment to the non secure environment. Computer checks of the data may be conducted. For example the computer may check the data to determine if there are any binary file formats embedded in the body of the message.

The user may be presented with the option to approve or disapprove the data at . If the unencrypted data is not acceptable the user may so indicate and the process may revert to normal mode at in which unencrypted data is blocked. If the user indicates that the unencrypted data is acceptable the unencrypted data may be forwarded to its destination at . For example the unencrypted data may be acceptable because it may include information to assent to the conditions for network access within limits assumed by the user to be suitable for being sent unencrypted. The unencrypted data may be acceptable because it may not include sensitive information that the user may not wish to be passed in an unencrypted form in the non secure environment.

Having sent data in bypass mode the process may proceed to again check the bypass limits. The status of the bypass limits may enable subsequent bypass mode communications. The status of the bypass limits may cause the process to terminate bypass mode and enter normal mode . Although not shown the user may terminate bypass mode and revert to normal mode at anytime.

The process may include a parallel logging function. The logging function may record activity associated with normal mode and bypass mode operation. For example the logging function may provide a secure audit record associated with the user of bypass mode . For example information associated with each bypass mode operation may be logged and encrypted locally. When a connection is available this data may be sent to a central server with data indicating the identity and circumstances of the user when the bypass mode was used. This data warehouse may be analyzed for signatures of misuse. Possible indications of misuse may be probed further to provide an additional layer of security.

Logged information may include the time date nature of transaction one or more Internet Protocol addresses associated with the transaction a copy of the data received from the non secure environment a copy of the data to be sent to the non secure environment information associated with one or more recent keystroke entries user identifier a memory and or core dump a process and or task list associated with the computer and or the like.

The user may be in bypass mode. The user may enter the room number and click the check box. The user may click the submit button which indicates to the browser that the data associated with presented page it to be sent back a hotel server.

The response may be intercepted and displayed to the user as illustrated in . The user s computer display may include additional window pop up window . The pop up window may include an indication of the user that the message has been intercepted. The pop up window may include instructions to the user that the information presented therein will be sent unencrypted i.e. in the clear and that the bypass feature is to be used to facilitate network access.

The pop up window may include human readable text corresponding to the message being sent from the secure environment to the non secure environment in unencrypted form. To illustrate the pop up window may include the body of the HTTP POST response in human readable form. The POST response may include information that indicates the previously entered room number and or the status of the checkbox for example.

The user may inspect this data. If the user approves the data to be sent unencrypted the user may click an approve button of the pop up window. If the user disapproves the user may click a discard button. Clicking the approve button may cause the data to be forwarded to a hotel server to facilitate network access for the user. Having provided the required information to the hotel server the hotel sever may enable network access for the user. The user may proceed to establish secure communications over the hotel s access network.

