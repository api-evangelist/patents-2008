---

title: Network independent location services
abstract: Techniques for supporting network independent location services (LCS) are described. In one design, a location center may communicate with a terminal to establish an account for the terminal with the location center for location services. The location center may establish the account for the terminal independent of a home network or a serving network for the terminal. During signup to establish the account, the location center may (i) provide address information for the location center, security information, and/or other information for the location center and (ii) receive public identity information and/or other information for the terminal. The location center may thereafter provide location services to the terminal based on the established account and without interacting with the home or serving network for the terminal. Techniques for supporting delivery of assistance data are also described.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09083745&OS=09083745&RS=09083745
owner: QUALCOMM Incorporated
number: 09083745
owner_city: San Diego
owner_country: US
publication_date: 20080311
---
The present application claims priority to provisional U.S. Application Ser. No. 60 894 282 entitled Network Independent Location Services filed Mar. 12 2007 and provisional U.S. Application Ser. No. 60 950 578 entitled Network Independent Location Services filed Jul. 18 2007 both assigned to the assignee hereof and incorporated herein by reference.

The present disclosure relates generally to communication and more specifically to techniques for supporting location services LCS for terminals.

It is often desirable and sometimes necessary to know the location of a terminal e.g. a cellular phone. The terms location and position are synonymous and are used interchangeably herein. For example an LCS client may desire to know the location of the terminal and may communicate with a location center in order to request the location of the terminal. The location center and the terminal may then exchange messages as necessary to obtain a location estimate for the terminal. The location center may then return the location estimate to the LCS client.

Various LCS standards have been developed by organizations such as 3rd Generation Partnership Project 3GPP 3rd Generation Partnership Project 2 3GPP2 and Open Mobile Alliance OMA . These LCS standards allow a terminal to obtain its location or the location of another terminal. These LCS standards also allow an LCS client to request and obtain the location of a target terminal.

The LCS standards generally require support from a home wireless network of a terminal being located and or a serving wireless network currently serving the terminal. This support is needed in order to i interpret and transfer a location request from an LCS client to the serving or home wireless network and ii return a location response with a location estimate for the terminal from the serving or home wireless network to the LCS client. This support is also needed to perform positioning for the terminal and or to assist the terminal make positioning related measurements and perform positioning. Since these LCS standards rely on support from the serving and or home wireless network a third party location provider may not be able to provide location services for the terminal unless the serving and or home wireless network supports location services and there is a business arrangement between the location provider and the serving and or home wireless network.

Techniques for supporting network independent LCS are described herein. The techniques may allow terminals to obtain location services from third party location providers without relying on support of location services by home and serving networks. In one design of network independent LCS a location center may communicate with a terminal to establish an account for the terminal with the location center for location services. The location center may establish the account for the terminal independent of a home network or a serving network for the terminal. During signup to establish the account the location center may i provide address information for the location center security information and or other information for the location center and ii receive public identity e.g. dialing information and or other information for the terminal. The location center may thereafter provide location services to the terminal based on the established account and without interacting with the home or serving network for the terminal. For mobile terminated location request MT LR the location center may send a location request to the terminal based on the public identity information for the terminal. For mobile terminated location request MO LR the location center may receive a location request sent by the terminal based on the address information for the location center. For both MT LR and MO LR the location center may establish secure communication with the terminal based on the security information and may provide location service via the secure communication.

Techniques for supporting delivery of assistance data are also described herein. Various aspects and features of the disclosure are also described in further detail below.

The techniques described herein allow a location provider to support location services for terminals without relying on serving and home networks which is referred to as network independent LCS. The techniques may be used with various LCS standards such as Secure User Plane Location SUPL from OMA V and V from Code Division Multiple Access CDMA Development Group CDG X.S0024 from 3GPP2 etc. SUPL is applicable for 3GPP 3GPP2 and wireless local area network WLAN networks. X.S0024 V and V are applicable for 3GPP2 networks. These LCS standards are also referred to as location solutions. For clarity certain aspects of the techniques are described below for SUPL.

Network s may include a wireless network that provides radio communication for terminals located within its coverage area. A wireless network may also be referred to as an access network a radio network a radio access network etc. A wireless network may be i a home wireless network with which terminal has service subscription and or ii a serving wireless network currently serving the terminal. The serving and home wireless networks may be the same or different wireless networks. Alternatively or additionally network s may include a wireline network such as a local area network LAN a digital subscriber line DSL network a packet cable network an Internet Service Provider ISP network a telephone network the Internet and or other voice and data networks. In the description herein a home network may be a home wireless network or a home wireline network or a home wireless and wireline network a serving network may be a serving wireless network or a serving wireline network or a serving wireless and wireline network and a network operator may be a wireless network operator service provider and or a wireline network operator service provider.

A location center may support network independent LCS for terminals and may be operated or leased by a location provider which may be independent or part of a network operator service provider. Location center may also be referred to as a gateway a location platform etc. Location center may perform various functions such as signup of users support of location services support of subscriber privacy authorization authentication charging billing service management etc. Location center may comprise a SUPL Location Center SLC a SUPL Location Platform SLP a 3GPP Gateway Mobile Location Center GMLC a 3GPP2 Mobile Position Center MPC etc. An LCS client may communicate with location center either directly or via another location center to obtain location information for LCS targets. An LCS client is a function or entity that requests location information for LCS targets. An LCS target is a terminal whose location is being sought.

A location server may support positioning for terminals and may be operated or leased by the location provider or some other entity. Location server may perform various functions to support positioning e.g. calculate location estimates deliver assistance data to terminals perform functions for security etc. Positioning refers to a process to determine a geographic or civil location estimate for an LCS target e.g. obtain latitude longitude and altitude coordinates for geographic location or a street address for civil location . Location server may comprise a SUPL Positioning Center SPC a 3GPP Serving Mobile Location Center SMLC a 3GPP2 Position Determining Entity PDE etc. Location server may be separate from location center as shown in or may be part of location center . A storage unit may store a database of assistance data and may provide assistance data as requested by location server . A Wide Area Reference Network WARN may monitor satellites and provide location server with satellite reference information for the coverage areas of the location server. The satellite reference information may comprise GPS ephemeris information and differential correction for the GPS ephemeris information and may be used in GPS and Assisted GPS A GPS location calculations.

Location services are typically available only through network operators. An LCS client may obtain a location estimate for a terminal if the terminal has a location service subscription with a home network the LCS client has a client subscription with a requesting network and there is a business agreement between the home network and the requesting network if these are different networks. The terminal is typically provisioned with location services through the home network operator and may only be able to obtain location services via networks operated by the home network operator or covered by roaming agreement with the home network operator. These restrictions may limit provision of location services in many instances.

In an aspect location center may support network independent LCS and allow terminals to obtain location services without relying on support of location services by home and serving networks. A location provider that operates or leases location center may or may not be a network operator and may be an ISP a VoIP Service Provider VSP some other service provider or simply a provider of only location services. A terminal may have an LCS subscription with any location provider and is not limited to its home network operator. An LCS client may also have an LCS subscription with any location provider and is not limited to a network operator. Location center may manage user subscription for both LCS clients and LCS targets provide location services manage user privacy and or perform other functions. Location center may communicate with the LCS clients and LCS targets using Internet Protocol IP Transmission Control Protocol IP TCP IP User Datagram Protocol UDP Short Message Service SMS Hypertext Transfer Protocol HTTP Session Initiation Protocol SIP Mobile Location Protocol MLP and or other data communication means supported by wireless and or wireline networks.

Signup program assists establishment of an account for terminal with location center . Signup program may be preconfigured in terminal downloaded by the user from a location provider website downloaded by a service provider e.g. the home network operator downloaded by a service provider using OMA Device Management transferred or downloaded from some other device e.g. a PC laptop or PDA copied from a passive storage device e.g. diskette hard drive CD ROM DVD ROM or flash memory card or installed in terminal in some other manner. Signup program may be supported in software firmware hardware or any combination of these. Signup program may be separate from other terminal applications programs processes and operating system or may be combined with one or more of these. Signup program may be common to different types of terminal e.g. due to use of known common APIs and which manage different terminal resources e.g. screen keyboard memory and network signaling interface in a uniform manner for different terminal types. Signup program may also be unique or special to terminal e.g. may be part of the capabilities provided by the terminal manufacturer or by some source provider to the terminal manufacturer. Signup program may be applicable for a specific location provider and may be customized to ensure correct interaction of the program with location center during a signup procedure to establish the account. Alternatively signup program may be applicable for different location providers and may support a common signup procedure for all location providers or a different signup procedure for each location provider. Signup program may be activated by the user e.g. by clicking on an icon on the display of terminal by responding to a menu prompt via computer etc.

When activated signup program may read the current setup state for all location providers in terminal and delete or modify any conflicting setup information e.g. after prompting the user to confirm . Signup program may prompt the user to confirm the location provider being accessed or to provide or select the location provider if the program supports multiple location providers. Signup program may interact with the user via APIs in order to transfer information to and from the user as part of signup to the location provider. Signup program may communicate with computer to exchange information as described below. Signup program may also access and interact with location center via secure communication to securely transfer user information and terminal information to location center and to receive location provider information e.g. identity location center address authentication keys etc. from location center . The secure communication may be based on HTTPS TCP Transport Layer Security TCP TLS etc. Signup program may prompt the user to enter or confirm pertinent information such as name email address credit card information desired privacy desired services etc. Signup program may also access user information from location center which may obtain this information via a separate online setup procedure performed by the user. Signup program may confirm completion of service activation to the user.

Signup program may access resources and capabilities supported by terminal by interacting with the operating system of terminal which may be Sun Microsystems JAVA Qualcomm BREW Microsoft Windows Mobile Symbian Google Android etc. via APIs provided by the operating system. Signup program may retrieve information from and write information to secure non volatile memory via APIs . Signup program may also modify and or add to location provider information associated with a specific location solution such as SUPL via APIs . For example signup program may create a new address and security keys for a home SLP H SLP to support SUPL. LCS module may support location services for terminal and may support SUPL and or other location solutions. In the description of various signup schemes disclosed herein references are sometimes made to terminal as the source or recipient of different actions and events. This is intended to simplify the description and signup program may be the ultimate source or recipient of any such action or event e.g. assisted by services supported by APIs and or APIs .

After completing signup terminal may obtain location services from location center via the established account block . Terminal may perform registration with location center after signup while obtaining location services or after completing location services. Terminal may provide its IP address to location center for registration. LCS Client may also obtain location services from location center in order to obtain location information for terminal .

The user of terminal may sign up with the location provider as an LCS target and or an LCS client. Signup as an LCS target allows the location of terminal to be determined and provided to terminal and or other LCS clients. Signup as an LCS client allows terminal to obtain location estimates for other terminals. Security and privacy may be supported to allow the location of terminal to be determined and provided only when authorized.

Terminal may then access location center to activate service step . Terminal may provide the local reference received in step to identify the user to location center . Terminal may perform mutual authentication with the temporary secret key to authenticate location center to terminal and to authenticate terminal to location center . The mutual authentication may be based on Pre Shared Key TLS PSK TLS authentication or some other security protocol. After completing the mutual authentication terminal may provide its public identity information which may be a Mobile Directory Number MDN a Mobile Station International ISDN Number MSISDN a public user SIP URI etc. Location center may provide its identity e.g. a name and a permanent URI to terminal . Location center and terminal may also negotiate a permanent secret key e.g. using a Diffie Hellman key exchange . Terminal may store the permanent secret key in secure non volatile memory and may use this secret key for future authentications with location center . Terminal may perform deactivation of location service with location center e.g. at the instigation of the user by performing steps similar to steps and . For all signup schemes deactivating location service and removing information related to the account between terminal and location center may be accomplished using steps similar to those used for signup.

For the first signup scheme security properties are as follows. Steps and may be performed in a secured manner. The user may know the true identity of the location provider and HTTPS may be used to securely return the temporary secret key and the local reference in step . Step may not be secure since someone other than the real user could perform steps and and then obtain temporary access to terminal . This may be circumvented by i prominently displaying the name of the location provider e.g. on a welcome screen of terminal so that the real user can become aware and ii alerting the user to re confirm activation e.g. periodically on terminal . Step should be as secure as steps and . Terminal or signup program may provide menus and functions to support provider activation in step and service activation in step .

Location center may then send a request for service activation to terminal step . This request may be sent using an SMS message that contains the location provider name the URI and possibly the code provided in step . Terminal may alert the user to authorize the service activation possibly at a later time step . Terminal may display the location provider name and possibly the code for authentication and may request the user to authorize service activation. If service activation is authorized by the user then terminal may confirm the service activation to location center step . Location center may provide a permanent URI to terminal . Terminal may authenticate the location provider identity e.g. using a public root key certificate for location center . Location center and terminal may negotiate a common secret key for future authentication and terminal may store this secret key in secure non volatile memory for future authentications. Terminal may provide confirmation of service activation to the user in either step or following step .

For the second signup scheme security properties are as follows. Steps and may be performed in a secured manner e.g. the user may know the true identity of the location provider. Step may not need to be secure since service is not yet activated. Step may not be secure since someone else may obtain temporary access to terminal . However the delay between steps and and steps and may make this less likely particularly if the location provider or terminal ensures this delay is not small e.g. ensures a delay of an hour or a day . This is because someone who had obtained temporary access to terminal would need to retain access in order to complete steps and given that the real user would see step as an unexpected event and would most likely not allow it to proceed . The main risk from steps and may be a request for service activation from another location provider not accessed by the user in steps and . To protect against this in step the user may be requested to enter the code received in step rather than to verify the code displayed by terminal . The code provided in step may then be used for mutual authentication between terminal and the location provider. In step terminal may verify the location provider identity using the public root key certificate. Terminal or signup program may provide menus and functions to support user activation in step and service activation in steps and .

Location center may verify activation at a later time e.g. one or more days later and may send a location request e.g. an MT LR using SUPL for the verification step . The verification may test the association of the MDN MSISDN or public user SIP URI provided in step to the secret code returned in step . The activation in step may be considered to be verified if location center is able to access terminal using the MDN MSISDN or public user SIP URI authenticate terminal using the secret key and obtain a location estimate. If the activation is verified then location center or terminal may alert the user. If the verification is not successful then location center may inform the user e.g. via an email sent to the email address provided in step . Security properties for the third signup scheme may be as described above for the first signup scheme in in order to ensure secure activation.

Terminal may alert the user to authorize the service activation step . Terminal may display the location provider name and obtain Key from the user. If the service activation is authorized by the user then terminal may verify the service activation with location center step . As part of step Key and Key may be combined into a permanent secret key K. As a further part of step terminal may perform an MO LR location request e.g. using SUPL using the secret key K for mutual authentication. If mutual authentication succeeds using the secret key K and a location estimate is obtained then the service activation in step may be considered to be verified by both terminal and location center . Terminal may confirm service activation to the user in step or following step .

Security properties for steps and in the fifth signup scheme may be as described above for steps and in the second signup scheme in in order to ensure secure activation. Step should be secure since the secret key K is obtained from two separate interactions. This prevents a request for service activation from another location provider not accessed by the user in steps and .

In the first through fifth signup schemes the user may sign up for service as an LCS target and or an LCS client with the location provider by accessing location center via the Internet using TCP IP HTTP HTTPS or some other means. The user may provide pertinent information such as the user name postal address email address billing information public identity information for terminal etc. For signup as an LCS target pertinent information may be provided to and stored by terminal so that it can interact correctly with location center in order to allow the terminal s location to be obtained when requested by the user or some other LCS client.

The first through fifth signup schemes each includes separate setup and activation portions. For the setup portion a user account is created in location center and may include user information such as user name postal address email address billing details privacy preferences subscribed location services MDN MSISDN or public user SIP URI of terminal etc. For the activation portion information about the location provider is configured in terminal and information about terminal e.g. the MDN MSISDN or public user SIP URI may be provided to location center . Information may be stored in both terminal and location center to enable mutual authentication when terminal and location center later interact for location services. A particular location solution e.g. SUPL may be enabled for use between terminal and location center to support location services.

The setup portion involves information transfer between the user and location center and may be performed by a separate online connection e.g. via the Internet as shown in . The activation portion involves information transfer between terminal and location center and interaction between the user and terminal . The setup and activation portions may be combined.

Location center may provide location provider information security information service information and or other information to signup program step . The location provider information may include location provider name and address e.g. URI or IP address . The security information may include authentication and ciphering keys to enable mutual authentication and secure communication between terminal and location center for future location requests. The service information may include privacy preferences and or other information for the user. Other information may include location solution s supported by the location provider. Signup program may store the information received in step in secure non volatile memory within terminal for later use for location services step . Signup program may optionally invoke an MO LR e.g. using SUPL to obtain a location estimate for terminal to verify that the location solution will now work correctly with the location provider step . Location center may similarly invoke an MT LR e.g. using SUPL to obtain a location estimate for terminal to verify correct operation. Signup program may confirm that setup and activation are complete to the user step .

If signup program is provided by the location provider e.g. downloaded from a location provider website or supplied by the location provider to any provider of programs and features for terminal then it may be possible to use communication procedures that the location provider prefers between signup program and location center in steps and . In particular it may be possible to employ reliable means of authentication and ciphering and flexible and extensible means of transferring data between signup program and location center . It may further be possible to make interaction between the user and signup program in steps and simple and user friendly from the user perspective. These effects may also be achieved if signup program is not provided by the location provider if the interface and procedures used between signup program and location center are provided e.g. standardized or otherwise publicly available. The sixth signup scheme may be more suitable for cases where the location provider provides signup program whereas the first through fifth signup schemes may be more suitable where signup program is not provided by the location provider. However all signup schemes may be used regardless of whether signup program is provided by the location provider or by some other source.

For the sixth signup scheme security properties are as follows. Steps and if performed may be secure e.g. the user may know the true identity of the location provider and HTTPS may be used to securely return the login and password information in step . Step is not secure and may be circumvented as described above for the first signup scheme. Steps to may be secure due to use of a secure IP protocol e.g. HTTPS or TLS between terminal and location center .

In a seventh signup scheme the location provider may be preconfigured e.g. as the primary or secondary H SLP in terminal . This preconfiguration may avoid a setup and activation procedure between terminal and location center since location provider information e.g. H SLP address authentication parameters etc. can already be stored in secure non volatile memory within terminal . The service may be pre activated and ready to use or may be activated by the user via a menu function or other command on terminal . The location provider may be changed and or other location providers may be added later via any of the signup schemes described above.

The signup schemes described above support portability of location services. The user may change home network operator retain the same MDN or MSISDN due to number portability and continue to obtain location services from the same location provider. SMS transfer of a SUPL INIT message would continue to work due to number portability provided that SMS portability enhancement is supported . Other aspects of location services would continue to apply because the service is not tied to the home network operator.

In general terminal and location center may utilize any location solution to obtain and provide location estimates for terminal to LCS clients and or to terminal to obtain and provide location estimates for LCS targets to terminal to provide assistance data to help terminal determine its own location etc. In one design SUPL may be used to support all of the above functions. SUPL can take advantage of IP capability of location center shared secret key established during service activation for mutual authentication and as an extension to SUPL capability of the terminal to register its current IP address in an H SLP.

Location center may support SUPL and may perform additional functions to i create user accounts via the signup procedure described above and ii activate SUPL use in terminals via the signup procedure. Location center may act as an H SLP with respect to terminal . If terminal already has a primary H SLP in the home network then the location provider may become a secondary H SLP in order to allow use of SUPL for both the home network and the location provider. If terminal has both a primary H SLP and a secondary H SLP then an MT LR request from either the primary or secondary H SLP to obtain the location of terminal on behalf of an LCS client may be supported in the manner currently defined for SUPL. In the case of a request by terminal e.g. instigated by the user or an application on terminal for the location of terminal or the location of some other terminal terminal or the instigating user or application may decide whether to send the request to the primary or secondary H SLP using defined SUPL procedures.

Referring back to LCS module may access location provider information e.g. H SLP address primary and secondary H SLP addresses security keys subscribed services etc. in secure memory which may have been placed there earlier by any of the signup schemes described above. LCS module may be part of e.g. an extension to signup program in which case LCS module may know how to access particular location provider information in secure memory by employing the same access routines in the same way as signup program . When LCS module is part of signup program and has been provided by the location provider it may also be possible to use any location solution and set of associated location procedures between terminal and location server e.g. not necessarily a standardized solution like SUPL which may be convenient e.g. reduce cost for the location provider. If signup program and LCS module are separate e.g. provided by different sources then known capabilities of OS APIs may be used to enable common access. In addition common access may be assisted by known conventions provided in specifications defining OS APIs e.g. conventions that define particular parameter values and or particular parameter names that refer to particular types of location provider information .

LCS client may desire location information for terminal and may send an MLP Standard Location Immediate Request SLIR message to location center step A . Location center may authenticate and authorize LCS client for the requested location information. Location center may then obtain routing information for terminal which is the LCS target step B .

Location center may send a SUPL INIT message to initiate a location session with terminal step C . The SUPL INIT message may be sent using SMS WAP Push SIP Push or UDP IP or TCP IP transfer if terminal has performed registration with location center and provides its IP address to the location center. The SUPL INIT message may include a session id used to identify the location session an intended positioning method posmethod the desired quality of positioning QoP etc. Upon receiving the SUPL INIT message terminal may perform a data connection setup procedure attach itself to a packet data network if the terminal is not already attached and establish a secure IP connection to location center step D . Terminal may send a SUPL POS INIT message to location center step E . The SUPL POS INIT message may include the session id the terminal capabilities e.g. supported positioning methods and protocols etc. Terminal may authenticate location center in step C and location center may authenticate terminal in step E based on PSK TLS using the shared secret key SSK established during signup.

Terminal may then exchange messages with location center and or location server for a positioning session which may be based on IS 801 Radio Resource LCS Protocol RRLP Radio Resource Control RRC Generic Positioning Protocol GPP etc. step F . For SET assisted positioning location center or location server may calculate a location estimate for terminal based on positioning measurements received from the terminal. For SET based positioning terminal may calculate the location estimate based on assistance from location center or location server . In any case upon completing the positioning session location center may send a SUPL END message to terminal step G and may also send the requested location information in an MLP Standard Location Immediate Answer SLIA message to LCS client step H .

Message flows and as well as other aspects of SUPL are described in OMA AD SUPL V1 entitled Secure User Plane Location Architecture dated Jun. 15 2007 in OMA TS ULP V entitled UserPlane Location Protocol dated Jun. 15 2007 in OMA AD SUPL V entitled Secure User Plane Location Architecture dated Aug. 31 2007 and in OMA TS ULP V entitled UserPlane Location Protocol dated Feb. 6 2008. These SUPL documents are publicly available from OMA.

As shown in a Generic Positioning Protocol GPP may be used for the positioning session in step F. GPP may support various access types and may be more suitable for network independent LCS to allow terminal to obtain location services via any wireless and or wireline network. Access specific positioning protocols such as RRLP RRC and IS 801 may also be supported and may be more suitable for GPS and GNSS.

Network independent LCS may be used for various applications. For example network independent LCS may be used to obtain location estimates for various purposes to receive notification of events and opportunities based on current location to track items or people e.g. children etc.

For block the location center may provide address information e.g. a URI an IP address etc. for the location center and security information e.g. at least one secret key during signup to establish the account. The location center may receive public identity information e.g. an MDN an MSDISDN or a public user SIP URI for the terminal during the signup. For MT LR in block the location center may send a request for location service to the terminal based on the public identity information. For MO LR in block the location center may receive a request for location service sent by the terminal based on the address information. For both MT LR and MO LR the location center may establish secure communication with the terminal for the location service based on the security information.

The signup to establish the account may be performed in various manners. For the first signup scheme in the location center may receive a request to set up the account for the terminal provide address information for the location center and a secret key in response to the request receive access by the terminal based on the address information perform mutual authentication with the terminal based on the secret key and activate service for the terminal after successful mutual authentication.

For the second signup scheme in the location center may receive a request to set up the account and public identity information for the terminal send a request for service activation to the terminal based on the public identity information and receive a confirmation of service activation from the terminal.

For the third signup scheme in the location center may receive a request to set up the account and public identity information for the terminal provide address information for the location center and a secret key in response to the request send a request for service activation to the terminal based on the public identity information perform mutual authentication with the terminal based on the secret key and activate service for the terminal after successful mutual authentication. The request for service activation may be a location request e.g. an MT LR which may simplify implementation since the location request may already be supported as part of normal location services.

For the fourth signup scheme in the location center may receive a request to set up the account and public identity information for the terminal provide address information for the location center and a secret key in response to the request receive a request for service activation sent by the terminal based on the address information perform mutual authentication with the terminal based on the secret key and activate service for the terminal after successful mutual authentication. The request for service activation may be a location request e.g. an MO LR which may simplify implementation since the location request may already be supported as part of normal location services.

For the fifth signup scheme in the location center may receive a request to set up the account and public identity information for the terminal provide a first secret key in response to the request send a request for service activation and a second secret key to the terminal based on the public identity information generate a third secret key based on the first and second secret keys receive a location request sent by the terminal to activate service perform mutual authentication with the terminal based on the third secret key and activate service for the terminal after successful mutual authentication.

For the sixth signup scheme in the location center may receive a request to set up the account for the terminal provide login and password information in response to the request establish secure communication with the terminal based on the login and password information receive public identity information for the terminal and send address information for the location center and security information to the terminal.

The signup to establish the account may involve i interaction between the location center and the terminal and ii possibly interaction between the location center and a separate computer. The signup may also involve steps different from those given above exchange of additional and or different information etc.

For block the terminal may receive address information e.g. a URI an IP address etc. for the location center and security information e.g. at least one secret key during signup to establish the account. The terminal may securely store the address information and the security information. For MT LR in block the terminal may receive a request for location service from the location center. For MO LR in block the terminal may send a request for location service to the location center based on the address information. For both MT LR and MO LR the terminal may establish secure communication with the location center for the location service based on the security information.

The signup to establish the account may be performed in various manners. For the first signup scheme in the terminal may receive address information for the location center and a secret key provided by the location center access the location center based on the address information perform mutual authentication with the location center based on the secret key and activate service with the location center after successful mutual authentication.

For the second signup scheme in the terminal may receive a request for service activation from the location center query for user authorization of the service activation and send a confirmation of service activation to the location center in response to receiving the user authorization.

For the third signup scheme in the terminal may receive address information for the location center and a secret key provided by the location center receive a request for service activation e.g. an MT LR location request from the location center perform mutual authentication with the location center based on the secret key and activate service with the location center after successful mutual authentication.

For the fourth signup scheme in the terminal may receive address information for the location center and a secret key provided by the location center send a request for service activation e.g. an MO LR location request to the location center based on the address information and perform mutual authentication with the location center based on the secret key and activate service with the location center after successful mutual authentication.

For the fifth signup scheme in the terminal may obtain a first secret key via user input receive a request for service activation and a second secret key from the location center generate a third secret key based on the first and second secret keys send a location request to the location center to activate service perform mutual authentication with the location center based on the third key and activate service with the location center after successful mutual authentication.

For the sixth signup scheme in the terminal may obtain login and password information provided by the location center establish secure communication with the location center based on the login and password information provide public identity information to the location center and receive address information for the location center and security information from the location center.

The signup may involve i interaction between the terminal and the location center and possibly ii interaction between the terminal and a separate computer. The signup may also involve steps different from those given above exchange of additional and or different information etc.

Location server may provide assistance data to terminal . The assistance data may be satellite navigation data to assist terminal with making measurements of satellites terrestrial assistance data to assist terminal with making measurements for terrestrial stations e.g. base stations cells WLAN access points APs etc. Terrestrial assistance data may comprise base station almanac BSA data which may include information that i identifies particular base stations cells cell sectors WLAN APs and other wireless access entities ii provides details on wireless support by each entity e.g. radio technology frequencies and channels used power output iii provides the location of each entity e.g. latitude longitude altitude country state county city street iv provides timing details for each entity e.g. transmission timing relative to other entities or relative to some absolute time and timing drift and v provides other information that may be useful in making measurements of signals received from these entities to obtain location and in calculating location. The assistance data may be provided for various positioning methods such as GPS Galileo GLONASS Enhanced Observed Time Difference E OTD Observed Time Difference Of Arrival OTDOA Advanced Forward Link Trilateration A FLT Enhanced Cell ID E CID etc. The assistance data may be valid for an extended period of time e.g. days or weeks and may enable terminal to determine its own location using a suitable positioning method at any time over the extended period of time without any further assistance from location server or any wireless network. The assistance data may also or instead enable terminal to perform measurements of satellite and base station signals without further assistance from location server and to send the signal measurements at any later time to location server or some other entity to provide or obtain location. The capability to provide assistance data may be referred to as eXTended Receiver Assistance XTRA .

Network independent LCS and XTRA may be used separately or together since they are not mutually dependent. When both are used they may be provided by the same or different providers e.g. one location provider may provide XTRA support and another location provider may provide network independent LCS . Combining XTRA with network independent LCS may allow a location provider to support a minimal subset of SUPL in which no positioning protocol RRLP RRC or ISA 801 and no SPC are used because the terminal is now able to measure and compute its own location without requiring interaction with a location server using a positioning protocol.

For all download schemes described above the downloaded terrestrial assistance data may include base station and WLAN AP locations timing data e.g. real time differences RTDs absolute time differences ATDs timing drift etc. to enable terminal based positioning methods fine time assistance FTA data and or other data. The terminal based positioning methods may include E OTD OTDOA A FLT E CID etc. Some terrestrial assistance data e.g. timing data for asynchronous wireless technologies like Global System for Mobile communications GSM Wideband CDMA WCDMA and Long term Evolution LTE may not be valid for an extended period of time. Location server or terminal may decide which data to download to terminal .

Terminal and may upload measured data to location server . Terminal may send the measured data via a SUPL Location ID parameter for each location fix a SUPL Multiple Location IDs parameter for historic measurements a SUPL location estimate for SET assisted or SET based positioning proprietary data via interaction with location server etc. The measured data may be for cells and networks in the current vicinity of terminal or those that have been encountered in the past. The measured data may be used by location server to build up a larger and more reliable database of terrestrial assistance data. Location server may combine measured data from many terminals e.g. terminals in for many different cells base stations WLAN APs and networks and may later provide portions of the combined data to terminals e.g. terminal in to help them obtain their own locations.

The measured data may include various types of measurements such as WLAN AP measurements RRLP E OTD measurements GSM Network Measurement Report NMR measurements GSM FTA RRC OTDOA measurements WCDMA Measured Results List for WCDMA MRL measurements WCDMA FTA IS 801 A FLT measurements and cell data etc. The WLAN AP measurements may enable identities locations and IEEE 802.11v capabilities of WLAN APs to be determined. The RRLP E OTD measurements GSM NMR measurements and GSM FTA may enable locations of GSM base stations to be determined or approximated enable RTDs between GSM base stations to be determined enable GPS time association for GSM base stations etc. The RRC OTDOA measurements WCDMA MRL measurements and WCDMA FTA may enable locations of WCDMA base stations to be determined or approximated enable RTDs between WCDMA base stations to be determined enable GPS time association for WCDMA base stations etc. The IS 801 A FLT measurements and cell data may enable the locations power output and timing of CDMA 1x CDMA EvDO and UMB base stations to be determined or verified.

Location server may receive the same or equivalent information from multiple terminals e.g. information about the same cell or WLAN AP. Location server may verify the information and may improve the reliability and accuracy of the information e.g. by averaging corresponding information values. In addition location server may be able to combine information from different terminals to obtain new information e.g. location coordinates of cell towers and WLAN APs from measurements of these different terminals.

Assistance data may be securely downloaded to terminal and securely stored in terminal . The assistance data may be considered to be valuable and confidential to the location provider and may be protected from i eavesdropping and interception during download and ii unauthorized access at terminal and location server . Security may be achieved by ciphering downloaded and uploaded data ciphering or preventing external access to data stored in terminal and protecting data stored in location server . Since data exchanged via SUPL is already ciphered security may be focused in other areas where ciphering is not inherently used.

To provide security assistance data stored on an externally readable memory within terminal including any memory that may be physically removed from terminal and read externally may be ciphered. Assistance data stored on processors within terminal may be ciphered and or protected from external access. To support XTRA a unique processor or terminal identity a secret key Ks a public key Kp for location server and or other parameters may be preconfigured on terminal . Additional secret keys K K etc. may be negotiated between terminal and location server during interaction with the location server for XTRA. Secret keys K K etc. may be used to cipher data for upload download and storage.

Not all data may be ciphered on terminal e.g. at least one secret key may be stored in non ciphered form in order to decipher other data. Some memory in terminal may be secure e.g. memory resident in a processor chip in terminal and it may not be possible to read or in any way obtain the contents of this memory without permanently damaging or destroying the memory. In this case certain critical data may be stored in this memory including cipher keys the address of location center the address of location server location services enabled or supported by these servers and the identity or identities public or private of the terminal. The amount of critical data may be fairly small e.g. a few hundred bytes which may be helpful if the amount of secure memory available to terminal is limited e.g. for cost reasons . Other less critical data may be stored in memory that can be read externally. Such data may include BSA data and GPS and other satellite ephemeris data provided by location server and measurements of base stations and WLAN APs made by terminal . Such less critical data may be more extensive e.g. one or more Megabytes. This less critical data may still be protected by ciphering it using security keys stored non ciphered within the secure memory of terminal . Similar security mechanisms may also be employed within location center and location server in order to protect both critical and less critical data.

Terminal may interact with location server in a secure manner for XTRA. Terminal and location server may authenticate one another prior to data download or upload. The integrity of data may be protected during download and upload based on various security schemes.

In a first security scheme terminal has a unique identity and a unique secret key Ks. Terminal and location server may perform secure PSK TLS mutual authentication using the secret key Ks. Ciphering may then be invoked and additional mutual secret keys K K etc. may be assigned if preferred. Future uploads and downloads may be protected using the secret key Ks and or K K etc.

In a second security scheme terminal has an identity and a secret key Ks that are common to other terminals but kept confidential. Sharing common keys for many or all terminals as opposed to assigning unique keys to each terminal may be used to reduce manufacturing and operating costs. Terminal and location server may perform PSK TLS mutual authentication using the secret key Ks. A unique identity and one or more unique secret keys K K etc. may then be negotiated and stored in terminal and location server . Future uploads and downloads may be protected using unique secret keys K K etc.

In a third security scheme terminal has the public key Kp of location server . Terminal may authenticate location server using e.g. TLS with Rivest Shamir Adleman RSA asymmetric key method. Location server may implicitly authenticate terminal by virtue of correct interaction by terminal with server e.g. if this interaction is not publicly defined . A unique identity and one or more unique secret keys K K etc. may be negotiated and stored in terminal and location server for future downloads and uploads. Alternatively terminal may continue to use the public key Kp for future downloads and uploads.

In a fourth security scheme terminal has the public key Kp of location server and a public key security certificate that includes a digital signature of public and other information for terminal such as its public identity information. The digital signature may be obtained using a secret key associated with public key Kp or some other public key known to location server . Terminal may authenticate location server using e.g. TLS with RSA asymmetric key method. Location server may similarly authenticate terminal using its public key security certificate and associated known public key e.g. using TLS with RSA. A unique identity and one or more unique secret keys K K etc. may then be negotiated and stored in terminal and location server for future downloads and uploads. Alternatively terminal may continue to use the public key Kp and the public key security certificate for future downloads and uploads.

To simplify security a common identity a common secret key Ks and or a common public key Kp may be used for multiple terminals but may be kept confidential. Terminal and location server may then negotiate a unique identity and a unique secret key K for the terminal. A unique secret key for the terminal may also be obtained in other manners. In any case the unique identity may be useful to maintain records about terminal in or accessible by location server to identify and filter out faulty or unreliable terminals to find a lost or stolen terminal to identify repeated duplicate BSA data uploads and downloads to maintain records for each individual terminal e.g. the most common locations and or base stations used by each terminal etc. Terminal may fall back to the original secret key Ks or public key Kp if secret key K is lost or corrupted on terminal or location server . Authentication interaction procedure between terminal and location server may be the same or similar for both initial and subsequent access. The authentication interaction procedure may also be the same or similar to that used for location requests e.g. SUPL SSK authentication .

Measurements may be sent by terminals via SUPL or some other location solution to location server and may be used to build up terrestrial assistance data. Assistance data e.g. terrestrial assistance data and or navigation data may also be downloaded by terminals via SUPL or some other location solution from location server .

For download SUPL 1.0 supports download of BSA data only for nearby cells. The BSA data may include latitude and longitude of base transceiver system BTS and RTDs and may be intended for SET based positioning methods such as E OTD and OTDOA. SUPL 2.0 or a later version of SUPL may support download of navigation data using extended ephemeris and extended almanac corrections at the RRLP RRC and IS 801 levels. A later version of SUPL may support download of BSA data for geographic areas extending beyond the immediate coverage of a terminal.

For upload SUPL 1.0 supports limited upload of cell ID and cell measurements results for the current serving CDMA WCDMA or GSM cell. SUPL 2.0 supports upload of data for the serving cell and other received cells WLAN information and historic cell measurement data e.g. over last 10 minutes . Location server may request historic measurements stored in terminal over a long period e.g. hours or days . Location server may inform terminal which cell types and BSA measurements to report. Terminal may report various types of information for the current serving cell and previous serving cells e.g. over the last 10 minutes . Terminal may also report individually on each cell and WLAN AP that can be received. Location server may obtain historic measurements from terminal over any period of time if previously stored in terminal .

Terminal may upload various types of information. Terminal may provide GSM cell information such as cell ID and timing advance TA for the serving GSM cell received signal level for e.g. up to 15 other cells obtained at the same time etc. Terminal may provide WCDMA cell information such as i cell ID and UTRA carrier received signal strength indicator RSSI level for the serving WCDMA cell and ii cell ID CPICH Ec No CPICH RSCP and or path loss for e.g. up to 32 neighbor cells etc. Terminal may provide CDMA cell information such as cell ID NID SID base station latitude longitude and GPS time with second granularity . Terminal may provide WLAN AP information such as a Medium Access Control MAC address AP transmit power antenna gain received signal to noise ratio S N and signal strength 802.11 type RTD reported location of WLAN AP SET transmit power antenna gain and S N and signal strength received at WLAN AP. Terminal may also provide A GPS FTA for GSM WCDMA and CDMA.

Location server may include a download upload program and a memory . Program may support data download and upload via SUPL XTRA and or some other location solution or protocol. Memory may store a BSA database comprising terrestrial assistance data and or a database of navigation data which may be downloaded from location server .

For SUPL data download and upload may be supported with various existing SUPL messages. Location server may send a SUPL INIT message a SUPL RESPONSE message or a SUPL TRIGGERED RESPONSE message with measurements supported by location server . Terminal may send a SUPL START message a SUPL POS INIT message or a SUPL REPORT message with cell and or WLAN measurements supported by location server . Location server may also send a SUPL POS message carrying an RRLP RRC IS 801 message with navigation data. For XTRA download and upload of terrestrial assistance data may be supported with XTRA and or SUPL messages.

The data uploaded from terminals via SUPL and or other location solutions may be used to build up a database for base stations and WLAN APs. The uploaded data may also be used by location server to derive location estimates for terminals and for downloading to terminals for self fixes.

The mutual authentication may be performed in various manners. In a first scheme the location server may perform mutual authentication with the terminal based on a unique secret key for the terminal generate at least one mutual secret key after successful mutual authentication and use the at least one mutual secret key for secure communication with the terminal. In a second scheme the location server may perform mutual authentication with the terminal based on a secret key applicable for a plurality of terminals including the terminal generate at least one mutual secret key after successful mutual authentication and use the at least one mutual secret key for secure communication with the terminal. In a third scheme the location server may perform mutual authentication with the terminal based on a public key for a location server generate at least one secret key after successful mutual authentication and use the at least one mutual secret key for secure communication with the terminal. The mutual authentication may also be performed in other manners.

For block the location server may receive a request for assistance data from the terminal and may download requested assistance data to the terminal. The location server may also receive measured data from the terminal and may update a database of assistance data based on the measured data. The location server may also determine and or provide the terminal s location to the terminal and or LCS clients.

On the downlink base stations in RAN transmit traffic data messages signaling and pilot to terminals within their coverage areas. These various types of data are processed by processor conditioned by transmitter and transmitted on the downlink. At terminal the downlink signals from base stations are received via an antenna conditioned by receiver and processed by processor to obtain various types of information for positioning and location and other services. Processor may perform or direct process in and or other processes for the techniques described herein. Memories and store program codes and data for terminal and RAN respectively. On the uplink terminal may transmit traffic data messages signaling and pilot to base stations in RAN . These various types of data are processed by processor conditioned by transmitter and transmitted on the uplink. At RAN the uplink signals from terminal and other terminals are received and conditioned by receiver and further processed by processor to obtain various types of information e.g. data messages signaling etc. RAN may communicate with other network entities via communication unit .

Within location center processor performs location and or positioning processing for the location center. Processor may perform or direct process in process in process in process in and or other processes for the techniques described herein. Memory stores program codes and data for the location center. Communication unit allows location center to communicate with other entities.

Within location server processor performs location and or positioning processing for terminals download of assistance data to terminals and upload of measured data from terminals etc. Processor may perform or direct process in process in process in and or other processes for the techniques described herein. Memory stores program codes and data for the location server. Communication unit allows the location server to communicate with other entities.

Those of skill in the art would understand that information and signals may be represented using any of a variety of different technologies and techniques. For example data instructions commands information signals bits symbols and chips that may be referenced throughout the above description may be represented by voltages currents electromagnetic waves magnetic fields or particles optical fields or particles or any combination thereof.

Those of skill would further appreciate that the various illustrative logical blocks modules circuits and algorithm steps described in connection with the disclosure herein may be implemented as electronic hardware computer software computer firmware or combinations of these. To clearly illustrate this interchangeability of hardware software and firmware various illustrative components blocks modules circuits and steps have been described above generally in terms of their functionality. Whether such functionality is implemented as hardware software or firmware depends upon the particular application and design constraints imposed on the overall system. Skilled artisans may implement the described functionality in varying ways for each particular application but such implementation decisions should not be interpreted as causing a departure from the scope of the present disclosure.

The various illustrative logical blocks modules and circuits described in connection with the disclosure herein may be implemented or performed with a general purpose processor a digital signal processor DSP an application specific integrated circuit ASIC a field programmable gate array FPGA or other programmable logic device discrete gate or transistor logic discrete hardware components or any combination thereof designed to perform the functions described herein. A general purpose processor may be a microprocessor but in the alternative the processor may be any conventional processor controller microcontroller or state machine. A processor may also be implemented as a combination of computing devices e.g. a combination of a DSP and a microprocessor a plurality of microprocessors one or more microprocessors in conjunction with a DSP core or any other such configuration.

The steps of a method or algorithm described in connection with the disclosure herein may be embodied directly in hardware in a software module executed by a processor as part of firmware or in a combination of these. A software module may reside in RAM memory flash memory ROM memory EPROM memory EEPROM memory registers hard disk a removable disk a CD ROM or any other form of storage medium known in the art. A firmware module may reside in ROM memory PROM memory EPROM memory EEPROM memory or may be part of a processing device. An exemplary storage medium is coupled to the processor such that the processor can read information from and write information to the storage medium. In the alternative the storage medium may be integral to the processor. The processor and the storage medium may reside in an ASIC. The ASIC may reside in a user terminal. In the alternative the processor and the storage medium may reside as discrete components in a user terminal.

The previous description of the disclosure is provided to enable any person skilled in the art to make or use the disclosure. Various modifications to the disclosure will be readily apparent to those skilled in the art and the generic principles defined herein may be applied to other variations without departing from the scope of the disclosure. Thus the disclosure is not intended to be limited to the examples and designs described herein but is to be accorded the widest scope consistent with the principles and novel features disclosed herein.

