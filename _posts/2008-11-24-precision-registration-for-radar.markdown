---

title: Precision registration for radar
abstract: A precision radar registration (PR) system and method that employs highly accurate geo-referenced positional data as a basis for correcting registration bias present in radar data. In one embodiment, the PRmethod includes sample collection and bias computation function processes. The sample collection process includes ADS-B sample collection, radar sample collection, and time alignment sub-processes. The bias computation function process includes bias computation, quality monitoring and non-linear effects monitoring sub-processes. The bias computation sub-process results in a bias correction solution including range bias b, azimuth bias b, and time bias bparameters. The quality monitoring sub-process results in an estimate of solution quality. The non-linear effects monitoring sub-process results in detection of the presence of non-linear bias, if any, in the bias correction solution.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08054215&OS=08054215&RS=08054215
owner: Lockheed Martin Corporation
number: 08054215
owner_city: Bethesda
owner_country: US
publication_date: 20081124
---
This application claims priority from U.S. Provisional Application Ser. No. 60 991 588 entitled PRECISION REGISTRATION FOR RADAR filed on Nov. 30 2007 which is incorporated by reference herein in its entirety.

This invention was made with Government support under Contract No. DTFA01 03 C 00015 awarded by the Federal Aviation Administration. The Government has certain rights in this invention.

The present invention relates generally to the tracking of target by radar and more particularly to correcting registration bias present in radar data.

The raw data provided by radar a measurement of range and azimuth in the radar coordinate system is subject to random noise and systematic errors aka registration errors . Before radar targets can be used by the tracking and display functions of Air Traffic Control ATC systems registration errors must be removed with as much accuracy as possible. In multi sensor environments failure to align the reference frames could result in unphysical track discontinuities and degraded surveillance accuracy to levels even lower than any single sensor. Legacy systems utilize methodologies to address registration errors between radars such that corrected reports from multiple radars each report an aircraft to be at the same position. The introduction of ADS B Automatic Dependent Surveillance Broadcast gives rise to a need to register ADS B target positions with radar positions in order to support safe separation of ADS B equipped aircraft from non ADS B equipped aircraft. In addition ADS B opens the possibility for significant accuracy improvements in the determination of registration parameters.

Air traffic controllers maintain aircraft safely separated with the help of targets rendered on a situation display as well as other tools. In a multi sensor environment e.g. combining various radars and ADS B the positional data displayed to the controller will show path discontinuities when there are residual registration correction errors. Inaccuracies in registration correction will also have a detrimental impact in the accuracy of the tracker and subsequently in the functions that depend on tracker outputs such as the tactical conflict alert function .

The legacy solution to the registration bias problem was developed based on a radar pair system. Targets from aircraft flying in a region where the coverage of two radars overlaps at least partially are time aligned and the distance between them computed. After collecting a large sample of such targets the random component in the computed distance is reduced tends to cancel out or reach negligible levels for sufficiently large samples the remaining value is an indication of uncorrected bias azimuth and range separately . All of these algorithms are related to the Maximum Likelihood ML problem i.e. obtain the best model parameters possible given the observed data where the model here is a simple additive bias to the azimuth and the range . Depending on the level of sophistication these algorithms are formulated in terms of a Least Squares LS problem only variances are used or a Generalized Least Squares GLS problem full covariance matrix is used .

However registration correction algorithms that work with radar pairs are not readily usable with ADS B surveillance sources. Leaving data format incompatibilities aside possible extensions of the two radar algorithms to use ADS B sources by treating the ADS B as data of better quality fail in two respects a most of the algorithms do not support sensors with large differences in accuracy and most importantly b even if they incorporated weights to the measurements based on sensor accuracy in a multi sensor environment the registration solutions can potentially be unstable exhibiting oscillations ringing when a 3sensor is introduced. To exemplify when the sensor pair A B is used the registration solution for B is high but when the algorithm is run for the pair B C the solution for B becomes low . An unstable oscillating solution is observed when alternating between A and C to find registration corrections for B.

A commonly used algorithm in major ATC systems HCS ERAM etc is the 2 radar 4 equation method R2E4 legacy registration which is a Least Squares minimization of the distance between pairs of reports coming from two radars and using a large collection of time aligned common targets. These algorithms rely on collecting two separate samples of targets from two regions located to each side of the line joining the radar centers. The need to have two independent samples collected in these two separate regions is dictated by the choice of LS problem that couples the equations containing the 4 registration parameters range and azimuth for two radars . In addition to the two problems described above the R2E4 introduces the additional burden of the need to have separate collections in two regions which could limit or exclude altogether its usability in areas of low traffic. Another drawback of the legacy registration algorithm is the need for a single sensor tracker implemented within the registration function that provides accurate time extrapolated positions to allow for time coincident comparisons of target positions. To improve accuracy of the time alignment of targets in some implementations a maneuver detector filters out maneuvering targets adding algorithm complexity .

Accordingly the present invention provides a precision radar registration PR algorithm that employs highly accurate geo referenced positional data as a basis for correcting registration bias present in radar data. In one embodiment the geo referenced positional data may be ADS B data although in other embodiments the geo referenced positional data may be from other sources in lieu of or in addition to ADS B systems.

The PRalgorithm may be implemented in for example ATC systems air surveillance radar networks with ADS B equipped aircraft traffic defense systems and command and control systems. The legacy approach to registration may be retained in an integrated implementation however the proposed algorithm does not depend on a tracker to provide a velocity. Instead target histories are retained and time alignment is achieved by interpolation between closely spaced ADS B target histories. Smoothed velocities used for target selection are derived from target histories. This approach reduces complexity and eliminates prediction errors such as tracker lag that are possible when using tracker produced velocity and is a key element that makes this registration approach independent from the ATC tracking function. That independence makes it possible to perform registration analysis on radars that are in a maintenance configuration that provides target reports as inputs to the system but are not made available to the tracking function.

The present invention recognizes that uncorrected registration bias parameters can be derived with significantly higher accuracy when ADS B data is available rather than just radar data this is due to the intrinsic higher accuracy of the ADS B data which is based on GPS. The algorithm presented here uses ADS B surveillance data as a positional reference to derive range azimuth and time bias parameters using targets associated with ADS B equipped aircraft that are simultaneously observed by radar. The registration correction algorithm also includes the derivation of registration correction parameters for radars not visited by ADS B traffic but that partially overlap radars that do have ADS B traffic within their coverage. Another situation where the PRalgorithm provides registration correction parameters is when a radar has only partial coverage of ADS B traffic. In this case PRfinds registration solutions as long as there are sufficient numbers of targets that pass the data collection criteria.

The PRalgorithm utilizes ADS B data as an accurate positional reference against which radar targets can be compared. The algorithm makes use of the Linear Regression Analysis LRA between the range and azimuth measurement differences and respective velocities. For situations where time bias is absent the LRA formalism reduces to the Least Squares LS approach that compares measurements targets with the trusted reference ADS B and minimizes the difference. To achieve enhanced results from the PRalgorithm it may be desirable for a sufficiently large sample of targets from a single radar and from ADS B equipped aircraft to be collected although it may be possible to achieve acceptable results with a smaller number of samples. For each radar a single radar optimization is performed to obtain its corresponding range azimuth and time bias parameters. The part of the algorithm that extracts the registration correction parameters can be extended to radars for which it is not possible to collect a sample of targets from ADS B aircraft but that overlap with radars that do have ADS B traffic. This is achieved by reusing the algorithm this time using the ADS B calibrated radar as the trusted source that serves as an accurate positional reference. This mechanism in effect transfers the positional accuracy of the ADS B calibrated radar to a second radar not in contact with ADS B traffic. The availability of an absolute reference removes the potential instability of solutions that could be obtained in current radar pair algorithms. One advantage of the PRalgorithm as compared with legacy algorithms is that whereas the legacy algorithms work on radar pairs providing a solution set for the 2 radars as a pair with subsequent potential inconsistencies of solutions when one of the members of the pair is paired with a 3overlapping radar the PRalgorithm fixes the ADS B source as a reference and only adjusts the three bias parameters for a single radar resulting in a more robust and stable solution. The algorithm also provides a metric that monitors the quality of the solution and thus aids in the identification of sources of registration bias not correctable by simple azimuth range and time bias parameters. These errors can arise as a result of errors in the adapted site coordinates. The mechanism proposed here includes an extension that derives proposed corrections to the site coordinates. The PRalgorithm may be integrated with legacy registration algorithms which will operate in parallel and can provide backup capability during ADS B rollout periods or periods of ADS B coverage degradation or outage.

Various refinements exist of the features noted in relation to the various aspects of the present invention. Further features may also be incorporated in the various aspects of the present invention. These refinements and additional features may exist individually or in any combination and various features of the various aspects may be combined. These and other aspects and advantages of the present invention will be apparent upon review of the following Detailed Description and accompanying figures.

In other embodiments the PRalgorithm may be implemented with a subset of the above five elements e.g. where sufficient samples of targets are collected from ADS B equipped aircraft for all radars being registered the third element of radar to radar registration is not needed . Regardless of the number of elements implemented provides an overview of the functional flow process of the PRalgorithm .

In the PRalgorithm is shown as including two main processes a PRsample collection process and a PRbias computation function process. The PRsample collection process includes ADS B sample collection radar sample collection and time alignment sub processes. The PRbias computation function process includes bias computation quality monitoring and non linear effects monitoring sub processes. The bias computation sub process results in a bias correction solution including range bias b azimuth bias b and time bias bparameters. The range bias b and azimuth bias b are examples of and may be referred to herein as the position bias parameters. The quality monitoring sub process results in an estimate of solution quality . The non linear effects monitor sub process results in detection of the presence of non linear bias if any in the bias correction solution . Various details of the foregoing elements of the PRalgorithm are described below 

The method for sample collection is described below. Sample collections includes both ADS B sample collection and radar sample collection . To achieve enhanced results it may be desirable that there be a statistically significant sample set. Preliminary analysis indicates that bias calculations can be performed with a sensitivity 1 sigma level of 10 feet in range 0.05 ACP azimuth change pulse units 360 4096 in azimuth and 16 milliseconds in time. These results were obtained using sample sizes of n 2000 targets that can be acquired in just below 3 minutes of operation under realistic traffic this result applies for a modeled bias amplitude equal 3 times the noise and it is independent of where the targets fall inside the radar coverage area . Sensitivity decreases in proportion to 1 square root over n when the sample size n increases. The samples collected comprise a series of uncorrected or previously corrected for registration radar reports together with ADS B reports from the same aircraft during the same time period. It is assumed there will be multiple ADS B reports for each radar report however one sample is counted for one radar report. Selection of a sequence of reports from several aircraft in different parts of radar coverage is desirable. It is noted that given the typical traffic loads in ATC facilities a sample of few hundred targets can be collected in a relatively short time for instance with 70 active aircraft flying inside the radar coverage a sample of 400 targets can be collected in just over 1 minute subject to traffic level. 

Collected targets are stored in containers that allow keyed access based on beacon code. When a total of or more targets has been collected for a number of aircraft each of which has at least sample collection stops for this iteration of the algorithm it is envisioned that the algorithm runs continuously although position and time bias parameters are obtained in a single pass . In this regard and are parameters that can be established prior to execution of the PRalgorithm . At the end of the collection period both the target data and the corresponding ADS B data is made available in suitable keyed containers. Removal of outliers resulting for instance from duplicate or non discrete beacon is handled by grouping targets from duplicate beacon codes based on a correlation algorithm works assuming these two aircraft are not flying too close to each other that excludes a target from one of the aircraft if the point to point distances and velocities exceed reasonable thresholds. Logic to deal with code duplication is essential however to reduce exposure to error it is advisable to limit sample collection to discrete codes. Use is made of the ICAO address available in ADS B targets to ensure that ADS B samples for one aircraft have the same ICAO address. Sample collection is transparent to beacon code changes in mid air because such changes will be consistently reflected in both the radar and ADS B sensors.

In accordance with the bias computation sub process the LRA takes place separately for range and for azimuth. The LRA delivers the slope and intercept of correlation pairs dot over and dot over which constitute the sought bias coefficients intercept physical bias slope time bias . The linear relationship between the and dot over and between and dot over stem from the fact that performing a time translation i.e. time bias to the kinematic equations for t and t result in a linear relationship to first order in time t of the form b bdot over for range and b bdot over for azimuth where b is the physical range bias b is the physical azimuth bias b is the time bias as seen in the range data and b is the time bias as seen by the azimuth data. In this embodiment the smoothed velocities dot over dot over are computed with point to point central differences and the Sym filter. The Sym filter is convenient and performs well but it is not critical to the correct operation of the PRalgorithm. Other smoothing filters could work as well. The Sym is an acausal symmetric filter and refers to the weighting coefficients of the current measurement and the previous smooth estimate . Note that the algorithm operates after the sample has been collected therefore at any given target time both the past and future path of the aircraft as given by ADS B are known. The use of an acausal filter is therefore justified. This non real time mode of operation greatly simplifies the implementation because there is no dependency on a secondary tracker that provides predicted positions. Making use of known future positions relative to the radar target time makes the estimation of velocities and time aligned ADS B positions simpler and more accurate. The algorithm described below incorporates some implementation choices that could admit variants in other embodiments of the algorithm. The important concept exposed by the PRalgorithm is that registration bias can be extracted in one pass and simultaneously for range azimuth and time by performing a LRA on the data pairs dot over and dot over . The LRA method below is a particular implementation that finds the slope and intercept of a linear trend by minimizing the difference between the data points and the corresponding ordinate of the linear trend evaluated at the same abscissa of the data point. There are other alternatives such as minimizing the orthogonal distance between the data point and the linear trend. Numerical evaluations of the algorithm shows that there are no substantial performance gains for more complex implementations of the LRA analysis. Evaluation of the performance of the LRA analysis as implemented below and using realistic inputs show that it performs as well as more complex LRA implementations that explicitly incorporate the errors in the measurement of the velocities.

The processing steps and intermediate calculations required to obtain range azimuth and time bias the bias correction solution using the PRapproach are described below. The steps refer to computation of regression coefficients for a single radar. The steps are repeated in identical fashion for all of the radars.

If the input target data is raw not registration corrected the computed correction bias parameters b b and bare added to the raw azimuth and range to obtain the corrected values. If the input target data is registration corrected using previously obtained correction parameters then b b and bprovide adjustments to the currently used registration correction parameters. Use of unregistered inputs is preferred to avoid computational losses in bias calculation however either method will work.

Working under realistic loads it is foreseen that a PRsolution will be available every few minutes. To reduce the statistical fluctuation of solutions it is advantageous to apply a run to run smoothing of the registration parameters 1 where 

For radars for which it is not possible to collect a sufficiently large sample of targets from ADS B equipped aircraft but that overlap with another radar that has undergone single radar ADS B based registration correction see step the PRalgorithm may proceed as follows 

Data from the ADS B based corrected radar is used as the trusted positional reference albeit with larger uncertainty in lieu of the ADS B proper data and the single radar algorithm described in step is applied using the targets from the ADS B based corrected radar data as ADS B data. The standard deviations of the measured and are computed using the appropriate noise characteristics of the radar in question. To compensate for higher target noise the sample size should be incremented and the interpolation smoothing should be made more aggressive velocity estimation depends on noisy targets . Note that the solution for the radar in question is still of good quality better than the radar pair 2R4E legacy algorithm because it relies in the accurately corrected positions from the reference radar the added noise can be made as small as possible limited only by sample size constraints .

After obtaining a solution its quality is evaluated by computing the statistic or goodness of fit as described in step . In this regard the statistic estimates the solution quality of the bias correction solution . The statistic is a measure of the residuals around the linear trend. If those residuals are consistent with noise i.e. they follow a chi squared distribution then one can say that the derived registration correction parameters do explain the observed linear behavior that is the observed deltas and and the corresponding velocities exhibit a linear correlation dependency. On the other hand if there are data quality issues outliers excess noise etc or other non linear effects driving registration response such as site surveying errors deteriorated performance of the radar motor mechanical anomalies antenna tilt etc then the measured will have a high numeric value that has a low probability of being a result of noise alone thus indicating the presence of bad data or non liner effects. This result on itself is an accurate diagnostics tool. The probability associated with the chi squared statistic providing an indication of the strength of the deviation from non linearity.

In the event of detecting a non linearity in some cases as noted below the PRbias computation can be used to identify the source of non linearity by looking at the variation of registration correction parameters as a function of azimuth. To perform this analysis target data is grouped in azimuth bins for example 12 bins of 30 each . For each azimuth bin the entire PRprocessing is followed step . A plot of the resulting registration correction parameters as a function of azimuth can be compared with distinct known signatures from various effects as follows 

A generalized method to extract the amplitude of non linear effects when the source has been identified may be implemented. A generalized least squares LS formalism for computation of non liner registration bias effects can be stated as follows Define a generalized chi squared function

The f f functions could be analytical expressions with the non linearities explicitly stated or could be the result of data transformations where the effects in question are taken into account. For instance the site surveying errors can be included in this analysis by applying an X Y offset these offsets being the only two coefficients in the vector b to the adapted radar location as part of the computation of the deltas and . The function above is minimized numerically and the set of coefficients b that results in the minimum is the solution. The considerations on goodness of fit described in connection with step also apply in the context of step .

Integration of PRwith a legacy system is depicted in . The PRalgorithm such as previously described provides registration bias corrections for radars that have ADS B targets within their coverage area as well as overlapping radars that do not if any exist. If desired in a deployed configuration the PRalgorithm may operate in parallel with a legacy radar to radar registration algorithm. In this regard an ATC system may have PRregistration functions implemented in parallel with legacy radar to radar functions The two types of functions will execute independent of each other. It is expected that the PRregistration bias corrections will be used operationally either automatically applied or with manual approval . In the event the PRregistration algorithm fails to provide bias corrections the corrections provided by the legacy function may be used. In addition the corrections provided by the two algorithms may be compared and alarms triggered if there is a significant difference in the algorithm results.

As illustrated in the PRalgorithm may be incorporated in the form of a PRregistration function within an ATC system that also includes radar data processor and position display features. In accordance with the PRoperations concept an ADS B equipped aircraft receives GPS broadcast signals from a GPS constellation processes the GPS signals onboard the aircraft and transmits ADS B information to an ADS B ground station that is in communication with the ATC system . One or more radar sites in communication with the ATC system monitor the aircraft . The radar data processor of the ATC system processes the radar data from the radar site s and provides the processed data to the PRregistration function which registers the radar site s using the ADS B positional data . The PRregistration function outputs bias corrections for the radar site s to the radar data processor . This capability allows the radar data processor to provide registration corrected target reports for display by the position display of the ATC system .

An example of the alignment of target reports from two overlapping radars radar A and radar B is depicted in . On the left side of the coverage area of radar A is represented by circle and the coverage area of radar B is represented by circle . Target reports from radar A for an aircraft moving through the coverage area of radar A are represented by symbols. Target reports from radar B for the aircraft moving through the coverage area of radar B are represented by x symbols. ADS B position reports for the aircraft are represented by the symbols. As can be seen on the left side plot of a number of the target reports from radars A and B may be misaligned due to uncorrected registration present in radars A and B. In this regard symbols represent the deviations from the more accurate ADS B sensor reported positions for the aircraft . The right hand side of illustrates the improved alignment of the target reports from radars A and B with the ADS B position reports from the aircraft after registration correction using position bias and time bias parameters generated for radars A and B respectively using the ADS B reports as an accurate positional reference in accordance with the PRalgorithm such as described herein.

While various embodiments of the present invention have been described in detail further modifications and adaptations of the invention may occur to those skilled in the art. However it is to be expressly understood that such modifications and adaptations are within the spirit and scope of the present invention.

