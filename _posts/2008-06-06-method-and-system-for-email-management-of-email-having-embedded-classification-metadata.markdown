---

title: Method and system for E-mail management of E-mail having embedded classification metadata
abstract: A method and system method for e-mail management of e-mails having embedded classification metadata. A query from an end user to access an e-mail account by an e-mail client is received. It is then determined whether the query has come from an insecure e-mail client, such as a web e-mail client. Access rules for defining classification access restrictions for the e-mail client to access e-mail in the e-mail account are retrieved when the e-mail client is determined to be insecure. The e-mail query can then be modified before sending to an e-mail server storing the email account. The query is modified based on the retrieved access rules to exclude retrieval of e-mails based upon the e-mail classification metadata.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08171540&OS=08171540&RS=08171540
owner: Titus, Inc.
number: 08171540
owner_city: 
owner_country: CA
publication_date: 20080606
---
This application claims priority from U.S. provisional application No. 60 942 982 filed Jun. 8 2007 which is hereby incorporated by reference.

The present invention relates to computer systems and software and in particular to electronic mail management and security.

Software applications exist to generate many different types of electronic mail. Web based e mail software web e mail allows users to access and send e mail via standard Internet browser sessions. With today s pervasive networking systems such as local area networks LANs wide area networks WANs and the Internet and software tools such as e mail it is very easy for individuals to send and read e mail from different computers computer systems and other individuals. As a matter of corporate security there is therefore a need to limit what e mail users can read and access while viewing e mail over unsecure channels such as the Internet and while reading e mail using unsecured non corporate PCs personal computers using browser based web e mail such as Microsoft Outlook Web Access.

Typical web based e mail systems allow the user to view any e mail messages and attachments regardless of the sensitivity of the information contained in the e mail. By definition web based e mail was designed to make it easy for users to view their e mail wherever they are and whenever they want. Making e mail access so easy also increases the likelihood of security breaches by orders of magnitude. Individuals passing by a user at a public kiosk can easily catch glimpses of secure documents or even see a user s entire logon name and password. Users can accidentally leave their account open when they leave a kiosk so the next user will have complete access to all of their e mails. And unless the web e mail service is provided over a virtual private network VPN and generally they are not then the various Internet Service Providers network Administrators and kiosk providers involved with the local system may all have access to the e mails. In addition users with access to web based e mail from their home computer may save sensitive e mails or document attachments to their home PC where the data will be beyond the control of the company they work for.

In addition most web based e mail systems keep a cache of e mail read on the local computer. If the local computer is a public terminal it is possible that anyone could view this e mail information via examination of the cache. As a result there is no current way to limit what e mail can be viewed via web e mail and there is no way to protect e mail information that is stored in the local cache of a publicly accessible computer.

In some jurisdictions effective e mail security is not just a matter of good business it s the law. Compliance legislation such as the Sarbanes Oxley Act in the United States or more precisely the Public Company Accounting Reform and Investor Protection Act of 2002 for example requires that safeguards be put in place to ensure the accuracy of financial reports. These include security of electronic data against unauthorized access or change both during transmission and in storage. In other jurisdictions there can be great liability if personal client information is leaked or becomes public. Web e mail provides more opportunities for these leaks to occur.

There is therefore a need for a method of and system for preventing users from viewing sensitive e mail when viewed via web based e mail systems.

An improved method of and system for preventing the viewing of sensitive e mail when using web based e mail systems is provided which obviates or mitigates at least one of the disadvantages described above.

Though users have full access to all of their e mail when accessing their e mail from a corporate computer on the corporate network in order to ensure greater information security companies may wish to limit what e mail users can read when using web e mail. Whereas companies may allow their users to view personal unclassified or low security e mail using web e mail they may wish to prevent users from viewing sensitive e.g. classified private or confidential e mail when using web based e mail.

In accordance with an aspect of the present disclosure there is provided a method for e mail management of e mails having embedded classification metadata the method comprising the steps of receiving a query from an end user to access an e mail account by an e mail client determining whether the query has come from an insecure e mail client retrieving access rules for defining classification access restrictions for the e mail client to access e mail in the e mail account when the e mail client is determined to be insecure and modifying the received query before sending to an e mail server storing the email account the query being modified based on the retrieved access rules to exclude retrieval of e mails based upon the e mail classification metadata.

In accordance with another aspect of the present disclosure there is provided a system for e mail management of e mails having embedded classification metadata the system comprising a memory and a processor for executing the steps of receiving a query from an end user to access an e mail account by an e mail client determining whether the query has come from an insecure e mail client retrieving access rules for defining classification access restrictions for the e mail client to access e mail in the e mail account when the e mail client is determined to be insecure and modifying the received query before sending to an e mail server storing the email account the query being modified based on the retrieved access rules to exclude retrieval of e mails based upon the e mail classification metadata.

In accordance with yet another aspect of the present disclosure there is provided a computer readable medium containing instructions for providing e mail management of e mails having embedded classification metadata the instructions which when executed by a processor perform the steps of receiving a query from an end user to access an e mail account by an e mail client determining whether the query has come from an insecure e mail client retrieving access rules for defining classification access restrictions for the e mail client to access e mail in the e mail account when the e mail client is determined to be insecure and modifying the received query before sending to an e mail server storing the email account the query being modified based on the retrieved access rules to exclude retrieval of e mails based upon the e mail classification metadata.

Other aspects and features will become apparent to those ordinarily skilled in the art upon review of the following description of specific embodiment of the invention in conjunction with the accompanying figures.

It will be noted that throughout the appended drawings like features are identified by like reference numerals.

Due to compliance legislation such as the Sarbanes Oxley Act in the United States or more precisely the Public Company Accounting Reform and Investor Protection Act of 2002 and general requirements for greater security of information companies need to be able to protect the distribution and viewing of certain information contained in e mails. One of the ways to protect sensitive or confidential information is to limit what e mail can be used over unsecured channels such as web based e mail systems. Heretofore this could not be done with web mail access software such as Microsoft Outlook Web Access OWA software. Web mail programs such as OWA cannot prevent the viewing of sensitive e mail. However the system and method described herein can prevent the user from viewing and reading messages classified as containing certain sensitive information.

In addition to allowing the viewing of only certain classifications the system and method allows administrators to block viewing of any messages that have not be classified when they were sent. This ensures that e mail which carries no classification but may be sensitive is not viewable over web based e mail systems. As described above the web mail server receives e mail queries from End Users and determines whether a given query can be satisfied. Since the web mail server is considering the e mail classification metadata to determine which e mails can be forwarded to the end user any e mails that are not classified at all can be blocked from access.

The present disclosure provides easy to use administration tools which allow administrators to determine what type of information will be viewable by users over web based e mail systems such as Microsoft OWA. Administrators can modify the configuration file on the OWA Server to determine what type of e mail users can view. This file settings.js contains the configurations for the software. By editing the settings file on the Outlook Web Access Server administrators can immediately change what e mails are viewable. For example users can be restricted from opening e mails that have an attachment by configuring one of the file settings to OFF . The system does not have to analyze or parse attachments to determine whether they can be forwarded it merely has to check the e mail metadata to make this determination. The default in the event that a type of attachment cannot be identified is simply to block the attachment. Of course access to the administration controls are protected using standard password access and similar control access security systems.

By limiting access to classified e mail when a public web mail client is being used personal private information is protected to ensure compliance with legislation such as Sarbanes Oxley the Health Insurance Portability and Accountability Act HIPAA or other legal or corporate guidelines.

A system and method for preventing the viewing of sensitive web based e mail works in concert with and is complementary to all e mail pre classification systems is provided. In each case the following exemplary e mail classification systems tie some form of metadata to specific e mails to define a classification property 

a The Titus Labs Message Classification for Web Access OWA product allows the users to classify web based e mail based on e mail specific properties such as security classification document type document retention document caveats and the like. The system generates e mail properties that are associated with the e mail as well as inserting visual markings in the e mail that allow users to quickly identify the security sensitivity intended distribution or retention requirements of the document 

b The Australian E mail Protective Marking standard provides a method for classifying e mail and creating e mail metadata via the X protective marking in the e mail header and

c E mail programs such as Microsoft Outlook 2007 allows users to add a classification property to e mail. This metadata is placed in the e mail x header however the classification is only provided for identification purposes and is not utilized to limit access.

As an example using e mail pre classification a user could classify an e mail as SECRET. This would automatically create an e mail property which identifies the e mail as secret. The property travels with the e mail to ensure that the recipient is aware of the classification.

Existing classification properties only provide information as to what the author deemed the content to be classified as. The ability to limit viewing of the actual e mail has not been provided. Existing web mail clients do not allow administrators to prevent viewing by end users of sensitive e mail that have been classified. As an example when users create new e mail classifying their messages for example as either UNCLASSIFIED or CONFIDENTIAL the present system and method prevents any recipients from viewing the CONFIDENTIAL e mail when reading messages via web based e mail systems whereas when a more secure client such as a desktop client is utilized access to the content is enabled.

Administration options are provided which allow an administrator to decide what type of e mail a user will be able to view when reading messages via web e mail client such as Microsoft Outlook Web Access. For example if all e mail is classified in one of three categories PERSONAL CONFIDENTIAL and SECRET the administrator has the option for defining access rules for allowing 

Administrators can restrict viewing of e mails with attachments over web based e mail. For example if an e mail has a document attached to it the administrator could restrict viewing of the e mail. In addition restriction of e mail with attachments regardless of the type of attachment is provided.

The following example provides more details on the system operation. In this example Microsoft Outlook Web Access is used as the web based e mail system though other e mail systems could also be used. The general architecture of the system is presented in . In short the bulk of the system resides on web mail server such as Outlook Web Access Server. The web mail server supports an application programming interface such as a JavaScript Environment. The web server functionality may be part of the mail server itself. The software code on the web mail server is operable to 

The flow of the system is also illustrated in . The following steps describe how a user would get access to their web based 

In contrast presents an exemplary Outlook Web Access client in a web browser providing Inbox through a user interface with only UNCLASSIFIED messages presented as shown in the subject line . In both cases the user interface appears very much as it would for any e mail application including the usual toolbars folder window list of e mail messages and the like. The only significant distinction is that the level of security is displayed in the subject re line of each e mail with a more detailed definition in each e mail itself. And of course e mails that the user is not authorized to view do not appear at all. Alternatively classified message headers may be viewable however when the user selects the message the message content will not appear and an alternative message is provided.

There is no published application programming interface API for Microsoft Outlook Web Access. In order to prevent messages from being viewed in Outlook Web Access the actual Microsoft OWA Javascript code needs to be changed and enhanced. As a result a very good understanding of the original Microsoft OWA code is required.

Because the OWA Javascript code is modified any time that Microsoft issues a new version or service pack of OWA the system needs to be modified resulting in slightly different code for each version of Microsoft OWA. In order to be able to ship only one version of the system we needed to come up with an install process that can recognize the current running version service pack fix of Microsoft OWA and install the correct code. This was done by calculating a hash of the Microsoft code and comparing the hash against stored codes representing each running version service pack fix of Microsoft OWA prior to installation.

Some e mail systems such as OWA will allow users to submit direct requests for specific e mails if they know the e mail Subject name rather than accessing via clicking on the message in the Inbox . For instance if there is an e mail with a Subject of Company Meeting a user may be able to request the viewing of this e mail simply by typing in a web address such as http owa.example.com exchange username Company Meeting.eml. This means of accessing e mails as it could be used to get around the restrictions to web e mail viewing. In order to continue to restrict viewing sensitive e mail based on the administrator configuration these requests are intercepted and it is determined whether they are outside what the administrator has allowed. If this is the case system will immediately close the viewing window for this e mail as soon as it starts to display so the user will not have time to read the e mail. Alternatively one could simply block all requests of this type.

The following describes the logic of the software and the associated triggered actions. The system adds functionality to the OWA client Microsoft OWA is referred to here as existing files or functions . It does this by modifying the files on the Microsoft Exchange server that sit in the Exchange directory default location of C Program Files Exchsrvr exchweb . Following is a list of files the may be modified or added to that directory. For each file will be a list of functions with a short description.

When a web client is showing the Inbox it sends a query to the Exchange Server that specifies what messages to retrieve. In this query are certain restrictions like what folder you are looking in Inbox Drafts Sent Items etc. . The web e mail server is modified by adding extra restrictions into the query before the query is sent to the mail server or Exchange Server. Instead of the query only specifying what folder to return items from restrictions are added stating what classification a message has to be. Restrictions are also added to only show messages without attachments when g SettingsRejectAttachments is enabled.

When a user wishes to view a message instead of that request going to the original mail web client code the classification code is accessed. If the request meets the criteria for viewing the message then the request is passed on to the original web client code for viewing. If the request does not meet the criteria for viewing a message then an error message is displayed as specified in g SettingsRejectMessage to the user instead of passing on the request to the original mail web client code.

Based upon the web mail access client the mail classified mail may provide different options on how to limit user access. For example a web client such as OWA 2003 the user does not even see the prevented e mails in their Inbox. In another client such as Outlook Web Access 2007 the user sees the e mail in their Inbox but when they go to open it they see a message like Viewing of sensitive messages are not allowed using Outlook Web Access .

In a web client such as OWA 2003 the basic structure is the client sends a SEARCH HTTP HyperText Transfer Protocol command to the Exchange Server with XML sent with the request. This XML eXtensible Markup Language wraps an SQL Structured Query Language query. The actual SQL query is modified to access the desired e mail. The basic format of the SQL sent to the Exchange Server is 

The WHERE clause is modified to prevent e mail viewing an implement administrator preferences. Depending on the administrator configuration such as defined by a settings.js criteria can be added like classification of message UNCLASSIFIED or message does not have attachments .

g SettingsRejectAbove is a number that determines which messages will be viewable via OWA. If the defined first level tags are UNCLASSIFIED CLASSIFIED SECRET and administrator sets g SettingsRejectAbove to 0 than all messages are viewable. If the administrator sets it to 1 and only UNCLASSIFIED messages are viewable. Set it to 2 and only UNCLASSIFIED and CLASSIFIED messages are viewable.

g SettingsRejectAttachments is a Boolean true or false and when set to true will block access to all messages that have an attachment on them. When set to false all messages with attachments are viewable.

g SettingsRejectMessage is a string that is displayed to the user when the user attempts to open a message that has a classification above the setting for g SettingsRejectAbove.

g SettingsRejectUnmarked is a Boolean true or false and when set to true will prevent viewing of messages that have no classification.

a Preventing Web e mail viewing for other web based e mail systems besides Microsoft OWA such as Lotus Notes Web Mail G mail Hotmail Yahoo Mail etc. 

b Preventing viewing based on criteria other than message classification. For instance the software may scan the contents of the e mail to determine its sensitivity and then block access on pre determined levels of sensitivity 

d Blocking the viewing of attachments contained in messages such as documents or spreadsheets. For example users can be allowed to view the message body but denied the user to view any e mail attachments.

In the determination of the client it is assumed that different clients will use the same access or addressing methods to retrieve mail. While some clients and servers preferentially use vendor specific proprietary protocols most support the Internet standard protocols Simple Mail Transfer Protocol SMTP for sending e mail and Post Office Protocol version 3 POP3 and Internet Message Access Protocol IMAP4 for retrieving e mail allowing interoperability with other servers and clients. For example Microsoft s Outlook client typically uses a proprietary protocol to communicate with an Exchange server as does IBM s Notes client when communicating with a Domino server but all of these products also support SMTP POP3 and IMAP4. Support for the Internet standard protocols allows many other e mail Clients such as Pegasus Mail or Mozilla Thunderbird to access these servers and similarly allows the clients to be used with other servers. It may be assumed that all HTML web access is insecure and therefore client determination is not required. All e mail would then be filtered based upon the administrator configuration.

Secure clients may be desktop clients or a web clients providing a pre defined level of security encryption based upon user access such as Secure Sockets Layer SSL key lengths. Alternatively it may be assumed that is the query is directed to a web mail server no client determination is required and the communication is immediate considered unsecured and filtering is required. The determination of the security of the client may also be based upon location information associated with where the client is accessing the e mail from. For example if a web e mail client access an account from within a secure domain defined by an IP address or logon credentials the e mail may not be restricted. Likewise if a desktop client originates an access request from outside a trusted network it may be restricted to only viewing non classified e mail if the appropriate security restrictions are not in place. The method of access may also be used to determine if a client is secure or insecure. For example all access via mobile or wireless networks regardless of the end e mail client may be determined to be insecure thus limiting access.

It will be apparent to persons skilled in the art that many alternatives modifications and variations can be made without departing from the scope as defined in the claims. The method steps described may be embodied in sets of executable machine code stored in a variety of formats such as object code or source code. Such code is described generically herein as programming code or a computer program for simplification. Clearly the executable machine code may be integrated with the code of other programs implemented as subroutines by external program calls or by other techniques as known in the art.

A computing environment for executing the document creation application and the classification toolbar may be implemented as computer software in the form of computer readable code executed. The computing environment may be any number of computing or computer based platforms such as mobile devices personal computer notebook computers or personal digital assistants. The computer comprises central processing unit CPU and memory. The CPU may be a single processor or multiprocessor system. In various computing environments main memory and storage can reside wholly on computer environment or they may be distributed between multiple computers.

Input devices such as a keyboard and mouse may be coupled to a bi directional system bus of a computer for receiving input for creating documents within the web client. The keyboard and mouse are for introducing user input to a computer and communicating that user input to processor if required. Computer may also include a communication interface. Communication interface provides a two way data communication coupling via a network link to a network by wired or wireless connection or may provide an interface to other host devices by a direct radio frequency connection. In any such implementation communication interface sends and receives electrical electromagnetic or optical signals which carry digital data streams representing various types of information. Communication between the communication interface unit and the network or host use electrical electromagnetic or optical signals which carry digital data streams. The signals through the various networks and the signals on network link and through communication interface which carry the digital data to and from computer are exemplary forms of carrier waves transporting the information.

The computer processor or similar device may be programmed in the manner of method steps or may be executed by an electronic system which is provided with means for executing these steps. The storage device may include both fixed and removable media such as magnetic optical or magnetic optical storage systems Random Access Memory RAM Read Only Memory ROM or any other available mass storage technology. The storage device or media may be programmed to execute such method steps. As well electronic signals representing these method steps may also be transmitted via a communication network.

The embodiments described above are intended to be illustrative only. The scope of the invention is therefore intended to be limited solely by the scope of the appended claims.

