---

title: Precise delay measurement through combinatorial logic
abstract: A high resolution circuit and method for facilitating precise measurement of on-chip delays for FPGAs for reliability studies. The circuit embeds a pulse generator on an FPGA chip having one or more groups of LUTS (the “LUT delay chain”), also on-chip. The circuit also embeds a pulse width measurement circuit on-chip, and measures the duration of the generated pulse through the delay chain. The pulse width of the output pulse represents the delay through the delay chain without any I/O delay. The pulse width measurement circuit uses an additional asynchronous clock autonomous from the main clock and the FPGA propagation delay can be displayed on a hex display continuously for testing purposes.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07809521&OS=07809521&RS=07809521
owner: The United States of America as represented by the Administrator of the National Aeronautics and Space Administration
number: 07809521
owner_city: Washington
owner_country: US
publication_date: 20080229
---
The invention described hereunder was made in the performance of work under a NASA contract and is subject to the provisions of Public Law 96 517 35 U.S.C. 202 in which the Contractor has elected not to retain title.

The present invention relates to digital electronic circuits and more particularly to a method and system for measuring on chip delays for Field Programmable Gate Arrays FPGAs for reliability testing.

A Field Programmable Gate Array or FPGA is a semiconductor device containing programmable logic components that can be programmed to duplicate the functionality of basic logic gates such as AND OR XOR NOT or more complex combinatorial functions such as decoders or simple math functions. The FPGA also contains sequential logic in the form of configurable flip flops. Many FPGAs also include memory elements such as RAMs.

An FPGA typically includes an array of configurable logic blocks CLBs surrounded by a ring of programmable input output blocks IOBs . The CLBs and IOBs are interconnected by a programmable interconnect structure. The CLBs typically include several lookup tables LUTs . A LUT is an addressable memory array that is typically loaded with data during the configuration process. For example some commercial CLBs includes eight LUTS and eight flip flops. Each LUT has four data input terminals that address the configurable memory. By storing predetermined values in the appropriate memory locations the LUT can be configured to provide any function of up to four variables. Indeed all of the CLBs IOBs and interconnect structure are typically programmed by loading a stream of configuration data bitstream into internal configuration memory that define how the CLBs IOBs and interconnect structure are configured. The collective states of the individual memory determine the function of the FPGA. As the size and complexity of FPGAs grow manufactures are becoming more concerned with measuring the speed and performance of their designs.

The above noted test procedure is problematic with FPGAs because many of the signal paths internal to the chip are not accessible via input and output pins and therefore cannot be measured directly.

Traditionally a delay chain of inverters is placed on the FPGA with an input port feeding the inverter chain and an output port driving the output of the chain off chip. Unfortunately this is inaccurate since the input and output delays are included.

Another method arranges the delay chain as a ring oscillator. For example U.S. Pat. No. 6 075 418 to Kingsley et al. entitled System With Downstream Set or Clear for Measuring Signal Propagation Delays on Integrated Circuits issued Jun. 13 2000 describes methods of measuring signal propagation delays by including signal paths of interest in ring oscillators. The ring oscillators oscillate at frequencies that area function of the delays through signal paths of interest. The oscillation frequencies of such oscillators are therefore indicative of the delays through various paths of interest.

See also Direct Measures of Path Delays on Commercial FPGA Chips by Mania Ruffoni et al. 6IEE Workshop Proceedings volume issue 2002 pages 157 159 which suggests a comparison between the operating frequency of a ring oscillator that includes the path under test and that of a reference ring oscillator that does not. The ring oscillator approach suffers from the problem that it does not always oscillate as expected.

United States Patent Application 20030098731 by Tabatabaei Sassan et al. published May 29 2003 shows a high resolution time to digital converter TDC that uses a pair of digital oscillators. The periods of the oscillators differ. The oscillators are triggered by START and STOP pulses. A counter counts a number of pulses until reference points on the signals output by the oscillators coincide. Measurements may be made using a dual resolution method. Intrinsic jitter of the TDC can be determined by comparing sets of measurements in which the switch in resolutions is made at different points. A range extender circuit may be provided to extend a valid measurement range of the TDC.

U.S. Pat. No. 6 983 394 to Morrison et al. Xilinx issued Jan. 3 2006 shows a method and apparatus for clock signal performance measurement using a digital delay in conjunction with a processing circuit to continuously measure the jitter of an input clock signal. A pair of digital delay circuits is used to continuously measure the skew or delay between a reference clock signal and a input clock signal thus providing a measurement of the skew of the input clock signal over time. The digital delay circuit s are formed on chip and thus an on chip determination of jitter or skew may be provided.

Santos A CMOS delay locked and sub nanosecond time to digital converter chip IEEE Trans on Nuclear Science vol. 43 pp. 1717 1719 June 1996 discloses a TDC based on the use of a delay chain. In this circuit the output of the delay elements in the delay chain are set HIGH as the START rising edge travels through them. A delay locked loop DLL is used to calibrate the delay elements to a known delay. Such a calibration requires very good matching between all the delay elements in both the delay chain and the DLL.

M. Abramovici and C. Stroud BIST based delay fault testing in FPGAs Journal of Electronic Testing vol. 19 no. 5 pp. 549 558 October 2003 discloses a comparison based delay test method in which a number of identical paths are constructed in the FPGA under test and every LUT on these paths is programmed to propagate an input value to its output. A fault is detected when the difference between the arrival times at the destinations of the first and last signals exceeds a specified threshold.

Design Specific Path Delay Testing in Lookup Table based FPGAs Premachandran R. Menoh et al. Transactions On Computer Aided Design Of Integrated Cirtuits And Systems Vol. XX No. Y 2005 shows an approach for FPGA path delay testing which partitions target paths into subsets that are tested in the same test configuration. Each path is tested for all combinations of signal inversions along the path length. Each configuration consists of a sequence generator response analyzer and circuitry for controlling inversions along tested paths all of which are formed from FPGA resources not currently under test.

E. Chmelar FPGA interconnect delay fault testing in IEEE Int. Test Conf. Charlotte N.C. September 2003 pp. 1239 1247 is a similar comparison based delay approach to the Abramovici article.

M. Tahoori and S. Mitra Interconnect delay testing of designs on programmable logic devices in IEEE Int. Test Conf. Charlotte N.C. October 2004 disclose a method of testing all paths in a combinational network for delay faults in which all paths are simultaneously tested for slow to rise faults by applying 0 1 transitions at all inputs. Slow to fall faults are similarly tested by changing LUT functions to ORs and applying 1 0 transitions at all inputs.

It would be greatly advantageous to provide an improved circuit architecture and method for built in self test BIST of FPGA propagation delay using available unused FPGA resources that provides an actual and very precise measurement of the propagation delay through the delay chain without any input and output delays.

It is a primary object of this invention to provide a built in self test BIST for FPGA propagation delay by configuring unused FPGA resources.

It is another object to provide a BIST test architecture configured from unused FPGA resources and a method of testing propagation delays through the FPGA LUTs that eliminates input and output delays.

It is a more specific object to provide a built in self test BIST for FPGA propagation delay that embeds a pulse generator on the FPGA chip for propagating a pulse train through groupings of LUTs and a pulse width measurement circuit likewise on chip to measure the pulse width of the generated pulse through the delay chain the pulse width representing the delay through the delay chain without any I O delays so that a determination of the propagation delay can be made very accurately.

It is still another object to provide a BIST architecture and test method as described above that uses an additional asynchronous clock autonomous from a main clock to increase the accuracy of the measurement of propagation delay.

In accordance with the foregoing objects the present invention is a circuit that facilitates precise measurement of on chip delays for FPGAs for reliability studies. The circuit incorporates an on chip pulse generator and on chip pulse measurement circuitry programmed into a conventional semiconductor FPGA device to act as a performance monitor to measure the duration of a generated pulse through one or more groups of LUTS the LUT delay chain which are also on chip.

A multiplexer multiplexes the pulse train Output from the groupings of LUTs and a logic gate compares the multiplexer output with the input pulse train all also on chip . The pulse width measurement circuit measures the pulse width of the generated pulse through the delay chain the pulse width representing the delay through the delay chain without any I O delays so that a determination of the propagation delay can be made very accurately.

Given the present architecture the I O delays are no longer significant and the delay measurements can be made very accurately.

Moreover the pulse width measurement circuit uses an additional asynchronous clock autonomous from a main clock to increase the accuracy of the measurement of propagation delay. The additional clock is not synchronized to the main clock and this vastly improves the sampling rate and resulting accuracy. The pulses are sampled and converted to an error value using state machines counters and lookup tables. The result is displayed on an external multidigit hex display continuously.

The present invention is a BIST test architecture and method for precise measurement of on chip delays for FPGAs to be used in reliability studies. The architecture incorporates an on chip pulse generator and on chip pulse measurement circuitry to measure the duration of a generated pulse through one or more groups of LUTS the LUT delay chain also on chip. The measured pulse width represents the delay through the LUT delay chain under test. Since the pulse is generated on chip there are no significant I O delays and the delay measurements can be made very accurately. The on chip pulse width measurement circuit uses an additional asynchronous clock autonomous from a main clock to greatly improve the sampling rate and resulting accuracy. The on chip pulse measurement circuitry is configured to measure the pulse width of the output pulse which is then converted to a hex value using state machines counters and lookup tables. The result is displayed on a multidigit hex display continuously.

The illustrated circuit includes a main clock implemented by an external off chip clock crystal and in accordance with the invention an additional asynchronous clock autonomous from the main clock. The second clock is here implemented as an additional external off chip clock crystal which is independent and asynchronous relative to the first. In the illustrated embodiment one clock is set to 100 50 Mhz and the other is 32 33 Mhz. The 100 50 Mhz crystal is used to test a majority of the FPGA logic and its clock signal is fed into on chip pulse generator .

Pulse generator is preferably configured from conventional combinatorial and sequential logic circuits including a high speed logic Counter Divider configured from the combinational and sequential circuits on the FPGA which is programmed to operate as a pulse generator.

More specifically the pulse generator includes a counter divider that divides the frequency here 50 Mhz from clock down by a controllable factor that depends on setup switches on the board. The pulse generator is programmed to produce two synchronous outputs 1 a 1 pulse per second clock which is fed into a pulse width measurement block and 2 a nominal 125 KHz pulse train.

Pulse width measurement block is likewise preferably configured from combinatorial logic on the FPGA which is programmed to measure an output pulse width to be described by sampling at the 1 pulse per second clock rate.

The nominal 125 KHz pulse train is fed into a set of LUTs resident on the existing semiconductor FPGA device for propagation through the delay chain to be measured. The LUTs lookuptables are the universal logic gates that implement the combinational logic on the FPGA. They are programmed to be inverters or buffers depending on the position of a switch on the FPGA board.

A multiplexer MUX following the LUTs allows selection of the length of the delay chain to be tested. The MUX allows selection of various size delay chains which verifies the delay measurements. In the present embodiment the MUX is programmed from unused LUTs as a 6 to 1 multiplexer which selects up to six separate taps on the delay chain. The LUTs under test are grouped into interconnected groups of 500 by pre programming the FPGA input output blocks IOBs . Each multiplexer input DC DC is connected to the output of one group of 500 LUTs under test. Thus up to six groups of 500 LUTs or 3000 LUTs total may be included in the delay chain to be tested. Of course this number may vary depending on the size and number of inputs of the MUX . The selector input S comprises a binary bit value sufficient to control the given number of selector inputs and to control six inputs DC DC a three bit selector input S is required from switch . This way switch determines whether one two three or up to all six groups of LUTs anywhere from 500 3000 are included in the delay chain to be tested.

A logic AND gate has one inverted input connected as shown to the output of the MUX and another input connected to the 125 KHz pulse train of pulse generator . Thus the output of logic gate is a pulse train shown with pulses that are shorter than the 125 KHz pulse train of pulse generator . This is because the ANDing effectively limits the pulse width of the 125 KHz pulse train to the propagation delay time through the selected delay chain under test. Consequently the width of this illustrated shortened pulse equals the delay through the LUTs. The output of the logic gate is connected back around into the pulse width measurement block and thereby feeds the shortened pulse into the pulse width measurement block for measurement.

In order to give correct counter values the counter cannot have any asynchronous inputs. The two synchronization circuits serve to re synchronize the inputs to the counter to avoid this problem. There are a variety of existing circuits that will suffice for the two synchronization circuits including a two stage synchronizer.

The counter count value is fed to a 32 bit shift register which records the number of times the pulse is high during the 1 second sampling interval. At the end of the 1 second time interval the value of the counter is transferred to shift register and the counter is cleared.

It is noteworthy that the above described circuit uses an additional asynchronous clock autonomous from the main clock and which operates autonomous therefrom. An individual pulse could only measured to an accuracy of 30 ns but with two clocks there are 125000 pulses measured with different sampling points every time. The resulting accuracy is better than 0.25 ps. The key to the accuracy here is the use of the additional asynchronous clock. An additional sampling accuracy of the 1 pps second clock reduces the measurement accuracy to 30 ns but this is averaged over 125K pulses so it contributes only an additional 0.25 ps of error per pulse and so the resulting accuracy is better than 0.25 ps.

Referring back to the output from the 32 bit shift register may be converted to a hex value using state machines lookup tables etc. The final two blocks in take the value in the shift register of and convert it to a form which can be displayed. A display driver is connected to a multidigit hex display to continuously display the value.

For verification the pulse generated in the internal logic through the delay chain may also be output off chip for corroboration of the pulse width on an external oscilloscope.

It should now be apparent that the above described architecture and method provide a built in self test BIST for FPGA delay propagation using available unused FPGA resources that eliminates input and output delays and provides far greater accuracy.

Having now fully set forth the preferred embodiment and certain modifications of the concept underlying the present invention various other embodiments as well as certain variations and modifications of the embodiments herein shown and described will obviously occur to those skilled in the art upon becoming familiar with said underlying concept. It is to be understood therefore that the invention may be practiced otherwise than as specifically set forth in the appended claims.

