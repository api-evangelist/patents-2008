---

title: Image processing apparatus and printing request making method
abstract: The present invention provides an image processing apparatus including a print screen display unit configured to display in a display device a print screen including document information items regarding documents stored in a device which communicates with the image processing apparatus through a network, a print request unit configured to request a server which communicates with the image processing apparatus through the network to print a document corresponding to a document information item selected from among the document information items included in the print screen, and a print-request limitation control unit configured to prevent a new print request from being issued for a period of time from when the print request unit requests the server to print the document to when registration of print reservation information regarding a print reservation of the document in a print reservation information management unit is detected.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08330978&OS=08330978&RS=08330978
owner: Canon Kabushiki Kaisha
number: 08330978
owner_city: Tokyo
owner_country: JP
publication_date: 20080923
---
In client server systems loads on servers increase as the number of client terminals increase and therefore the risk of generation of fatal delays or failures in the systems is present. Furthermore such risks also exist for printing systems utilizing print servers and therefore measures to avoid these risks such as improving functionalities of servers or increasing the number of servers are taken in accordance with the increase in the number of client terminals.

Since the increase in the number of servers directly relates to increase in cost the number of servers should not be increased haphazardly. Therefore it is important to recognize loads to which the client terminals and the servers are subjected to and thereafter increase the number of servers.

Furthermore in the printing systems utilizing the print servers it is important to show to users progress of printing operations performed in the print servers from the viewpoint of usability.

Japanese Patent Laid Open No. 7 230515 discloses a method for allowing progress of processing performed between a client terminal and a server to be recognized from an amount of data transmitted between the client terminal and the server.

In addition in printing systems in the related art progress is recognized from the number of sheets printed by devices.

Moreover as a method for allowing progress of processing performed using a server to be recognized a method for periodically performing polling from a client terminal to a server is taken as an example. However in this method there may arise a problem in that the polling operation itself may become a load for the server.

In printing processing through a network there arises a problem in that information leaks may occur due to a printed sheet being abandoned or a user forgetting to take a printed sheet. Therefore there is a demand for a printing system in which a printed sheet is securely obtained by a user who instructed printing processing.

To meet this demand a printing system called a pull print system has been provided. In the pull print system a client terminal uploads data to be printed to a server and an actual instruction for printing is issued using a device. Therefore a printed sheet may be prevented from being abandoned or being forgotten to be taken.

The pull print system is one of the client server printing systems and the client terminal is equivalent to the device . Therefore as with the problems described above it is necessary to allow recognition of progress of processing performed using the server and control a load to which the server is subjected to.

However when the progress is managed in the pull print system by the method disclosed in Japanese Patent Laid Open No. 7 230515 the following problems arise.

In the pull print system unlike a system in which a client terminal including data to be printed transmits the data to be printed to a server and instructs performance of a printing operation data to be printed is managed in the server. Therefore it is difficult for the client terminal that is the device in the pull print system to recognize the size of the data to be printed and therefore it is difficult to recognize progress. Accordingly there arises a problem in that it is difficult to control a load to which the server is subjected to.

Furthermore with the method for managing the progress by the method disclosed in Japanese Patent Laid Open No. 7 230515 and the method for managing the progress using the number of printed sheets when a plurality of documents are simultaneously instructed to be subjected to pull print processing it is difficult to determine whether a load to which the server is subjected to should be reduced. That is it is difficult for the client terminal the device in the pull print system to properly recognize the load to which the server is subjected to. Accordingly there arises a problem in that it is difficult to control the load to which the server is subjected to.

The present invention has been made in view of the above disadvantages and controls a load to which a server is subjected to.

According to an aspect of the present invention there is provided an image processing apparatus including a print screen display unit configured to display in a display device a print screen including document information items regarding documents stored in a device which communicates with the image processing apparatus through a network a print request unit configured to request a server which communicates with the image processing apparatus through the network to print a document corresponding to a document information item selected from among the document information items included in the print screen and a print request limitation control unit configured to prevent a new print request from being issued for a period of time from when the print request unit requests the server to print the document to when registration of print reservation information regarding a print reservation of the document in a print reservation information management unit is detected.

According to another aspect of the present invention there is provided an image processing apparatus including a print screen display unit configured to display in a display device a print screen including document information items regarding documents stored in a device which communicates with the image processing apparatus through a network a print request unit configured to request a server which communicates with the image processing apparatus through the network to print a document corresponding to a document information item selected from among the document information items included in the print screen and a polling control unit configured to perform polling for obtaining a result of the request to the server for a period of time from when the print request unit requests the server to print the document to when registration of print reservation information regarding a print reservation of the document in a print reservation information management unit is detected.

According to still another aspect of the present invention there is provided a print request making method employed in an image processing apparatus including a print screen display step of displaying a print screen including document information items regarding documents stored in a device which communicates with the image processing apparatus through a network a print request step of requesting a server which communicates with the image processing apparatus through the network to print a document corresponding to a document information item selected from among the document information items included in the print screen and a print request limitation control step of preventing a new print request from being issued for a period of time from when the server is requested to print the document in the print request step to when registration of print reservation information regarding a print reservation of the document in a print reservation information management unit is detected.

According to a further aspect of the present invention there is provided a print request making method employed in an image processing apparatus including a print screen display step of displaying in a display device a print screen including document information items regarding documents stored in a device which communicates with the image processing apparatus through a network a print request step of requesting a server which communicates with the image processing apparatus through the network to print a document corresponding to a document information item selected from among the document information items included in the print screen and a polling control step of performing polling for obtaining a result of the request to the server for a period of time from when the server is requested to print the document in the print request step to when registration of print reservation information regarding a print reservation of the document in a print reservation information management unit is detected.

Further features of the present invention will become apparent from the following description of exemplary embodiments with reference to the attached drawings.

Exemplary embodiments of the present invention will be described hereinafter with reference to the accompanying drawings.

In the printing system server systems for example which control the printing system printing devices and client terminals client computers are widely connected through a wide area network hereinafter referred to as a WAN to one another.

A DBMS Database Management System manages document data print jobs and data such as printer information which are stored in a storage device . Note that the DBMS is software installed in a server computer for example. A CPU of the server computer performs processing in accordance with the DBMS . However description of this exemplary embodiment is made provided that the DBMS performs the processing for simplicity. The DBMS accepts instructions of updating obtaining adding and deleting of a variety of data from servers and performs processes in accordance with the instructions.

The storage device may be directly connected to the DBMS so as to serve as a DAS Direct Attached Storage or may be connected through the network to the DBMS so as to serve as an SAN Storage Area Network . Note that in a case of a large printing system the DBMS or the server computer including the DBMS installed therein may have a cluster configuration as a measure to attain load distribution or may have a configuration having a redundancy as a measure to avoid generation of a failure.

A print server system includes a server computer which monitors and manages the printing device which controls and monitors a print job and which transfer the print job to the printing device in the printing system. Note that in a case of a large printing system the print server system also may have a cluster configuration as a measure to attain load distribution or may have a configuration having a redundancy as a measure to avoid generation of a failure.

The print server system is connected through a LAN Local Area Network A to the DBMS and a web server system and transmits and receives print job data a printing control instruction and information on a print job managed in the print server system .

The web server system transmits the information on the print job managed in the print server system and document information managed in the print server system through the WAN to front end client terminals A to D hereinafter collectively referred to as a client terminal unless otherwise distinguished . The web server system is a system including a server computer and may have a cluster configuration as a measure to attain load distribution or may have a configuration having a redundancy as a measure to avoid generation of a failure.

Furthermore the web server system receives print instructions and instructions for print jobs issued from the client terminal and printing devices A to D hereinafter collectively referred to as a printing device unless otherwise distinguished and transmits the instructions to the print server system . The web server system collaboratively operates with a directory server which will be described later so as to perform authentication management of logins from the client terminal and the printing device . The web server system stores therein authority information of a user set in advance by a system designer or a creator of a document. Examples of the authority information includes information on an authority for referring to the document information on an authority for printing information on authority for deleting information on an authority for printing using a certain printer and information on an authority for deleting a print job. The authority information may be stored or managed in the web server system or the DBMS .

The directory server is a server computer which performs authentication management of users utilizing combinations of user names and passwords for example. Note that the user may participate in domain groups. For example the web server system and the DBMS may set authorities of the domain groups in a range different from ranges of authorities of the respective users. Furthermore the web server system may set user information or group information for example so that the user participates in a plurality of domain groups.

The printing device is connected through a network interface not shown to a LAN B or a LAN C. The LANs B and C are connected to the WAN and the printing device communicates with the print server system and the web server system through the LANs B or C and the WAN . As the printing device an image processing apparatus such as a laser beam printer employing an electrophotography method or an inkjet printer employing an inkjet method is used as needed. Furthermore the printing device includes a schedule application print reservation information management application which manages a printing schedule printing reservation information which will be described later and a pull print application which is used to issue a print instruction from the printing device . The printing device further includes an authentication application which simultaneously performs a login to the printing device and a login to the web server system . An information input device is connected to the printing device so as to communicate with the printing device and perform login to the printing device .

The client terminal performs information processing and is connected through the network interface not shown to the LAN B or the LAN C. The LANs B and C are connected to the WAN and the client terminal communicates with the various server systems through the LANs B or C and the WAN . The client terminal may be a computer to which a persistent storage device is connected or a computer constituted only by a temporary storage device that is a computer having a thin client configuration.

As shown in in the print server system a plurality of print servers print server computers A to N are connected to the LAN A through a load balancer serving as a switching system for load distribution. The load balancer recognizes loads to which the plurality of print servers A to N are subjected to and preferentially issues requests to print servers among the print servers A to N to which loads are not applied in order to attain load distribution. The load balancer recognizes the loads to which the print servers A to N are subjected to by a round robin method for simply successively circulating a request among the print servers A to N or a method for periodically transmitting predetermined requests to the respective print servers A to N and determining times required for replies from the print servers A to N to be loads.

A functional configuration of one of the print servers A to N hereinafter collectively referred to as a print server unless otherwise distinguished will be described.

The print server includes an API Application Program Interface a DB driver a job manager and a device manager .

The API registers documents transmitted from the web server system or other servers which generate printable documents and accepts requests for printing documents and requests for controlling print jobs. Examples of the servers which generate printable documents include ledger sheet servers which generate standard ledger sheets and document management servers which collectively manage documents of users.

The DB driver is a module which communicates with the DBMS when a request for registering a document is received and the document is registered to the directory server or when a request for printing is received and printing data is obtained from the DBMS .

The job manager registers the document received using the API to the DBMS through the DB driver . When the DB driver receives a request for printing the job manager obtains document data to be printed from the DBMS through the DB driver and manages the obtained document data as a print job.

The data managed here is job information shown in . is a diagram illustrating an example of the job information . The job information includes a job ID a document name a user name a reception date and time a document ID and a status . The job ID represents an identifier of a job. The user name represents an account name of a user who instructed printing. The document ID represents an identifier of a document managed in the DBMS . The status represents a status of the print job. Examples of the status include waiting for reception representing printer waiting transferring which is shown when printing data is being transferred to the printing device and printing which is shown when the printing device is performing printing. The job manager instructs the device manager which will be described later to print the obtained document using the printing device .

The device manager manages device information shown in and stores a variety of information on the printing device which is used for printing. is a diagram illustrating an example of the device information . The device information includes a device name an address of a communication destination of the device a communication port number a method for transferring printing data and a status of the device. Examples of the method for transferring printing data include an RAW method or an LPR Line Printer Daemon Protocol method for successively transmitting printing data as streams in accordance with a TCP IP protocol and a method for transmitting data in accordance with an HTTP protocol. The device information may be managed in the DBMS instead of the device manager and may be obtained through the DB driver as needed. That is the data may be stored in any unit. When receiving a request for transmitting printing data from the job manager the device manager starts communicating with the schedule application included in the printing device and successively prints the data. A method for printing the data will be described later in detail.

A CPU reads programs stored in a HDD Hard Disk Drive into a RAM and performs processes in accordance with the programs to thereby perform operations of this device a server computer or a client computer . A ROM which is not rewritable stores therein data and the programs regarding the operations performed using this device. The rewritable RAM electrically stores therein temporary data regarding the operations performed using this device. The programs the data and the temporary data for example regarding the operations performed using this device are stored in the HDD . An input device includes a keyboard and a pointing device which accept an input of an instruction to this device. A display device displays an operation status of this device and information items output as results of the operations performed in accordance with the programs operated in this device. A network I F is connected through a network to a corresponding one of the LANs A to C and the Internet so as to transmit information to or receive information from an external device. An external device I F is used to connect an external storage device to this device.

An image reader reads an original using a document feeder . The image reader and an image forming section are used to convert the read original or data received through the network into an image for printing and print the image. A paper ejecting unit ejects sheets which have been subjected to printing and performs a sorting operation and a stapling operation on the ejected sheets for example. A network I F is connected through the network to a corresponding one of the LANs B and C and the Internet and transmits information to or receives information from an external device. A CPU reads programs stored in a ROM or an HDD into a RAM and performs processes in accordance with the programs to thereby perform operations using this device the printing device . The ROM is a nonvolatile storage unit and stores therein data and programs regarding the operations performed using this device. The rewritable RAM electrically stores therein temporary data regarding the operations performed using this device. The HDD stores the programs the data and the temporary data regarding the operations performed using this device. An operation unit displays a screen which will be described later and accepts an operation instructed by the user using the screen.

As described above the web server system has a cluster configuration for load distribution and includes a plurality of web server computers. Web servers installed in the web server computers perform information communications in a WWW World Wide Web system and each of the web servers is software.

The web server system obtains user account information a user name and a password in response to a login from the client terminal or the printing device and performs an authentication operation using the directory server . When the authentication of the login is successfully performed the web server system approves an authority of the user for referring to documents. The web server system obtains document information from the DBMS in accordance with the approved authority of reference and transmits the information to the client terminal or the printing device which has been logged in. Furthermore when receiving an instruction for printing of a document from the client terminal or the printing device the web server system transmits an instruction for printing to which a document ID is assigned to the print server system .

Examples of a policy of approving the reference authority include a policy in which the user can refer to documents of users who belong to the same domain and a policy in which the user can only refer to own documents. The policies may be flexibly designed as policies of the user who introduce the printing system. Furthermore the web server system may approve not only the authority of reference of documents but also an authority of printing of documents an authority of deleting a print job and an authority of promotion.

As the DBMS various databases such as a card database a relational database or an object database may be employed for managing data. In this exemplary embodiment a relational database which has been widely used is employed as the DBMS . The DBMS stores therein a document table as table information. is a diagram illustrating an example of the document table .

The document table includes a document ID which represents an identifier of a document a document name a user name which represents a name of a user who registered the document and a data path which represents a location where the document is actually stored. In this embodiment the document table stores a reference of the document and document data is stored in another unit. However the document may be directly stored in the document table .

The web server system specifies a certain user name and obtains information items regarding documents corresponding to the specified user name from the DBMS . The print server specifies a certain document ID and obtains information on a document corresponding to the specified document ID from the DBMS . The print server registers a new document in the DBMS .

An image reading unit corresponding to the image reader shown in includes a scanner for example optically reads an original image and converts the original image into digital image information. Furthermore the image reading unit outputs the digital image information to the image forming section so that the image forming section forms an image on the basis of the digital image information or supplies digital image information to a fax unit or a network interface unit so that the digital image information is transmitted through a line.

A device controller controls operations of the image forming section and the image reading unit so that original information read using the image reading unit is copied using the image forming section for example. Furthermore the device controller includes the network interface unit a print processing unit the fax unit and an operation unit controller and controls transmission and reception of information among these units. Note that the device controller corresponds to the CPU the ROM the RAM and the HDD shown in .

The fax unit performs transmission and reception of a facsimile image. Specifically the fax unit transmits digital image information read using the image reading unit or decodes a received facsimile signal so as to record information on the signal in the image forming section .

The operation unit controller controls the operation unit to generate a signal in response to a user s operation using an operation panel included in the operation unit and controls the operation unit or a display unit to display various data items and messages.

The print processing unit processes printing data input through the network interface unit and outputs the printing data to the image forming section so that the printing data is printed. The network interface unit controls transmission and reception of data through a communication line between the printing device and another communication terminal.

A virtual machine is located in a higher level relative to the device controller and controls the device controller .

Each of the device controller and the virtual machine directly uses the network interface unit so as to independently access an external network.

Furthermore applications described by programming languages compatible with an API Application Programming Interface provided by the virtual machine are located in a higher level of the virtual machine . These applications can act indirectly on the device controller through the virtual machine and can activate the image forming section and the image reading unit .

According to this invention the applications described above correspond to the schedule application the pull print application and the authentication application . Each of these applications can be uninstalled from the virtual machine and newly installed as an application .

The applications described above are installed in the printing device in this exemplary embodiment. However the applications may be provided as hardware. Alternatively the applications may be included in an external computer connected to the printing device for communication.

An external storage device controller controls the image forming section to convert an image read using the image reading unit into an image having a certain format which can be stored in the external storage device and stores the converted image to the external storage device. Furthermore the external storage device controller reads data stored in the external storage device and performs printing processing through the image forming section or externally transmits the data through the network interface unit .

In this exemplary embodiment an IC card reader serving as a login unit is connected to the printing device for communication and account information of the user is transmitted through the IC card reader to the authentication application . Note that the user may login by inputting an instruction using the operation unit a display panel managed using the operation unit controller instead of use of the IC card reader .

The communication manager allows the print server to be connected accepts a request from the print server and transmits notification of a change of a status of a print job transmitted from the device controller . Note that a sequence of processes of printing will be described later in detail.

The job manager is a module which schedules print jobs transmitted from the print server manages the print jobs and performs controlling so that printing operations are successively performed as scheduled. Furthermore the job manager accepts a deleting operation and a promoting operation priority changing operation performed by the pull print application so as to control a print job.

The device manager is a module which communicates with the device controller . In addition the device manager serves as a driver which deletes a print job and catches a change of a state of the print job.

Each of the schedule information items includes a job ID of the print job a document name a user name a reception date and time a document ID and a status of the print job. Each of the schedule information items basically includes information items similar to those included the job information managed in the print server and therefore descriptions thereof are omitted.

The authentication application obtains information on an IC card from the IC card reader connected to the printing device for communication and obtains a user ID from a user management table stored therein. The user management table is a two dimensional table including IC card information and user IDs.

Then the authentication application notifies the pull print application of the obtained user ID. Furthermore the authentication application detects a logout of the user and similarly notifies the pull print application of the logout of the user. Examples of a method for detecting a logout include a method for detecting a press of a hard key included in the printing device and a method for automatically determining that a logout is performed when a predetermined period of time has past after the last time the user performed an operation.

The screen activation module receives a notification of a login or a logout transmitted from the authentication application and transmits the notification to the pull print controller . When receiving the notification of a login the pull print controller initializes and generates the pull print screen . The pull print screen will be described in detail hereinafter.

When receiving the notification of a logout the pull print controller discards the generated pull print screen .

A printing sequence performed between the print server and the schedule application will be described with reference to .

Note that although not shown the schedule application performs an event registration to the device controller when being activated. Therefore when a state of a print job or the device which is controlled using the device controller is changed the change of the state is notified to the schedule application .

As a printing request a document ID and a name of a printer which performs printing or an address of the printer are transmitted to the print server . The job manager obtains document data from the DBMS through the DB driver in accordance with the document ID. Then the device manager specifies one of the printing devices A to D which is used for printing and the printing device performs printing in accordance with the following sequence.

In step S a session of communication between the print server and the schedule application is started. The communication session is established using a communication protocol such as a TCP IP protocol or an HTTP protocol.

In step S the print server issues a connection request to the schedule application . The schedule application receives the connection request using the communication manager .

In step S the print server performs an event registration to the device controller so as to receive a notification when a status of a print job or the printing device is changed.

In step S the print server obtains a list job list of schedule information items currently managed using the job manager included in the schedule application . The obtained list of the schedule information items is transmitted to another application server connected to the print server for example and is output to a console used to manage the print server . Alternatively a function of transmitting information on a print job through the web server system to the client terminal may be realized.

In step S the print server issues a schedule request of a print job to the schedule application . Note that the schedule request includes the job information .

In step S the schedule application which received the schedule request adds information to the schedule information items print reservation information items which are managed using the job manager newly issues an job ID and registers the job ID. The job ID is transmitted to the print server .

In step S the job manager controls an order of printing so that a printing operation is performed in an order of the list of the schedule information items and issues permission of printing to one of the print servers A to N which registered the print job corresponding to one of the schedule information items which has currently a turn to be subjected to printing. Examples of a method for controlling the order of printing include a method for controlling the order of printing so that a printing operation is merely performed in an order of registration and a method for controlling the order of printing so that a printing operation is performed in an order obtained by sorting in accordance with priorities assigned to the jobs.

In step S the print server which received the permission of printing notifies the schedule application of start of transfer of printing data blocks. In step S the print server starts transferring a print job to the device controller . The transfer of the print job is performed in accordance with the transfer method set in the device information . The schedule application changes the status of a corresponding one of the schedule information items during the transfer.

In step S the device controller successively analyzes the received printing data blocks and starts printing. In step S the device controller changes the status of the print job managed using the device controller itself during printing and notifies the schedule application which has been subjected to the event registration of the fact that the status is changed to a status in which the printing is started.

In step S the schedule application which received the notification of start of printing through the device manager notifies the print server of the start of printing. As described above the print server recognizes a status of the print job which is printed using the print server itself.

When the transfer of the print data blocks are completed the print server notifies the schedule application of the completion of the transfer in step S. As with the start of the transfer the schedule application which received the notification changes the status included in the corresponding one of the schedule information items of the print job so as to represent the completion of the transfer.

When the printing operation using the printing device is terminated in step S as with the start of the printing operation the device controller notifies the schedule application of end of the printing operation in step S. When receiving the notification of the end of the printing operation the schedule application similarly notifies the print server of the end of the printing operation in step S.

When print jobs corresponding to all predetermined printing requests are completed the print server which received the notification of the end of the printing operation cancels the event to the schedule application in step S and subsequently the print server transmits a disconnection request to the schedule application in step S.

When receiving the notification of the cancellation and the disconnection request the schedule application performs a termination operation of the communication with the print server .

The authentication application which receives login information from the IC card reader obtains a user account user ID in step S and notifies the pull print application of the login in step S. The pull print application receives the login information using the screen activation module and starts monitoring a print job.

In step S a session of communication between the pull print application and the schedule application is started. The communication session is established using a communication protocol such as a TCP IP protocol or an HTTP protocol. However since the communication is performed using the single virtual machine a method called loopback is employed and communication data is not externally transmitted.

In step S the pull print application transmits a connection request to the schedule application . The schedule application receives the connection request using the communication manager . In step S the pull print application performs an event registration to the schedule application so as to receive a notification when a status of the print job is changed.

In step S the pull print application obtains a list job list of schedule information items currently managed using the job manager of the schedule application .

After obtaining the list of the schedule information items the pull print application registers the list to a print job management table. The print job management table corresponds to a list of job information items . An example of the job information items is shown in .

When a new print job is scheduled using the print server in step S for example the schedule application transmits a schedule notification to the pull print application in step S. When receiving the schedule notification the pull print application registers the new print job in the print job management table.

When the device controller updates the status of the print job in step S and step S the schedule application performs the following operation. For example when receiving a notification of start of printing or end of printing in step S or step S the schedule application transmits a notification of a change of the status to the pull print application which performs an event registration in step S and S. When receiving the change of the status of the print job the pull print application updates a status of a print job in the print job management table corresponding to the print job.

When detecting a logout of the user by detecting a press of the hard key for example in step S the authentication application notifies the pull print application of the logout of the user in step S. When receiving the notification the pull print application transmits a notification of cancellation of the event in step S and thereafter transmits a disconnection request to the schedule application in step S. Then the session between the pull print application and the schedule application is terminated in step S.

When receiving a notification of a login from the IC card reader in step S the authentication application obtains a user account user ID and notifies the pull print application of the login in step S. The pull print application receives the notification of the login using the screen activation module and generates a pull print screen. Here the pull print application displays a user name corresponding to the obtained user account in a login user name region in the pull print screen print screen display .

In step S the pull print application transmits a notification of the login to the web server system . Here the pull print application utilizes the user account user ID obtained from the authentication application as login information. Note that an authentication method using a password may be employed for improvement of security. In this case the password may be managed in the authentication application so as to correspond to the user ID. Furthermore the user ID and the password may be input using the screen instead of use of the IC card reader .

When receiving the login notification from the pull print application the web server system transmits an authentication information request to the directory server in step S. The directory server refers to user information registered in advance and performs authentication in step S. When the authentication was successfully performed the directory server returns user information and information on a domain group in which the user belongs to as the authentication information to the web server system in step S. On the other hand when the authentication failed the directory server returns failure information representing a failure of the login to the web server system .

When receiving the authentication information from the directory server the web server system notifies the pull print application of start of a session. Simultaneously the obtained authentication information is transferred to the pull print application as notification information in step S.

In step S the pull print application transmits a request for obtaining a document list to the web server system in accordance with the obtained authentication information. Here the pull print application may determine a narrowing down condition such as whether only a list of documents registered on the basis of user IDs is obtained or a list of all documents of a certain domain group in which the user belongs to are obtained. Note that a case where the list of documents registered on the basis of user IDs is obtained is described in this exemplary embodiment.

When receiving the request for obtaining a document list the web server system obtains a list of documents corresponding to the user ID from the DBMS and transmits the obtained document list to the pull print application in step S.

When obtaining the list the pull print application displays a document list of the pull print screen printing screen display . Here the pull print application displays the total number of obtained documents in a document count . If all documents to be displayed in the document list are too many to simultaneously display in the document list paging processing is performed. shows an example in which items corresponding to the documents are displayed within one page of the document list .

Furthermore the pull print application may have a function of displaying when a detail button in the pull print screen is pressed detailed information regarding a document in which a check box corresponding to the document is checked in the document list is displayed in another screen.

When a deleting button is pressed in the pull print screen the pull print application transmits a document deleting request to the web server system . When receiving a document deleting request the web server system deletes a document to be deleted in the DBMS .

When detecting a logout of the user by detecting a press of the hard key for example in step S the authentication application notifies the pull print application of the logout of the user in step S. When receiving the notification the pull print application transmits a notification of the logout to the web server system in step S. In step S the session between the pull print application and the web server system is terminated.

Note that an operation performed when a printing button in the pull print screen is pressed will be described hereinafter.

When detecting a press of the printing button in step S the pull print application obtains a document ID of a document which is marked. The pull print application generates the print instruction management table in accordance with the obtained document ID in step S.

The print instruction management table is used to manage progress of a print instruction in a pull print operation. As shown in the print instruction management table includes a document ID a print instruction result and a detailed result . The document ID corresponds to the document ID included in the job information and the document ID included in the document table . The print instruction result includes symbols as shown in the print instruction result list . The detailed result includes a cause of an error when a print instruction result represents an error.

In step S the pull print application issues a print instruction to the web server system printing request . As the print instruction the obtained document ID and information on a printing device including the pull print application installed therein are transmitted. The information on the printing device includes an address and model information of the printing device .

In step S the web server system specifies one of the printing device A to D. Specifically the web server system specifies one of the printing device A to D using the device information managed in the DBMS or the print server on the basis of the obtained information on the printing device . If the information on the printing device is not included in the information managed in the DBMS or if the information on the printing device is flaw information the web server system determines that the web server the print instruction is not acceptable. A result of the determination is transmitted to the pull print application as a print instruction result in step S which will next be described.

Subsequently the web server system determines whether the user who instructed the pull print operation has an authority of printing of the specified document that is the web server system performs an approval operation in step S. When the approval failed the web server system determines that the print instruction is not acceptable.

After determining whether the print instruction is acceptable in step S and step S the web server system transmits a result of the determination as the print instruction result to the pull print application .

Furthermore the web server system may simultaneously receive a plurality of instructions for printing documents. In this case the web server system determines whether the plurality of print instructions are acceptable for individual print instructions and results of the determinations are transmitted to the pull print application .

When the approval of the authority was successfully performed the web server system issues a print instruction to the print server in step S. As the print instruction the device information on the specified printing device and the document ID are transmitted.

When receiving the print instruction the print server obtains document data using the document ID as a key from the DBMS in step S.

Note that in a case where a document corresponding to the document data is not printable since the document has been deleted for example the print server fails to obtain the document. In step S the print server transmits a print instruction result which is a result of a determination as to whether the document is obtained to the web server system .

The web server system stores the print instruction result . In this state when receiving a confirmation of the print instruction result obtained by a periodic polling from the pull print application the web server system transmits the print instruction result stored therein to the pull print application .

Then the print server prints the document which is successfully obtained in step S to step S in accordance with the sequence described in .

The information which is registered in a schedule in the schedule application in step S is transmitted from the schedule application to the pull print application in step S. When receiving the information the pull print application updates information included in the print instruction management table generated in step S in step S. A method for controlling the print instruction management table will be described in detail hereinafter.

The printing system performs the pull print operation through the pull print screen as described above.

Management and control of a print instruction in the pull print operation will be described with reference to flowcharts shown in . are flowcharts illustrating an example of processing of managing and controlling a print instruction in the pull print operation.

As shown in the management and the control of a print instruction in the pull print operation are performed by two control operations operating in parallel.

A first control operation is performed in accordance with the flowchart shown in . The flowchart shown in corresponds to a portion of a sequence of the processes in step S to step S in which the print instruction is managed included in the print job monitoring sequence shown in . Portions which do not relate to the management and the control of the print instruction have already described with reference to and therefore descriptions thereof are omitted.

The pull print controller included in the pull print application registers an event in the schedule application in step S. In step S the pull print controller waits for an event of a status change of a print job managed in the schedule application .

When receiving a notification of the event of a status change of a print job the pull print controller determines in step S whether the notification indicates that a new job is scheduled. When the determination is affirmative the pull print controller proceeds to step S. On the other hand when the determination is negative the pull print controller returns to step S where the pull print controller waits for an event. Note that the notified event includes the job information .

In step S the pull print controller compares all document IDs of print instruction information items managed in the print instruction management table with the document ID included in the notified job information . When it is determined that the document ID matched one of the document IDs the pull print controller updates a print instruction result of a print instruction information item corresponding to the one of the document IDs to OK and the process returns to step S.

As described above the pull print controller determines whether a job corresponding to an issued instruction is scheduled in the schedule application by the first control operation.

A second control operation is performed in accordance with the flowchart shown in . The flowchart shown in corresponds to a portion of a sequence of the processes of managing and controlling the print instruction included in the pull print sequence shown in . Portions which do not relate to the management and the control of the print instruction have already described with reference to and therefore descriptions thereof are omitted.

The pull print controller included in the pull print application detects a press of the printing button in step S. In step S the pull print controller displays a printer waiting dialog screen shown in in front of the pull print screen so as to overlap with the pull print screen print request limitation control . is a diagram illustrating an example of the printer waiting dialog screen .

The printer waiting dialog screen includes a progress showing section which shows progress of a print instruction control operation and a button used to close the printer waiting dialog screen . The progress showing section shows a degree of the progress which increases as processing of the flowchart of advances. The degree of the progress may be represented by difference in color or difference in color density of a display region which is a so called progress bar by a percentage or by rotating a needle like stick on a dial window.

When the printer waiting dialog screen is first displayed the close button is not allowed to be pressed.

The pull print screen is not allowed to be operated while the printer waiting dialog screen is displayed and therefore any request is not issued to the web server system . Accordingly the number of request issued from a single printing device to the web server system is limited by controlling a period of time in which the printer waiting dialog screen is displayed print request limitation control .

As a method for preventing requests from being issued to the web server system in addition to the method for displaying the printer waiting dialog screen as described in this exemplary embodiment the following method may be employed. That is a method for banning uses of the printing button and the deleting button may be employed print request limitation control .

After the printer waiting dialog screen is displayed the pull print controller generates print instruction management tables for documents selected in the document list displayed in the pull print screen in step S. In print instruction results of the print instruction management tables a symbol representing a state of waiting for information is stored.

Subsequently the pull print controller issues a print instruction to the web server system in step S and obtains print instruction results from the web server system in step S.

In step S the pull print controller determines whether an error occurs in accordance with information on each of the obtained print instruction results for each document. When it is determined that an error occurred the pull print controller sets a symbol NG representing generation of an error in print instruction results and a reason of the error is stored in detailed results in step S. The detailed results are obtained from the web server system . If it is determined that errors occurred in all the documents the pull print controller determines that all results are obtained in step S and the process proceeds to step S.

When it is determined that among all the documents a document corresponding to a print instruction result in which the symbol NG is not set was detected that is when a response representing that a print instruction is accepted was received the pull print controller proceeds to step S.

In step S the pull print controller starts periodic polling so as to obtain print instruction results that is results of processing performed using the DBMS from the web server system polling control . Time intervals of the periodic polling are preset in the pull print application . However the time intervals may be changeable using a setting screen not shown.

In step S the pull print controller starts monitoring of timeout of the periodic polling. The timeout of the periodic polling is set taking an assumption in which a processing time of the print instruction becomes accidentally long due to congestion of communication traffics of the pull print system trouble of a communication path or server trouble into consideration. The timeout may not be set that is the periodic polling may not time out.

In step S the pull print controller displays the close button in the printer waiting dialog screen so that the close button is allowed to be pressed button display . is a diagram illustrating an example of the printer waiting dialog screen including the close button activated. Note that the close button may not to be displayed. The display of the close button relates to a range of control of loads to which the servers are subjected to in this pull print system. In a case where a load to which the web server system is subjected to is set as the control range the close button is displayed here. On the other hand in a case where a load to which the DBMS is subjected to is set as the control range it is determined that the close button is not displayed. When the close button is displayed and pressed the pull print controller proceeds to step S. In this state the user can subsequently issue another request. That is a request can be subsequently issued before the processing performed using the DBMS is terminated.

In step S the pull print controller checks whether a timeout occurred. When the determination is affirmative the process proceeds to step S. On the other hand when the determination is negative or when the timeout was not set the pull print controller examines the print instruction results obtained through the periodic polling in step S. When it is determined that the print instruction results are not transmitted to the web server system the pull print controller proceeds step S.

When the print instruction results are obtained from the web server system in step S the process proceeds to step S where the pull print controller updates the results in the print instruction management tables and then the process proceeds to step S.

Note that although not shown in it may be determined whether the close button is displayed when the print instruction results are obtained. In a case where the control range of a load to which the DBMS is subjected to is set as the control range the pull print controller displays the close button here. On the other hand in a case where the control range of a load to which the print server is subjected to is set as the control range the pull print controller determines not to display the close button . In this state when the close button is displayed and pressed the pull print controller proceeds to step S where the user can subsequently issue another request. That is a request is subsequently issued before schedule processing performed using the print server is terminated.

In step S the pull print controller determines whether all print instruction results of the print instruction management tables are obtained. The determination as to whether all print instruction results are obtained is made along with the update operation in the flowchart of the first control operation described above. When it is determined that all the results were not obtained the pull print controller returns to step S. On the other hand when it is determined that all the results were obtained the pull print controller proceeds to step S.

When all the print instruction results are obtained the following condition is obtained all jobs instructed to be printed have symbols NG in the print instruction results or the print instruction results or are scheduled in the schedule application .

In a case where the timeout monitoring is performed the pull print controller terminates the monitoring in step S. In step S the pull print controller terminates the periodic polling to the web server system polling control .

In step S the pull print controller closes the printer waiting dialog screen when the printer waiting dialog screen is displayed and deletes the print instruction management tables in step S. The process is thus terminated.

As described above the pull print controller manages and controls a pint instruction by the first and second control operations. With these operations loads to which the servers are subjected to in the pull print system are recognized and limited.

Furthermore the progress of the pull print operation is displayed for the user who instructed the pull print operation.

Objects of the present invention are attained as follows. That is a storage medium or a recording medium which stores therein a program code of software which realizes functions of the foregoing exemplary embodiment is mounted in a system or a device. Then a central calculation processing unit CPU Central Processing Unit or MPU Micro Processing Unit included in the system or the device reads and executes the program code stored in the storage medium. In this case the program code itself read from the storage medium realizes the functions described in the foregoing exemplary embodiment and therefore the storage medium which stores therein the program code is included in the present invention.

Furthermore by executing the program code read using the central calculation processing unit included in the system or the device an operating system OS for example operating in the system or the device performs a part of or all processing in accordance with an instruction of the program code. The present invention includes a case where the functions of the foregoing exemplary embodiment are realized by the processing.

It is assumed that the program code read from the storage medium is written in a function expansion card inserted into the system or the device or a memory included in a function expansion unit connected to the system or the device. The present invention includes a case where the CPU for example included in the function expansion card or the function expansion unit performs a part of or all the processing in accordance with an instruction of the program code so that the functions of the foregoing exemplary embodiment are realized.

In a case where the present invention is applied to the storage medium the storage medium stores therein program codes corresponding to the flowcharts described above.

According to the foregoing exemplary embodiment the pull print operation is prevented from being continuously performed until loads to which the servers are subjected to are reduced. Furthermore since periodic polling for checking request results is performed progress can be displayed in detail.

While the present invention has been described with reference to exemplary embodiments it is to be understood that the invention is not limited to the disclosed exemplary embodiments. The scope of the following claims is to be accorded the broadest interpretation so as to encompass all modifications and equivalent structures and functions.

This application claims the benefit of Japanese Application No. 2007 249780 filed Sep. 26 2007 which is hereby incorporated by reference herein in its entirety.

