---

title: Image processing including process of outputting preview image using database storing synthesizing data corresponding to finish processing condition
abstract: An image processing apparatus is disclosed. The image processing apparatus uses software architecture called pipes-and-filters architecture. The image processing apparatus includes an inputting filter, a processing filter, a printing filter, and a preview image displaying filter. When a preview image of image data to be output is instructed to be displayed, the preview image displaying filter makes an operating section display the preview image.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08595623&OS=08595623&RS=08595623
owner: Ricoh Company, Ltd.
number: 08595623
owner_city: Tokyo
owner_country: JP
publication_date: 20080306
---
The present invention generally relates to an image processing apparatus an image processing method and a computer readable recording medium storing an image processing program.

Recently in an image processing apparatus such as a printer a copying machine a scanner and a multifunctional peripheral realizing the above functions in one cabinet generally similar to in a computer a CPU central processing unit is provided for realizing the functions by controlling application software.

For example in an image forming apparatus disclosed in Patent Document 1 functions which are used in common among many pieces of application software are provided as a platform and one application software package can be installed in the platform by using an API application programming interface of the platform. In the image forming apparatus since the functions which are used in common among the many pieces of application software are provided as the platform it is avoided that the same function of the many pieces of the application software is installed in the platform multiple times and developing efficiency of the application software can be increased.

However when the granularity size of the function interface in the platform is not properly designed the developing efficiency of the application software may not be increased.

For example when the granularity is too small even if the application software supplies a simple service many APIs are required and the source code becomes complex.

On the contrary in a case where the granularity is too large when some application software whose part of the function is changed is desired to be installed in the platform the platform must be changed. Consequently the developing labor hours of the application software may be increased. Especially when the dependence relationship among modules in the platform is great not only a new function must be added in the platform but an existing function in the platform may be changed.

In addition when a part for example an image inputting process of a service being supplied by existing application software is changed the part and another part related to the changed part must be changed. Consequently new application software in which source code is described must be installed again in the platform.

In a preferred embodiment of the present invention there is provided an image processing apparatus an image processing method and a computer readable recording medium storing an image processing program in which customizing and expanding a function in a platform can be simplified.

Features and advantages of the present invention are set forth in the description that follows and in part will become apparent from the description and the accompanying drawings or may be learned by practice of the invention according to the teachings provided in the description. Features and advantages of the present invention will be realized and attained by an image processing apparatus an image processing method and a computer readable recording medium storing an image processing program particularly pointed out in the specification in such full clear concise and exact terms so as to enable a person having ordinary skill in the art to practice the invention.

To achieve one or more of these and other advantages according to one aspect of the present invention there is provided an image processing apparatus. The image processing apparatus includes an inputting section to which image data to be processed are input an inputting filter which controls an inputting process of the image data input to the inputting section an outputting section from which the processed image data are output a first outputting filter which controls an outputting process of the image data to be output from the outputting section a processing filter which controls an image data processing process of the input image data by being connected between the inputting filter and the first outputting filter and a second outputting filter which controls an outputting process of a preview image of the image data to be output from the outputting section. When an instruction to display the preview image of the image data to be output from the outputting section is received the second outputting filter is connected to the processing filter.

According to another aspect of the present invention there is provided an image processing method of an image processing apparatus having an image data inputting section and an image data outputting section. The image processing method includes an inputting step of inputting image data to be processed by the image processing apparatus to the image data inputting section an image data input controlling step of controlling an inputting process of the image data input to the image data inputting section by an inputting filter a first image data processing step of processing the image data input to the image data inputting section via the inputting filter by a processing filter a first image data output controlling step of controlling an outputting process of the image data to be output from the image data outputting section by a first outputting filter a second image data processing step of processing the image data input to the image data inputting section via the inputting filter by the processing filter for forming a preview image of the image data to be output from the image data outputting section and a second image data output controlling step of controlling an outputting process of the preview image of the image data to be output from the image data outputting section by a second outputting filter. When an instruction to display the preview image of the image data to be output from the image data outputting section is received the second image data processing step and the second image data output controlling step are executed.

According to another aspect of the present invention there is provided a computer readable recording medium storing an image processing program in an image processing apparatus having an image data inputting section and an image data outputting section. The image processing program includes an inputting step of inputting image data to be processed by the image processing apparatus to the image data inputting section an image data input controlling step of controlling an inputting process of the image data input to the image data inputting section by an inputting filter a first image data processing step of processing the image data input to the image data inputting section via the inputting filter by a processing filter a first image data output controlling step of controlling an outputting process of the image data to be output from the image data outputting section by a first outputting filter a second image data processing step of processing the image data input to the image data inputting section via the inputting filter by the processing filter for forming a preview image of the image data to be output from the image data outputting section and a second image data output controlling step of controlling an outputting process of the preview image of the image data to be output from the image data outputting section by a second outputting filter. When an instruction to display the preview image of the image data to be output from the image data outputting section is received the second image data processing step and the second image data output controlling step are executed.

According to an embodiment of the present invention the image processing apparatus uses software architecture called pipes and filters architecture. Therefore a dependence relationship does not exist between a first outputting filter and a second outputting filter. Consequently functions of the first and second outputting filters can be easily expanded or customized changed without a change in one filter influencing the other filter.

The best mode of carrying out the present invention is described with reference to the accompanying drawings.

In embodiments of the present invention software architecture called pipes and filters architecture is applied to an image processing apparatus. With this customizing and expanding a function in a platform is simplified. Further a filter for outputting a preview image of image data to be output from an image processing apparatus is provided. With this the preview image is displayed without changing an existing component in the platform.

Before describing a first embodiment of the present invention the concept of the pipes and filters architecture which is applied to an image processing apparatus according to the embodiments of the present invention is described.

The filter is a program which applies a predetermined process to input data and outputs a processed result data . The pipe connects the filters. In a pipe a processed result output from a filter connected to an input side of the pipe is temporarily stored and the stored result is output to another filter connected to an output side of the pipe. That is in the pipes and filters architecture processes in the filters can be sequentially executed via the corresponding pipes.

In the present embodiment the predetermined process to be applied to the input data by the filter is assumed to be a predetermined converting process. That is in the image processing apparatus of the embodiments of the present invention functions to be applied to the input data document by the image processing apparatus are assumed to be sequential converting processes. In the embodiments of the present invention it is assumed that the functions of the image processing apparatus are formed of a data document inputting process a data processing process and a data outputting process. That is the data inputting process the data processing process and the data outputting process are assumed to be the data converting processes and a software component for realizing one data converting process is the filter.

In the embodiments of the present invention a filter which controls the data inputting process is named as an inputting filter a filter which controls the data processing process is named as a processing filter and a filter which controls the data outputting process is named as a outputting filter. Each filter is an independent program and a dependence relationship does not exist among the filters. Therefore a filter can be independently installed in and uninstalled from the image processing apparatus.

Next referring to the drawings an image processing apparatus according to the first embodiment of the present invention is described.

The software structure of the image processing apparatus is a layer structure for realizing the functions. The layer structure includes a user interface layer a control layer an application logic layer a device servicing layer and a device layer . The hierarchical relationship among the layers is based on a calling up relationship among the layers. That is in an upper layer calls up a lower layer.

When a user instructs the image processing apparatus to execute a function by using the user interface layer the user interface layer calls up the control layer and the control layer controls the application logic layer based on the instruction. The application logic layer executes an application for realizing the function based on an instruction from the control layer . The device servicing layer supplies services to the application logic layer . The device layer controls hardware resources of the image processing apparatus based on an instruction from the application logic layer . By the above operations the image processing apparatus executes the function instructed by the user at the user interface layer .

The user interface layer includes for example a local UI user interface section and the local UI section receives an instruction from a user for realizing one of functions of the image processing apparatus . The functions are a printing function a copying function a scanning function a facsimile function and so on. The local UI section can be installed in an operating section not shown of the image processing apparatus on which the user operates the image processing apparatus . The operating section can be formed of an operating panel having for example a display. The instruction received at the user interface layer is sent to the control layer .

The control layer includes functions for controlling processes which realize the functions of the image processing apparatus . Specifically the control layer connects filters in the application logic layer based on the instructed function and controls processes for executing the function by using the connected filters. In the present embodiment a function of the image processing apparatus is defined as one unit of a service from receiving an instruction to outputting a result of the instruction supplied to a user and is an equivalent term of an application which supplies one unit service.

The application logic layer includes filters components each of which filters realizes a part of the functions that the image processing apparatus supplies a user. In the application logic layer one function is realized by combining plural filters based on the control of the control layer . In the present embodiment the application logic layer includes an inputting filter a processing filter an outputting filter and an activity filter . The filters in the application logic layer are operated by the same definition and are controlled by the control layer based on the definition. The filters are described below in detail. The activity filter controls processes in the filters for realizing the function.

The device servicing layer includes a function component which is used in common among the filters in the application logic layer . In the present embodiment the device servicing layer includes an image pipe . The image pipe is the pipe shown in which transfers a result processed at a filter to another filter. That is for example the image pipe can connect the inputting filter to the processing filter and the processing filter to the outputting filter .

The device layer includes drivers programs for controlling the hardware resources. In the present embodiment the device layer includes for example a scanner section and a plotter section . The scanner section controls a scanner not shown and the plotter section controls a plotter not shown .

The inputting filter controls an inputting process of data input to the image processing apparatus from an external device. The inputting filter is for example a document reading filter an e mail receiving filter a facsimile receiving filter or a PC personal computer document receiving filter. The document reading filter controls reading image data of a document by for example a scanner and outputs the read image data. The e mail receiving filter controls receiving e mail and outputs data in the received e mail. The facsimile receiving filter controls receiving a facsimile and outputs data of the received facsimile. The PC document receiving filter controls receiving data to be printed from for example a client PC not shown and outputs the received data to be printed. In addition the inputting filter can include a reporting filter not shown . Setting information and history information of the image processing apparatus are input to the reporting filter. The reporting filter arranges the setting information and the history information into for example a table format and outputs the arranged information.

The processing filter applies a predetermined process to image data input from an input side filter and outputs a processed result to an output side filter. The predetermined process is for example an aggregating process an enlarging reducing process and a rotating process of input image data.

The outputting filter controls an outputting process of data input to the outputting filter processes the input data and outputs the processed data via the device layer . The outputting filter includes a printing filter and a preview image displaying filter . In addition to the filters and the outputting filter can include for example an e mail transmitting filter a facsimile transmitting filter and a PC document transmitting filter.

The printing filter makes the plotter section output print image data on a recording medium. The preview image displaying filter makes the operating section not shown of the image processing apparatus output display a preview image of image data to be output.

The e mail transmitting filter makes an e mail transmitting function transmit image data to an e mail address by attaching the image data to e mail. The facsimile transmitting filter makes a facsimile transmitting function transmit image data to an external device by facsimile. The PC document transmitting filter makes a PC document transmitting function transmit image data to a client PC not shown .

An instruction input from the local UI section of the user interface layer is input to the activity filter via the control layer . The activity filter controls executing jobs in the inputting filter the processing filter and the outputting filter based on the instruction.

The application logic layer realizes the functions in the image processing apparatus by combining the filters in the application logic layer . That is in the image processing apparatus the functions can be realized by combining the filters via the image pipe in the device servicing layer . Specifically for example when a copying function is executed the application logic layer combines the document reading filter in the inputting filter the processing filter and the printing filter via the image pipe in the device servicing layer .

Next a printing process in the image processing apparatus is described. is a diagram showing the printing process in the image processing apparatus according to the first embodiment of the present invention.

First when the local UI section of the user interface layer instructs the control layer to execute a printing process based on a request of the user the local UI section sends the instruction to the control layer S . In the present embodiment a copying process is described. In this case the local UI section instructs to read a paper document and to print the read paper document on a recording medium.

Then the control layer instructs the activity filter of the application logic layer to control the filters and S . In the image processing apparatus when a user selects a copying function pushes a start button or turns on a power switch on the image processing apparatus the control layer instructs the activity filter .

When the control layer receives the instruction to read the paper document and to print the read paper document the control layer connects the inputting filter the processing filter and the printing filter in the application logic layer via the image pipe in the device servicing layer . Specifically at this time the document reading filter in the inputting filter is connected to the processing filter via the image pipe . Then the control layer makes the inputting filter generate a job in the filter S makes the processing filter generate a job in the filter S and makes the printing filter generate a job in the filter S .

When the filters and generate corresponding jobs the activity filter instructs the filters and to execute the corresponding jobs. The inputting filter makes the scanner section refer to in the device layer read the paper document and the paper document is read as image data. The read image data are output from the inputting filter and the output image data are input to the processing filter via the image pipe .

The processing filter applies a predetermined process to the input image data and the processed image data are output to the printing filter via the image pipe . The printing filter makes the plotter section refer to in the device layer plot print the image data on a recording medium.

Next a case is described in which a preview image of the image data to be output copied is instructed to be displayed when the copying process of the image data is executed.

In the image processing apparatus of the present embodiment when a preview image of image data to be output is instructed to be displayed the preview image of the image data can be displayed by connecting the preview image displaying filter to the processing filter via the image pipe without changing existing components filters .

Referring to a preview image displaying process in the image processing apparatus is described. is a diagram showing the preview image displaying process in the image processing apparatus according to the first embodiment of the present invention.

First when a user instructs the image processing apparatus to display a preview image of image data to be output by using the local UI section the local UI section sends the instruction to the control layer S .

When the control layer receives the instruction to display the preview image the control layer connects the preview image displaying filter to the processing filter via the image pipe . Then the control layer makes the processing filter generate a job for forming preview image data to be output to the preview image displaying filter S . Further the control layer makes the preview image displaying filter generate a job for displaying a preview image S .

When the jobs in the corresponding filters and are generated the activity filter instructs the filters and to execute the corresponding jobs. The processing filter applies a predetermined process to image data output from the inputting filter and outputs the processed image data to the preview image displaying filter . The preview image displaying filter outputs the processed image data as preview image displaying data.

The preview image displaying data output from the preview image displaying filter can be displayed on the operating section not shown of the image processing apparatus . The operating section is described below in detail.

The job generated by the processing filter in S is the same as the job generated in S shown in . Therefore the processing filter applies the same process as that described in to the image data. That is the processing filter executes the job generated by the instruction from the control layer based on the instruction of the activity filter in both the printing process and the preview image displaying process.

As described above in the image processing apparatus of the present embodiment when a preview image of image data to be output is instructed to be displayed the preview image of the image data can be displayed by connecting the preview image displaying filter to the processing filter via the image pipe without changing existing filters. In addition a dependence relationship does not exist between the printing filter and the preview image displaying filter . Therefore the functions of the printing filter and the preview image displaying filter can be easily expanded or customized changed without a change in one filter influencing the other filter.

In addition since the processing filter applies the same process to input image data the processing filter can output the same processed image data to the printing filter and the preview image displaying filter . Therefore the image data to be output as the print data can be output as the preview image data.

Next referring to processes are described in which the printing process is executed after executing the preview image displaying process in the image processing apparatus . is a diagram showing the processes in which the printing process is executed after executing the preview image displaying process in the image processing apparatus according to the first embodiment of the present invention. In in order to clearly describe the processes suffixes are attached to the image pipes . However actually one image pipe can operate as plural image pipes through . Further two processing filters are shown in however actually one processing filter applies a predetermined process to image data. In addition in order to avoid redundant description some processes described above are omitted.

First when a user instructs the image processing apparatus to display a preview image of image data to be output by using the local UI section the control layer makes the filters and generate corresponding jobs. When the filters and generate the corresponding jobs the activity filter instructs the inputting filter to execute the job to read image data S .

The inputting filter reads the image data whose preview image is displayed and whose image data are printed. That is the inputting filter executes the job. The inputting filter outputs the read image data to the image pipes and S . The image data to be output to the image pipes and are the same. That is actually the image pipe and the image pipe are one image pipe .

When the inputting filter reads the image data the activity filter instructs the preview image displaying filter to execute the preview image displaying process S . The preview image displaying process is the job generated by the preview image displaying filter based on the instruction from the control layer .

The preview image displaying filter requests the image pipe to send preview image data to the preview image displaying filter S . Since the image pipe does not store the preview image data the image pipe sends the request to the processing filter S . The image processing filter reads the image data from the image pipe S applies a predetermined process to the read image data and outputs the processed image data to the image pipe

The preview image displaying filter continues to request the image pipe to send the preview image data until the preview image displaying filter obtains the preview image data. With this the image data processed by the processing filter are sent to the preview image displaying filter .

The preview image displaying filter applies a process to the image data sent from the image pipe for outputting preview image data and outputs preview image data S . The preview image data are displayed on the operating section of the image processing apparatus via a preview image UI user interface section .

When the user instructs to print image data of the preview image data on the operating section via the preview image UI section S the preview image displaying filter sends the report of completion of the preview image displaying process to the activity filter S . The preview image displaying process is the job generated by the preview image displaying filter based on the instruction from the control layer .

The activity filter instructs the printing filter to execute a printing process of the image data after receiving the completion report of the preview image displaying process S . The printing filter requests the image pipe to send the image data to be printed S . The image pipe sends the request to the processing filter S .

The processing filter reads the image data from the image pipe S . The processing filter applies a process to the read image data and outputs the processed image data to the image pipe . The printing filter continues to request the image pipe to send the image data until the printing filter obtains the image data. With this the image data processed by the processing filter are sent to the printing filter via the image pipe

When the printing filter obtains the processed image data from the image pipe the printing filter applies a process to the image data for outputting the image data as print data and makes the plotter section refer to output the print data. The print data are printed on a recording medium by a plotter not shown based on control of the plotter section .

As described above in the image processing apparatus a preview image of image data to be printed is displayed and also the image data are printed.

In the image processing apparatus of the present embodiment it is possible that the inputting filter outputs both image data for printing and image data for displaying a preview image. That is the inputting filter outputs two image data sets different from each other.

Next referring to processes are described in which the inputting filter outputs both the image data for printing and the image data for displaying a preview image. is a diagram showing the processes in which the inputting filter outputs both the image data for printing and the image data for displaying a preview image. In similar to in suffixes are attached to the image pipes . In addition in order to avoid redundant description some processes described above are omitted.

In the inputting process of image data at the inputting filter of the image processing apparatus image data A for printing outputting and image data B for displaying a preview image are generated. The inputting filter generates the image data B for displaying the preview image whose resolution is lower than the resolution of the image data A for printing.

The image data A is output to the image pipe and the processing filter applies a process to the image data A from the image pipe and the processed image data A are output to the printing filter via the image pipe . The image data B are output to the image pipe and the processing filter applies a process to the image data B from the image pipe and the processed image data B are output to the preview image displaying filter via the image pipe

Since the resolution of the image data B is lower than the resolution of the image data A a period during which the processing filter applies a process to the image data B in the preview image displaying process can be shortened. In addition a resolution converting process in the preview image displaying process is not required. Therefore the performance in the preview image displaying process can be increased. That is the time and the workload which are required to display the preview image can be decreased. In the image processing apparatus of the present embodiment it is determined that the resolution of the image data B for displaying the preview image is for example 1 16 of the resolution of the image data A for printing.

In addition in the image processing apparatus of the present embodiment the inputting filter generates the image data A and B with the same data format. With this the processing filter can apply the same process to the image data A and B. Therefore even if the resolutions are different between the image data A and B the preview image data of the same format as that of the image data to be output can be displayed.

In the image processing apparatus of the present embodiment it is determined that the data format of the image data A and B is the RGB data format. However the data format is not limited the RGB data format and can be a data format to which a process can be applied in the processing filter .

As described above in the image processing apparatus of the present embodiment when a preview image of image data to be output is instructed to be displayed the preview image of the image data can be displayed by connecting the preview image displaying filter to the processing filter via the image pipe without changing existing components filters .

As described above in the image processing apparatus of the present embodiment the data formats of the image data A and B are the same and the resolution of the image data B for displaying the preview image is lower than the resolution of the image data A for printing. With this the period which is required in the preview image displaying process can be shortened and the preview image whose data format is the same as the data format of the printed image can be obtained.

Next referring to the drawings a second embodiment of the present invention is described. The second embodiment of the present invention includes an image processing apparatus A and the image processing apparatus A includes a finish determining service section which determines a parameter in a finishing process for image data to be output. The functions of the other elements in the second embodiment of the present invention are almost the same as those in the first embodiment of the present invention and some elements have additional functions compared with the first embodiment however the some elements have the corresponding same reference numbers as those in the first embodiment. In the second embodiment of the present invention points different from the first embodiment of the present invention which points include the finish determining service section are mainly described.

As shown in the image processing apparatus A of the second embodiment of the present invention includes a finish determining service section in the device servicing layer . That is the device servicing layer additionally includes the finish determining service section . The finish determining service section calculates and determines a parameter in the finishing process.

In the present embodiment the finishing process includes for example a stapling process for stapling recording media recording sheets on which images are printed and a punching process for punching the printed sheets.

Specifically in the stapling process a parameter showing a precise stapling position on the output printed sheets must be determined. In addition in the punching process a parameter showing a precise punching position on the output printed sheets must be determined. The finish determining service section calculates and determines the above parameters in the finishing process. That is the parameter is a precise position of the staple or the punch for example the staple position is 10 mm from the left side and 15 mm from the upper side of the document output image data .

Since the device servicing layer additionally includes the finish determining service section both the printing filter and the preview image displaying filter can use the finish determining service section . That is the finish determining service section can supply the parameters which are required in the finishing process to both the printing filter and the preview image displaying filter . Therefore a preview image with the finishing process applied can be displayed without a dependence relationship between the printing filter and the preview image displaying filter .

Next referring to a preview image displaying process is described in which a finishing process is applied to a preview image in the image processing apparatus A.

In similar to in in order to clearly describe the processes suffixes are attached to the image pipes . However actually one image pipe can operate as plural image pipes through . Further two processing filters are shown in however actually one processing filter applies a predetermined process to image data. In addition in order to avoid redundant description some processes described above are omitted.

As shown in in the image processing apparatus A of the second embodiment of the present invention the finish determining service section includes a finish determining section and a condition retaining section . In addition in the image processing apparatus A of the second embodiment of the present invention the printing filter includes a condition retention instructing section and a finish determination instructing section and the preview image displaying filter includes a condition obtaining section and a finish determination instructing section

The finish determining section calculates and determines a parameter for executing the finishing process based on a determined finish processing condition. The condition retaining section retains the determined finish processing conditions. It is possible that the finish processing conditions are temporarily retained.

The condition retention instructing section in the printing filter instructs the finish determining service section to retain a finish processing condition determined for the printing filter . The finish determination instructing section in the printing filter instructs the finish determining service section to calculate and determine a parameter for executing the finishing process.

The condition obtaining section in the preview image displaying filter obtains a finish processing condition stored in the condition retaining section in the finish determining service section . The finish determination instructing section in the preview image displaying filter instructs the finish determining service section to calculate and determine a parameter for executing the finishing process.

In the image processing apparatus A of the present embodiment by using the elements described above when a finish processing condition is determined a preview image of image data to be output can be displayed under the determined finish processing condition.

First when a user inputs a finish processing condition by using a printing UI user interface section the finish processing condition is set in the printing filter S . The printing UI section is a user interface where a printing process setting is input and is disposed in the operating section of the image processing apparatus A. The setting of the finish processing condition is included in the printing process settings. In addition a setting input from the printing UI section is set for only the printing filter .

In the following a case is described in which the finish processing is a stapling process and the finish processing condition is a position of a staple.

When the finish processing condition of the position of the staple is set in the printing filter the condition retention instructing section instructs the finish determining service section to retain the finish processing condition in the condition retaining section S . As described above the finish processing condition is the position of the staple on recording media recording sheets and is not the precise position calculated and determined by the parameter. For example the position is an upper left side position.

When the finish processing condition is retained in the finish determining service section the activity filter instructs the preview image displaying filter to execute a preview image displaying process S . The preview image displaying filter requests the finish determining service section to send the finish processing condition retained in the condition retaining section in the finish determining service section by using the condition obtaining section S .

The finish determining service section sends the finish processing condition to the preview image displaying filter S . When the preview image displaying filter obtains the finish processing condition the preview image displaying filter reads image data for displaying a preview image from the image pipe S . The finish determination instructing section in the preview image displaying filter instructs the finish determining service section to determine a parameter for the preview image displaying process by sending information of the read image data the obtained finish processing condition and a finish processing determination instruction S . The information of the read image data is for example the outputting direction and the size of the document.

The finish determining section in the finish determining service section determines a parameter for executing the finishing process based on the information of the read image data and the finish processing condition retained in the condition retaining section . Specifically in the stapling process a parameter showing the precise position of the staple is determined. The finish determining service section sends the determined parameter to the preview image displaying filter S .

When the preview image displaying filter receives the parameter the preview image displaying filter forms a preview image after executing the finishing process based on the read image data and the parameter and makes the operating section display the preview image by using the preview UI section S .

As described above in the image processing apparatus A of the present embodiment the preview image to which the finishing process has been applied is displayed.

When the image data of the displayed preview image are determined to be printed the activity filter instructs the printing filter to execute an image data printing process. By an instruction from the finish determination instructing section in the printing filter processes similar to the processes in S and S are executed. That is the printing filter makes the finish determining service section determine a parameter for the finishing process of the image data and obtains the determined parameter. Then the printing filter executes the image data printing process by using the obtained parameter.

As described above in the present embodiment since the finish determining service section is provided in the device servicing layer the finish determining service section can be used in common between the printing filter and the preview image displaying filter . With this the preview image displaying filter can make the operating section display the preview image of the image data after executing the finishing process by using the preview UI section .

Next referring to settings in a finishing process and determination of a parameter in the finishing process of the image processing apparatus A processes in the printing filter the preview image displaying filter and the finish determining service section are described.

First when a user inputs an instruction to print image data the printing filter receives the instruction S . The printing filter determines whether a finish processing condition is input S . When a finish processing condition is input YES in S the finish processing condition is set in the printing filter S . The condition retention instructing section instructs the finish determining service section to retain the finish processing condition in the condition retaining section S .

When a finish processing condition is not input NO in S a predetermined default finish processing condition is set in the printing filter S and the condition retention instructing section instructs the finish determining service section to retain the default finish processing condition in the condition retaining section .

In the image processing apparatus A of the present embodiment even if a finish processing condition is not input a default finish processing condition is set in the printing filter . Therefore regardless of the presence of the input of a finish processing condition the printing filter can execute the processes in S and S.

Next processes in the preview image displaying filter are described for setting a finish processing condition.

When a user inputs an instruction to display a preview image of image data to be output the preview image displaying filter receives the instruction S . Then the preview image displaying filter receives an instruction to execute a preview image displaying process from the activity filter S .

The condition obtaining section obtains a finish processing condition from the finish determining service section by using a request S . The obtained finish processing condition is set in the preview image displaying filter S and the preview image displaying filter executes the preview image displaying process S .

In the image processing apparatus A of the present embodiment the preview image displaying filter obtains a finish processing condition retained in the finish determining service section regardless of the presence of a finish processing condition in the finish determining service section . That is when a finish processing condition is not set in the finish determining service section the preview image displaying filter obtains a default finish processing condition and executes the preview image displaying process by using the obtained finish processing condition. Therefore the preview image displaying filter can execute the processes from S through S regardless of the presence of the setting of the finish processing condition.

Next processes in the finish determining service section are described in a setting of a finish processing condition.

The finish determining service section receives an instruction to retain a finish processing condition from the printing filter and retains the finish processing condition in the condition retaining section S . When the finish determining service section receives a request to send a finish processing condition to the preview image displaying filter S the finish determining service section sends the requested finish processing condition to the preview image displaying filter S .

As described above in the image processing apparatus A of the present embodiment the finish determining service section receives an instruction to retain a finish processing condition and retains the finish processing condition in the condition retaining section . In addition the finish determining service section receives a request to send the finish processing condition and sends the retained finish processing condition. Therefore a dependence relationship does not exist among the finish determining service section the printing filter and the preview image displaying filter . Consequently the finish determining service section can receive and send a finish processing condition without a change in one filter influencing the other filter.

As described above in the image processing apparatus A of the present embodiment a finish processing condition is input to the printing filter and is set in the printing filter the finish processing condition is retained in the finish determining service section and the finish processing condition is set in the preview image displaying filter .

As described above in the image processing apparatus A of the present invention since a dependence relationship does not exist between the printing filter and the preview image displaying filter the filters and can obtain the same finish processing condition. Therefore even if the function of one filter is changed the finish processing condition can be set in both the filters and without the change influencing the other filter. Consequently the functions of the filters and can be easily expanded and customized.

Next referring to processes are described in which a parameter in a finishing process is determined in the image processing apparatus A according to the second embodiment of the present invention. is a flowchart showing processes for determining a parameter in a finishing process in the image processing apparatus A according to the second embodiment of the present invention.

First processes in the printing filter are described in a parameter determining process based on a finish processing condition.

The printing filter receives an instruction to output print image data from the activity filter S and starts an image outputting process image printing process S .

The printing filter obtains image data to be output printed from the image pipe S . The printing filter sends information of the obtained image data a finish processing condition and an instruction from the finish determination instructing section to the finish determining service section . The information of the read image data is for example the outputting direction and the size of the document.

The printing filter obtains a parameter for executing a finishing process which parameter is calculated and determined by the finish determining service section and determines the finish of the image data to be output S . The printing filter executes a printing process of the obtained image data by using the parameter S . That is the printing filter makes the plotter section refer to print the image data on recording media recording sheets . Then the printing filter determines whether all pages of the image data are output S . When all pages of the image data are output YES in S the printing process ends.

As described above after the finish processing condition is set the printing filter obtains a parameter determined by the finish determining service section regardless of the presence of the preview image displaying filter and executes the printing process of the image data and the finishing process is applied to the printed document. Therefore in the printing process of the image data under the finish processing condition since a dependence relationship does not exist between the printing filter and the preview image displaying filter the preview image displaying filter can be deleted or the preview image displaying filter can be added again after the deletion.

Next processes in the preview image displaying filter in a parameter determining process based on a finish processing condition are described.

In the processes of the preview image displaying filter processes from S through S shown in are the same as the processes from S through S shown in . That is the preview image displaying filter receives an instruction to display a preview image of image data to be output S . Then the preview image displaying filter receives an instruction to execute a preview image displaying process from the activity filter the condition obtaining section obtains a finish processing condition from the finish determining service section and sets the obtained finish processing condition in the preview image displaying filter S . Then the preview image displaying filter executes the preview image displaying process S . In the processes for obtaining the finish processing condition from the finish determining service section are omitted.

When the preview image displaying filter starts to execute the preview image displaying process under the finish processing condition the preview image displaying filter obtains image data for displaying a preview image from the image pipe S . The preview image displaying filter sends information of the obtained image data the finish processing condition and an instruction from the finish determination instructing section to the finish determining service section . The information of the obtained image data is for example the outputting direction and the size of the document to be read.

The preview image displaying filter obtains a parameter for executing a finishing process which parameter is calculated and determined by the finish determining service section and determines the finish of the preview image S . The preview image displaying filter executes the preview image displaying process of the obtained image data by using the parameter S . That is the preview image displaying filter makes the operating section display the preview image. Then the preview image displaying filter determines whether all pages of the preview images are displayed S . When all pages of the preview images are displayed YES in S the preview image displaying process ends.

When all pages of the preview images are not displayed NO in S the preview image displaying filter determines whether a preview image of another page is requested to be displayed S . When a preview image of another page is requested to be displayed YES in S the preview image displaying filter repeats the processes from S through S. When a preview image of another page is not requested to be displayed NO in S the preview image displaying filter ends the preview image displaying process and enters a standby mode.

As described above in the preview image displaying process under the finish processing condition a dependence relationship does not exists between the preview image displaying filter and the printing filter . Therefore in the image processing apparatus A of the present embodiment the function of the printing filter can be freely customized and expanded regardless of the presence of the preview image displaying filter .

Next processes in the finish determining service section are described in a parameter determining process based on a finish processing condition.

When the finish determining service section receives the information of the image data the finish processing condition and the instruction from the finish determination instructing section from the printing filter S the finish determining service section calculates and determines a parameter for executing the finishing process and sends the parameter to the printing filter S .

Similarly when the finish determining service section receives the information of the image data the finish processing condition and the instruction from the finish determination instructing section from the preview image displaying filter S the finish determining service section calculates and determines a parameter for executing the finishing process and sends the parameter to the preview image displaying filter S .

As described above in the image processing apparatus A of the present embodiment a dependence relationship does not exist among the finish determining service section the printing filter and the preview image displaying filter . Therefore even if the function of one of the filters is changed the finish determining service section can determine a parameter for determining finish of image data and a preview image without the change influencing the other filter.

Consequently in the image processing apparatus A of the present embodiment the functions of the filters can be easily expanded or customized.

Next the operating section of the image processing apparatus A is described. is a diagram showing an operating section of a conventional image processing apparatus. is a diagram showing an operating section of the image processing apparatus A according to the second embodiment of the present invention.

First the operating section of the conventional image processing apparatus is described. The operating section is formed of a member having a displaying function for example an operating panel.

The operating section independently provides a process setting screen and a finish setting screen. On the process setting screen a process for image data in a printing process is set. On the finish setting screen a finish processing condition in an image outputting process of image data is set. As shown in on the process setting screen settings such as rotation scaling density of an image including in an image process which is executed by a processing filter are set. On the operating section when a preview image of image data to which a setting is applied on the process setting screen is displayed a preview button is pushed. When the preview button is pushed the process setting screen is changed to a preview image displaying screen on the operating section . Then a preview image to which the setting has been applied on the process setting screen is displayed on the preview image displaying screen.

When the setting is changed on the preview image displaying screen a process setting button is pushed. Then the preview image displaying screen is changed to the process setting screen again and a new setting is executed again.

Similarly a finish processing condition is set on the finish setting screen. That is when a preview image of image data under a finish processing condition which is set on the finish setting screen is displayed on the preview image displaying screen the finish setting screen is changed to the preview image displaying screen on the operating section by pushing the preview button .

As described above the operating section of the conventional image processing apparatus independently provides the process setting screen the preview image displaying screen and the finish setting screen. Consequently when a user confirms the settings the user must change a screen to another screen. That is the user must execute complex processes. In addition on the operating section of the conventional image processing apparatus since a setting cannot be executed while displaying a preview image the user must memorize the settings displayed on the process setting screen and the finish processing condition displayed on the finish setting screen that is the operability of the operating section is low.

In order to solve the above problems the image processing apparatus A of the present embodiment includes a process setting region a finish processing condition setting region and a preview image displaying region on a screen of the operating section .

Next referring to the operating section of the image processing apparatus A of the present embodiment is described. The operating section is formed of a member having a displaying function for example an operating panel.

As shown in on the operating section of the image processing apparatus A a process setting region first operating region a finish processing condition setting region second operating region and a preview image displaying region third operating region are simultaneously displayed on the screen. A process setting for image data is determined on the process setting region a finish processing condition is determined on the finish processing condition setting region and a preview image to which the process setting and the finish processing condition have been applied is displayed on the preview image displaying region .

On a preview image displaying screen of the operating section for example when a punch button displayed in the finish processing condition setting region is pushed a preview image displayed in the preview image displaying region is changed to a preview image to which a punching process finishing process has been applied.

As described above on the operating section of the image processing apparatus A a preview image displayed on the preview image displaying screen can be changed to a new preview image to which a setting and a condition have been applied without changing the preview image displaying screen. Consequently processes for the settings are simplified and the operability on the operating section can be high.

Next referring to the drawings a third embodiment of the present invention is described. In the third embodiment of the present invention the image processing apparatus A is also used. However the functions of the image processing apparatus A of the third embodiment of the present invention are slightly different from those of the second embodiment of the present invention. That is the image processing apparatus A of the third embodiment of the present invention includes a preview image displaying filter A. The functions of the other elements in the third embodiment of the present invention are almost the same as those in the second embodiment of the present invention and some elements have additional functions compared with the second embodiment however the some elements have the corresponding same reference numbers as those of the second embodiment. In the third embodiment of the present invention points different from the second embodiment of the present invention which points include the preview image displaying filter A are mainly described.

In the second embodiment of the present invention the preview image displaying filter makes the operating section display the preview image of the image data read from the image pipe to which preview image the finishing process has been applied based on the parameter determined by the finish determining service section . That is in the second embodiment of the present invention the preview image displaying filter dynamically forms the preview image data. That is the preview image displaying filter forms the preview image under the finish processing condition by using the finish processing condition and the determined parameter.

In the second embodiment of the present invention when a new finish processing condition is added the preview image displaying filter must change the preview image by including the new finish processing condition.

That is in the second embodiment of the present invention when a new finish processing condition is added the source code of the preview image displaying filter must be rewritten.

In other words in the second embodiment of the present invention when a new finish processing condition is added or an existing finish processing condition is changed a preview image is not easily displayed.

In the third embodiment of the present invention when a new finish processing condition is added or an existing finish processing condition is changed a preview image is easily displayed.

The preview image displaying filter A of the third embodiment of the present invention makes the operating section display a preview image of image data in which image data read from the image pipe are synthesized with synthesizing image data described below based on a finish processing condition retained in the condition retaining section .

Next referring to the preview image displaying filter A is described. is a diagram showing a structure of the preview image displaying filter A and processes performed by the preview image displaying filter A.

As shown in the preview image displaying filter A includes a searching section and an image data synthesis instructing section in addition to including the condition obtaining section and the finish determination instructing section . The searching section searches for a file name of synthesizing image data corresponding to a finish processing condition from a finish processing condition table described below . The image data synthesis instructing section instructs an image data synthesis processing section described below to synthesize image data read from the image pipe with the synthesizing image data.

The image processing apparatus A of the third embodiment of the present invention further includes the finish processing condition table the image data synthesis processing section and a synthesizing image data database . The finish processing condition table and the synthesizing image data database are stored in a storage unit for example an HD hard disk of the image processing apparatus A.

The finish processing condition table stores the finish processing conditions and the corresponding file names of the synthesizing image data. The file name is information to identify synthesizing image data corresponding to a finish processing condition. The synthesizing image data database stores the synthesizing image data. The synthesizing image data are image data of an icon corresponding to a finish processing condition. The icons are for example an icon of a staple showing a stapling process and an icon of a punch hole showing a punching process.

Next referring to the processes of the preview image displaying filter A are described. In the processes after the process of S shown in are described. That is the preview image displaying filter A has obtained the image data from the image pipe and the parameter for executing the finishing process determined by the finish determining service section . In other words the preview image displaying filter A has obtained the finish processing condition S .

The searching section of the preview image displaying filter A searches for a file name in the finish processing condition table by using the obtained finish processing condition as a key S . The preview image displaying filter A obtains a file name of synthesizing image data corresponding to the obtained finish processing condition S .

For example in Staple ON and Upper Left Side ON Stapling at Upper Left Side are set in the obtained finish processing condition. Therefore the preview image displaying filter A searches for a file name in the finish processing condition table by using Staple ON and Upper Left Side ON as the key and obtains a corresponding file name Staple Reft Up.jpg .

When a file name of synthesizing image data corresponding to the obtained finish processing condition is not obtained the preview image displaying filter A makes the operating section display the preview image of the image data read from the image pipe as they are.

When the preview image displaying filter A obtains the file name the image data synthesis instructing section instructs the image data synthesis processing section to synthesize the image data read from the image pipe with the synthesizing image data corresponding to the obtained file name S . At this time the preview image displaying filter A sends the file name of the synthesizing image data the image data read from the image pipe and the parameter obtained from the finish determining service section to the image data synthesis processing section .

Then the image data synthesis processing section synthesizes the image data read from the image pipe with the synthesizing image data icon corresponding to the obtained file name.

Specifically when the image data synthesis processing section obtains the file name the image data synthesis processing section refers to the synthesizing image data database S and obtains synthesizing image data corresponding to the obtained file name from the synthesizing image data database S . When the image data synthesis processing section cannot obtain the synthesizing image data corresponding to the obtained file name it is possible that an error message is displayed on the operating section.

The image data synthesis processing section synthesizes the obtained synthesizing image data at the position designated by the parameter sent from the preview image displaying filter A on the image data read from the image pipe . The image data synthesis processing section sends the synthesized image data to the preview image displaying filter A. The preview image displaying filter A makes the operating section display the synthesized image data as the preview image.

In an example shown in the image data synthesis processing section obtains the file name Staple Reft Up.jpg . Therefore the image data synthesis processing section searches for synthesizing image data corresponding to the obtained file name in the synthesizing image data database and obtains synthesizing image data . In this case the synthesizing image data is an icon showing a stapling process. The image data synthesis processing section synthesizes the synthesizing image data with image data read from the image pipe and forms synthesized image data .

The synthesized image data are sent to the preview image displaying filter A. The preview image displaying filter A makes the operating section display the synthesized image data . It is possible that the image data synthesis processing section is realized by installing a program having the synthesizing process in an ASIC application specific integrated circuit .

As described above the preview image displaying filter A can make the operating section display a preview image without dynamically forming the preview image. That is the preview image displaying filter A only executes processes in which a file name of synthesizing image data is obtained from the finish processing condition table and the obtained file name is sent to the image data synthesis processing section .

Therefore the preview image displaying filter A can make the operating section display the preview image by using the finish processing condition table the synthesizing image data database and the image data synthesis processing section . Consequently in the present embodiment even if a new finish processing condition is added or an existing finish processing condition is changed the preview image can be easily displayed.

In the third embodiment of the present invention the finish processing condition table and the synthesizing image data database are stored in the HD. However the finish processing condition table and the synthesizing image data database can be stored in an external storage unit as general purpose files. At this time when a new finish processing condition is added the finish processing condition table and the synthesizing image data database are simultaneously updated by including the new finish processing condition and the corresponding icon. Therefore when the new finish processing condition is added a preview image corresponding to the added new finish processing condition can be easily displayed without changing the preview image displaying filter A.

Next referring to processes in a case are described in which a new finish processing condition is added to the image processing apparatus A. is a diagram showing processes in a case in which a new finish processing condition is added to the image processing apparatus A according to the third embodiment of the present invention.

In a case is shown in which a marking filter A is added to the image processing apparatus A as the new finish processing condition. By using the marking filter A a document is printed by attaching a predetermined barcode to the document.

In this case when the marking filter A is added another finish processing condition table and another synthesizing image data database corresponding to the marking filter A are simultaneously added.

First when a user instructs to display a preview image of image data by using the preview UI section the preview image displaying filter A obtains a finish processing condition set by the marking filter A and obtains synthesizing image data icon of the finish processing condition .

Specifically the preview image displaying filter A searches for a file name in the finish processing condition table by using a finish processing condition Barcode ON of the marking filter A as a key and obtains a file name Barcode.jpg of the synthesizing image data. The preview image displaying filter A sends the file name Barcode.jpg to the image data synthesis processing section refer to . The image data synthesis processing section synthesizes synthesizing image data corresponding to the file name Barcode.jpg obtained from the synthesizing image data database with the image data refer to read from the image pipe and outputs the synthesized image data to the preview image displaying filter A.

The preview image displaying filter A makes the operating section display a preview image including the synthesizing image data.

As described above even if a new finish processing condition is added a preview image can be easily displayed without changing the preview image displaying filter A.

Next a case is described in which synthesizing image data of a finish processing condition are changed by for example customization.

In this case when a finish processing condition including synthesizing image data is changed a preview image under the changed finish processing condition can be displayed by only rewriting the finish processing condition table and the synthesizing image data database.

In this case synthesizing image data showing an icon of the finish processing condition Double Face ON are added to a synthesizing image data database . In addition the file name Double Face.jpg corresponding to the finish processing condition Double Face ON is added to a finish processing condition table

As described above in the present embodiment when a new finish processing condition is added in an outputting filter the new finish processing condition table and the new synthesizing image data database are formed. That is a preview image under the new finish processing condition can be displayed without changing the preview image displaying filter A.

In addition in the present embodiment when synthesizing image data stored in the synthesizing image data database are revised a preview image can be revised. is a diagram showing processes when synthesizing image data stored in a synthesizing image data database are revised.

In a case is shown in which synthesizing image data corresponding to a punching process in a synthesizing image data database are revised to synthesizing image data .

In this case when only the synthesizing image data are revised to the synthesizing image data in the synthesizing image data database the synthesizing image data new icon can be displayed in the preview image. At this time the file name in a finish processing condition table is not revised. That is the file name of the synthesizing image data is the same as that of the synthesizing image data .

The processes described in the first through third embodiments of the present invention can be recorded in a computer readable recording medium as an image processing program.

As shown in the image processing apparatus includes a CPU a hard disk a memory unit a displaying section a scanner section a communication section a data and program reading section and a plotter section . The CPU executes operations and processes in the image processing apparatus . The hard disk stores application software to be executed by the CPU data processed by the application software and other data. The memory unit stores predetermined setting values which are used in the processes in the image processing apparatus results of operations by the CPU and so on.

The displaying section displays operating conditions of the image processing apparatus and so on. In addition a user instructs performing a process in the image processing apparatus by using the displaying section . The scanner section includes a scanner and an engine for controlling the scanner converts a document into image data by scanning the document and inputs the converted data to the image processing apparatus . The communication section is for example a network control unit and the image processing apparatus communicates with an external device by using the communication section . The data and program reading section reads data and a program stored in a recording medium. The data and program reading section is for example a floppy disk drive. The plotter section includes a plotter and an engine for controlling the plotter and outputs image data on for example a recording sheet.

The recording medium stores an image processing program for executing the processes described in the first through third embodiments of the present invention. The image processing program is read by the data and program reading section and the CPU executes the image processing program. The recording medium is for example a memory card or a floppy disk or can be a recording medium readable by the image processing apparatus . In addition the image processing program can be received by the communication section from an external device via a network and can be stored in the hard disk .

Further the present invention is not limited to the specifically disclosed embodiments and variations and modifications may be made without departing from the scope of the present invention.

The present invention is based on Japanese Priority Patent Application No. 2007 057882 filed on Mar. 7 2007 and Japanese Priority Patent Application No. 2007 260173 filed on Oct. 3 2007 with the Japanese Patent Office the entire contents of which are hereby incorporated herein by reference.

