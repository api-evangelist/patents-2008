---

title: Method and apparatus for 3D metal and high-density artifact correction for cone-beam and fan-beam CT imaging
abstract: A 3D metal artifacts correction technique corrects the streaking artifacts generated by titanium implants or other similar objects. A cone-beam computed tomography system is utilized to provide 3D images. A priori information (such as the shape information and the CT value) of high density sub-objects is acquired and used for later artifacts correction. An optimization process with iterations is applied to minimize the error and result in accurate reconstruction images of the object.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08023767&OS=08023767&RS=08023767
owner: University of Rochester
number: 08023767
owner_city: Rochester
owner_country: US
publication_date: 20080310
---
The work leading to the present invention was funded by the NIH under Agreement Nos. R01 9 HL078181 and P50 AR054041. The government has certain rights in the invention.

The present invention is directed to CT imaging and more particularly to the correction of high density artifacts in such imaging.

Bone grafting is a common procedure in orthopedic surgery. As shown in a bone graft is grafted between bone hosts portions of the patient s original bone and . The bone graft is held in place by a titanium plate and titanium screws until the bone graft and the bone hosts grow together.

Orthopedists have developed a method to prevent the future failure of reconstruction surgery by revitalizing structural grafts to improve their biomechanical properties. Through using certain combinations of viruses and drugs they can introduce angiogenic osteogenic and remodeling signals onto the cortical surface of the grafts. Therefore the volume growth of contiguous new bone that spans the host graft host junction is the most important parameter to accurately assess bone healing.

With the capability for 3D imaging of large volumes with isotropic resolution the CBCT cone beam computed tomography imaging technique is helpful to determine that parameter. However the titanium plates and screws used to connect structural grafts with host bones as seen in cause streaking and shading artifacts in the reconstructed images due to their high attenuation of x rays. These artifacts will distort the information of bones and cause difficulties and errors when measuring their growth. The main reason for these artifacts is the beam hardening caused by metal implants high attenuation of x rays.

High orders of metal projections are usually used to compensate for the effect of beam hardening. In order to get the metal only projection grey level thresholding is commonly used on the reconstructed images to segment metals out which will be forward projected onto the detector. However due to the large size of the titanium plate and screws used by orthopedists in the reconstruction surgery streaking artifacts are usually so severe that thresholding cannot carry out the metal segmentation without including artifacts in the segmented image.

To solve this problem and help orthopedists correctly monitor the growth of host graft host junctions the present invention is directed to a 3D metal artifacts correction technique to correct the streaking artifacts generated by titanium implants or other similar objects. This 3D technique can be generalized for any correction of the artifacts caused by high density sub objects such as metal implants in orthopedic surgery and isotope seeds in cancer treatments for example prostate and or breast cancer treatments .

The novelty of this technique lies in three parts. Firstly a CBCT system is utilized to provide 3D images hence this 3D technique can deal with high density artifacts globally. Secondly a priori information such as the shape information and the CT value of high density sub objects is acquired and used for later artifacts correction. Finally an optimization process with iterations is applied to minimize the error and result in accurate reconstruction images of the object.

The present invention can be implemented along with the technologies disclosed in U.S. Pat. Nos. 5 999 587 6 075 836 6 298 110 6 477 221 6 480 565 6 504 892 6 618 466 and 6 987 831 and U.S. Patent Application Publications 2007 0053477 and 2007 0253528 all of which are hereby incorporated by reference in their entireties into the present disclosure.

A preferred embodiment of the present invention will be set forth in detail with reference to the drawings in which like reference numerals refer to like elements or steps throughout.

Metal artifacts are mainly due to the beam hardening caused by high attenuation of x rays of metal implants. Because more low energy photons are absorbed by metal the x ray beam becomes more penetrating and thus the attenuation coefficient of the object along the x ray path appears smaller and smaller along the x ray path. Therefore the line integral is not linear to the length of the x ray path anymore. Instead it gets smaller as the x ray path gets longer as illustrated in .

Since there are discrepancies between the projection rays that pass through only one of the dense objects and the rays that pass through multiple objects dark banding artifacts and streaking artifacts appear as seen in which show streaking artifacts and and shading artifacts . In order to correct these artifacts the line integral of the metal with beam hardening as seen in curve P in needs to be corrected back to a linear relationship with the x ray path length as seen in curve P in .

Theoretically any smooth monotonically increasing concave function like P can be mapped onto a straight line by the following operation 

where is the coefficient of the ipolynomial term. These coefficients are dependent on the material and the spectrum of the x ray tube. They can be determined by the experiment described as follows. The material of simple shape for example sphere or cylinder is scanned and reconstructed to provide its images for the calculation of the x ray path length at each detector cell. The material s projection image is then acquired with given x ray spectrum and high mAs to calculate the line integral image containing beam hardening. The line integral value is plotted as function of the x ray path length for all detector pixels. This curve corresponds to curve P in . In order to get curve P in the linear attenuation coefficient of the material at the average energy of the given x ray spectrum is obtained from the NIST National Institute of Standards and Technology X ray Attenuation Database. And then curve P in can be plotted as P l where l is the x ray path length at each detector pixel. Once Pand P are obtained can be determined by minimum least squares fit using the nonlinear curve Pas the independent variable and the straight line P as the dependent variable. Usually the second and the third order polynomial terms of Pare enough to correct most artifacts.

As discussed just above the line integral of the metal high density object containing beam hardening denoted by P needs to be acquired first to correct the beam hardening caused by the metal. This can be achieved by segmenting the metal high density object from the reconstructed images and forward projecting it onto the detector. The forward projected metal projection is the line integral of the metal containing beam hardening. Once Pis obtained using Eq. 1 can get the corrected projection data 2 

where Prepresents the original projection of the whole scanned object including metal bone and soft tissue etc. Prepresents the projection with the correction of beam hardening caused by the metal.

After the corrected projections are obtained they will be back projected to reconstruct the artifacts corrected images. The correction process can be summarized as follows with reference to the flow charts of .

A CBCT system is provided in step . A first scan in step yields high density sub objects e.g. metal implants isotope seeds or the like in step . Reconstruction and information abstraction in step yield a library of high density sub objects 3D shape information and CT value in step .

A second scan in step yields image data for an object containing high density sub objects in step . Reconstruction in step yields original 3D reconstructed images in step . High density sub object characterization in step yields translation and rotation information concerning the high density sub objects in the 3D images in step .

The translation and rotation information from step and the library from step are used to form translated and rotated 3D metal shape images in step . An optimization process with iterations in step yields segmented high density sub object images in step . Forward projection in step yields high density sub object projections in step . A high order operation in step yields high orders of the sub objects projections error projections in step . The error projections are scaled by and added to the original projections in step to yield corrected projections in step . The corrected projections are used in a reconstruction in step to yield corrected 3D reconstructed images in step .

Firstly a CBCT system is utilized to provide 3D images hence this 3D technique works on 3D images and deals with high density artifacts globally. Conventional methods usually work on 2D images and correct the high density artifacts slice by slice.

Secondly a priori information such as the shape information and the CT value of high density sub objects is acquired and used for later artifacts correction. During the correction of beam hardening caused by high density sub objects the segmentation of those sub objects from the reconstructed images is important. Usually when beam hardening is not very severe using grey level thresholding can easily do the work since those sub objects have very high CT values. But when a high density sub object is large beam hardening will be severe that its CT value drops and streaking artifacts are serious. Hence using thresholding can not segment the whole sub object out and some severe artifacts may be included.

To solve this problem our 3D metal artifacts correction technique uses a 3D library which contains those high density sub objects shape information to help to do the segmentation. This library can be set up before high density sub objects are implanted. During the acquisition of this a priori information a high x ray technique can be chosen to reduce beam hardening as much as possible i.e. highest kVp with beam filters and highest mAs. The reconstructed images will be processed and the 3D shape information of the sub object will be stored as binary images in the library. When an object containing high density sub objects is scanned 3D shape information of the sub objects will be retrieved from the library and registered with the object s images to help to do the segmentation. Since the high density sub objects will be placed in the scanned object in various positions the 3D library needs to be rotated and translated to register with the reconstructed images. In order to do so the characteristics of the sub objects such as the long axis and the short axis of the metal plate and the axes of the nails will be identified in the object s images to provide the rotation and the translation information of high density sub objects. This information will be used to register the 3D library with the object s reconstructed images to do the segmentation.

Thirdly an optimization process with multiple iterations is applied to minimize the segmentation error and accurate reconstruction images of the object can finally result from the 3D correction technique. To segment the high density objects from the reconstructed images it is important to accurately register the shape information of the high density sub objects in the library with the reconstructed images. Therefore an optimization process with iterations is applied here to minimize the segmentation error. Firstly high density objects are roughly segmented from reconstruction images by thresholding method to approximate their translation and rotation information. Although thresholding might include some artifacts the orientation information of the high density objects can be obtained from this initial segmentation to guide the registration. The shape images in the library are then translated and rotated basing on the initially obtained orientation information to register with the high density objects. Three dimensional convolution is performed between the rotated shape images and the initially segmented high density objects to calculate the registration error. An iteration process is used to rotate and translate the shape images within a small range and the registration error is calculated at each time. The iteration process stops once the smallest registration error is achieved and the orientation information at that moment is recorded. The shape images in the library are finally translated and rotated basing on the optimized orientation information to segment the high density objects from the reconstructed images.

It is worth pointing out here that the metal library only contains binary images and the sub objects CT values thus it does not consume much storage resource and can be easily updated by just adding new information into it. In addition an individual library can be set up to provide particular high density sub objects information for each patient case to do continuous studies or treatments.

While a preferred embodiment of the invention has been set forth in detail with reference to the drawings those skilled in the art who have reviewed the present disclosure will readily appreciate that other embodiments can be realized within the scope of the invention. For example numerical values are illustrative rather than limiting as are disclosures of specific imaging technologies. For example any 3D imaging technique such as fan beam computed tomography can be used. Also as noted above the invention is not limited to the imaging of titanium objects or of bone grafts. Moreover there is no reason why the image data have to be taken and processed at the same time or in the same place instead they could be transmitted off site over the Internet or another suitable communication medium for processing or stored for later processing. Therefore the present invention should be construed as limited only by the appended claims.

