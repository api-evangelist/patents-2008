---

title: Techniques for virtual machine backup scheduling
abstract: Techniques for virtual machine backup scheduling are disclosed. In one particular exemplary embodiment, the techniques may be realized as an apparatus for scheduling one or more backup operations. The apparatus may comprise one or more virtual machines to operate on one or more systems. The apparatus may also comprise a backup manager to monitor resource requirements associated with at least one of the one or more virtual machines, associate the resource requirements with each of the one or more virtual machines, and to create a backup schedule for the one or more virtual machines based at least in part upon the resource requirements associated with the at least one of the one or more virtual machines. The apparatus may further comprise a module for implementing backups of the one or more virtual machines based at least in part upon the backup schedule created by the backup manager.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08959509&OS=08959509&RS=08959509
owner: Symantec Corporation
number: 08959509
owner_city: Mountain View
owner_country: US
publication_date: 20080602
---
The present disclosure relates generally to backup operations and more particularly to techniques for virtual machine backup scheduling.

A backup operation associated with a computer system may require a great deal of resources both in terms of processor resources and memory resources. In a computerized system hosting one or more virtual machines where one or more of the virtual machines is backed up the requirements to perform backup operations on the virtual machines may increase the processor and memory requirements. Devoting processor and memory resources to the simultaneous backup of one or more virtual machines may remove resources from other competing virtual machines.

Moreover during the time that a virtual machine is being backed up it may not be available or may have limited availability to perform the operations for which it was instantiated. Virtual machines may operate according to a pre determined schedule. For example a virtual machine may be instantiated to control a database linking operation for a product database after new products are added. New products may only be added to the exemplary database at 5 PM every Tuesday evening so the exemplary virtual machine may require a relatively greater amount of processor and memory resources between 5 PM and 7 PM on Tuesdays and may require a relatively smaller amount of processor and memory resources during the rest of the week or may even require only a nominal amount of resources during the non peak time.

Virtual machine backup operations may be scheduled by hand so that for example a system administrator may note when specific virtual machines on a system are in a non peak time and may specify backup operations to take place when all or most of the virtual machines are in a non peak time. However virtual machines may be migrated from one physical system to another physical system in order to balance the processor and or memory requirements to upgrade physical systems or for other reasons. Hand scheduled backup operations for individual virtual machines moved onto a new physical system may occur at times of increased activity of the moved virtual machines or virtual machines already existing on that system. Alternatively new virtual machines may be created on a physical system which may conflict with the backup schedules of existing virtual machines. This is a problem because the movement of virtual machines while expedient from an efficiency standpoint creates problems in creating an efficient backup schedule.

In view of the foregoing it may be understood that there are significant problems and shortcomings associated with current backup technologies.

Techniques for virtual machine backup scheduling are disclosed. In one particular exemplary embodiment the techniques may be realized as an apparatus for scheduling one or more backup operations. The apparatus may comprise one or more virtual machines to operate on one or more systems. The apparatus may also comprise a backup manager to monitor resource requirements associated with at least one of the one or more virtual machines associate the resource requirements with each of the one or more virtual machines and to create a backup schedule for the one or more virtual machines based at least in part upon the resource requirements associated with the at least one of the one or more virtual machines. The apparatus may further comprise a module for implementing backups of the one or more virtual machines based at least in part upon the backup schedule created by the backup manager.

In accordance with other aspects of this particular exemplary embodiment one or more virtual machines may be associated with a priority level and the backup schedule may be further based at least in part on the priority level assigned to the at least one of the one or more virtual machines.

In accordance with further aspects of this particular exemplary embodiment the resource requirements may include processor requirements.

In accordance with further aspects of this particular exemplary embodiment the resource requirements may include memory requirements.

In accordance with further aspects of this particular exemplary embodiment the resource requirements may include network requirements.

In accordance with further aspects of this particular exemplary embodiment the resource requirements may include noting if the virtual machine is in operation.

In accordance with further aspects of this particular exemplary embodiment the backup manager may monitor the resource requirements associated with the at least one of the one or more virtual machines once per second.

In accordance with further aspects of this particular exemplary embodiment the backup manager may monitor the resource requirements associated with the at least one of the one or more virtual machines once per minute.

In accordance with further aspects of this particular exemplary embodiment the backup manager may monitor the resource requirements associated with the at least one of the one or more virtual machines once per hour.

In another particular exemplary embodiment the techniques may be realized as a method for scheduling one or more backup operations. The method may comprise providing one or more virtual machines to operate on one or more systems. The method may also comprise monitoring resource requirements associated with at least one of the one or more virtual machines. The method may further comprise associating the resource requirements with each of the one or more virtual machines. The method may additionally comprise creating a backup schedule for the one or more virtual machines based at least in part upon the resource requirements associated with the at least one of the one or more virtual machines. The method may still further comprise implementing backups of the one or more virtual machines based at least in part upon the backup schedule created by the backup manager.

In accordance with other aspects of this particular exemplary embodiment one or more virtual machines may be associated with a priority level and the backup schedule may be further based at least in part on the priority level assigned to the at least one of the one or more virtual machines.

In accordance with further aspects of this particular exemplary embodiment the resource requirements may include processor requirements.

In accordance with further aspects of this particular exemplary embodiment the resource requirements may include memory requirements.

In accordance with further aspects of this particular exemplary embodiment the resource requirements may include network requirements.

In accordance with further aspects of this particular exemplary embodiment the resource requirements may include noting if the virtual machine is in operation.

In accordance with further aspects of this particular exemplary embodiment the backup manager may monitor the resource requirements associated with the at least one of the one or more virtual machines once per second.

In accordance with further aspects of this particular exemplary embodiment the backup manager may monitor the resource requirements associated with the at least one of the one or more virtual machines once per minute.

In accordance with further aspects of this particular exemplary embodiment the backup manager may monitor the resource requirements associated with the at least one of the one or more virtual machines once per hour.

In another particular exemplary embodiment the techniques may be realized as at least one processor readable medium for storing a computer program of instructions configured to be readable by at least one processor for instructing the at least one processor to execute a computer process for performing the method as recited above.

In another particular exemplary embodiment the techniques may be realized as an article of manufacture for scheduling one or more backup operations wherein the article of manufacture comprises at least one processor readable medium and instructions carried on the at least one medium wherein the instructions are configured to be readable from the at least one medium by at least one processor and thereby cause the at least one processor to operate so as to provide one or more virtual machines to operate on one or more systems monitor resource requirements associated with at least one of the one or more virtual machines associate the resource requirements with each of the one or more virtual machines create a backup schedule for the one or more virtual machines based at least in part upon the resource requirements associated with the at least one of the one or more virtual machines and implement backups of the one or more virtual machines based at least in part upon the backup schedule created by the backup manager.

The present disclosure will now be described in more detail with reference to exemplary embodiments thereof as shown in the accompanying drawings. While the present disclosure is described below with reference to exemplary embodiments it should be understood that the present disclosure is not limited thereto. Those of ordinary skill in the art having access to the teachings herein will recognize additional implementations modifications and embodiments as well as other fields of use which are within the scope of the present disclosure as described herein and with respect to which the present disclosure may be of significant utility.

Referring to there is shown a system level diagram of a backup manager system in accordance with an embodiment of the present disclosure. As shown in the backup manager system comprises a backup manager in communication with one or more systems and . Each of the systems and may operate a hypervisor and which may be operable to instantiate one or more virtual machines VM and collectively .

The backup manager may be a separate system or systems operating for the task of scheduling backups or the backup manager may be embodied as one or more processes or software instructions operating on one or more of the systems and associated with the virtual machines . The backup manager if separate from the systems and may be in communication with the systems and via a network not shown a direct connection or another technique for one computer or computerized system to communicate with another computer or computerized system.

The backup manager may also be in communication with the one or more virtual machines . The backup manager may then record information regarding the one or more virtual machines . For example the backup manager may record information or resource requirements regarding a virtual machine s memory usage processor usage network usage virtual machine up time relative weight disk usage and or available system capacity. The backup manager may also record other information regarding or related to the virtual machines . The backup manager may record the information periodically. For example the backup manager may record information regarding virtual machines at one second intervals or less five second intervals five minute intervals hourly intervals daily intervals and or monthly intervals. The backup manager may average one or more values across a period of time so that for example memory usage determined at five second intervals may be aggregated and recorded at one hour intervals.

The backup manager may also associate a priority or a priority level with a virtual machine . The priority may indicate a preference that one or more virtual machines receive access to processor memory network bandwidth or other network resources or indicate other metrics for one or more virtual machines . For example a virtual machine having a priority of 6 may receive a higher amount of system capacity than a virtual machine having a priority of 1. Alternatively a virtual machine having a priority of 1 may be suspended while a virtual machine having a priority of 6 may utilize the resources of a physical system in which both virtual machines may co exist.

The backup manager may also store an estimated backup completion time for the one or more virtual machines . The estimated backup completion time may be the time estimated for a virtual machine to be backed up. The estimated backup completion time may be determined by monitoring previous backups of the virtual machine . For example the estimated backup completion time may be determined based on an average of all of the previous backups of the virtual machine or an average of the last five backups of the virtual machine . The estimated backup completion time may also be estimated from other characteristics of the virtual machine . For example the memory requirements of the virtual machine or the amount of disk space that the virtual machine utilizes may be included in an estimate of backup time.

The backup manager may record information regarding the one or more virtual machines into for example memory associated with the backup manager disk storage associated with the backup manager or other storage media. The backup manager may also recall information regarding the one or more virtual machines from a memory disk or other storage media associated with the backup manager . The backup manager may associate the information with each of the virtual machines . For example the virtual machine may incorporate the information from the backup manager into a file system of the virtual machine . Each virtual machine may record its own information so that if a virtual machine is moved from one physical system and to another physical system and the information regarding the virtual machine may also be transferred to the other physical system and .

Systems and may be physical devices commonly known in the art. For example systems and may be implemented as servers. Systems and may receive data from one or more inputs produce data through one or more outputs have one or more persistent storage devices for storing and retrieving data and be in communication with one or more networks. Systems and may operate using an operating system and may load the operating system into memory in local persistent storage for example a hard drive or may load the operating system into memory in shared storage across a network.

Each hypervisor and may operate on each of the one or more systems and . The hypervisors and may manage the creation and or operation or one or more virtual machines . For example the hypervisors and may interface between the physical services provided by the systems and for example the processor or processors and the memory of the systems and and the one or more virtual machines . The hypervisors and may also create new instances of virtual machines or may manage or coordinate the transfer of one or more virtual machines from one system and to another system and . Of course other methods may be utilized to create transfer manage and or control one or more virtual machines . For example hardware in communication with the system and may be operable to create transfer manage and or control the one or more virtual machines . Alternatively other software or hardware may be executed or may be associated with the system and to create transfer manage and or control the one or more virtual machines .

Within the system one or more virtual machines may be instantiated. For example within System1 VM1 VM2 and VM3 may be instantiated. A system and may include any number of virtual machines . A virtual machine may appear to be a physical system but instead may be instantiated on a physical system and . A virtual machine may appear to receive data from one or more inputs produce data through one or more outputs have addressable memory and persistent storage for storing and retrieving data and be in communication with one or more networks.

Virtual machines may migrate between physical systems and . For example VM1 shown hosted on System1 may move to System2 . Migration may help to distribute processor or memory or persistent storage requirements between systems. Virtual machines may also migrate between systems and to diversify operations. For example if System1 fails at least one virtual machine hosted on System2 may be available to continue processing tasks previously processed on System1 .

Each of the one or more networks referenced above may include but are not limited to for example a wide area network WAN a local area network LAN a global network such as the Internet a telephone network such as a public switch telephone network a wireless communication network a cellular network an intranet or the like or any combination thereof. Also each network may be used so that components of the present disclosure may be in communication with one another. In exemplary embodiments of the present disclosure a network may include one or any number of the exemplary types of networks mentioned above operating as a stand alone network or in cooperation with each other. Use of the term network herein is not intended to limit the network to a single network.

Referring now to there is shown an exemplary method for scheduling backup operations in accordance with an embodiment of the present disclosure. In step a virtual machine may be assigned to a backup manager . The assignment may occur after the virtual machine has been instantiated by a hypervisor and or virtual machines may be assigned to a backup manager according to another process. For example all virtual machines instantiated on System1 may be assigned to a first backup manager e.g. .

In step a priority may be assigned to the virtual machine . The priority may indicate the relative importance of the process for which the virtual machine was instantiated. Priority may be assigned to the virtual machine before the virtual machine is assigned to a backup manager so that step may occur before step .

In step the backup manager may monitor the performance of the virtual machine including for example processor memory network requirements up time relative weight disk usage and or available system capacity and may store such performance information as metadata associated with the virtual machine . Step may also be performed before a priority is assigned to the virtual machine in step .

In step a backup window is specified. The backup window may be a period of time during a day a week a month or a year in which backups may take place. An operator may define the backup window or the backup window may be calculated based on for example idle times of the virtual machines and or systems and .

In step the backup manager may create a potential backup time for the virtual machine . The backup time may be the time at which the backup may occur with reduced downtime effect. For example a backup time may take into account periods of inactivity or low activity of the virtual machine or the backup time may take into account periods of inactivity or low activity of the systems and .

In step the backup manager may create a backup schedule for one or more of the virtual machines . For example the backup manager may create a backup schedule for all of the virtual machines instantiated on the systems and or may create a backup schedule for all of the virtual machines assigned to the backup manager . The backup manager may create the backup schedule by taking into account for example the specified backup window historical statistics of the one or more virtual machines the priority of the virtual machines the backup times created in step up time relative weight disk usage and or available system capacity. To create the backup schedule the backup manager may create a union of the historical data of the virtual machines . The backup manager may use the union of historical data with the specified backup times to find one or more windows in which backups may occur. Highest priority virtual machines may be scheduled for backup first and then successively lower priority virtual machines may be scheduled. The backup manager may also use the estimated backup time to calculate which virtual machines may be backed up during a window. The backup manager may also move backup times of virtual machines in order to accommodate unanticipated activity by a virtual machine the creation of one or more new virtual machines or the movement of virtual machines from one system to another system.

In step the backup manager may initiate the backup of the virtual machine according to the backup schedule.

Referring now to there is shown exemplary historical data of three virtual machines in accordance with an embodiment of the present disclosure. Processor usage data for an exemplary section of a week is shown including 12 AM through 5 AM on a Monday 9 PM through midnight on Monday 12 AM through 5 AM on a Tuesday and 9 PM through midnight on Tuesday. The numbers recorded at each of the hour markers indicates the percentage of processor availability that each virtual machine required over the aggregated hour. Information may be recorded and displayed at other granularities. For example information regarding processor requirements for each virtual machine may be recorded and stored at each second or each minute or other aggregation. The backup manager may have recorded the data shown in from the last backup cycle of the virtual machines or may have aggregated the information from two or more backup cycles.

The three exemplary virtual machines are shown in as VM1 VM2 and VM3. VM1 has been assigned a priority of 1 VM2 has been assigned a priority of 5 and VM3 has been assigned a priority of 6. In this exemplary embodiment a higher priority number is granted higher priority so VM3 has the highest priority of the three virtual machines and VM1 has the lowest priority. Priority may be assigned by an operator or priority may be assigned to the one or more virtual machines by the system the backup manager or another system on the network.

In the example shown in VM1 with a priority of 1 may utilize one percent of the available processor resources between 12 AM and 5 AM and may utilize 20 percent at 8 PM 25 percent at 9 PM 80 percent at 10 PM and 90 percent at 11 PM. VM1 may not utilize any of the available processor resources on Tuesday. VM2 with a priority of 5 may utilize 20 percent of the available processor resources between 1 AM and 5 AM on Monday and between 1 AM and 5 AM on Tuesday. VM2 may not utilize the available processor resources at other times on Monday or Tuesday. VM3 with a priority of 6 may utilize 90 percent of the available processor resources at 12 AM on Monday 5 percent at 1 AM and 90 percent at 2 AM and may not utilize the processor resources at other times on Monday and Tuesday.

One or more backup windows may be specified. The backup windows may be a time in which backups take place. The backup windows may be specified by an operator or may be automatically selected according to the relative usages of the virtual machines . In this example backup windows may correspond to Monday between 12 AM and 5 AM and between 9 PM on Monday and 5 AM the following Tuesday.

The optimal backup window found from the example in may be the window of time from 12 AM to 5 AM on Tuesday. The highest priority virtual machine in this instance VM3 may be scheduled for backup during that time. 9 PM to 11 PM on Monday a smaller portion of the 9 PM to midnight backup window specified may be the second best backup window in this example and 3 AM to 5 AM a smaller portion of the 12 AM to 5 AM backup window specified may be the third best backup window. The backup manager may attempt to create a backup schedule in which all three of the virtual machines are backed up during the best backup window using the calculated estimated backup times for each of the virtual machines. If the backup for VM3 does not allow for the backup of VM2 to complete by the end of the best backup window the backup manager may schedule VM2 s backup during the second best window. Similarly if VM1 cannot complete within the second best backup window after the completion of the backup for VM2 then the backup manager may select VM1 for backup during the third best backup window.

At this point it should be noted that the systems and methods in accordance with the present disclosure as described above typically involves the processing of input data and the generation of output data to some extent. This input data processing and output data generation may be implemented in hardware or software. For example specific electronic components may be employed in a computerized system or similar or related circuitry for implementing the functions associated with a backup manager in accordance with the present disclosure as described above. Alternatively one or more processors operating in accordance with instructions may implement the functions associated with the backup manager in accordance with the present disclosure as described above. If such is the case it is within the scope of the present disclosure that such instructions may be stored on one or more processor readable media e.g. a magnetic disk or other storage medium or transmitted to one or more processors via one or more signals embodied in one or more carrier waves.

The present disclosure is not to be limited in scope by the specific embodiments described herein. Indeed other various embodiments of and modifications to the present disclosure in addition to those described herein will be apparent to those of ordinary skill in the art from the foregoing description and accompanying drawings. Thus such other embodiments and modifications are intended to fall within the scope of the present disclosure. Further although the present disclosure has been described herein in the context of a particular implementation in a particular environment for a particular purpose those of ordinary skill in the art will recognize that its usefulness is not limited thereto and that the present disclosure may be beneficially implemented in any number of environments for any number of purposes. Accordingly the claims set forth below should be construed in view of the full breadth and spirit of the present disclosure as described herein.

