---

title: Method and system for automated annotation of persons in video content
abstract: Methods and systems for automated annotation of persons in video content are disclosed. In one embodiment, a method of identifying faces in a video includes the stages of: generating face tracks from input video streams; selecting key face images for each face track; clustering the face tracks to generate face clusters; creating face models from the face clusters; and correlating face models with a face model database. In another embodiment, a system for identifying faces in a video includes a face model database having face entries with face models and corresponding names, and a video face identifier module. In yet another embodiment, the system for identifying faces in a video can also have a face model generator.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08213689&OS=08213689&RS=08213689
owner: Google Inc.
number: 08213689
owner_city: Mountain View
owner_country: US
publication_date: 20080714
---
The Internet hosts vast amounts of content of different types including text images and video. Leveraging this content requires that the content is searchable and organized. Images are generally searched and organized based on tags that are manually assigned by users. Similarly video content is generally searched and organized based on tags that are manually assigned.

However it is impractical to maintain consistency when manually assigning tags to the large amounts of video content available on the Internet. For example each video may be of substantial length and may include many persons appearing in different parts of the video. The video may vary according to pose expression illumination occlusion and quality. It would require a substantial amount of manual effort to accurately tag the video with the name of each person appearing in the video. The manual approach of tagging content is not scalable to the large amount of content available on the internet.

Current approaches to general object recognition include using an image search engine to find images relevant to a given query and then learn relevant models for various objects that are then used for object detection recognition in images and in video. However these approaches do not address the substantial variations that can be presented by the face of a single person in a large data set and cannot robustly recognize a face belonging to the same person but having substantial variation due to aspects including age makeup expression light conditions etc. Other approaches automatically extract discriminant coordinates for faces and apply a clustering step to estimate likely labels using news archives. However clustering directly based on discriminant coordinates for faces does not address issues of noise occurring in sequences of images.

Therefore what are needed are methods and systems to automatically annotate video content based on faces of persons appearing in the video.

In one embodiment a computer implemented method that identifies faces in a video includes the stages of generating one or more face tracks from an input video stream selecting key face images for each of the one or more face tracks clustering the face tracks to generate face clusters where each face cluster is associated with one or more key face images creating face models from the face clusters and correlating face models with a face model database.

In another embodiment a system for identifying faces in a video includes the components a face model database having face entries with face models and corresponding names and a video face identifier module. The video face identifier module can include a face detection module that detects faces in an input video stream a face tracking module that tracks detected faces and generates face tracks an intra track face clustering module an inter track face clustering module a detected face model generator module and a model comparison module that compares detected face models with face entries in a database.

In yet another embodiment a system for identifying faces in a video includes a face model generator having as components a name generating module that generates a name list an image searching module that locates images corresponding to the name list a face detection module a face model generation module a collection module that pair wise stores the one or more face models and the corresponding names and a consistency learning module. In addition to the detected face model and name pairs the collection module may also store face model and name pairs derived from user input.

Further features and advantages of the present invention as well as the structure and operation of various embodiments thereof are described in detail below with reference to the accompanying drawings. It is noted that the invention is not limited to the specific embodiments described herein. Such embodiments are presented herein for illustrative purposes only. Additional embodiments will be apparent to persons skilled in the relevant art s based on the teachings contained herein.

While the present invention is described herein with reference to illustrative embodiments for particular applications it should be understood that the invention is not limited thereto. Those skilled in the art with access to the teachings herein will recognize additional modifications applications and embodiments within the scope thereof and additional fields in which the invention would be of significant utility.

Increasingly larger collections of video are becoming available with the proliferation of content spurred by the widespread availability of video recording devices and the connectivity offered by the Internet. Through the use of interconnected networks and shared video collections at any instant a single user may have access to large collection of video content on various subjects authored by persons spread throughout the world. To leverage the information contained in these large collections it is necessary that the collections are structured in a manner that facilitates searching. A system that can automatically annotate these large collections of video with information such as for example names of persons appearing in the video would be useful. The methods and systems in this disclosure make use of large text and image corpora available for example on the Internet to automatically associate names and faces with minimal manual intervention and then to derive a set of face models used for robust recognition of faces in video content. The derived set of models can be used for automatic recognition and annotation of video content to make the video content more searchable. Models may be developed for example for celebrities or other popular people for whom there is sufficient information available to make an association.

Video processor module can also access a video corpus an image corpus and a text corpus . Some or all of corpora and may be accessible through a network such as for example a wide area network WAN like the Internet or a local area network LAN or may be located locally on a user s own system. Corpora and may each include one or more corpora that are co located or distributed. In some embodiments corpora and may be co located in part or in whole. Video processor module may be coupled to network through any connection including for example and without limitation a PCI bus Ethernet and a wireless communication standard. Video corpus may include video clips of any length and in any video format including for example and without limitation any Moving Picture Experts Group MPEG standard audio video interleave standard AVI QuickTime and Windows Media Video WMV . The video clips include videos having one or more persons. Image corpus may include images in any image format such as JPEG TIFF and PNG. Image corpus includes images of persons. Text corpus includes for example text archives accessible locally and or over the Internet. Available text archives may include for example and without limitation ASCII text PDF text and other forms of text.

Video processor module is also coupled to a database of face models and a database of annotated video over connections . Database of face models includes face models generated by the video processor module based at least partly on images available in the image corpus . Such generation of face models will be further described with respect to below. Database may include one or more face models for each person represented. It may also include additional information such as names or other tags attached to the person or facial images of the person. Database of annotated video includes video primarily from video corpus annotated during the processing in video processor module . As used in this disclosure database refers to any collection of data elements and associated storage and access mechanisms. Connections may use one or more connection methods such as for example a PCI bus Ethernet and wireless communications standards.

Video processor module can include several components including a face model generator module a video face recognition module a video annotator module a model updater module and a query module . Video processor module and some or all of the sub modules and may be implemented in software hardware or any combination thereof. For example model generator module may be implemented as executable code on a central processor unit not shown in . In another embodiment model generator module may be implemented in a hardware component such as a Field Programmable Gate Array. A person skilled in the art would understand that video processor module may be implemented in one or more platforms.

Face model generator module may build models of faces that are selected from images in image corpus and video corpus . Module may also determine a set of people whose facial images are to be modeled. For example in an embodiment text corpus is analyzed to derive a list of most popular persons and locate one or more images of the faces of each of them. A news archive may be a combined text corpus and image corpus and an analysis of the frequency of occurrence of person names in the news archive can generate a list of most frequently occurring names. Many of the most frequently occurring names may be associated with an image having the face of the named person in one or more news articles and can therefore be used as a starting point to get models of the facial images of those named people. Face models derived from these and other matched images from image corpus and video corpus can then be stored in database of face models .

Video face recognition module uses face models including face models from database of face models to detect and recognize faces from video corpus . Recognition of faces in video streams is explained in more detail with respect to and below. As faces are detected and recognized in the video streams of video corpus module together with video annotator module can annotate the video with information known about the person whose face is being recognized. For example names and tags in database associated with a corresponding image may be used for the annotation. The annotated video or part thereof can then be stored in database of annotated video .

In some embodiments of the present invention a model updater module can be used to update face models in database based on new additions to the image corpus and video corpus . It may also update face models in database by adding faces that are recognized by video face recognition module . Updating available face models in database according to an increasing number of images may increase the reliability of face recognition for persons having multiple images covering a range of postures lighting conditions etc. Also in some embodiments a query module may be used for leveraging the video information in annotated video database . For example query module may collaborate with external modules to search for a set of video clips or parts of video clips that include an appearance of a specified person and make those video clips available for access by the external modules. In this manner for example a standard browser search for a specific person can be enhanced to present video tracks having at least one appearance of the specified person.

Returning to face model database contains one or more face models per person that is included in the database. The use of multiple models in face recognition increases the accuracy of the system. Multiple face models can represent different appearances of the same person different light conditions different environments etc. A very large variation in facial expressions facial accessories age light conditions etc. can be expected for the face of the same person in a large collection of image and video content. Associated with each face model and or each group of face models for the same person can be one or more tags including the person s name.

In components of video face recognition module are shown according to an embodiment of the present invention. Video face detector module detects faces in an incoming video. After detector module detects a face a face tracker module tracks that face in the incoming video stream. Face tracker module can create one or more tracks for each face that is detected by module and then tracked by module . An intra track clustering module then processes the generated tracks to create face clusters based on each track. For example if the face of a single person undergoes substantial variations in appearance due to facial expressions facial accessories such as sunglasses different light conditions etc. then multiple face models may be required to capture the face accurately because of its many variations even in the duration of the single track. Intra track clustering module collects one or more facial images for each face that is tracked in each video track according to the level of variation detected in a particular face. An inter track clustering module creates clusters using the intra track clusters of facial images. Inter track clustering module can combine similar clusters from separate tracks to create one set of face image clusters for each person detected in the video.

Taking as input the facial image clusters generated by inter track clustering module a video face model generator module generates face models corresponding to the selected one or more images for each person. The new face models that are generated can be stored in for example database of face models . For example having multiple face models encompassing a variety of expressions lighting conditions etc. generally makes it easier to reliably detect the occurrence of a face in a video or image corpus. A model comparison module takes the newly generated face models and may determine whether it would be beneficial to store the additional models. Module matches the newly generated face models to one or more models stored in database and thereby associates the newly generated face models with one or more tags stored in database including possibly a person s name. Having associated a newly detected face with information previously stored in database module may facilitate an annotation module to annotate the video track or segment with data such as the name of the associated person and or other information contained in the tags. The annotated video may be stored in a database of annotated video . As new face models are added to database of facial models verification and filtering algorithms such as for example consistency learning algorithms can be used to create or update face models.

In stage image corpus is searched to gather multiple images associated with each of the names in the name list. As stated earlier embodiments of the present invention may operate with fully or partially integrated text and image corpora. For example image captions or articles in which images are embedded can be used to obtain a substantially unambiguous association between a name and an associated image. In embodiments of the present invention an association can be assumed between a name and an image such as the association of a name appearing frequently in a news article with an image appearing in the same article. Loose associations between a name and an image such as in the above described news article for example can in general be considered weak and noisy text image correlation data. As the size of the corresponding text corpus increases relative to the size of the image corpus it becomes more difficult to reliably correlate a name to an image. However the size and diversity of text and image corpora such as what is accessible on the Internet allows the use of these weak and noisy associations as initial estimates of facial image to name associations.

In stage face detection is performed for each image found in stage . Methods of face detection in images are well known in the art. Where an image yields only one detected face the association between the detected face and the corresponding name may be unambiguous. When an image yields multiple detected faces in some embodiments of the present invention an association may be assumed between the corresponding name and each detected face. The resolution of the associations to a single person can be left to for example stage . In some embodiments images having more than a predetermined number of detected faces may be excluded from being used for purposes of this invention. In some embodiments methods such as correlating the most prominent facial image with the most frequently occurring name in the corresponding document may be used. A person of skill in the art will understand that there are multiple ways in which to form a loose initial association between a name appearing in a text sample and a corresponding image. In one embodiment of the present invention a user may provide one or more images including the face of a person and a corresponding name or text label. These user provided image and name pairs may also be added to the face database for further processing.

For each face that is detected in stage one or more feature vectors are generated in stage . Feature vectors describe specific properties of a detected face such that comparison of two facial images is possible using the corresponding feature vectors. Methods of generating feature vectors for a facial image are known in the art. For example searching of image corpora for named persons and processing the images that are found is described in U.S. Patent Application Publication No. 2008 0130960 titled Identifying Images Using Face Recognition which is hereby incorporated by reference in its entirety.

In stage the feature vectors are stored in association with the corresponding person name. For example feature vectors and corresponding name pairs including other associated tag information can be stored in a database such as database of facial images . illustrates an example of an entry in database of facial images in one embodiment of the present invention. For a particular person A all feature vectors representing the facial images of the person may be associated with text labels or tags including the name associated with that person A. A person skilled in the art will understand that other forms of storing the data are possible.

In stage feature vectors for a specific person are processed to reduce to a set of face models and or feature sets that can reliably be considered as belonging to that specific person. The number of face models retained for each person is variable and primarily depends on the variation in conditions of the images such as facial expressions age facial accessories lighting conditions etc. In some embodiments of the present invention a bagging technique such as consistency learning is applied to distil a suitable set of face models for each represented person. Consistency learning is described in detail in U.S. patent application Ser. No. 11 840 139 titled Graph Based Sampling which is hereby incorporated by reference in its entirety.

In some embodiments of the present invention face detection and face tracking are used alternately and periodically for each detected face. Periodically performing face detection guided by the face tracking process helps reduce the computational load because face detection in general is computationally more intensive than face tracking. To improve the reliability of face tracking some embodiments of the present invention can use facial feature based tracking where a selected set of features from the feature set of each facial image is tracked. Facial feature based tracking can reliably determine whether a face can be tracked.

When it is determined in step that the current video frame is not a shot boundary then stage decides whether to perform face detection on the video frame. The use of face tracking is contemplated to reduce the computational load that can be caused by implementing face detection on each frame. Facial feature based tracking systems can efficiently determine whether tracking can be continued on each frame. When the decision in stage is to use face detection then face detection is initiated in stage . If a face is detected in stage it must then be determined in stage whether the detected face is currently being tracked. If the face detected in stage is being currently tracked then in stage an attempt is made to reactivate an existing corresponding tracker. If it is determined in stage that an existing tracker cannot be reactivated then a new tracker is created and activated in stage . If the face detection fails in stage then an attempt is made to use the existing trackers in stage . In stage it is determined whether existing trackers are available to be used in stage . Each existing tracker that fails in stage is terminated in stage .

If in stage it is determined that no face detection is necessary for the current video frame then an attempt is made to reactivate each of the existing face trackers in stage . If it is determined in stage that the tracker activation fails further checks are implemented in stage to determine whether the tracker can be detected. Trackers that cannot be detected in stage are terminated in stage . Otherwise for those trackers that can still be detected in stage new trackers are created and activated in stage . The result received in stage for each input video frame can be recorded or stored for further processing.

Returning to the video having been subjected to face detection and tracking a set of representative facial images is selected for each track in stage . After face detection and tracking in stage the faces may be represented by face tracks where each track is a sequence of faces of in an embodiment the same person in consecutive video frames. In considering widely available video corpora such as what is accessible in the Internet it is often the case that the quality of the video is poor. The selection of key face images in each video track in stage can substantially reduce the effects of the lower quality videos that are included in video corpus . A clustering based algorithm for example hierarchical clustering and or k means clustering can be used in selecting the set of key face images within a video track. To separate the face into clusters the distance between two images may be used. The distance between two facial images can be based on selected local Gabor features extracted from facial feature points.

After clustering each cluster will include different faces of the same person according to pose occlusion and quality. To reduce the noise in some embodiments of the present invention clusters having less than a predetermined number of facial images may be discarded. In another embodiment clusters or facial images having non frontal facial images can be discarded because recognition based on non frontal faces is less reliable.

The same person can appear several times in a single video. In stage inter track clustering is implemented so that tracks having images of the same person can be considered together. In clustering tracks the distance measure can be based on the similarity of the key faces in each track which were chosen in stage . For example the distance between two clusters can be defined by the maximum similarity between a key face of a first track and a key face from the second track. A hierarchical clustering algorithm can also be used in this stage for clustering the tracks. After the intra track clusters are clustered into inter track clusters further processing may be done to the set of key face images in each inter track cluster so that unnecessary or duplicate images are discarded.

Next processing stage implements face recognition on each one of the clusters created in stage . In an embodiment of the present invention a combination of a majority voting algorithm and a probabilistic voting algorithm can be used for selecting the identity of each facial image. In a majority voting algorithm the identity within the cluster that occurs most frequently is chosen. In a probabilistic voting algorithm the confidence of the identity association is also taken into account. Therefore in a probabilistic voting algorithm the identity having the strongest confidence score is selected. In one embodiment of the present invention this may be accomplished by introducing a straw person that represents some person who does not have corresponding images in the set of face models under consideration. For example consider each key face f where the set of key faces of a cluster of face tracks is f f . . . f that is recognized by the k nearest neighbor algorithm as person p f with confidence c f . Then for each person in all recognized persons p p f the number of times the key faces are recognized as pis N p i.e. 

where p f p is an indicator function that is 1 when the two arguments match and 0 otherwise. The average recognition confidence of pis p i.e. 

The identity with the maximum N p and p can be recognized as the identity of this cluster of tracks if those parameters reach above a predetermined threshold. If the predetermined threshold is not reached then the identity of the cluster is unknown.

Subsequent to identifying a person s face in stage the associations derived previously for the corresponding face or faces can be used to annotate the video. For example database of face models may associate with each stored model a person s name and or other information that can be used for annotating the newly processed video segment. A module such as for example video annotation module can cooperate with video face recognition module to provide annotation.

The annotated video for example the video stored in database of annotated video can be used to provide additional information in query responses. For example in one embodiment of the present invention a search for a person by name can retrieve links to particular segments of the video in which the person appears or an indication of a time of appearance in a full video. In another embodiment the stored information can be used to provide thumbnail images to accompany links provided in search responses. For example query module can cooperate with an external search application by providing matching image clips or video clips corresponding to an identified person relevant to a search query.

It is to be appreciated that the Detailed Description section and not the Summary and Abstract sections is intended to be used to interpret the claims. The Summary and Abstract sections may set forth one or more but not all exemplary embodiments of the present invention as contemplated by the inventor s and thus are not intended to limit the present invention and the appended claims in any way.

The present invention has been described above with the aid of functional building blocks illustrating the implementation of specified functions and relationships thereof. The boundaries of these functional building blocks have been arbitrarily defined herein for the convenience of the description. Alternate boundaries can be defined so long as the specified functions and relationships thereof are appropriately performed.

The foregoing description of the specific embodiments will so fully reveal the general nature of the invention that others can by applying knowledge within the skill of the art readily modify and or adapt for various applications such specific embodiments without undue experimentation without departing from the general concept of the present invention. Therefore such adaptations and modifications are intended to be within the meaning and range of equivalents of the disclosed embodiments based on the teaching and guidance presented herein. It is to be understood that the phraseology or terminology herein is for the purpose of description and not of limitation such that the terminology or phraseology of the present specification is to be interpreted by the skilled artisan in light of the teachings and guidance.

The breadth and scope of the present invention should not be limited by any of the above described exemplary embodiments but should be defined only in accordance with the following claims and their equivalents.

