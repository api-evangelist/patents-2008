---

title: Method for analyzing a network environment
abstract: A method for analyzing a network environment, is provided. First acquiring a plurality of connection data of all network cards of a terminal device is performed. Then, according to connection data, determining whether or not a terminal device uses a PPPoE connection to connect to a network system. Finally, determining whether or not an IP address of the terminal device is a public IP address and determining whether or not the terminal device uses DHCP to acquire a target IP address.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07643432&OS=07643432&RS=07643432
owner: Vivotek Inc.
number: 07643432
owner_city: Taipei County
owner_country: TW
publication_date: 20080325
---
The present invention relates to a method for analyzing a network environment and setting up of a network device and more particularly relates to a method which analyzes a network configuration of a terminal device to determine the corresponding network structure.

Currently the use of network cameras is becoming increasingly widespread which has led to network cameras gradually becoming part of our daily life and more and more users are using network cameras. However the first step for the user to use a network camera is installing the network camera. Typical hardware infrastructure for installing a network camera involves coupling the network camera to a sharing device and coupling the sharing device to a personal computer. Under the installation procedure of the prior art the user needs to have a thorough understanding of the corresponding network environment to complete the process. In general network environments can be separated into four types direct dial up network access public IP address direct fixed connection network access fixed public IP address using a sharing device to access the network floating LAN IP address and use a sharing device to access the network fixed LAN IP address . The user must accurately set up the network parameters of the network camera according to the network environment where the camera is located to enable the network function to be operated normally. If the network camera is installed to a sharing device or other device provided with Network Address Transfer NAT functionality then after installation the user must also open the corresponding connection ports of the NAT device to enable a client to connect and access the network camera from the external networks.

However unfortunately the general user usually does not have the adequate background knowledge of networks. Hence for the general user setting up network parameters is an extremely distressing process because the general user is not aware of what network structure is before him. Thus when there is a need to install a network camera especially when it is required that a user can remotely connect to the network camera via an internal network or external network then the user needs to face succession of complicated network settings which frequently makes the user feel quite helpless.

In the prior art since the installation procedure is unable to automatically identify the network environment and complete the setting up of the network camera the setting procedure becomes too excessively complicated for the general user who does not have the background knowledge on networks to set up the system by himself.

In light of the above an objective of the present invention is to provide a method for analyzing a network environment which uses a terminal device to execute a software program and after the software program has analyzed the network structure then the network device is automatically set up thereby completing the installation procedure without the need for the user to carry out complicated procedures to set up the network.

In order to achieve the aforementioned and other objectives the present invention proposes the method for analyzing a network environment which is suitable for installation in a network device wherein a typical network infrastructure of the method of the present invention comprises a data set a terminal device a network device and a sharing device. The data set is coupled with a network system and the terminal device is provided with a target IP address while the sharing device is coupled to the data set the terminal device and the network device respectively.

 1 Executing a first analysis procedure by the terminal device to determine whether or not a Point to Point Protocol over Ethernet PPPoE connection is used to connect to a network 

 2 Executing a second analysis procedure by the terminal device to determine whether or not a IP address is a public IP address and

 3 Executing a third analysis procedure by the terminal device to determine whether or not the terminal device uses Dynamic Host Configuration Protocol DHCP to acquire a target IP address.

According to the analysis if the terminal device uses a PPPoE connection to connect to the network then the method of the present invention determined that the network structure is a first network structure. If the terminal device does not use a PPPoE connection to connect to the network and the target IP address of the terminal device is a public IP address and DHCP is used to acquire the target IP address then the method of the present invention determines that the network structure is a second network structure. If the terminal device does not use a PPPoE connection to connect to the network and the target IP address is a public IP address and DHCP is not used to acquire the target IP address then the method of the present invention determines that the network structure is a third network structure. If the terminal device does not use a PPPoE connection to connect to the network and the target IP address is not a public IP address and DHCP is used to acquire the target IP address then the method of the present invention determine that the network structure is a fourth network structure. If the terminal device does not use a PPPoE connection to connect to the network and the target IP address is not a public IP address and DHCP is not used to acquire the target IP address then the method of the present invention determine that the network structure is a fifth network structure. After the determination of the network structure the terminal device can automatically set up the network device accordingly.

According to the description of the preferred embodiments of the present invention the aforementioned network device can be a network camera or a network video server.

According to the description of the preferred embodiments of the present invention the aforementioned data set can be an ADSL modem or a cable modem.

According to the description of the preferred embodiments of the present invention the aforementioned sharing device can be a hub a switch or an IP router.

According to the description of the preferred embodiments of the present invention the aforementioned terminal device can be a personal computer.

According to the description of the preferred embodiments of the present invention after the software programs determine the corresponding network structure then the network device is set up according to the different network structures. In circumstances where it is determined that the network structure is the first network structure the second network structure or the fourth network structure then the terminal device sets up the network device to connect to the network system using the corresponding network structure. In circumstances where it is determined that the network structure is the third network structure or the fifth network structure then the network configuration of the terminal device is taken as the basis and a set of target network configurations are derived. The target network configurations comprise an unused IP address and the software programs set up the target network configuration in the network device. Moreover according to situation requirements the software programs set up the network device for corresponding DDNS and port forwarding functionality.

In conclusion the present invention provides methods for analyzing a network environment and setting up of a network device and it uses a terminal device that has already been successfully connected to a network to actively analyze the network environment where a network device is located and this invention offers a choice of five types of corresponding network structures thereby enabling the network device to be automatically set up according to the five different types of network structures.

The present invention overcomes the shortcomings of the prior art and eliminates the need for a user to set up network parameters himself. The installation procedure is extremely easy to implement for general users lacking the background knowledge of networks and enables the user to easily install a network camera.

To enable a further understanding of said objectives and the technological methods of the invention herein a brief description of the drawings is provided below followed by a detailed description of the preferred embodiments.

Referring to which shows a schematic view depicting a typical network infrastructure of a preferred embodiment according to the present invention wherein a typical network infrastructure comprises a network system a data set a sharing device a network device and a terminal device . The data set is coupled to the network system while the sharing device is coupled to the data set the network device and the terminal device . In the embodiment the data set is an Asymmetric Digital Subscriber Line ADSL modem or a cable modem. The network device is a network camera or a network video server. The sharing device is a hub a switch or an IP router. It is worth mentioning that the data set and the sharing device can be each an independent device or combine to be a single device comprising a data set function and a sharing device function. The terminal device is provided with a target IP address and the target IP address is the IP address of the terminal device . In order to analyze the network structure a plurality of connection data of all network cards of the terminal device must be obtained to enable determining whether or not the terminal device is connected to the network system using a PPPoE connection after which it is determined whether or not the target IP address of the terminal device is a public IP address and then it is determined whether or not the terminal device uses DHCP Dynamic Host Configuration Protocol to acquire the aforementioned target IP address.

In order to analyze a network structure an embodiment of the present invention differentiates the network structure into five situations. Referring to which shows a schematic view depicting a typical network environment of a first network structure of a preferred embodiment according to the present invention wherein a typical network environment of a first network structure comprises a network system a modem a hub or switch a network device and a terminal device . The hub or switch is coupled to the modem the network device and the terminal device . The terminal device is connected to the network system using a PPPoE connection via the modem enabling the terminal device to acquire a target IP address and the target IP address is a public IP address. Moreover the terminal device is provided with a PPPoE interface and a local area network interface.

Referring to which shows a schematic view depicting a typical network environment of a second network structure of a preferred embodiment according to the present invention wherein a typical network environment of a second network structure comprises a network system a modem a hub or switch a network device and a terminal device . The hub or switch is coupled to the modem the network device and the terminal device . The terminal device acquires a public IP address using DHCP via the modem in order to connect to the network system and the target IP address is a public IP address.

Referring to which shows a schematic view depicting a typical network environment of a third network structure of a preferred embodiment according to the present invention wherein a typical network environment of a third network structure comprises a network system a modem a hub or switch a network device and a terminal device . The hub or switch is coupled to the modem the network device and the terminal device . The terminal device is connected to the network system using a fixed public IP address. The target IP address is the aforementioned fixed public IP address.

Referring to which shows a schematic view depicting a typical network environment of a fourth network structure of a preferred embodiment according to the present invention wherein a typical network environment of a fourth network structure comprises a network system a modem an IP router a network device and a terminal device . The IP router is coupled to the modem the network device and the terminal device . The IP router is a sharing device and the IP router enables DHCP. The terminal device acquires a first LAN IP address using DHCP. The target IP address is the aforementioned first LAN IP address. The network device acquires a second LAN IP address using DHCP. The IP router is able to connect to the network system via the modem .

Referring to which shows a schematic view depicting a typical network environment of a fifth network structure of a preferred embodiment according to the present invention wherein a typical network environment of a fifth network structure comprises a network system a modem an IP router a network device and a terminal device . The IP router is coupled to the modem the terminal device and the network device . The IP router is a sharing device and the IP router is DHCP disabled. Under certain circumstances because the IP router is DHCP disabled thus the terminal device fails to acquire the first LAN IP address thus the user himself assigns a LAN IP address and only then can the terminal device connect to the network system . The aforementioned LAN IP address and the IP router belong to the same network domain and the IP router connects to the network system via the modem . Moreover the target IP address is the aforementioned assigned LAN IP address.

Referring to a flow chart depicts a preferred embodiment of a method for analysis of a network environment according to the present invention wherein in conjunction with the method for analysis of a network environment is suitable for installing a network device in which a terminal device executes software programs to implement the method of the present invention.

The method of the present invention comprises the following steps A terminal device executes a first analysis procedure to determine whether or not the terminal device is connected to a network using a PPPoE connection . If the terminal device is connected to the network using a PPPoE connection then the method of the present invention determines that the network structure is the first network structure .

If no the terminal device executes a second analysis procedure to determine whether or not the target IP address of the terminal device is a public IP address . If the target IP address is a public IP address then the terminal device executes a third analysis procedure to determine whether or not the terminal device uses DHCP to acquire the target IP address . Subsequently if the terminal device is not connected to the network using PPPoE the target IP address is a public IP address and the terminal device uses DHCP to acquire the target IP address then the method of the present invention determines that the network structure is the second network structure .

If the terminal device is not connected to the network using PPPoE the target IP address is a public IP address and the terminal device does not use DHCP to acquire the target IP address then the method of the present invention determines that the network structure is the third network structure .

Similar to the above if the target IP address is not a public IP address then the terminal device still executes the third analysis procedure to determine whether or not the terminal device uses DHCP to acquire the target IP address . If the terminal device does is not connected to the network using PPPoE the target IP address is not a public IP address and the terminal device uses DHCP to acquire a target IP address then the method of the present invention determines that the network structure is the fourth network structure . If the terminal device is not connected to the network using PPPoE the target IP address is not a public IP address and the terminal device does not use DHCP to acquire the target IP address then the method of the present invention determines that the network structure is the fifth network structure .

Referring to which shows a flow chart depicting the first analysis procedure of a preferred embodiment according to the present invention wherein the first analysis procedure comprises the following steps 

 1 The terminal device executes a first decision procedure to acquire a plurality of connection data of all network cards to determine whether or not the terminal device uses Point to Point Protocol PPP to connect to the network system 

 2 If it is determined that the terminal device uses PPP to connect to the network system then the terminal device executes a second decision procedure to acquire corresponding data of the PPP to accurately determine whether or not PPPoE is used to connect to the network system .

Under the Microsoft operating system a plurality of different Windows APIs Application Programming Interfaces can be called to execute the aforementioned first decision procedure and the second decision procedure. Moreover if it is determined that the terminal device does not use PPP to connect to the network system then it is determined that the terminal device uses Ethernet to connect to the network system. Furthermore if the method of the present invention determines that the terminal device does not use a PPPoE connection to connect to the network system then it is determined that the terminal device uses an Ethernet connection to connect to the network system.

If the terminal device simultaneously uses a PPPoE connection and an Ethernet connection then it represents that the terminal device simultaneously uses a plurality of network cards. Hence the method of the present invention must determine which of the network cards the terminal device uses to access the network for that the terminal device executes a third decision procedure . The third decision procedure comprises the following steps 

 1 The terminal device connects to a Public IP Report Server to find out which connected public IP address the terminal device uses to access the network 

 2 The method of the present invention determines whether or not the connected public IP address is different from the corresponding IP address of the PPPoE .

According to the above if the connected public IP address and the corresponding IP address of the PPPoE connection are the same then the third decision procedure determines that the terminal device uses a PPPoE connection to connect to the network system . If the connected public IP address and the corresponding IP address of the PPPoE connection are different then the third decision procedure determines that the terminal device uses an Ethernet connection to connect to the network system .

Referring to which shows a flow chart depicting a preferred embodiment of a method for analysis of a network environment according to the present invention wherein in conjunction with the method for analysis of a network environment comprises the following steps Using the method for analysis of a network structure of if the corresponding network is the first network structure then the terminal device requests that the user input an account number and password for the PPPoE connection and the account number and password are transmitted to the network device . The network device is set up to connect the network system using a PPPoE connection after which the terminal device requests that the user inputs Dynamic Domain Name Service DDNS registration data and the registration data is then registered with a DDNS server . The network device then reboots to complete the set up .

If the corresponding network is the second network structure then the method of the present invention sets up the network device to connect to the network system using DHCP . The terminal device requests that the user inputs DDNS registration data and the registration data is registered with a DDNS server . The network device then reboots to complete the set up .

If the corresponding network is the third network structure then the network configuration of the terminal device is taken as the basis and a new target network configuration is derived from it. The new target network configuration and the network configuration of the terminal device belong to the same network domain wherein the target network configuration comprises an unused public IP address . Subsequently the target network configuration is set up in the network device after which the terminal device asks whether or not the user wants to set up DDNS . If the user wants to set up a DDNS then the terminal device requests that the user inputs DDNS registration data and the registration data is registered with the DDNS server then the network device reboots to complete the set up . If the user does not need to set up a DDNS then the network device reboots to complete the set up .

If the corresponding network is the fourth network structure then the method of the present invention sets up the network device to connect to the network system using DHCP after which the terminal device requests that the user inputs DDNS registration data and the registration data is registered with the DDNS server then the network device reboots to complete the set up .

If the corresponding network is the fifth network structure then the network configuration of the terminal device is taken as the basis and a new target network configuration is derived. The new target network configuration and the network configuration of the terminal device belong to the same network domain wherein the target network configuration comprises an unused public IP address . Subsequently the target network configuration is set up in the network device after which the terminal device requests that the user inputs DDNS registration data and the registration data is registered with the DDNS server then the network device reboots to complete the set up .

Referring to which shows a flow chart depicting another preferred embodiment of a method for analysis of a network environment according to the present invention wherein in conjunction with a method for analysis of a network environment comprises the following steps 

 1 In the event the network environment is determined to be the fourth network structure or the fifth network structure since the network device is installed after a device with NAT function thus a port forwarding function must be executed to enable user to access the network device from external network 

 2 If the corresponding network is the fourth network structure or the fifth network structure then the terminal device analyzes the NAT device to determine whether or not it supports a Universal Plug and Play UPnP port forwarding function 

 3 If the NAT device supports the function then a support state is confirmed after which the UPnP port forwarding function is executed . If the NAT device does not support the function then the terminal device displays a message that the NAT device does not support the UPnP port forwarding function .

It is of course to be understood that the embodiments described herein are merely illustrative of the principles of the invention and that a wide variety of modifications thereto may be effected by persons skilled in the art without departing from the spirit and scope of the invention as set forth in the following claims.

