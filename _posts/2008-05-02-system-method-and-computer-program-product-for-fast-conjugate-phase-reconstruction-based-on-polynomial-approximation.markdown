---

title: System, method and computer program product for fast conjugate phase reconstruction based on polynomial approximation
abstract: A fast conjugate phase reconstruction method for MRI is based on a polynomial expansion of the off-resonance phase accrual term. The expansion is truncated and can be a Taylor or Chebyshev expansion.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08094907&OS=08094907&RS=08094907
owner: University of Virginia
number: 08094907
owner_city: Charlottesville
owner_country: US
publication_date: 20080502
---
The present application claims the benefit of U.S. Provisional Application Nos. 60 927 462 filed May 3 2007 60 930 882 filed May 18 2007 and 60 989 178 filed Nov. 20 2007 whose disclosures are hereby incorporated by reference in their entireties into the present application.

The work leading up to the present invention was supported by NIH Grant No. HL079110. The government has certain rights in the invention.

The present invention is directed to phase reconstruction in imaging and more particularly to conjugate phase reconstruction based on a polynomial e.g. Taylor or Chebyshev approximation of the off resonance phase accrual term.

Off resonance effects are common in magnetic resonance imaging MRI . In contrast to Cartesian acquisitions where off resonance effects usually cause only geometrical distortion and intensity variations off resonance effects can cause unacceptable image degradation in non Cartesian acquisitions. In particular uncorrected off resonance causes space variant image blurring in spiral k space scanning This issue has been long recognized and is one of the most challenging problems in non Cartesian MRI.

Off resonance effects in MRI can arise from various sources. The off resonance from chemical shift usually can be addressed by presaturation RF pulses or spectral spatial excitation. Another source of off resonance effects is B0 field inhomogeneity including susceptibility induced field inhomogeneity and main field inhomogeneity. Off resonance effects can also come from concomitant gradient fields. The combination of a static main field and linear gradients as applied in MRI do not satisfy Maxwell s equations of electrodynamics. As a result additional magnetic field terms known as concomitant gradients arise. When the off resonance phase from B0 field inhomogeneity and concomitant gradients are both present correction of only one of them is insufficient and sometimes can even increase blurring artifacts in some parts of the image.

Field inhomogeneity commonly exists in MRI and becomes more significant at high field strength. Field inhomogeneity causes geometrical distortion and intensity variations for acquisition using Cartesian trajectories. For acquisition using non Cartesian trajectories such as spiral or radial trajectories field inhomogeneity causes image blurring artifacts which can impair the diagnostic value of the images.

Since both B0 field inhomogeneity and concomitant gradient fields vary slowly in space we would expect that conjugate phase CP reconstruction can afford effective simultaneous correction of both off resonance effects. However direct calculation of CP reconstruction is very time consuming. Fast alternatives to CP reconstruction with comparable accuracy have been developed including time approximation methods frequency approximation methods and polynomial approximation methods. Each of these methods was originally developed for B0 field inhomogeneity correction. King et al King K F Ganin A Zhou X J Bernstein M A. Concomitant gradient field effects in spiral scans. 1999 41 103 112 discussed how to extend fast CP methods for concomitant field correction in spiral imaging. No literature to date has discussed in detail simultaneous B0 inhomogeneity and concomitant field correction in non Cartesian MRI.

Conjugate phase reconstruction and its fast approximations are widely used methods of compensating for field inhomogeneity effects. Ignoring T2 relaxation conjugate phase reconstruction can be expressed as exp 2 1 where s t k t r and w t are the time signal k space trajectory field inhomogeneity and the density compensation accounting for the non uniformity of the data sampling in k space respectively. Direct computation of Eq. 1 is time consuming. Fast approximations include time segmented reconstruction frequency segmented reconstruction and mutlifrequency interpolation. All of these methods reduce the computation cost of conjugate phase reconstruction by employing different approximations for the off resonance phase accrual term exp j r t . However a technique offering both accuracy and computational efficiency is still needed.

To achieve the above and other objects the present invention is directed to conjugate phase reconstruction based on a polynomial approximation e.g. Taylor or Chebyshev of the off resonance phase accrual term.

In at least some embodiments the present invention implements a new fast conjugate phase reconstruction method based on a polynomial expansion of the off resonance phase accrual term. This algorithm achieves high approximation accuracy and can be performed rapidly with the developed computational strategies. The aspects of the present invention method and algorithm may be implemented as a computer method system computer system and computer program product. Further the aforementioned present invention method system computer method computer system and computer program product may be implemented with MRI systems MRI subsystems and various types of computer processors and computer related systems and components.

In one of the preferred embodiments we introduce a new fast alternative to CP reconstruction where the off resonance phase term is approximated by its Chebyshev polynomials. Compared to similar ideas discussed in the past that embodiment is more computationally efficient and is well suited for simultaneous B0 inhomogeneity and concomitant field correction. We apply the technique to deblurring images acquired using spiral scanning. We also demonstrate that the proposed method is efficient for combined semi automatic inhomogeneity correction and concomitant field correction. Semi automatic correction is accurate even with an inaccurate or low resolution field map.

B0 field inhomogeneity and concomitant gradient fields can cause image degradation in non Cartesian MRI. We propose an efficient algorithm for simultaneous B0 inhomogeneity and concomitant field correction in non Cartesian MRI. Our algorithm is a fast alternative to CP reconstruction with the off resonance phase term approximated by Chebyshev polynomials. Conventional B0 map acquisition can be inaccurate in some applications. We demonstrated that the proposed algorithms can be employed for combined semi automatic correction and concomitant field correction to address this problem.

The algorithms are computationally efficient. The interpolation coefficients are object independent and can be precalculated and used for any sequence with a given trajectory. Since the number of base images required is proportional to the off resonance frequency range linear concomitant field correction is incorporated to reduce the computational cost. Incorporation of linear B0 inhomogeneity correction is also desirable in many applications to reduce computational cost when the B0 inhomogeneity is not highly non linear. To reduce the number of gridding operations we also interchange the sequence of gridding operation and multiplication of modified sampling time when calculating base images.

During our experiments we found that automatic off resonance correction and semi automatic off resonance correction can sometimes achieve comparable results to combined B0 inhomogeneity and concomitant field correction when the concomitant gradient field is mild or moderate. The rationale behind this is that in automatic or semi automatic correction the off resonance phase r r t is approximated as a spatially dependent angular off resonance frequency times t which is equivalent to approximating tas t where is a constant. This approximation is reasonable for the spiral gradients designed in our sequences because the latter part of the spiral gradients has constant magnitude. Consequently automatic correction and semi automatic correction can achieve modest simultaneous B0 inhomogeneity correction and concomitant field correction even without explicitly including a concomitant field term. We constrained the searching range of off resonance frequency within 50 Hz from the acquired B0 map when performing semi automatic correction on acquired data sets. A least square fit of t to tfrom our spiral gradient indicates that 50 Hz B0 off resonance frequency corresponds to about 100 Hz searching range of concomitant field off resonance frequency. This is sufficient for a moderate concomitant field especially after incorporating linear concomitant field correction. A larger searching range can be employed in semi automatic correction to accommodate a stronger concomitant gradient field. Automatic off resonance correction does not have this issue since the searching range is not constrained by the B0 field map.

We focused on fast CP reconstruction in the preferred embodiments. The idea of approximating a phase term by a Chebyshev or other polynomial can be applied to other image reconstruction methods where off resonance phase is a concern such as SPHERE and off resonance correction based on iterative reconstruction.

We only discussed the concomitant gradient field arising from spiral gradients in this paper. Since arbitrary time varying phase terms can be approximated by Chebyshev or other polynomials the present invention should be able to address the concomitant gradient field from a more general readout gradient. The present invention is also likely capable of addressing other time varying phase terms such as those induced by eddy current effects.

Preferred embodiments of the invention will be set forth in detail with reference to the drawings in which like reference numerals refer to like elements or steps throughout.

The preferred embodiments use polynomial expansions of the off resonance phase accrual term namely . . . t 2 

The expansions are converging infinite series however the approximations terminate the series at some point as disclosed below.

The first preferred embodiment replaces the phase term with its Taylor expansion which can be expressed as follows 

where m r are referred to as base images. The base images can be reconstructed by replacing the time signal s t with its multiplication by tfollowed by conventional gridding reconstruction. The direct calculation of the base images requires performing gridding individually for each of them which is computationally inefficient. In our implementation as shown in we perform gridding on the time signal s t to acquire a Cartesian time signal and also interpolate the time t onto a Cartesian grid using Delaunay triangulation to form a Cartesian time mask. To compute the base images we then simply multiply the Cartesian time signal by the time mask n times and then perform a Fourier transform. Since the time mask is only a function of the k space trajectory and sampling period it can be computed off line if the k space trajectory and sampling period do not change during the scan.

The number of base images required is proportional to the off resonance phase accrual r t which can be reduced by incorporating center frequency or linear off resonance correction into the algorithm since the bulk center linear terms are subtracted from r in the phase term. Equation 3 now can be written as 

where umlaut over r is the residual off resonance after subtracting the center linear off resonance frequency from r s t is the signal demodulated by the center off resonance frequency and W t and k t are the updated density compensation function and the warped k space trajectory respectively with the linear off resonance correction incorporated.

We compared the accuracy of different fast conjugate phase reconstruction methods by simulation studies. The simulation was conducted at two different off resonance frequency ranges 60 Hz and 100 Hz. The sampling duration was 16.4 ms in each case. At individual off resonance frequencies with 2 Hz increment within the off resonance frequency range and at each sampling time point with sampling period 2 microseconds we calculated the difference between the exact phase term exp j r t and the approximated value from the fast conjugate phase reconstruction methods. The logarithm of the sum of the absolute value of these differences was plotted against the number of base images segments employed in the fast conjugate phase reconstructions in . More specifically show semi log plots of the approximation error vertical axis as a function of the number of base images segments used horizontal axis . The off resonance range is 60 Hz and 100 Hz . The sampling time duration is 16.4 ms.

The simulation studies indicated that the first preferred embodiment solid lines in usually requires more base images than the other fast conjugate phase reconstruction methods when the off resonance phase accrual is relatively large. This problem is mitigated at small off resonance phase accrual. An advantage of the first preferred embodiment indicated by the simulation is that it can ultimately achieve better approximation accuracy than all the other existing methods.

The first preferred embodiment usually needs more base images than the other fast conjugate phase reconstruction methods when the off resonance phase accrual is large. This problem is mitigated by incorporating center frequency or linear off resonance correction to reduce the off resonance phase accrual. The Taylor expansion can be performed around non zero time points. Performing Taylor expansion around a non zero time point likely can further reduce the number of base images required. T2 T2 decay was ignored in this study. The first preferred embodiment can also be applied to simultaneously compensate T2 T2 decay and off resonance effect.

A second preferred embodiment uses a Chebyshev expansion rather than a Taylor expansion. As is well known a function can be expanded into a Chebyshev expansion in the following manner 

In the second preferred embodiment the off resonance phase accrual term is approximated by a finite series of Chebyshev polynomials 

As with the Taylor approximation in the Chebyshev approximation N is the number of base images used in the approximation.

The preferred embodiments will now be compared. is a plot of the magnitude of the error as a function of time for 60 Hz. Both the Taylor and the Chebyshev approximations use five base images. shows the same thing except that for the Taylor approximation 15 base images are used. In both cases the Chebyshev approximation gives better accuracy.

A variation of the second preferred embodiment uses the Chebyshev approximation to handle the off resonance effects. Considering the presence of both Bfield inhomogeneity and concomitant gradient fields and ignoring relaxation the MR signal from an object with spin density m r is given by exp 2 9 

where r represents the angular off resonance frequency of Bfield inhomogeneity and r t represents the off resonance phase due to concomitant field.

For spiral scanning King et al cited above gave an approximation of the off resonance phase from the lowest order concomitant field for arbitrary scan plane orientation as follows t 11 

where B g t and gare the static field the amplitude of the readout gradient and the maximum amplitude of the readout gradient respectively. Fto Fare calculated from the rotation matrix used to rotate from the logical to the physical coordinate system. X and Y are the in plane coordinates of the logical coordinate system and Z is the through plane coordinate of the logical coordinate system. The calculation of Fto Fis given in the appendix in King et al.

When the off resonance varies smoothly in space CP reconstruction is an effective method of off resonance correction for various non Cartesian acquisition methods. CP reconstruction corresponding to Eq. 9 can be expressed as exp 2 14 

where W t is the density compensation function which accounts for non uniform sampling in k space in non Cartesian acquisition. W t can be calculated from geometric arguments as the Jacobian of the coordinate transformation or by numerical methods. Noll et al Noll D C Fessler J A Sutton B P. Conjugate phase MRI reconstruction with spatially variant sample density correction 2005 24 325 336 discussed the implementation of a spatially varying density compensation function in CP reconstruction.

CP reconstruction is computationally inefficient. Fast alternatives including time approximation methods frequency approximation methods and polynomial approximation methods have been developed. These methods essentially approximate the off resonance phase term in different ways to reduce the computational cost of CP reconstruction and consequently possess different features. Each of these methods was originally developed to correct for B0 field inhomogeneity. Fast CP reconstruction in the presence of both B0 field inhomogeneity and concomitant gradient fields has increased numerical complexity and has not been previously described to our knowledge. Extending the time approximation and frequency approximation methods to produce a combined correction would likely increase computation significantly. As we show below it is possible to design a particular polynomial approximation that leads to fast and accurate correction for both B0 inhomogeneity and concomitant gradient fields.

Fast conjugate phase reconstruction based on the Chebyshev approximation will now be discussed. Schomberg Schomberg H Off Resonance Correction of MR Images. 1999 18 481 495 has previously discussed Chebyshev approximation in CP reconstruction for the purpose of Bfield inhomogeneity correction. In his algorithm the off resonance phase term is approximated by a Chebyshev polynomial that is a function of the product of Bfield inhomogeneity and time. One drawback of Schomberg s algorithm is that the calculation of Chebyshev coefficients becomes object dependent since the field map is involved in the Chebyshev polynomial variable. Another problem associated with Schomberg s algorithm is that it can not be applied for simultaneous B0 field inhomogeneity correction and concomitant gradient field correction.

To address these problems we propose a fast CP reconstruction algorithm where the off resonance phase term is approximated by a Chebyshev polynomial in time t. The proposed fast CP reconstruction algorithm can be expressed as follows 

where is the readout length I r are base images and w r r are constant coefficients whose values depend on the Bfield inhomogeneity the concomitant gradient field and the readout length. The mathematical derivation of Eq. 15 is given in Appendix A below. Two forms of Eq. 15 including Eq. A5 and Eq. A10 are derived. Our experiments on spiral data sets indicate that these two formulas lead to equivalent off resonance correction results. The present embodiment can also be easily modified for B0 field inhomogeneity correction or concomitant field correction when only one off resonance source is present.

The coefficients w r r can be calculated offline and saved as a table at a range of r and r . The table is object independent and the same table can be used for any data set acquired with same readout length. The table is three dimensional and the length of each dimension corresponds to the number of bins of r the number of bins of r and the number of base images respectively.

Equation 15 involves reconstruction of the time signal s t multiplied by tl 0 1 2 . . . followed by a fast reconstruction method such as gridding. To reduce the computational cost as explained above with reference to we perform gridding on the time signal s t to calculate raw data on a Cartesian grid and also interpolate the time t onto a Cartesian grid using Delaunay triangulation to form a Cartesian time mask. To compute the base images we then simply multiply the Cartesian time signal by the time mask multiple times and then perform a Fourier transform. This strategy reduces the number of gridding operations performed during image reconstruction. Since the time mask is only a function of the k space trajectory it can also be calculated offline and used for data sets acquired with same k space trajectory.

The number of base images needed in Eq. 15 is proportional to the range of B0 field inhomogeneity and concomitant gradient field. Center frequency correction can be incorporated into Eq. 15 to reduce the range of B0 field inhomogeneity. When the B0 field map is not highly non linear incorporation of linear off resonance correction into Eq. 15 is desirable to further reduce the computational cost. To reduce the range of concomitant gradient field we incorporate linear concomitant gradient correction into Eq. 15 . For a given scan plane orientation linear concomitant gradient correction reduces the frequency range of an off center slice to that of a slice at isocenter. The derivation of this is given Appendix B below.

The combination of semi automatic off resonance correction and concomitant gradient field correction will now be disclosed. CP reconstruction requires knowledge of accurate off resonance maps. The off resonance map from concomitant gradient fields can be calculated from theory. For B0 inhomogeneity correction a field map is usually acquired by two single shot spirals at different echo times. Such field map acquisitions however can be inaccurate in many applications and residual errors can appear in images. Recently we proposed a method termed semi automatic off resonance correction Chen W Meyer C H Semiautomatic off resonance correction in spiral imaging. 2008 May 59 5 1212 9. to address this problem. In semi automatic off resonance correction the acquired map is used to provide a frequency constraint for following automatic off resonance correction rather than directly for CP reconstructions.

The computational strategy developed in semi automatic correction requires calculating the value of individual pixels at an arbitrary constant frequency without reconstructing the whole image at that frequency. Multifrequency interpolation was employed previously for this purpose. Note that the proposed fast CP reconstruction method also has this property. Therefore the proposed CP reconstruction based on Chebyshev approximation is well suited for combined semi automatic off resonance correction and concomitant field correction. To perform combined semi automatic correction and concomitant field correction we reconstruct a series of images as follows 

where umlaut over r is the frequency constraint estimated from an acquired low resolution B0 field map and i 1 2 . . . is a series of constant frequency shifts from umlaut over r . Note that concomitant field effects are corrected when reconstructing m r in Eq. 16 . After reconstructing m r semi automatic correction is then performed for B0 field inhomogeneity correction.

We tested our algorithm on both phantom and in vivo data sets collected by spiral scanning on a Siemens 1.5 T Avanto scanner Siemens Medical Solutions . We performed the following correction methods and compared the results 1 concomitant field correction using the proposed method 2 field map based B0 field inhomogeneity correction using fast CP reconstruction 3 semi automatic off resonance correction 4 combined field map based B0 field inhomogeneity correction and concomitant field correction combined correction A and 5 combined semi automatic B0 field inhomogeneity correction and concomitant field correction combined correction B . For semi automatic correction and combined correction B the following parameters are used for the semi automatic portion of the image reconstruction the size of summation window was 15 15 the power of the objective function was 1 the searching range of the off resonance frequency shift was from 50 Hz to 50 Hz the increment of searching frequencies was 10 Hz and the first 1.6 ms of the readout was used to reconstruct the low resolution images after concomitant gradient field correction whose phase was then removed from corresponding high resolution images before objective function calculation. The value of each of these parameters was the same as those specified in our above cited 2008 paper. To account for trajectory errors due to gradient delay and eddy current effects modified k space trajectories based on methods described by Tan et al Tan H Meyer C H K space trajectory estimation in spiral imaging. Proc. ISMRM 15th Annual Meeting Berlin 2007 981 were used for image reconstruction.

A 3 D table of interpolation coefficients was precalculated for the present embodiment and used for each of the data sets acquired with the same readout length. The 3 D table was calculated with B0 field inhomogeneity from 100 Hz to 100 Hz with a 1 Hz frequency increment concomitant field off resonance frequency

We performed combined correction based on Eq. A5 and Eq. A10 on the data sets we acquired and found the results were equivalent. show the results for a coronal scan of a resolution phantom. The parameters of the spiral sequence are as follows 14 interleaves with 8192 samples and 2 microseconds ADC dwell time per interleaf 5 mm slice thickness and 512 by 512 reconstructed image matrix. A low resolution field map was acquired using two single shot spirals with 1 ms echo delay. The imaging slice was 6.4 cm off isocenter along the transverse direction 2.3 cm off isocenter along the sagittal direction and 1.4 cm off isocenter along the coronal direction. is the image with no off resonance correction. is the result after concomitant gradient correction. Note that there is significant deblurring of concomitant field effects at the bottom of the image but that the B0 blurring is still obvious at the top of the image. is the result after B0 inhomogeneity correction using fast CP reconstruction. Note that now the B0 blurring artifacts are removed but the concomitant field blurring is obvious. is the result after semi automatic off resonance correction. Note that semi automatic correction can provide both B0 inhomogeneity correction and moderate concomitant field correction but residual concomitant field blurring is still obvious. are combined correction A and B respectively. Both combined correction methods achieved simultaneous B0 inhomogeneity correction and concomitant field correction. Compared to shows better deblurring in regions indicated by the white arrows in indicating the inaccuracy of the acquired B0 field map in these regions.

and c r r are coefficients that depend on the strength of B0 field inhomogeneity r the strength r and readout length . c r r can be calculated as follows 29 

where bis the lcoefficient term for T t . Combining Eq. A1 Eq. A4 and Eq. 6 after mathematical rearrangement we have 

Eq. A5 A6 and A7 represent a direct implementation of Chebyshev approximation for fast CP reconstruction. A more computationally efficient implementation for fast CP reconstruction is to use the polynomial form of Chebyshev approximation. Note that by combining Eq. A1 and Eq. A4 and after mathematical simplification we have 

Eq. A10 is another approach for fast CP reconstruction based on Chebyshev approximation. Compared to Eq. A5 Eq. A10 is more computationally efficient since Eq. A5 involves an additional combination of images. We found both methods achieved equivalent results on the spiral data sets we acquired.

Assuming a fixed scan plan orientation Fthrough Fand Z are constant throughout the rest of this derivation. Adding an offset of A B C to the scan plane in the X Y and Z axes leads to B2 

Concomitant linear correction applies a linear fit to the concomitant field with a spatially constant fterm and gradients in the X and Y directions. The constant term is used to demodulate the raw data and the gradients to warp the k space trajectory. Mathematically umlaut over B5 exp 2 B6 

The linear fit will completely remove off resonance phase due to the 2and 3square brackets in B4 as those terms are either constant or linear in X or Y. The remaining terms in B4 given in B7 are identical to B1 . These terms in B7 which are all square and cross terms will be partially corrected by the linear fit principally by the center frequency term.

For a fixed scan plane orientation the linear concomitant correction completely removes any blurring due to phase resulting from off center terms the 2and 3square brackets in B4 . The residual blurring pattern is the same as that of an isocenter scan that has been linear corrected.

While preferred embodiments of the invention have been set forth above those skilled in the art who have reviewed the present disclosure will readily appreciate that other embodiments can be realized within the scope of the invention. For example numerical values are illustrative rather than limiting. Therefore the present invention should be construed as limited only by the appended claims.

