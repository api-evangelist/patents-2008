---

title: Optical transceiver using heterodyne detection and a transmitted reference clock
abstract: A heterodyne communication system uses coherent data modulation that is resistant to phase noise. In particular, a pilot tone and reference clock signal are transmitted along with the modulated data to form the basis of an electrical demodulation local oscillator at the receiver. The pilot tone and/or reference clock signal carry phase noise which is correlated with the phase noise in the data signal. At the receiver, the local oscillator is generated from the pilot tone and reference clock signal in a manner so that the local oscillator also has phase noise which is correlated with the phase noise in the data signal. Thus, the two noise components can be used to cancel each other during demodulation of the data signal using the local oscillator.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07620318&OS=07620318&RS=07620318
owner: 
number: 07620318
owner_city: 
owner_country: 
publication_date: 20080114
---
This application is a continuation of U.S. patent application Ser. No. 10 107 085 filed Mar. 25 2002 now U.S. Pat. No. 7 346 279 the entirety of which is incorporated herein by reference.

This invention relates generally to optical fiber communications and more particularly to a reduction in the effects of phase variations introduced by the optical carrier.

As the result of continuous advances in technology particularly in the area of networking there is an increasing demand for communications bandwidth. For example the growth of the Internet home office usage e commerce and other broadband services is creating an ever increasing demand for communications bandwidth. Upcoming widespread deployment of new bandwidth intensive services such as xDSL will only further intensify this demand. Moreover as data intensive applications proliferate and data rates for local area networks increase businesses will also demand higher speed connectivity to the wide area network WAN in order to support virtual private networks and high speed Internet access. Enterprises that currently access the WAN through T1 circuits will require DS 3 OC 3 or equivalent connections in the near future. As a result the networking infrastructure will be required to accommodate greatly increased traffic.

Optical fiber is a transmission medium that is well suited to meet this increasing demand. Optical fiber has an inherent bandwidth which is much greater than metal based conductors such as twisted pair or coaxial cable. There is a significant installed base of optical fibers and protocols such as SONET have been developed for the transmission of data over optical fibers. Typical communications systems based on optical fibers include a transmitter an optical fiber and a receiver.

The transmitter modulates the data converts the data into an optical form and transmits the resulting optical signal across the optical fiber to the receiver. In a common design the transmitter includes a laser source coupled to an external modulator. The laser source produces an optical carrier which is modulated with the data by an external modulator. This results in an optical data signal which carries the data to be transported across the optical fiber.

On the other end of the optical fiber the receiver recovers the original data from the optical data signal transported across the optical fiber. Recent advances in receiver technology are leading to more widespread adoption of receivers based on heterodyne detection. A heterodyne receiver typically includes a local laser source. The local laser source generates an optical local oscillator which is mixed with the incoming optical data signal as part of the heterodyne detection process.

To increase the efficiency of data transmission many fiber communications systems utilize a coherent modulation scheme before transmitting the data on the optical data signal. A coherent modulation scheme takes advantage of phase information in a data signal.

Coherent modulation schemes are used in modulating data onto a transmitted optical signal and demodulating a received signal to obtain the transmitted data. For coherent modulation an absolute phase reference is present at the transmitter and receiver to modulate and demodulated the transmitted signal respectively. The phase references at the transmitter and receiver are said to be phase coherent when they are locked in phase.

A coherent modulation scheme utilizes phase information in representing data in a signal. Relative phases errors in the absolute phase references generally results in errors in the transmitted data. Example coherent modulation schemes include Quadrature Amplitude Modulation QAM Phase Shift Keying PSK and Quadrature Phase Shift Keying QPSK .

An electrical signal generated by coherent modulation may be upshifted to an optical carrier to generate an optical signal employing coherent modulation. This optical signal can be generated using a laser source and an amplitude modulator e.g. an MZM to generate coherently modulated optical subcarriers. This approach in which coherent modulation originates in the electrical domain contrasts with direct coherent optical modulation in which optical signals comprising coherent modulation can be generated using a phase modulator to modulate the optical carrier directly.

Data transmitted using coherently modulated optical signals can be received using heterodyne detection. Heterodyne detection is a type of coherent optical detection or coherent detection that generally utilizes an optical source as a local oscillator to downshift a coherently modulated optical signal to an RF signal. The local oscillator is generally at a different center frequency than an optical carrier or subcarrier. Subsequently the RF signal is demodulated using a coherent local oscillator at an RF frequency. Data may also be coherently demodulated directly using homodyne detection in which the optical local oscillator is phase coherent with the transmitting laser.

One particular optical communication process utilizes coherent modulation including optical subcarrier multiplexing at the transmitter and heterodyne detection at the receiver. Throughout this process the data signal employing coherent modulation is converted from the electrical domain to the optical domain and then back to the electrical domain. The integrity of the data signal relies on the fidelity of the phase information in the data signal. At each step phase noise can be introduced into the signal. Significant sources of phase noise in a transmission system include the phase noise of the transmit laser source producing an optical carrier and the phase noise in the receive laser source producing the optical local oscillator. Other sources of phase noise include the transmit local oscillator generating the electrical signal and the receive local oscillator demodulating the received electrical signal.

Traditionally optical communication system s have addressed the problem of added phase noise by either using a phase stable laser or by designing complex phase locking circuits into the demodulator. However phase stable lasers are both bulky and expensive making them impractical for commercial applications. Complex phase locking circuits are likewise expensive and difficult to implement. Furthermore both solutions significantly raise the cost and complexity of the system.

Therefore there is a need for a fiber optic communications system which adequately deals with phase noise including laser phase noise without utilizing complex phase locking circuits or expensive lasers.

The present invention overcomes the limitations of the prior art by providing a heterodyne communication system using coherent data modulation that is resistant to phase noise including laser phase noise electrical phase noise and phase noise from other sources as well. In particular a pilot tone and reference clock signal are transmitted along with the modulated data to form the basis of an electrical demodulation local oscillator at the receiver end. The pilot tone carries phase noise that is correlated with the phase noise in the data signal. At the receiver the local oscillator is generated from the pilot tone and reference clock signal in a manner so that the local oscillator also has phase noise that is correlated with the phase noise in the data signal. Thus the two noise components can be used to cancel each other during demodulation of the data signal using the local oscillator.

In one implementation a transmitter subsystem includes a pilot tone generator a reference clock generator a signal generator and an optical modulator. The pilot tone generator generates a pilot tone at a pilot tone frequency. The reference clock generator generates a reference clock signal at a reference clock frequency. The signal generator combines the reference clock generator the pilot tone and a subcarrier channel into an information signal. The subcarrier channel includes a coherently modulated data stream located at a subcarrier frequency. In one implementation the data is modulated according to a QPSK modulation scheme. The optical modulator generates an optical signal containing the information signal. Preferably the pilot tone and subcarrier channel are derived from mutually coherent sources or from the same source.

In one embodiment the signal generator includes a incoherent reference signal modulator. The incoherent reference signal modulator modulates the pilot tone with the reference clock signal utilizing a incoherent modulation scheme e.g. AM modulation to protect the resulting reference signal from phase noise. Thus the optical signal contains the pilot tone modulated by the reference clock signal and also the subcarrier channel. In a preferred embodiment the pilot tone is modulated using AM modulation and square law detectors or filters recover the reference signal.

In another embodiment the pilot tone frequency subcarrier frequency and reference clock frequency are chosen such that the difference between the pilot tone frequency and the subcarrier frequency is a fractional multiple of the reference clock frequency. Preferably this fractional multiple is an integer multiple. In this way the pilot tone can be frequency shifted to the subcarrier frequency by adding or subtracting a multiple of the reference clock.

In another implementation the signal generator combines additional subcarrier channels into the information signal. Each of these additional subcarrier channels has a unique subcarrier frequency and is coherently modulated preferably by QPSK. Preferably each subcarrier frequency can be expressed as a multiple of the reference clock frequency plus the pilot tone frequency. The use of several unique subcarrier frequencies allow the frequency division multiplexing of several data signals while transmitting a single pilot tone and reference clock signal to guard against phase noise.

In another aspect of the invention a receiver subsystem includes a heterodyne detector an information signal splitter a local oscillator generator and a coherent demodulator. The heterodyne detector receives an optical signal and converts it into an electrical signal. The electrical signal includes a pilot tone a reference clock signal and a subcarrier channel. The information signal splitter divides the electrical signal into these individual components. The local oscillator generator generates an electrical local oscillator from the pilot tone and reference clock signal in a manner such that the local oscillator carries phase noise which is correlated with phase noise in the subcarrier channel. The coherent demodulator demodulates the subcarrier channel using the local oscillator canceling the phase noise in the two signals.

In one implementation the information signal splitter includes a data recovery section and a pilot tone recovery section. The data recovery section isolates the subcarrier channel. The pilot tone recovery section isolates the pilot tone. Each recovery section has a corresponding group delay and care is taken to match the two group delays so that ideally they are equal thus providing for cancellation of phase noise.

In another aspect of the invention the information signal splitter includes a clock recovery section. The clock recovery section isolates the reference clock signal. Preferably the reference clock signal is incoherently demodulated from the pilot tone in order to remove any phase noise from the reference clock signal.

In one implementation the local oscillator generator includes a frequency multiplier and a mixer. The frequency multiplier multiplies the reference clock frequency by a fractional factor. The mixer adds or subtracts the multiplied clock from the pilot tone frequency to form the local oscillator. Preferably the reference clock signal does not include any phase noise so that when added to the pilot tone the local oscillator has the same phase noise as the pilot tone and consequentially the same phase noise as the subcarrier channel.

In another embodiment the receiver subsystem includes additional local oscillator generators additional coherent demodulators and the information splitter includes additional data recovery paths. The information splitter recovers additional subcarrier channels located at unique subcarrier frequencies. The additional local oscillator generators generate additional local oscillators and the additional coherent demodulators demodulate the additional subcarrier channels with respect to the additional local oscillators. Preferably each local oscillator generator generates a local oscillator for each corresponding subcarrier channel and farther contains the same phase noise as the corresponding subcarrier channel.

In another aspect of the invention the coherent demodulator utilizes a QPSK demodulation scheme. The demodulator includes an I channel mixer a Q channel mixer two variable phase delays a Costas phase discriminator loop and a Quadrature Imbalance Compensated Phase Discriminator loop. The mixers mix the local oscillator and the subcarrier channel together to recover the I and Q channels of the data. The variable phase delays work to adjust the local oscillator to accurately recover the phase information for each channel. The Costas loop adjusts the relative phase between the local oscillator and the subcarrier channel while the Quadrature Imbalance Compensated Phase Discriminator adjusts the relative phase between the I and Q channels.

One advantage of the present invention is that it significantly reduces the effects of phase noise in a coherently modulated optical heterodyne communications system.

System operates as follows. Data stream typically is a digital data stream. In certain applications data stream may instead be analog. Signal formatter receives data stream and formats it into an information signal . An example of one embodiment of information signal can be seen in a frequency spectrum . Spectrum includes a subcarrier channel characterized by a subcarrier frequency f. The information carried in subcarrier channel corresponds to the information carried in data stream . Spectrum also includes a pilot tone located at a frequency fand two reference clock sidebands each offset from fby a reference clock frequency f. The term tone as used in this description is contemplated to indicate a continuous wave signal. Spectrum illustrates one possible arrangement of the elements of information signal . Other variations will be apparent to one skilled in the art.

Optical modulator receives information signal and modulates an optical carrier from optical source to generate an optical data signal . Optical data signal is characterized by an optical carrier frequency f. The frequency spectrum of one embodiment of optical data signal can be seen in a spectrum . Optical data signal includes an upper sideband U and a lower sideband not shown or transmitted in the preferred embodiment containing identical information. Further illustration will reference upper sideband U but the description is equally applicable to the lower sideband. Upper sideband U includes a subcarrier channel offset in frequency from fby an amount equivalent to f. Upper sideband U also includes a pilot tone and two reference clock sidebands . Pilot tone is located at a frequency equal to f f while reference clock sidebands maintain an offset of ffrom pilot tone . Spectrum illustrates only one possible arrangement of elements in optical data stream . Other arrangements will be apparent to one skilled in the art.

In more detail the optical source produces an optical carrier signal at the optical carrier frequency f. Many commercially practical implementations of optical source also introduce a significant amount of phase noise with the optical carrier signal which is generally characterized by a linewidth. The modulator receives the information signal and modulates the optical carrier with the information signal to generate optical data signal . illustrates a signal using single sideband modulation resulting in upper side band U however other types of modulation such as double sideband modulation may also be used. In the example of the modulator suppresses the optical carrier and does not produce a significant signal at the optical carrier frequency f. Transmitted pilot tone replaces the optical carrier signal as an aid to signal recovery within heterodyne detector . This arrangement allows the system to avoid transmitting the optical carrier signal thus reducing power handling requirements in fiber . Single sideband modulation also increase spectral efficiency and resistance to impairments such as chromatic dispersion by reducing nonlinear optical distortion.

In a preferred embodiment the modulator includes a Mach Zender modulator MZM . The conventional two arm MZM has a raised cosine transfer function. The MZM is based at one minimum point of the raised cosine transfer function. Operation at the minimum point suppresses the optical carrier and the result is an optical data signal that includes lower sideband not shown and upper sideband U but no optical carrier signal at f. The MZM further includes an optical filter to suppress the lower sideband.

In another approach a conventional two arm MZM is biased at a point close to but slightly offset from the minimum point of the raised cosine transfer function. The slight offset results in some carrier being introduced into the optical signal thus resulting in a spectrum with a reduced optical carrier. Other techniques for generating singe sideband modulation are discussed in K. Higuma et. al. EL37 No. 8 Apr. 12 2001 which is incorporated by reference in its entirety herein.

Returning to the optical data signal and the phase noise from optical source are transmitted over fiber to receiver . Current optical fibers have two spectral regions which are commonly used for communications the 1.3 and 1.55 micron regions. At a wavelength of 1.3 micron transmission of the optical signal is primarily limited by attenuation in the fiber . Dispersion is less of a factor. Conversely at a wavelength of 1.55 micron the optical signal will experience more dispersion but less attenuation. Hence the optical signal preferably has a wavelength either in the 1.3 micron region or the 1.55 micron region and for long distance communications systems the 1.55 micron region is generally preferred.

At receiver heterodyne detector receives the incoming optical data signal and also receives an optical local oscillator signal at a frequency ffrom optical LO source . In local oscillator signal is shown at a frequency fwhich is equal to the carrier frequency f. However the local oscillator signal may also be located at a frequency fwhich is higher or lower than the carrier frequency f. The optical signal and local oscillator signal are combined and heterodyne detection of the combined signal effectively downshifts optical signal from a carrier at frequency fto the original frequency space of information signal . The resulting electrical signal has spectrum . Note that upper sideband U has been recovered and frequency downshifted compared to optical signal . In the preferred embodiment sideband U includes a subcarrier channel a pilot tone and two reference clock sidebands . These elements correspond to the elements present in information signal . Electrical signal also contains the phase noise generated by optical source .

Signal extractor receives electrical signal from heterodyne detector and removes the formatting applied to data stream by signal formatter . Signal extractor then outputs a recovered data stream which carries the same information and format as data stream .

Signal formatter operates as follows. Data stream is received by data modulator . Data modulator includes a coherent modulator to modulate data stream into subcarrier channel which is characterized by a subcarrier frequency fprovided by subcarrier frequency generator . In one embodiment data modulator utilizes a QAM or QPSK modulation scheme but one skilled in the art will recognize that other coherent modulation schemes are equally applicable. Coherent modulation provides an advantage over other modulation techniques by better using available bandwidth through use of a signal s phase information. However a coherently modulated signal is susceptible to the phase noise generated by optical source as well as any phase error introduced into system . In order to keep system efficient the effects of phase noise and phase error should be reduced. As will become evident in the discussion below the present invention includes novel and advantageous ways of efficiently reducing the effects of phase noise and or phase error.

Returning to signal generator receives subcarrier channel from data modulator as well as a pilot tone at a frequency fand a reference clock signal at a frequency ffrom pilot tone generator and reference clock generator respectively. Pilot tone generator reference clock generator and subcarrier frequency generator are all conventionally implemented frequency generators and may consist phase locked oscillators and multipliers conventional crystal oscillators astable vibrator circuits digital signals or other suitable frequency generators. Signal generator combines the signals from data modulator pilot tone generator and reference clock generator to produce information signal .

As noted above spectrum illustrates just one arrangement of the signals into information signal . By adjusting the frequencies generated by subcarrier frequency generator pilot tone generator and reference clock generator different arrangements of the signals within information signal can be generated. Furthermore the pilot tone reference clock signal and subcarrier channel can be combined in different ways to generate different information signals .

In more detail reference signal modulator includes a non coherent modulator. Examples of non coherent modulation include AM modulation. As noted above phase noise can interfere with the coherent modulation scheme utilized in data modulator . Therefore it is desirable to find a way to cancel or de emphasize the effects of the phase noise on signal extractor . As will be shown below pilot tone and reference clock signal are used by signal extractor to help defeat the phase noise present at signal extractor . To aid in this process modulator utilizes an amplitude modulation scheme to modulate pilot tone with reference clock signal . One skilled in the art will recognize that other non coherent modulation schemes may also be used. By using an amplitude modulation scheme reference clock signal can be recovered by signal extractor without interference from the phase noise.

Signal extractor operates as follows. Electrical signal is received from heterodyne detector by electrical signal splitter . Electrical signal splitter generates three copies A B and C of electrical signal one for each recovery arm and . Data recovery arm isolates the subcarrier channel characterized by subcarrier frequency ffrom electrical signal copy C and outputs subcarrier channel along with the phase noise to demodulator . Tone recovery arm isolates the pilot tone frequency component from its electrical signal copy A and outputs a pilot tone component at frequency fand the phase noise to local oscillator generator . Reference clock recovery arm isolates the pilot tone and reference clock components from electrical signal copy B and outputs a reference clock signal at frequency fwithout phase noise to local oscillator generator . Local oscillator generator receives both pilot tone and reference clock and generates an electrical local oscillator at frequency f. In the preferred embodiment fis equal to f. This feature is particularly useful if fis equal to fin heterodyne detector so that electrical signal occupies the same frequency spaces as information signal . If fis not equal to f it would be necessary to adjust fto account for the incomplete downshifting of optical data signal at heterodyne detector . Such adjustments are known to those skilled in the art and are contemplated within the scope of this invention. Local oscillator has the same phase noise and group delay as subcarrier channel .

Specifically in signals A C the pilot tone and subcarrier channel carry correlated phase noise since they were generated and transmitted together in transmitter and heterodyne detected together in receiver . The phase noise in the pilot tone traverses a signal path through the tone recovery arm and local oscillator generator to reach demodulator . The phase noise in the subcarrier channel traverses a signal path through the data recovery arm to reach demodulator . These two signal paths are matched so that the phase noise experiences the same group delay. Thus when they arrive at demodulator they will still be correlated and can be canceled at demodulator .

Returning to the general operation of signal extractor local oscillator is output to demodulator . Demodulator demodulates subcarrier channel with respect to local oscillator and outputs recovered data stream . In a preferred embodiment f fat heterodyne detection when local oscillator has the same frequency fas subcarrier channel namely f the recovered data is completely downshifted to the original form of data stream . In embodiments utilizing a heterodyne detection where fdoes not equal f an adjusted local oscillator frequency fwill be necessary to completely downconvert recovered data stream .

Demodulator utilizes the same modulation scheme as used in signal formatter . In a preferred embodiment demodulator uses the same coherent demodulation scheme as data modulator . As noted in the discussion of data modulator coherent demodulation schemes are susceptible to phase noise introduced by optical source as well as any group delays within the signal recovery arms and . However if the local oscillator and data signal include the same phase noise and group delay then the phase distortions will cancel within demodulator allowing efficient recovery of recovered data signal . As noted above local oscillator generator and data recovery arm are designed to produce signals with correlated phase error and phase delay.

Tone recovery arm includes a band pass filter configured to isolate pilot tone from electrical signal A. Likewise data recovery arm includes a band pass filter configured to isolate subcarrier channel from electrical signal C. Both recovery arms preserve the phase noise introduced into optical data signal by optical source . While recovery arms and are illustrated as using band pass filters other methods for isolating the respective frequency components can be used.

Local oscillator generator operates as follows. Frequency multiplier receives reference clock signal at frequency f. Frequency multiplier generates a multiplied clock which is at a frequency which is a fractional multiple N of the frequency of the incoming reference clock . In other words the frequency of reference clock signal is increased from fto N F. In a preferred embodiment N is an integer factor. However any reproducible factor can be chosen. Local oscillator combiner combines pilot tone and multiplied clock to generate local oscillator having the same phase noise and group delay as subcarrier channel . In a preferred embodiment group delay matching is accomplished by ensuring that the signal paths are matched from separation to reconstruction.

In the embodiment shown in signal multiplier receives pilot tone and multiplied clock . These two signals are multiplied together to form a difference signal and a sum signal. The difference signal is located at a difference between the frequencies of the tone and multiplied clock . The sum signal is located at a sum of the frequencies of the tone and multiplied clock . Note that the phase noise present with pilot tone is preserved in both the sum signal and the difference signal since the reference clock signal and therefore also the multiplied clock signal does not have a phase noise component. Generally the phase noise comprises both optical and electrical phase noise. In DWDM systems the phase noise may further comprise cross phase modulation from other wavelengths carrying data signals as well as other phase noise arising from nonlinear optical coupling of two or more wavelength channels. The sum and difference signals are passed to band pass filter which isolates one of the two signals for output as local oscillator . In effect tone is either shifted up or down in frequency by multiplied clock to form local oscillator depending on whether fis higher or lower than f. The process for selecting N as well as for selecting f f and fwill be discussed below.

In more detail generation of the subcarrier pilot tone and reference clock and the selection of their corresponding are interrelated with the overall design goals of the system. A change in the pilot tone frequency ftypically will change the reference clock frequency fand or the subcarrier frequency f.

As noted above in the discussion of local oscillator combiner in one embodiment a general formula for the interrelationship between the frequencies is as follows. f f N f where N is some fraction and preferably an integer. In embodiments where the optical local oscillator of the heterodyne detector does not have the same frequency fas the optical carrier fgenerated by the optical source the combination of N f fshould be adjusted accordingly to account for the offset between fand f. The pilot tone is selected to be at a frequency fsuitable to form a base from which to generate local oscillator at the demodulator . Furthermore the pilot tone located at frequency fshould reside outside of a bandwidth defined by the subcarrier channel. The reference clock frequency and multiplied clock frequency are chosen to raise or lower the pilot tone so that the resulting local oscillator frequency fis equal to the subcarrier frequency f. Typically fis close in frequency to fwhile fis a much lower frequency.

This arrangement provides several advantages By having a smaller f when the pilot tone is modulated with the reference clock the resulting reference signal has a smaller bandwidth. This promotes efficiency in transmitting the optical data signal by allowing the pilot tone and reference clock sidebands to fit in the frequency spectrum closer to the subcarrier channel . Furthermore a small fincreases the scalability since several subcarrier frequencies can be used and several local oscillators can be matched to these subcarrier frequencies by simply changing the value of N for each subcarrier frequency. This particular embodiment will be discussed in more detail in conjunction with below.

Local oscillator is received by variable phase delay which selectively increases or decreases the phase of local oscillator . Variable phase delay outputs the phase delayed local oscillator to I mixer and to second variable phase delay . Second variable phase delay adds approximately 90 of phase to the phase delayed local oscillator and outputs the signal to Q mixer . Quad imbalance phase discriminator receives the output from both low pass filters . Quad imbalance phase discriminator is coupled to quad imbalance offset controller which in turn is coupled to variable phase delay . Similarly Costas loop phase discriminator receives the output from both low pass filters and is coupled to Costas offset controller which in turn is coupled to variable phase delay .

Demodulator operates as follows. Demodulator coherently demodulates subcarrier channel to produce an I channel and a Q channel of recovered data . In a preferred embodiment the modulation is QPSK. However other forms of modulation may also be used such as Quadrature Amplitude Modulation QAM Frequency Shift Keying FSK Amplitude Shift Keying ASK Phase Shift Keying PSK BiPhase Shift Keying BPSK and On Off Keying OOK . Generally in QPSK two data channels are modulated by subcarrier signals which have the same reference frequency but are 90 out of phase allowing the signals to be combined without significant interference for more efficient use of bandwidth. At the demodulation stage such as demodulator the combined signal is again mixed with the two 90 out of phase reference signals reproducing the original two data channels.

In a preferred embodiment subcarrier channel is input into Q mixer and I mixer . In mixers and subcarrier channel is mixed with two variants of local oscillator A and B to recover the Q and I channels respectively. As with most demodulation schemes the resultant signals from Q and I mixers contains a difference component and a sum component. Low pass filters filter the outputs of Q mixer and I mixer respectively to allow only the difference components to be output. By selecting the difference component phase noise is effectively cancelled.

Local oscillator is received into the demodulator by variable phase delay . Variable phase delay selectively adjusts the phase on local oscillator to generate B and passes the signal B to I mixer via second variable phase delay . While depicted in as an external local oscillator signal coupled to the variable phase delay local oscillator B may more generally be generated directly by an oscillator . One such oscillator would be a voltage controlled oscillator VCO which receives the output of the Costas Offset Controller as control input. Second variable phase delay is a typical component in any basic QPSK demodulator. Second variable phase delay typically adds approximately an additional 90 of phase to local oscillator B but may selectively adjust the amount of phase added to local oscillator B to produce A which is used by Q mixer to demodulate the Q channel from subcarrier channel .

Variable phase delays and operate as follows. Variable phase delay adjusts the phase of local oscillator to match the phase of subcarrier channel . To control this adjustment demodulator uses Costas loop phase discriminator . Costas loop phase discriminator generates an error signal from sampling the I and Q channels from the output of low pass filters and . Error signal is calculated based on the quantity where I and Q are outputs of the quadrature demodulator and the operator indicates a time average and indicates a Signum function. The error signal is a measure of the phase offset between the local oscillator phase and the phase of the incoming signal. Costas loop offset controller uses error signal to control variable phase delay . The goal of Costas loop offset controller is to adjust the phase so that error signal is driven to zero.

Variable phase delay adjusts the phase of local oscillator B to match the amount of phase difference between the I and Q channels. As noted above in ideal conditions the I and Q channels are modulated 90 out of phase. Ideally 90 of phase should be added by second variable phase delay to efficiently recover the I and Q channels. However operating conditions may exist where the I and Q channels may be more or less than 90 out of phase. Variable phase delay effectively fine tunes the phase shifting to match operating conditions. To control this adjustment demodulator uses quad imbalance phase discriminator . Quad imbalance phase discriminator generates an error signal from sampling the I and Q channels from the output of low pass filters and . Error signal is calculated based on the quantity . This error signal measures quadrature imbalance i.e. the extent to which phase offset between I and Q differs from 2. Quad imbalance offset controller uses error signal to control variable phase delay . The goal of quad imbalance offset controller is to adjust the relative phase enough so that error signal is driven to zero.

On the transmit side communication system includes a plurality of data modulators A D a plurality of corresponding subcarrier frequency generators A D a signal combiner an optical modulator an optical source and an optical fiber . On the receive side communication system includes a heterodyne detector an optical local oscillator generator a signal power splitter a tone recovery arm a clock recovery arm a plurality of data recovery arms A D a plurality of corresponding local oscillator generators A D and corresponding demodulators A D.

Modulators A D each receive a unique subcarrier frequency from subcarrier frequency generators A D. Modulators A D are coupled to signal combiner which in turn is coupled to optical modulator . Optical modulator also receives an optical carrier from optical source and is coupled to optical fiber . Heterodyne detector receives input from fiber and optical local oscillator and outputs to signal power splitter . Signal power splitter outputs to tone recovery arm clock recovery arm and data recovery arms A D. Tone recovery arm and clock recovery arm are coupled to each of the local oscillator generators A D. Data recovery arms A D and local oscillator generators A D are pairwise matched and coupled to their respective demodulators A D.

Communication system operates as follows. Each individual part operates as discussed above. For ease of recognition similar numbers have been used where appropriate. Furthermore elements unique to a single data channel have been designated with an A D suffix. Elements having the same suffix work together to provide a single data channel. Generally modulators A D each operate to modulate a separate data stream not shown onto a unique subcarrier frequency fprovided by subcarrier frequency generators A D respectively. The outputs from modulators A D represent a plurality of data channels A D.

Reference signal modulator operates as discussed with respect to . Reference signal modulator modulates a pilot tone from pilot tone generator with a reference clock from reference clock generator to form reference signal . Data channels A D and reference signal are combined by signal combiner to form a single frequency multiplexed information signal . Information signal has a plurality of subcarrier channels A D each corresponding to a data channel A D. Information signal further includes a pilot tone and a pair of reference clock sidebands corresponding to reference signal . Information signal is received by optical modulator which optical transmits information signal as an optical signal on an optical carrier provided by optical source over fiber and is received by heterodyne detector .

Using optical local oscillator heterodyne detector receives and converts optical signal into an electrical signal . Electrical signal is split into a plurality of identical signals by signal power splitter . Tone recovery arm clock recovery arm and data recovery arms A D each receive a split signal. Tone recovery arm recovers the pilot tone. Clock recovery arm recovers the reference clock. Each data recovery arm A D isolates its designated subcarrier channel A D. Tone recovery arm and clock recovery arm provide input to each local oscillator generators A D.

As in the single channel embodiment local oscillator generators A D multiply the reference clock signal by N and mix it with the pilot tone signal to generate a fequal to f. In communication system however each local oscillator A D has a unique N to facilitate using the same clock signal and pilot tone signal to generate unique local oscillators matching their respective subcarrier frequencies generated by subcarrier frequency generators A D. In terms of the formulas noted above in the discussion of the Nis chosen such that f N f f fwhere x designates one of the data channels A D. Demodulators A D may be identical in operation and construction. Demodulators A D receive the unique local oscillators from local oscillator generators A D and their corresponding subcarrier channels from data recovery arms A D and demodulate the subcarrier channels with respect to local oscillators A D to recover the original data channels.

Although the invention has been described in considerable detail with reference to certain embodiments thereof other embodiments are possible. Therefore the scope of appended claims should not be limited to the description of the preferred embodiments contained herein.

