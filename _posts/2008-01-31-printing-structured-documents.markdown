---

title: Printing structured documents
abstract: Print objects () are captured. In the process of capturing each of the print objects () a user input gesture () over a region of a document () being rendered on a display () in accordance with a structured object specification () of the document () is received; an element of the structured object specification () being rendered within an active area of the user input gesture () on the display () is identified; the user input gesture () is interpreted as a print content designation command; and the print object () is derived from the structured object specification () in accordance with the identified element of the structured object specification () and the print content designation command. A print layout () of the print objects () on one or more pages () is determined. The print layout () is outputted.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09529438&OS=09529438&RS=09529438
owner: Hewlett-Packard Development Company, L.P.
number: 09529438
owner_city: Houston
owner_country: US
publication_date: 20080131
---
This application relates to the following copending application which is incorporated herein by reference U.S. application Ser. No. 11 769 671 filed Jun. 27 2007.

A document is a set of information that is designed and presented as an individual entity and is recorded or stored in a physical storage medium e.g. an electronic memory device or a print medium such as paper . A structured document is formed of displayable elements e.g. text images audio and video whose presentations are related to one another. The elements typically are related to one another in terms of their layout and relative location within the document. Document elements may be formed from lower level elements. For example texts typically are formed from words sentences and paragraphs. Images typically are formed from different layers e.g. foreground and background and different areas. Audio and video typically are formed from temporally and hierarchically arranged units and sequences of audio and video content respectively.

The logical structure or semantics of a structured document can be described using a markup language such as the standard generated markup language SGML the extensible markup language XML and a hypertext markup language HTML . A markup language description of a document typically includes a set of tags that delimit and label discrete elements of the document. In XML for example a tag is a keyword that identifies the beginning and ending points of its associated element. Markup language tags typically have a distinct syntax that distinguishes them from the elements that they surround. The tag syntax allows a parser to recognize the tag. A structured document can be presented by any tool e.g. a web browser that is capable of interpreting the markup language description of the document. In some cases one or more style sheets e.g. cascading style sheets CSS can be attached to the logical structure of the document to produce different respective presentations.

In many cases a structured document presentation that is designed for one application environment is not suitable or at least not optimized for another application environment. For example web pages typically are ill formatted for printing. As a result users typically consume more resources e.g. ink and paper than needed when they print entire web pages that contain contents such as advertisements headers footers center column and large margin design features which are not of interest to the users.

In one aspect the invention features a method in accordance with which print objects are captured. In the process of capturing each of the print objects a user input gesture over a region of a document being rendered on a display in accordance with a structured object specification of the document is received an element of the structured object specification being rendered within an active area of the user input gesture on the display is identified the user input gesture is interpreted as a print content designation command and the print object is derived from the structured object specification in accordance with the identified element of the structured object specification and the print content designation command. A print layout of the print objects on one or more pages is determined. The print layout is outputted.

The invention also features apparatus and a machine readable medium storing machine readable instructions causing a machine to implement the method described above.

Other features and advantages of the invention will become apparent from the following description including the drawings and the claims.

In the following description like reference numbers are used to identify like elements. Furthermore the drawings are intended to illustrate major features of exemplary embodiments in a diagrammatic manner. The drawings are not intended to depict every feature of actual embodiments nor relative dimensions of the depicted elements and are not drawn to scale.

The embodiments that are described in detail herein are capable of enabling a user to specify individual elements of structured documents that they would like to print. In this way these embodiments reduce unnecessary consumption of resources such as paper and ink. In addition some of these embodiments are capable of aggregating contents from resources outside of a structured document based on user selection of hyperlink references in structured document. In some implementations this feature provides users with a convenient mechanism for aggregating content across different web pages and different web sites.

As used herein the term document means a set of information that is designed and presented as an individual entity and is recorded or stored in a physical storage medium e.g. an electronic memory device or a print medium such as paper . A structured document is a document that is formed of displayable elements i.e. a cohesive subset of the constituent information of a structured document e.g. text images audio and video whose presentations are related to one another spatially temporally or spatiotemporally. Spatially related elements typically are related to one another in terms of layout and relative location within the document. Document elements may be formed from lower level elements.

The term structured object specification means a description of the logical structure or semantics of a structured document. This information may be described using a markup language such as the standard generated markup language SGML the extensible markup language XML and a hypertext markup language HTML . In XML for example a structured document is described as a document object that contains a set of nested XML elements. A structured object specification may be presented through an application programming interface API . For example the Document Object Model DOM is a specification for an API that allows programs and scripts to access and modify the content structure and style of structured documents. The DOM represents structured documents in the form of a hierarchical tree of nodes which implement specialized interfaces. Each node has a DOM node type a node name and a node value. The DOM structures the document object and its constituent elements into multiple nodes of different types providing views of the document structure at different levels of detail.

The term print object refers broadly to any type of visually perceptible structured document content that may be rendered on a physical or virtual page including images and text. Image based print objects may be complete or partial versions of any type of digital or electronic image element of a structured document including an image that was captured by an image sensor e.g. a video camera a still image camera or an optical scanner or a processed e.g. filtered reformatted enhanced or otherwise modified version of such an image a computer generated bitmap or vector graphic image a textual image e.g. a bitmap image containing text and an iconographic image. The term print object encompasses both a single element print object and a multi element print object formed from a cohesive group or collection of one or more structured document elements. The assignment of multiple structured document elements to a single print object signifies that the constituent structured document elements are related. In general the type of structured document elements in a multi element print object may be the same or different.

The term user input gesture means a graphical input that is received from a user and may be interpreted as a command. The input may correspond to any type of graphical input e.g. an input generated by user manipulation of a stylus or a virtual pointer such as a computer mouse . In some embodiments the user input gesture corresponds to a freeform graphical shape which may be composed of a sequence of one or more strokes i.e. a sequence or set of captured points . In other embodiments the user input gesture corresponds to a constrained graphical shape e.g. a rectangular or curved boundary whose size or aspect ratio or both may be selected by the user.

The term print content designation command means a command that indicates whether an element of a structured document should be included in a print layout or excluded from a print layout.

The term page refers to any type of discrete area in which graphic objects may be laid out including a physical page embodied by a discrete physical medium e.g. a piece of paper on which a layout of graphic objects may be printed and a virtual digital or electronic page containing a layout of graphic objects that may be presented to a user by for example an electronic display device.

A computer is a machine that processes data according to machine readable instructions e.g. software that are stored on a machine readable medium either temporarily or permanently. A set of such instructions that performs a particular task is referred to as a program or software program.

The term machine readable medium refers to any medium capable carrying information that is readable by a machine e.g. a computer . Storage devices suitable for tangibly embodying these instructions and data include but are not limited to all forms of non volatile computer readable memory including for example semiconductor memory devices such as EPROM EEPROM and Flash memory devices magnetic disks such as internal hard disks and removable hard disks magneto optical disks DVD ROM RAM and CD ROM RAM.

A node is a junction or connection point in a network. Exemplary nodes include but not limited to a terminal a computer and a network switch.

The structured document may be any type of electronic document that is associated with a structured object specification that describes the structure of the document in a way that allows a parser or interpreter to separate the contents of the document from the structural description or markup . In some embodiments the structured object specification is in the form of an electronic file that describes or models the document using a markup language such as SGML XML and HTML. In the illustrated embodiment the structured document includes regions of various types of content e.g. image content regions such as a LOGO region an AD BANNER region and an image region that includes a set of four images A B C D a video clip region a mixed content region and a hyperlink reference region that includes a set of three hyperlink references whose layout and relative locations within the document constitute the structure of the document .

The structured document printing system generates a print layout of a set of elements of the structured document that a user has designated for printing. In addition the structured document printing system is capable of aggregating contents from resources outside the structured document based on user selection of hyperlink references in structured document. The structured document printing system enables the user to designate individual elements of the document that he or she would like to print using input gestures which in some cases may rather coarsely coincide with the actual rendering of the elements on the display . The structured document printing system interprets gestures that are input by the user based on an analysis of the structural description of the document that is provided by the structured object specification . In these ways the structured document printing system reduces unnecessary consumption of resources such as paper and ink while providing a quick efficient and convenient mechanism for the use to specify print content designation commands.

The structured document printing system may be implemented in any computing or processing environment including in digital electronic circuitry or in computer hardware firmware or software. In some embodiments the print object capture module and the print layout generator module are implemented by one or more respective software modules that are executed on a computer. Computer process instructions for implementing the structured document printing system and the data it generates typically are stored in one or more machine readable media.

In response to receipt of each user input gesture over a region of the document being rendered on the display the print object capture module initiates a process of capturing a print object block . In this process the print object capture module identifies an element of the structured object specification that is being rendered within an active area of the user input gesture on the display block . The print object capture module interprets the user input gesture as a print content designation command block . The print object capture module derives the print object from the structured object specification in accordance with the identified element of the structured object specification and the print content designation command block . The print object capture module typically stores the print objects in a database on a machine readable medium see .

In response to receipt of a print layout generation command from the user block the print layout generator module determines the print layout of the print objects on one or more pages block and outputs the print layout block . The print layout can be output by the print layout generator module in a variety of different ways. For example the print layout can be output by rendering it in a preview window on the display storing it in a database on a machine readable medium and rendering it on a print medium e.g. paper .

The structured document printing system typically is implemented by one or more discrete data processing modules or components that are not limited to any particular hardware firmware or software configuration. For example in some implementations the structured document printing system is embedded in the hardware of any one of a wide variety of electronic apparatus including desktop laptop and workstation computers cable or satellite set top boxes capable of browsing web pages and the like and portable telecommunications devices e.g. web browser enabled mobile telephones .

The print object capture module and the print layout generator module are data processing components that may be implemented in any computing or data processing environment including in digital electronic circuitry e.g. an application specific integrated circuit such as a digital signal processor DSP or in computer hardware firmware device driver or software. In some embodiments the functionalities of these data processing components are combined into a single data processing component. In some embodiments the respective functionalities of each of one or more of these data processing components are performed by a respective set of multiple data processing components. In some embodiments the print object capture module and the print layout generator module are integral components of an internet browser software application. In other embodiments these modules are provided as part of a plug in extension to an internet browser software application program such as the Internet Explorer web browser the Mozilla Firefox web browser the Safari web browser and the Opera web browser.

In some implementations process instructions e.g. machine readable code such as computer software for implementing the methods that are executed by the structured document printing system as well as the data it generates are stored in one or more machine readable media.

As explained above the print object capture module initiates a process of capturing a print object in response to receipt of each user input gesture over a region of the document being rendered on the display block .

A gesture is a graphical input that is received from a user and is interpretable as a command. A gesture may be input by a user in a variety of different ways. In some embodiments the user inputs gestures using a computer mouse e.g. by clicking the left button of the computer mouse or by clicking the left or right button of the computer mouse and moving the mouse while the button is depressed or other input device. In some embodiments for example the user inputs gestures using a stylus on a digitizer input tablet.

Gestures typically are characterized by one or more of the following attributes default action action area display screen position size and shape. The default action is the action that is taken by the print object capture module in response to the gesture. In some embodiments a gesture may have more than one default action. The action area is a region of the structured document underlying at least a part of the gesture. For some gestures the action area corresponds to only a portion of the gesture. For example the action area of a checkmark gesture is a region of the document near the vertex of the checkmark and the action area of a cross mark i.e. a mark formed by two intersecting lines such as an X a x and a is a region of the document near the intersection of its two constituent lines. For other gestures the action area corresponds to a region of the document that is at least partially surrounded by a boundary formed by the strokes constituting the gesture. The boundary may for example correspond to the border of a bounding box or a freeform shape.

In the process of capturing a print object block the print object capture module identifies an element of the structured object specification that is being rendered within an active area of the user input gesture on the display block .

In response to receipt of the checkmark gesture the print object capture module identifies any element of the structured object specification being rendered near the vertex of the checkmark. Depending on the content of the mixed content region and the overall size of the checkmark gesture the print object capture module may identify all or a part of the structured object specification element being rendered in the mixed content region . For example 

In the process of capturing a print object block the print object capture module additionally interprets the user input gesture as a print content designation command block . For example in some embodiments the print object capture module interprets checkmark gestures and boundary gestures as print content designation commands to include the identified elements of the structured object specification in the print layout whereas the print object capture module interprets cross gestures as print content designation commands to exclude the identified elements of the structured object specification from the print layout . Thus with respect to the embodiment illustrated in these embodiments of the print object capture module would interpret the user input gestures and as commands to include in the print layout all or part of the structured object specification element being rendered in the mixed content region the hyperlink reference element the video clip element and the image element the print object capture module additionally would interpret the user input gesture as a command to exclude from the print layout all or a part of the structured object specification element being rendered in the text region .

In the process of capturing a print object block the print object capture module additionally derives the print object from the structured object specification in accordance with the identified element of the structured object specification and the print content designation command block . In this process the print object capture module derives a respective print object from each of the elements of the structured object specification that is to be included in the print layout . Thus with respect to the embodiment illustrated in the print object capture module would derive a respective print object from each of the following elements all or part of the structured object specification element being rendered in the mixed content region the hyperlink reference element the video clip element the image element and any sub element part of the structured object specification element being rendered in the text region that has not been excluded from the print layout if any .

In response to a user selection of a Highlight button the graphical user interface changes one or more of the display parameters e.g. brightness contrast and color of the corresponding content being presented in the window in which the structured document is being presented. For example in the illustrated embodiment one or more of the display parameters of the second text sub element of the mixed content element being presented in the mixed content region are changed so as to highlight the textual content corresponding to the selected text element in the DOM representation .

In some embodiments the user may modify the contents being presented in the pane . For example with respect to the embodiment illustrated in the user may modify the textual content in any of variety of different ways including but not limited to deleting some or all of the textual content and adding new textual content. In response to a user selection of an Update button the print object capture module will store the modified content in a respective print object. In some embodiments the print object capture module also will present the modified content in the corresponding region of the structured document being rendered in the graphical user interface .

In some embodiments the structured object specification contains hyperlink references to respective contents of the structured document instead of containing the actual content. For example instead of containing an embedded resource e.g. another structured document such as a web page or a multimedia file such as an image file or a video clip file the structured object specification typically contains a hyperlink reference e.g. a uniform resource locator URL or uniform resource identifier URI that identifies an address or path name that specifies the location of the resource outside of the structured document.

In response to the receipt of an input user gesture selecting a hyperlink reference to a resource outside of the structured document the print object capture module retrieves the resource based on the hyperlink and generates one or more of the print objects from the resource. Depending on the type of resource retrieved the print object capture module may generate one or more print objects from the resource automatically or in response to additional user input. In some embodiments if the retrieved resource is a structured document e.g. a web page the print object capture module presents the structured document in a separate window on the display and allows the user to input print content designation commands with respect to the presented structured document in accordance with any of the methods described herein see e.g. block of the structured document printing method . In some embodiments if the retrieved resource is a multimedia file e.g. an image file or a video file the print object capture module automatically derives one or more print objects from the retrieved resource. For example print objects may be generated from keyframes extracted from a video file or from a thumbnail image that is extracted from an image file.

As explained above the print layout generator module determines the print layout of the print objects on one or more pages block and outputs the print layout block . In some embodiments the print layout generator module automatically determines the print layout by assigning respective ones of the print objects to one or more pages and determining a respective layout for each of the pages based on layout rules and layout optimization criteria applied to the print objects assigned to the page.

The page assignment module assigns graphic objects to one or more pages block . The page assignment module operates on the collection of print objects which are received from the print object capture module . The page assignment module assigns the print objects to the one or more pages using any one of a wide variety of page assignment methods. In some approaches the page assignment module assigns the print objects to pages based on a page filling criterion such as a user specified or default maximum number of print objects that may be laid out on a page or a user specified or default fixed number of pages. In these approaches the page assignment module may assign the print objects to pages in accordance with one or more arrangement criteria such as a user specified arrangement of graphic objects or a default arrangement rule that is specified in terms of metadata that is associated with the print objects . The page assignment module typically assigns print objects to pages in the reading order in which the contents of the print objects are arranged in the structured document . The page assignment module passes print object page assignment data which specifies the assignments of the print objects to the pages to the page layout generator module .

The page layout generator module outputs print layouts of the respective print objects on each of the pages in accordance with the graphic object assignment data block . In some embodiments the page layout generator module determines a print layout for a given one of the pages based on a scoring evaluation or fitness function. Such a scoring evaluation or fitness function may be utilized in a wide variety of different layout generation embodiments as described in detail below. The page layout generator module outputs the print layouts of the print objects on the one or more pages to the user interface module . In some implementations the page layout generator module outputs the print layouts in the form of a specification that is arranged in a particular file format e.g. PDF or XML .

The user interface module presents or renders the print layouts on the display block . In some implementations the user interface module allows a user to interactively browse the pages that are generated automatically by the print layout generator module . The user interface module also allows a user to specify edits to the pages. Any specified edits to a given page are interpreted by the user interface module . The user interface module transmits the interpreted user command instructions to the page layout generator module . The page layout generator module repeats one or more aspects of the method of to determine revised print layouts of one or more pages in accordance with the edits received from the user interface module . The user interface module presents the revised final layouts to the user. The user then may browse the revised pages specify edits to the one or more revised pages or command the structured document printing system to render some or all of the pages.

The page layout generator module may determine a print layout of print objects on a given page in a wide variety of different ways.

In some embodiments the page layout generator module determines a print layout for a given page using a tree structure based partitioning of each page. In this process the page layout generator module iteratively constructs a series of successive layouts each of which includes an additional one of the graphic objects added to the preceding layout in the series. In each of the iterations the page layout generator module constructs a current one of the successive layouts from the preceding successive layout based on respective scores. The scores are calculated from comparisons of ones of the actual rendering sizes with respective ones of the target rendering sizes that are computed for candidate current layouts defined by different respective relative positions of the additional graphic object in the preceding successive layout. Additional details regarding the structure and operation of the tree structure based page partitioning embodiments are contained in U.S. application Ser. No. 11 769 671 filed Jun. 27 2007.

In other embodiments the page layout generator module determines a print layout for a given page by evolving a respective genetic structure that defines the locations scales and rotational orientations of the print objects that are placed on the given page in accordance with a genetic algorithm and selecting a print layout from the resulting layouts based on the above mentioned scoring evaluation or fitness function along with certain preferences and page requirements. Additional details regarding the structure and operation of the genetic evolution based print object arrangement embodiments are contained in for example U.S. Pat. No. 6 636 648 and U.S. Patent Application Publication No. 2002 0122067.

In other embodiments the page layout generator module determines a print layout for a given page by positioning print objects on a page based on a force model that assumes that each print object imposes a force on other print objects located on the same page. The force is a function of the distance separating the print objects. Each print object is moved in a direction of the net force acting on the print object by a distance that is a function of the net force. Additional details regarding the structure and operation of the force model based print object arrangement embodiments are contained in for example U.S. Pat. No. 6 636 650.

The structured document printing system see may be implemented by one or more discrete modules or data processing components that may be implemented in any computing or data processing environment including in digital electronic circuitry e.g. an application specific integrated circuit such as a digital signal processor DSP or in computer hardware firmware device driver or software. In some implementations computer process instructions for implementing the methods that are executed by the structured document printing system as well as the data it generates are stored in one or more machine readable media.

The computer system includes a processing unit CPU a system memory and a system bus that couples processing unit to the various components of the computer system. The processing unit typically includes one or more processors each of which may be in the form of any one of various commercially available processors. The system bus may be a memory bus a peripheral bus or a local bus and may be compatible with any of a variety of bus protocols including PCI VESA Microchannel ISA and EISA. The computer system also includes a persistent storage memory e.g. a hard drive a floppy drive a CD ROM drive magnetic tape drives flash memory devices and digital video disks that is connected to the system bus and contains one or more computer readable media disks that provide non volatile or persistent storage for data data structures and computer executable instructions.

The system memory typically includes a read only memory ROM that stores a basic input output system BIOS that contains start up routines for the computer system and a random access memory RAM . The system memory also stores an instance of the structured document print system a GUI driver input data output data intermediate processing data and other data. A user may interact e.g. enter commands or data with the computer system using one or more input devices e.g. a keyboard a computer mouse a microphone joystick and touch pad . The computer system also typically includes peripheral output devices such as speakers and a printer. The computer system can connect to remote nodes over a network connection made through a network interface card NIC . Information may be presented through the graphical user interface GUI that is displayed to the user on the computer display monitor . The GUI typically is integrated into a web browser application program that is executable by the CPU .

The embodiments that are described in detail herein are capable of enabling a user to specify individual elements of structured documents that they would like to print. In this way these embodiments reduce unnecessary consumption of resources such as paper and ink. In addition some of these embodiments are capable of aggregating contents from resources outside of a structured document based on user selection of hyperlink references in structured document. In some implementations this feature provides users with a convenient mechanism for aggregating content across different web pages and different web sites.

