---

title: Verification key handling
abstract: A method, an apparatus, and a computer program product for enabling verification key handling is disclosed. Said handling is enabled by receiving a verification key including an identifier of the parent verification key of the verification key, wherein the verification key includes a constraint portion, determining whether the constraint portion of the verification key corresponds to the constraint portion of the parent verification key, associating, in case the constraint portion of the verification key corresponds to the constraint portion of the parent verification key, the verification key with a particular state update, and storing the verification key associated with the particular state update.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08300829&OS=08300829&RS=08300829
owner: Nokia Corporation
number: 08300829
owner_city: Espoo
owner_country: FI
publication_date: 20080623
---
The invention relates in general to trusted computing and in particular though not exclusively to verification key handling in trusted computing.

Today s mobile phones typically serve as computing platforms for software and firmware that is supplied by a number of vendors. For example a device manufacturer supplies the device with software and or firmware that enables the operation of different components of the device such as the radio interface and smart card reader modules while an application processor manufacturer supplies the software and firmware related to the operation of the application processor. Furthermore an operating system and user applications may be supplied by one or more software vendors.

There are factors that impose strict requirements on the security and integrity protection of the mobile computing platform and or software and firmware run on the platform. For example usage of radio frequencies is highly regulated by authorities. Another example is the prevention of device hijacking so that the mobile device cannot be used anonymously for malicious purposes. This means that a mobile device operating as a computing platform needs to be able to control the operation of software running on the mobile device such that e.g. unauthorized modification of radio configuration parameters can be prevented.

The requirement of trusted computing on a mobile device has been addressed e.g. by the introduction of the mobile trusted module concept by Trusted Computing Group. In said concept e.g. modifications to system configuration parameters may be controlled by a mobile trusted module that itself runs in a secure computing environment provided by the mobile device. Modifications to e.g. system configuration parameters and parameters representing a particular state of a computer program module may be made by using Reference Integrity Metrics RIM certificates. The RIM certificates requesting modifications to configuration and state parameters may be signed by verification keys issued e.g. by the mobile trusted module to parties that are authorized to make said modifications. If a party is in possession of a properly issued and validated verification key said party may be able to authorize any state change on the mobile device including those the modification of which may compromise device security or cause the mobile device to operate against regulations. In other words the authorization enjoyed by a holder of a proper verification key may not be appropriately limited in current mobile computing platforms.

The invention aims at addressing at least some of the issues discussed above. According to a first aspect of the invention there is provided a method comprising the steps of receiving a verification key including an identifier of the parent verification key of the verification key wherein the verification key comprises a constraint portion determining whether the constraint portion of the verification key corresponds to the constraint portion of the parent verification key associating in case the constraint portion of the verification key corresponds to the constraint portion of the parent verification key the verification key with a particular state update and storing the verification key associated with the particular state update.

According to a second aspect the invention provides an apparatus comprising a processor configured to receive a verification key including an identifier of the parent verification key of the verification key the verification key comprising a constraint portion determine whether the constraint portion of the verification key corresponds to the constraint portion of the parent verification key and to associate the verification key with a particular state update the apparatus further comprising a memory configured to store the verification key associated with the particular state update.

According to a third aspect there is provided a computer program product embodied on a computer readable medium the computer program comprising program code operable to be loaded into the memory of and executed on a computing apparatus the program code having been configured to enable when executed the computing apparatus to receive a verification key including an identifier of the parent verification key of the verification key wherein the verification key comprises a constraint portion determine whether the constraint portion of the verification key corresponds to the constraint portion of the parent verification key associate in case the constraint portion of the verification key corresponds to the constraint portion of the parent verification key the verification key with a particular state update and to store the verification key associated with the particular state update.

According to a fourth aspect the invention provides an apparatus comprising means for receiving a verification key including an identifier of the parent verification key of the verification key the verification key comprising a constraint portion means for determining whether the constraint portion of the verification key corresponds to the constraint portion of the parent verification key means for associating the verification key with a particular state update and means for storing the verification key associated with the particular state update.

Various exemplary embodiments of the invention are illustrated hereinafter in the detailed description of the invention as well as in the dependent claims appended hereto. The embodiments are illustrated with reference to selected aspects of the invention. A person skilled in the art appreciates that any embodiment of the invention may apply to other aspects as well either alone or in combination with other embodiments.

Reference is made to which depicts a general overview of a trusted mobile platform on which an embodiment of the invention may be implemented. shows three engines . Each engine may comprise a dedicated processor or a run time environment that has access to trusted resources. Each engine may run both trusted services and normal services. Trusted services are services that are instantiated by using and modifying trusted resources of a computing device such as a mobile phone. Trusted resources are resources whose integrity can be verified e.g. by using an authentication key.

The engine of may be configured to provide cellular services such as cellular protocol stacks required for an access to a mobile communication network to the application services engine via an interface . The cellular services engine may comprise a conventional cellular services module a trusted services module and a mobile trusted module . The cellular services module may use the services of the trusted services module via the application programming interfaces APIs and and the mobile trusted services module may in turn access the services of the mobile trusted module via the interface .

The application services engine of may be configured to provide application services such as a phone book application service for the user service engine via an interface . The application service engine may comprise an application service module a trusted service module and a mobile trusted module . The application service module may access the services of the trusted service module via the APIs and and the trusted service module may in turn access the services of the mobile trusted module via the API .

The user services engine may comprise a conventional user service module such as web browser application a trusted service module and a mobile trusted platform module . The user service module may access the services of the trusted service module via the interfaces and and the trusted service module may access the services of the mobile trusted module via the interface .

Each of the engines which may be trusted engines may be implemented in hardware software firmware or a combination thereof. The trusted service modules may make measurements of the configuration and functions of the conventional service modules and store the measurements in the mobile trusted modules respectively.

Reference is now made to which shows another general overview of a trusted mobile platform on which an embodiment of the invention may be implemented. shows engines corresponding to the engines of . further shows an operating system of a computing device and trusted service modules corresponding to the trusted service modules of respectively. In the platform of the trusted service modules have been implemented as services of the operating system . further shows allocated Roots of Trust modules and a Root of Trust for Enforcement RTE module .

The engines may be trusted engines that are initiated by using secure startup or secure boot. The secure startup of the engines may use the bootstrap method where a startup of bootstrapped modules starts with the initiation of a module the integrity of which is secured by the computing platform e.g. by storing the first module in the bootstrap chain in a secure memory location. Once the first module is up and running it starts and verifies the next module in the bootstrapped secure boot chain.

The allocated Roots of Trust modules of may comprise a Root of Trust for Storage RTS module a Root of Trust for Verification RTV module and a Root of Trust for Reporting RTR module. The Root of Trust for Enforcement RTE module in combination with at least some of the allocated Roots of Trust modules may be used to setup a secure computing environment for a mobile trusted module to load and initialize. The secure computing environment may be e.g. a processor memory. In the operating system may provide a compartmentalized secure execution environment including processing and storage resources as well as an instance of a mobile trusted module for each of the trusted engines .

The concepts of mobile trusted module and trusted mobile platform have been described in detail e.g. in the specifications TCG Mobile Trusted Module Specification version 1.0 of 12 Jun. 2007 and TCG Mobile Reference Architecture version 1.0 of 12 Jun. 2007 of the Trusted Computing Group.

Reference is now made to which shows an outline of an apparatus on which an embodiment of the invention may be implemented. The apparatus of comprises a processor and a memory . further shows a computer program stored in the memory that represents an example of a computer readable medium and operable to be loaded into and executed on the processor .

The processor may be e.g. a central processing unit CPU a microprocessor a digital signal processor DSP a graphics processing unit or the like. shows one processor but the apparatus may comprise a plurality of processors. The apparatus may e.g. comprise a baseband processor and an application processor.

The memory may be for example a non volatile or a volatile memory such as a read only memory ROM a programmable read only memory PROM erasable programmable read only memory EPROM a random access memory RAM a flash memory a data disk an optical storage a magnetic storage a memory or smart card such as a SIM or USIM card or the like. The apparatus may comprise a plurality of memories . The memory may be constructed as a part of the apparatus or the processor or it may be inserted into a slot port or the like of the apparatus by a user. The memory may serve the sole purpose of storing data or it may be constructed as a part of an apparatus serving other purposes such as processing data.

Reference is now made to which depicts an example of a method according to an embodiment of the invention. In step a verification key is received. The verification key may be received e.g. by a mobile trusted module such as the mobile trusted modules of . The mobile trusted module may e.g. be represented by the computer program of . The verification key may be e.g. a verification key used for authorizing and integrity protecting Reference Integrity Metrics RIM certificates that in turn are used for conveying and or modifying Platform Configuration Register PCR values that represent a particular state of e.g. a software module during system startup. Typically a RIM certificate contains an expected value of a state or configuration parameter and RIM certificates may also be used to effect state transitions. RIM certificates and use thereof are further discussed in the TCG Mobile Trusted Module and Mobile Reference Architectures.

If the verification key received in step of comprises a constraint portion it is determined in step whether the constraint portion of the received verification key corresponds to the constraint portion of the verification key s parent verification key.

If the received verification key is to be part of a verification key hierarchy the verification key typically comprises an indication of the parent verification key of the verification key. A mobile trusted module that receives the verification key for the purpose of establishing a hierarchy of verification keys may use the indication for identifying the parent verification key of the received verification key. The constraint portion of the verification key may comprise a set of allowed state updates that determine the particular state update. The set of allowed state updates may comprise at least one platform configuration register. The constraint portion of the verification key may impose restrictions on the use of the verification key for authorizing RIM certificates. For example the constraint portion may indicate that a RIM certificate signed with the verification key may be used only for authorizing a particular state transition during a secure boot process. If the verification key is used for signing a RIM certificate that is tried to be used to modify a state that is not indicated by the constraint portion the modification may not be authorized by a mobile trusted module. The indication of the allowed state transitions may be e.g. in the form of PCR values the modification of which may be authorized by the verification key in question.

The constraint portion of the verification keys may be utilized to implement a hierarchy of verification keys wherein the extent of the authorization power of a verification key is limited to the extent of the authorization power of the parent verification key or the child key may have a narrower power to authorize RIM certificates and state updates. For example a parent key may comprise a constraint portion that indicates that the parent key may be used to authorize updates to the values of PCRs to . A child key of said parent key may in turn comprise a constraint portion that has a matching constraint portion i.e. the constraint portion of the child key indicates that the child key can also be used to authorize modifications of PCRs to . Another child key of said parent key may comprise a constraint portion that indicates that the other child key may be used for authorizing the modification of PCRs to for example.

If said hierarchy of constrained trust is established within a mobile trusted module the mobile trusted module may determine in step of that the constraint portion of the received verification key corresponds to the constraint portion of the parent verification key i.e. the constraint portion of the child verification key matches or is a subset of the constraint portion of the parent verification key. If the result of the determination step is that the constraint portion of the child verification key does not correspond to the constraint portion of the parent verification key the mobile trusted module may reject the received verification key in step .

If in step the mobile trusted module determines that the constraint portion of the received verification key corresponds to the constraint portion of the parent verification key in a manner described hereinbefore the mobile trusted module may register in step an association between the received verification key and a particular state update. The mobile trusted module may e.g. maintain such registrations in a table or the like stored e.g. in the memory of the apparatus of . Once an association has been registered the registered verification key may be used for authorizing a state transition update associated with the verification key.

The integrity of the compartment of the memory where the verification keys and or the registered associations are stored may be secured by a Root of Trust for Storage RTS module.

If the parent key of the verification key received in step is the root key of the verification key hierarchy the received key is compared against the root key. A mobile trusted module may receive the root key for example a Root Verification Authority Identifier RVAI described in the TCG specifications referred to hereinbefore in a suitable manner during the instantiation of the mobile trusted module in a secure boot process.

The received verification key may also comprise a signature portion and the received verification key may have been signed using the parent verification key. The received verification key may be further validated by checking the signature in the received verification key against the parent verification key.

Reference is now made to which shows another example of a method according to an embodiment of the invention. In step a state update certificate is received. The state update certificate may be received e.g. by a mobile trusted module such as the mobile trusted modules of . The mobile trusted module may be e.g. represented by the computer program of . The state update certificate may be e.g. a Reference Integrity Metrics RIM certificate that is used for conveying and or modifying Platform Configuration Register PCR values that represent a particular state of e.g. a software module during system startup. Typically a RIM certificate contains an expected value of a state or configuration parameter and RIM certificates may also be used to effect state transitions. RIM certificates and use thereof are discussed in detail in the TCG specifications referred to hereinbefore.

The state update certificate received in step may request a particular state update and it may have been signed with a request verification key. In step it is determined whether the request verification key corresponds to a stored verification key that has been associated with the particular state update requested by the received state update certificate. For example in step a mobile trusted module may compare the request verification key against a verification key that the mobile trusted module has received stored and associated with a particular state transition update in a manner described hereinbefore. The request verification key may comprise a constraint portion that determines the type of state update certificates that can be validated using the request verification key. For example the constraint portion may restrict the use of the request verification key to validating a state update certificate that requests state updates determined by the constraint portion of the request verification key. Other state update certificates may not be validated by said request verification key. For example the constraint portion may restrict the validation of a state update certificate e.g. a RIM certificate such that the request verification key can only be used for validating state update certificates that request a change to platform configuration register s allowed by the constraint portion.

If the request verification key matches step a stored verification key the requested state update is allowed in step . If the keys do not match the state update certificate is rejected in step . For example a mobile trusted module may allow a particular modification of PCR values that the mobile trusted module stores and maintains according to a received RIM certificate if the RIM certificate has been signed with a verification key that the mobile trusted module has associated with said particular modification of PCR values.

The requested state update may relate to a transition from one state to another state of a system during a secure startup or boot. The state update certificate received in step of may represent an allowed or expected state of e.g. a computer program module during the secure startup. The expected state or configuration of the computer program module may be e.g. the version of the computer program module.

The method apparatus and computer program described herein may be used e.g. for ensuring that a correct version of a computer program module is loaded during a secure boot. The method apparatus and computer program may be further used to limit the parties that are allowed to authorize the load and execution of a computer program module and or a particular version of the module. For example the kernel of an operating system may be loaded into a secure computing environment under the control of a mobile trusted module. The mobile trusted module may control that a component that is loaded prior to the loading of the OS kernel does not load a wrong version of the OS kernel during startup.

The foregoing description has provided by way of non limiting examples of particular implementations and embodiments of the invention a full and informative description of the best mode presently contemplated by the inventors for carrying out the invention. It is however clear to a person skilled in the art that the invention is not restricted to details of the embodiments presented above but that it can be implemented in other embodiments using equivalent means without deviating from the characteristics of the invention.

Furthermore some of the features of the above disclosed embodiments of this invention may be used to advantage without the corresponding use of other features. As such the foregoing description shall be considered as merely illustrative of the principles of the present invention and not in limitation thereof. Hence the scope of the invention is only restricted by the appended patent claims.

