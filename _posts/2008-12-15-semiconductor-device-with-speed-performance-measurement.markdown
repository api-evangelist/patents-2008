---

title: Semiconductor device with speed performance measurement
abstract: A speed performance measurement circuit that may perform speed performance measurement is provided between a first logic circuit and a second logic circuit. The speed performance measurement circuit includes a first flip flop that stores first data, a first delay circuit that delays the first data and generates second data, and a second flip flop that stores the second data. Furthermore, the speed performance measurement circuit includes a first comparator circuit that compares output of the first flip flop to output of the second flip flop, and a third flip flop that stores output data from the first comparator circuit in accordance with timing of the first clock signal. Data in a normal path is compared to data in a path delayed by a certain time to measure speed, and power voltage of a circuit is determined based on such comparison. Thus, change in speed with respect to power voltage in a critical path can be measured.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07911221&OS=07911221&RS=07911221
owner: Renesas Electronics Corporation
number: 07911221
owner_city: Kawasaki-shi
owner_country: JP
publication_date: 20081215
---
The Present application claims priority from Japanese application JP 2007 324991 filed on Dec. 17 2007 the content of which is hereby incorporated by reference into this application.

The present invention relates to a semiconductor device including a plurality of circuits for performing predetermined processing to an inputted signal and furthermore relates to a circuit technique for reducing amount of margin which is secured when a circuit is designed in order to allow circuit operation even if performance of a manufactured integrated circuit is varied so that a semiconductor chip may operate with optimum performance of the circuit.

With progress of size reduction in semiconductor manufacturing process variation is increased in threshold voltage Vth of a MOS transistor. When Vth of a manufactured MOS transistor is decreased due to variation in Vth since a drive current of the MOS transistor is increased operable operation speed of a circuit is increased. Conversely when Vth of a manufactured MOS transistor is increased due to variation in Vth since a drive current of the MOS transistor is decreased operable operation speed of a circuit is decreased. When processing size is decreased to less than 90 nm in the semiconductor manufacturing process difference in speed caused by variation is increased due to increase in variation of Vth leading to difficulty in determination of operation speed of a circuit. Particularly in case of using a technique called FV control in which each of operation frequency and power voltage of a circuit is changed depending on required performance of the circuit since operable frequency of the circuit is different depending on power voltage when the circuit is designed operation frequency is hardly determined to meet any power voltage depending on variation. Therefore when optimum operation frequency can be determined by measuring a characteristic of a manufactured circuit performance of the manufactured circuit can be adequately used. For example JP A 2003 273234 describes a technique where timing of a clock inputted into a circuit is controlled to measure performance of the circuit.

With progress of a manufacturing process of LSI Large Scale Integrated circuit a transistor in LSI is progressively reduced in size. For example a small transistor having a transistor gate length of 50 nm was mass produced in 2006. A transistor is progressively reduced in size which increases variation in Vth of the transistor consequently Vth of a transistor configuring an actually manufactured circuit is greatly shifted from Vth of the transistor when designed. For example in case that Vth of a manufactured transistor is higher than Vth of the transistor when designed operation current of the transistor decreases leading to reduction in operation speed. Particularly in case of using the FV control technique a power voltage required for operation of a circuit at a predetermined frequency needs to be accurately measured for each manufactured circuit and a result of the measurement needs to be held in the circuit.

In the JP A 2003 273234 two memory flip flops FF are provided which are disposed in a path called critical path being slowest in signal transfer timing of a clock for controlling respective FF is shifted between the flip flops and contents of data held in the respective FF are compared to each other thereby whether timing error occurs is measured. In such a case power voltage is gradually decreased and in case that occurrence of error is found from a result of the comparison between the FF the power voltage is increased so that a lower limit value of the power voltage is measured. However in the JP A 2003 273234 output Sig106 of a determiner 106 is directly inputted into a power voltage control circuit and power voltage is adjusted in accordance with error determination of the output Sig106. Therefore 1 in case that noise such as a glitch occurs in Sig106 it may be determined as error determination and consequently even if a power voltage can be essentially lowered the voltage is possibly increased. In addition 2 control is performed in a way that when error occurs power voltage is increased and when error does not occur the power voltage is decreased as shown in . Therefore in such control power voltage fluctuates at any time. In the JP A 2003 273234 what degree of pitch is used for changing the power voltage is not known. In case that the pitch is small since a fluctuation area is small any problem may not particularly occur. However in case that the pitch is small the power voltage hardly reaches the lower limit value unless the control is performed many times therefore much time is possibly required for control. On the other hand in case that the pitch is made large in order to fast reach the lower limit value operation speed is greatly affected by the pitch thereby stable operation of a circuit being essentially intended may not be performed. Moreover in case that the lower limit value of power voltage is measured if a prior state of a circuit is not kept in case that the power voltage is gradually changed a minimum power voltage value above which no error occurs cannot be measured when timing error occurs. Furthermore 3 a configuration is used in which an arithmetic circuit group performing normal operation outputs data for error determination in addition error determination is performed in each clock cycle. In case that error determination is performed in each clock cycle data in F F need to be inverted. Therefore the technique is hard to be used for portions other than a portion where data outputted from a typical logic circuit unit is changed in logical value between 1 and 0 in each clock cycle. Finally 4 when a circuit is designed a path being slowest in signal transfer has been able to be estimated in the past. However in a circuit manufactured by a current fine semiconductor manufacturing process since variation in Vth of a MOS transistor is increased a plurality of paths critical paths being slowest in signal transfer are considered to exist therefore a plurality of paths to be measured in timing are necessary. In JP A 2003 273234 since F F for error determination is additionally provided if the technique is used for a plurality of paths circuit scale is increased.

The foregoing and other objects and novel features of the invention will be clarified from description of the specification and accompanying drawings.

That is a speed performance measurement circuit that may measure speed performance is provided between a first logic circuit and a second logic circuit. The speed performance measurement circuit includes a first flip flop that stores first data inputted in synchronization with a first clock signal a first delay circuit that delays the first data and generates second data a second flip flop that stores the second data inputted in synchronization with the first clock signal a first comparator circuit that compares output of the first flip flop to output of the second flip flop and a third flip flop that stores data of an output signal from the first comparator circuit in accordance with timing of the first clock signal. A measurement result of change in speed with respect to power voltage in a critical path is obtained from output of the third flip flop.

An advantage obtained by a typical invention among inventions disclosed in the application is briefly described as follows.

First summary of a typical embodiment of the invention disclosed in the application is described. A reference sign in a drawing which is seen with a bracket in description of the summary of the typical embodiment merely exemplifies contents included in concept of a component marked with the sign.

 1 A semiconductor device SOC or SOC according a typical embodiment of the invention includes a first logic circuit LOGIC a second logic circuit LOGIC that is disposed in a subsequent stage of the first logic circuit and transmitted with first data outputted from the first logic circuit and a speed performance measurement circuit SEQ that may perform speed performance measurement between the first logic circuit LOGIC and the second logic circuit LOGIC . The speed performance measurement circuit includes a first flip flop FF that stores the first data in synchronization with a clock signal a first delay circuit DELAY that delays the first data and generates second data a second flip flop FF that stores the second data in synchronization with the clock signal a comparator circuit EXOR that compares output of the first flip flop to output of the second flip flop and a third flip flop FF that stores data of an output signal from the comparator circuit in accordance with timing of the first clock signal.

 2 Each part may include a voltage source VGEN for generating power voltage for operation and a voltage control circuit CONTV that may adjust the power voltage by using output data from the comparator circuit.

 3 The semiconductor device may include a memory circuit MEM that may hold control information of the power voltage wherein the voltage control circuit refers to the control information in the memory circuit for adjusting the power voltage.

 4 The semiconductor device may include a fourth flip flop FF wherein in case that output logic of the first comparator circuit is turned to a high level the fourth flip flop accordingly keeps an output state at a high level for a certain time.

 5 The semiconductor device may include a resource manager RM for managing a resource of a circuit module CPU or CPU having a predetermined function wherein the power voltage is adjusted depending on resource management of the circuit module performed by the resource manager.

 6 When a plurality of the speed performance measurement circuits SEQ are provided a speed performance measurement result output unit SEQ may be provided for collecting output signals from the plurality of speed performance measurement circuits into one signal. In this case the speed performance measurement result output unit may be configured to include an OR circuit OR for collecting output signals from the plurality of speed performance measurement circuits into one signal by obtaining OR logic between the output signals from the plurality of speed performance measurement circuits and a fifth flip flop circuit FF for holding an output signal from the OR circuit in synchronization with the clock signal.

 7 Moreover the speed performance measurement result output unit may include a second delay circuit DELAY for delaying the clock signal a plurality of first transistors MN and MN that are disposed corresponding to the plurality of the speed performance measurement circuits and load output signals from the respective corresponding speed performance measurement circuits a second MOS transistor MP that is controlled in operation by an output signal from the delay circuit and couples drain electrodes of the plurality of first transistors to a power supply at a high potential side a third MOS transistor MN that is controlled in operation by an output signal from the second delay circuit and couples source electrodes of the plurality of first transistors to a power supply at a low potential side and a sixth flip flop circuit FF that may hold logic of the drain electrodes of the plurality of first transistors in synchronization with the clock signal.

 8 The semiconductor device may include a frequency control circuit CONTF that may control frequency of the clock signal based on output data from the first comparator circuit.

 9 The semiconductor device may include a clock generation circuit PLL that generates the clock signal and may change frequency of the clock signal based on an output signal from the frequency control circuit.

 10 The semiconductor device may include a body bias adjustment circuit CONTVB that adjusts body bias of a transistor by using output data from the comparator circuit.

 11 The semiconductor device may include a memory circuit MEM that holds control information of body bias wherein the body bias adjustment circuit refers to the control information in the memory circuit for adjusting body bias of the transistor.

 12 From a different viewpoint a semiconductor device may include a first flip flop FF that stores first data in accordance with timing of a clock signal a first delay circuit INV or INV that delays the first data and generates second data a first selection circuit INV or INV that selectively outputs a third data which are inputted through a different path from a path of the first data and the second data a second flip flop FF that stores an output signal from the first selection circuit in accordance with timing of the clock signal and a comparator circuit EXOR that compares output of the first flip flop to output of the second flip flop.

 13 The semiconductor device may be configured such that when a first mode for measuring speed performance and a second mode other than the first mode are included the second flip flop is inputted with the third data in the second mode and inputted with the second data in the first mode according to selection operation of the first selection circuit.

 14 The semiconductor device may include a third flip flop FF that stores output of the second comparator circuit in synchronization with timing of the clock signal.

 15 From a still different viewpoint a semiconductor device may include a seventh flip flop FF that stores inputted sixth data in synchronization with timing of a clock signal a first delay circuit INV or INV that delays the first data and generates second data a first selection circuit INV or INV that selectively outputs the second data and output of the first flip flop a second flip flop FF that stores an output signal from the first selection circuit in accordance with timing of the clock signal and a comparator circuit EXOR that compares output of the first flip flop to output of the second flip flop.

 16 The semiconductor device may include a second selection circuit INSEL that may input data in the second flip flop into the first flip flop.

 17 The semiconductor device may be configured such that when a circuit is in a standby state supply of power voltage is broken to the first flip flop the third delay circuit the second selection circuit and the comparator circuit and the second flip flop is supplied with a signal having a power voltage level.

In VGEN is a power voltage generator CONTV is a power voltage control circuit and MEM is a memory circuit storing control information of power voltage. ERCK is an error check circuit and ERCN is an error control circuit. VDD is power voltage CHV is a signal specifying power voltage and ERROUT is an output signal from a circuit measuring speed performance. In the circuit the minimum power voltage for operation can be set by the ERROUT signal outputted from the circuit measuring speed performance.

In in step a value of current power voltage is stored in MEM in . In step power voltage is lowered. In step data of ERROUT are subjected to comparison. In case that a high H level is outputted based on the comparison processing of step is performed. In case that a low L level is outputted operation of the step is performed. In the step control information of power voltage is set in MEM. Power voltage is controlled according to the set control information. Operation from steps to is performed enabling setting of a minimum power voltage for operation of a circuit at a certain operation speed. In the power voltage setting sequence of whether ERROUT is H or L is determined in the step . In this way the memory circuit MEM is provided for storing power voltage information and only in case that error does not occur the power voltage information is changed and when error occurs the power voltage is reset to a prior value when error did not occur. Thus a lower limit of power voltage can be set and consequently the problem 2 can be solved. shows a configuration example of the ERCK.

The ERCK is disposed between LOGIC and LOGIC as shown in . Each of LOGIC and LOGIC is a combinational logic circuit that may perform predetermined logic operation.

An output signal from LOGIC is transmitted to LOGIC disposed in a later stage via ERCK. ERCK performs measurement of speed performance of a critical path from the LOGIC to the LOGIC and performs error check based on a result of the speed performance measurement. While not particularly limited a result of the error check is used for power voltage control described later.

The ERCK includes a speed performance measurement circuit SEQ that may perform measurement of speed performance of the critical path and an error determination circuit SEQ that performs error determination based on a result of measurement ERROUT by the SEQ. An error determination signal ERREX is outputted from the SEQ.

While not particularly limited the SEQ includes a delay circuit DELAY flip flop circuits FF FF and FF and an exclusive OR circuit EXOR . The DELAY is configured by two stages of inverters. An output signal D from the LOGIC is subjected to signal delay by time corresponding to two stages of inverters due to the DELAY. An output signal DD from the DELAY is transmitted to FF. FF holds the output signal D from the LOGIC in synchronization with a clock signal CLK. FF holds the output signal DD from the DELAY in synchronization with the clock signal CLK. EXOR obtains exclusive OR logic between output signals from the FF and FF. A result of the exclusive OR logic ERROR is held by FF in synchronization with the clock signal CLK. An output signal ERROUT from FF is transmitted to SEQ in a subsequent stage. In this way FF is provided which loads the output ERROR from EXOR being a comparator circuit in accordance with the clock signal CLK inputted into each of FF and FF. Thus even if noise such as a glitch occurs in ERROR the noise may be neglected and thus information of the comparison result ERROR can be accurately held and consequently the problem 1 can be solved.

The power voltage control circuit CONTV and the memory circuit MEM shown in may operate as a trigger for directly changing power voltage information by the ERROR signal while FF is not provided. However the circuits are particularly effective in combination with FF in . That is when ERROR is directly used as a trigger for changing power voltage information in the memory circuit while FF does not exist the power voltage information may be falsely changed due to noise such as a glitch. Therefore error information held by FF is accurately obtained thereby stable operation can be performed.

In the circuit shown in while not shown a flip flop circuit operating upon a clock signal CLK is disposed in a prior stage of LOGIC and data are inputted into the LOGIC upon input of the clock signal CLK and output of the LOGIC is stored into FF in synchronization with a subsequent clock signal CLK. In the circuit in case that delay of LOGIC moves at a speed higher than frequency given by the clock signal CLK by at least delay of two stages of inverters the output signal ERROUT from FF has a low level. However when the delay of the combinational logic circuit LOGIC moves at a speed approximately equal to speed of the frequency given by the clock signal CLK or lower than the frequency speed a high level signal is outputted as the output signal ERROUT from FF.

A cyclical clock signal CLK is inputted into LOGIC and data of the output signal D from LOGIC are changed in level before rising of the clock. Then since the clock signal CLK is inputted into FF a value of the output signal D from LOGIC is loaded into FF and outputted as a signal and the outputted signal is inputted into LOGIC in a subsequent stage. Moreover data of the signal DD the signal being given by delaying the output signal D from LOGIC by delay of two stages of inverters are also changed in level before rising of the clock signal CLK. Therefore data are loaded into FF inputted with the output signal DD from DELAY at the same time with rising of the clock signal CLK and the data are outputted as QD. In this case since data loaded into each of FF and FF respectively are the same Q and QD being output signals from FF and FF have the same value and the signal ERROR obtained by exclusive OR between Q and QD has a low level. Furthermore output of FF loading such a signal ERROR has a low level.

In a case of an operation example shown in delay of LOGIC moves slow compared with the case of . Therefore at timing while data of the output signal D from LOGIC have been changed in level data of the output signal DD from DELAY are not changed. Therefore input data into FF is turned to a low level at rising of the clock signal CLK at the timing and therefore the output signal Q from FF is also turned to a low level. On the other hand data into FF is turned to a high level and the output signal QD from FF is also turned to a high level. Accordingly the value of exclusive OR ERROR between the signals Q and QD has a high level. Furthermore at timing corresponding to rising of a subsequent clock signal CLK output of EXOR is held by FF and the signal ERROUT is turned to a high level. Furthermore at timing corresponding to rising of a next subsequent clock signal CLK since the output signal Q from FF is equal in level to the output signal QD from FF the value of exclusive OR ERROR is turned to a low level and data loaded into FF is also turned to a low level. In this way when the circuit shown in is used detection can be made on a fact that a speed value of delay of the LOGIC is close to that of the frequency given by the clock signal CLK.

However in SEQ shown in the cyclical ERROUT is not outputted at a speed error occurring condition. This is because SEQ shown in compares data between FF and FF when data are changed and detects whether data are different between them therefore when data inputted into FF are not changed even if speed error occurs the signal ERROUT is not turned to a high level.

Thus in the example the error determination circuit SEQ is disposed in a subsequent stage of the speed performance measurement circuit SEQ which enables error determination of whether output ERROUT from the flip flop circuit FF is turned to a high level during several cycles.

While not particularly limited SEQ includes a logic circuit ORAND and a flip flop circuit FF as shown in . ORAND includes an OR circuit OR that calculates the logical sum of an output signal ERROUT from FF and an output signal ERREX from FF and an AND circuit AND that calculates the logical multiplication of an output signal from the OR and a reset signal RESET the signals being coupled with each other. An output signal N from the ORAND is transmitted to FF in a subsequent stage.

A clock signal CLK is cyclically inputted. An initial state shows a state after a reset signal is once turned to a low level wherein an output signal ERREX from FF has a low level. At time when high level data are inputted into an output signal ERROUT from FF an output signal N from ORAND is turned to a high level and at time the high level data are stored into FF and the output ERREX is turned to a high level. At time while low level data are inputted into the output signal ERROUT from FF the output signal ERREX from FF still keeps the high level. At time a reset signal RESET is turned to a low level and SEQ is reset. Then at time the low level data are held by FF and the output ERREX is also turned to a low level. In this way the circuit SEQ shown in is provided which enables storing a fact that high level data are inputted from the output signal ERROUT of FF. Consequently SEQ is disposed in the subsequent stage of SEQ enabling error determination of whether the output ERROUT from FF is turned to a high level during several cycles. That is according to the configuration if error determination is made even once during a plurality of clock cycles a period before a reset signal is inputted error determination data are held by FF. That is an error determination circuit can be provided even if it is not subsequent to a logic circuit that alternately outputs H and L and thus the problem 3 can be solved. In addition FF has the same advantage as FF. That is even if noise such as a glitch occurs in ERROR or ERROUT since FF loads data according to the same clock signal as in FF or FF stable operation can be achieved.

 1 FF that stores a first data inputted in synchronization with a clock signal CLK FF that delays the first data and generates second data FF that stores the second data inputted in synchronization with the clock signal CLK EXOR that compares output of the FF to output of the FF and FF that stores data of an output signal from the EXOR according to timing of the clock signal CLK are provided whereby it can be detected without being affected by noise that delay of the combinatorial logic circuit LOGIC has a speed value close to that of the frequency given by the clock signal CLK.

 2 SEQ is disposed in the subsequent stage of SEQ which enables error determination of whether the output ERROUT from FF is turned to a high level during several cycles.

 3 The operation and effects of 1 and 2 enable setting of the minimum power voltage while securing required speed performance in SOC.

In SOC mounted with a plurality of CPU in this way a plurality of circuit blocks that limit performance exist in the SOC. In such a case a circuit for adjusting a resource of each processor is needed. In the example the RM performs resource adjustment of each of the CPU and CPU. Operation speed of each of CPU and CPU after such resource adjustment is measured by the special ERCNT and a minimum power voltage corresponding to the speed performance is set in the special VGEN.

In this way in the embodiment 2 operation speed of each of CPU and CPU after the resource adjustment is measured by the special ERCNT and the minimum power voltage corresponding to the speed performance is set in the special VGEN therefore appropriate power voltage setting is performed in accordance with the resource adjustment of each of CPU and CPU.

Typically SOC has a plurality of paths called critical paths in which speed performance is lowest. In such a case a plurality of speed performance measurement circuits SEQ are preferably used to measure speed performance. shows a configuration example of a major part in case that a plurality of SEQ are provided in such a way.

In the example shown in four SEQ are provided and output signals from the SEQ are transmitted to a speed performance measurement result output unit SEQ in a subsequent stage respectively. Since the four SEQ are configured in the same as that shown in detailed description of them is omitted here. The SEQ is configured as follows.

ERROUT to ERROUT are output signals from the four SEQ respectively. An OR circuit OR is provided which obtains OR logic between ERROUT to ERROUT. An output signal N from OR is transmitted to a flip flop circuit FF in a subsequent stage. FF holds the output signal N from OR in synchronization with a clock signal CLK. An output signal ERREX from FF is supplied as an output signal error determination signal from SEQ to a circuit in a subsequent stage such as CONTV refer to .

In this way according to the configuration shown in OR logic between ERROUT to ERROUT is obtained by OR. Therefore when even one of ERROUT to ERROUT is turned to a high level the output signal N from the OR is accordingly turned to a high level. Such a signal is stored in FF at rising of the clock signal CLK and outputted as ERREX. That is according to the example a high level output signal can be detected from output of a plurality of circuits that measure speed performance respectively. Therefore when the signal ERREX is used to adjust circuit performance a minimum power voltage to secure predetermined circuit performance can be set in SOC.

In the example shown in two SEQ are provided and output signals from the SEQ are transmitted to a speed performance measurement result output unit SEQ in a subsequent stage respectively. Since the two SEQ are configured in the same way as SEQ shown in detailed description of them is omitted here. In SEQ is configured as follows.

MP is a p channel MOS transistor for precharging a node N to a high level power VDD level at a high potential side MN and MN are n channel MOS transistors for loading the ERROUT and ERROUT respectively MN is an n channel MOS transistor for pulling down a source electrode of each of the MN and MN to a low level power VSS level at a low potential side . In addition a delay circuit DELAY formed by a plurality of inverters is provided which delays a clock signal CLK. A clock signal CLKB delayed by the DELAY is supplied to each of gate electrodes of the p channel MOS transistor MP and the n channel MOS transistor MN.

A circuit shown in is inputted with a cyclical clock signal CLK. At time speed error occurs and ERROUT is turned to a high level. Then the n channel MOS transistor MN is turned on. At time the clock signal CLKB is turned to a high level thereby the n channel MOS transistor MN is turned on and thereby the node N is turned to a low level. At time the clock signal CLK is inputted into FF and thus low level data are stored into FF and the stored data are outputted as ERREX. When ERREX has a high level it shows a state without speed error and when ERREX has a low level it shows a state with speed error. At time either of the inputted signals ERROUT and ERROUT is turned to a low level and therefore the node N is not discharged and at time being next cycle start time high level data are stored into FF and the stored data are outputted.

In two SEQ are provided and output signals from the two SEQ are transmitted to the speed performance measurement result output unit SEQ in the subsequent stage respectively. However the configuration may be made such that three SEQ are provided and output signals from the three SEQ are transmitted to SEQ respectively. Moreover while an output signal such as ERROUT from FF is loaded as an output signal from SEQ in an output signal from EXOR may be loaded. In this case FF in the plurality of SEQ are unnecessary.

The configuration shown in each of which shows a circuit obtaining logic sum of a plurality of signals is suitable for a case that a plurality of critical paths exist in a circuit and a plurality of circuits of are mounted. The circuit shown in is available up to about four signals. However the number of signals further increases which causes increase in number of wirings and in circuit scale leading to difficulty in use of the circuit. On the other hand in the circuit shown in when the number of inputted signals increases a MOS transistor corresponding to the n channel MOS transistor MN or MN can be merely added therefore increase in circuit scale can be suppressed.

In recent SOC a technique of FV control is generally known in which each of frequency and power voltage of a clock signal is changed so that required operation performance is secured in addition power voltage is decreased thereby power consumption is reduced. A circuit technology of the embodiment enables measurement of a minimum power voltage required for operation at a particular frequency. Therefore when the circuit technology is used a power voltage can be set to the minimum voltage in FV control and consequently low power consumption can be achieved in SOC. shows a configuration example in such a case.

ERCNT shown in is greatly different from that shown in in that an operation frequency control circuit CONTF is provided and the CONTF controls operation of PLL Phase Locked Loop .

In VGEN is a power voltage generator PLL is a clock generation circuit that generates a clock signal CLK CONTV is a power voltage control circuit CONTF is a frequency control circuit that controls frequency of the clock signal CLK MEM is a memory circuit for storing power voltage or control information of frequency of the clock signal CLK. VDD is power at a high potential side CLK is the clock signal CHV is a signal specifying the power voltage CHF is a signal specifying operation frequency and ERROUT is an output signal from a circuit measuring speed performance.

In the circuit an operable minimum power voltage can be set by ERREX outputted from ERCK as in the case shown in . Furthermore in the circuit adjustment of the clock signal CLK is additionally performed.

In step frequency of a clock generated by the clock generation circuit is set to a value required for circuit operation. In step a control signal CHV is transmitted from CONTV to VGEN so as to generate a predetermined power voltage so that a power voltage is set. In step a current power voltage value is stored in MEM in and in step a signal is transmitted from CONTV to VGEN so as to generate a power voltage lowered by several millivolts to tens of millivolts from a value of the power voltage stored in the step so that control information of power voltage is set. In step determination is made on whether data outputted from ERROUT have a high level. In the determination in case that the data outputted from ERROUT is determined to have a high level operation of step is performed. On the other hand in case that the data outputted from ERROUT is determined to have a low level operation is returned to the step . In the step power voltage is adjusted according to the control information stored in MEM . Operation from steps to is performed enabling setting of an operable minimum power voltage of a circuit at a predetermined operation speed.

SEQ shown in is disposed between LOGIC and LOGIC in the same way as SEQ shown in . In FF and FF are flip flops with scan function D and D are data to be inputted into FF and FF and Q and Q are signals to be outputted from FF and FF respectively. CLK is a clock signal. EXOR shows a logic circuit obtaining exclusive OR. ERROR shows a result of obtaining exclusive OR between the output signals Q and Q. FF is a flip flop for holding ERROR in synchronization with the clock signal CLK. Output of FF is shown as ERROUT. INSEL is a selection circuit for selectively transmitting the inputted signals D and D to a circuit in a subsequent stage.

The FF includes inverters INV INV INV INV and INV clocked inverters INV and INV n channel MOS transistors MN and MN and p channel MOS transistors MP and MP. The n channel MOS transistor MN and the p channel MOS transistor MP are connected in parallel thereby a transfer gate is formed. The n channel MOS transistor MN and the p channel MOS transistor MP are connected in parallel thereby another transfer gate is formed. The inverter INV and the clocked inverter INV are connected in parallel thereby a latch circuit is formed and the inverter INV and the clocked inverter INV are connected in parallel thereby another latch circuit is formed. D is held by the inverter INV and the clocked inverter INV via the inverter INV and the MOS transistors MN and MP and furthermore held by the inverter INV and the clocked inverter INV via the MOS transistors MP and MN. A value of the held D is outputted as Q via the inverter INV. The clock signal CLK is supplied to the p channel MOS transistor MP clocked inverter INV n channel MOS transistor MN and clocked inverter INV via the inverters INV and INV thereby D is outputted as Q in two cycles in synchronization with the clock signal CLK.

The FF includes clocked inverters INV INV and INV inverters INV INV INV and INV n channel MOS transistors MN and MN and p channel MOS transistors MP and MP and is configured in the same way as FF.

The circuit has two FF in which EREN is turned to a high level thereby the inputted data D is compared to data of a signal formed by delaying D by time corresponding to two stages of inverters so that speed error in a path inputted with D can be detected. In case that SOC including the circuit performs normal operation each of FF and FF is within a path of the circuit and used as a part of operation circuit. In case that SOC including the circuit is transferred into a mode of measuring operation performance FF is used as a flip flop for comparison with data in FF.

In a period when a level of EREN is a low level that is in a period being not shown as COMP in data inputted through D are stored into FF at rising of the clock signal CLK and the stored data are outputted through the data output Q. Data inputted through D are stored into FF at rising of the clock signal CLK and the stored data are outputted through the data output Q.

Each of INV and INV operates as a delay circuit that delays D by time corresponding to two stages of inverters. In case that EREN is turned to a high level in a signal inputted into FF is switched from D to a signal given by delaying D by time corresponding to two stages of inverters by the circuits of INSEL and INSEL. In case that delay given by adding delay of two stages of inverters to delay in a path of a signal inputted into D is shorter than delay provided by a cycle of the clock signal CLK the same data are stored into FF and FF. This is shown as a period shown by COMP in . In this period a level of EREN is a high level and furthermore either of Q and Q being output of FF and FF has DAT or DAT which shows that the same data are stored. Accordingly low level data are outputted through ERROR as a result of obtaining exclusive OR between the two data.

In case that delay given by adding delay of two stages of inverters to delay in a path of a signal inputted into D is longer than delay provided by a cycle of the clock signal CLK data in FF in a prior cycle are stored into FF. This is shown as a period shown by COMP in . In this period a level of EREN is a high level and furthermore Q and Q being output of FF and FF have DAT and DAT and DAT and DAT respectively that is each FF stores different data. Accordingly high level data are outputted through ERROR as a result of obtaining exclusive OR between the two data. Since the output signal ERROR is outputted in the same condition as the output signal ERROR in the circuit is used in the same way as the case of the embodiment 1 thereby speed error in the circuit can be detected.

In the circuit in case that the circuit performs normal operation FF is within a normal operation path. Therefore in case that the circuit is used to measure operation speed since FF may not perform normal operation operation needs to be changed from the normal operation. In addition the same circuit as shown in may be used as a circuit for setting power voltage.

In in step a mode is shifted to a test mode. That is in the circuit of when EREN is inputted with a high level signal input of FF is switched to D so that a mode is shifted to the test mode. In step power voltage is set. That is a signal is transmitted from CONTV to VGEN so as to generate a predetermined power voltage thereby power voltage is set. In step a current power voltage value VDD is stored in MEM in . In step the power voltage VDD is lowered. That is a signal is transmitted from CONTV to VGEN so as to generate a power voltage lower than a value of the power voltage stored in the step by several millivolts to tens of millivolts thereby the power voltage VDD is set. In step data outputted through ERROUT is subjected to comparison. In case that a high level is outputted operation of step is performed. In case that a low level is outputted as a result of the comparison operation is shifted to operation of the step . In step power voltage is set to the value stored in MEM in and setting is finished. In step the test mode is shifted from the test mode to a normal operation mode and in the circuit of EREN is turned to a low level thereby input of FF is switched from D to D so that the test mode is shifted to the normal operation mode. Operation from steps to is performed enabling setting of an operable minimum power voltage of a circuit at predetermined operation speed.

In this way the switching circuit INSEL is used thereby FF used for normal operation may be used for error determination. Therefore area overhead can be reduced. Thus even in VLSI having many critical paths such as SOC optimization of operation voltage can be achieved without increasing area and consequently the above problem 4 can be solved.

SEQ shown in is disposed between LOGIC and LOGIC in the same way as SEQ shown in or . SEQ shown in is greatly different from SEQ shown in is in that a selection circuit INSEL is provided for selectively loading the output signal Q from FF into FF and a circuit is provided in INSEL for selectively transmitting a store signal STORE and an output signal from FF to FF. The INSEL includes INV INV and INV. The circuit for selectively transmitting the store signal STORE and the output signal from FF to FF includes an inverter and a clocked inverter .

In FF shows a flip flop that stores inputted data D and outputs the data as Q upon a clock signal CLK. Here FF operates as a balloon latch which may store the data stored in FF according to STORE and may write previously stored data into FF according to a reset signal REST Typically FF and FF are handled in pair and in case that a logic circuit including the flip flops is into a standby state a region enclosed by PDAREA including FF is broken in power and power is supplied to only a portion of FF. Thus a leakage current of a circuit in PDAREA is reduced so that power consumption of a logic circuit can be reduced during standby in addition since data are stored in the flip flop recovery time from the standby state is reduced. ERROR shows a result of obtaining exclusive OR between the signals Q and Q. INSEL and INSEL are selection circuits for selecting signals to be inputted into FF and FF respectively.

In the circuit EREN is turned to a high level thereby the inputted data D is compared to data of a signal given by delaying D by time corresponding to two stages of inverters speed error in a path to be inputted with D can be detected.

In case that EREN is turned to a high level thereby in case that a high level signal is inputted in INSEL switches an input signal into FF to a signal given by delaying D by time corresponding to two stages of inverters. In case that delay given by adding delay of two stages of inverters to delay in a path of a signal inputted as D is shorter than delay provided by a cycle of the clock signal CLK refer to the same data are stored into FF and FF. This is shown as a period shown by COMP in . In this period a level of EREN is a high level and furthermore either of Q and Q being output of FF and FF has DAT which shows that the same data are stored. Accordingly low level data are outputted as ERROR as a result of obtaining exclusive OR between the two data.

In case that delay given by adding delay of two stages of inverters to delay in a path of a signal inputted as D is longer than delay provided by a cycle of the clock signal CLK refer to data in FF in a prior cycle are stored into FF. This is shown as a period shown by COMP in . In this period EREN is H and furthermore Q and Q being output of FF and FF have DAT and DAT respectively that is each FF stores different data. Accordingly high level data are outputted as ERROR as a result of obtaining exclusive OR between the two data. Since the output signal ERROR is outputted in the same condition as the output signal ERROR in speed error in the circuit can be detected as the case of the embodiment 1.

In addition in the circuit data stored in FF may be held in FF by using STORE and REST and furthermore the data may be returned into FF. In when STORE is turned to a high level Q being output of FF is connected to input of FF and the data in FF is written into FF upon input of a subsequent clock signal CLK. Such a state can be confirmed from a fact that data DAT in FF in a prior cycle of ST are written into FF in a cycle of ST in . In a period of PWRDN shows that a logic circuit including the circuit of the invention is in a standby state in which power is broken in a region within PDAREA in and power is supplied to only a circuit of FF so that leakage current of the entire circuit is reduced leading to low power consumption. While only one cycle is shown in the waveform diagram the standby state where power is broken actually continues at least 100 cycles in many cases. Then a state is returned from the standby state to the normal state and power is supplied to the circuit within PDAREA and then a REST signal is inputted. Thus the data stored in FF is rewritten into FF.

As hereinbefore in the embodiment FF is used for operation for holding data in a low leakage condition during standby of a logic circuit and FF is used for measuring speed in a logic path up to D during a normal operation condition. Therefore low leakage current operation and speed adjustment operation can be performed while suppressing increase in area of a flip flop. That is according to the embodiment while speed performance required in SOC is secured a minimum power voltage can be set.

Even in the configuration the switching circuit INSEL is used thereby FF having a different function data holding function during standby may be used even for error determination. Therefore area overhead can be reduced. Thus even in VLSI having many critical paths such as SOC optimization of operation voltage can be achieved without increasing area and consequently the above problem 4 can be solved.

Generally body bias being backgate potential of a MOS transistor is controlled thereby performance of the transistor can be changed. In addition as a value of VBN being body bias of an n channel MOS transistor is decreased operation speed is decreased but a leakage current flowing through the MOS transistor is decreased and thus power consumption can be reduced. Moreover as a value of VBP being body bias of a p channel MOS transistor is decreased operation speed is decreased but a leakage current flowing through the MOS transistor is decreased and thus power consumption can be reduced. In the embodiment change in speed is measured and thereby desired operation speed is obtained through which optimum body bias is determined.

In VBGEN is a body bias generation circuit that generates VBN being body bias of an n channel MOS transistor VBGEN is a body bias generation circuit that generates VBP being body bias of a p channel MOS transistor and ERCNT is a body bias control circuit that may control body bias. CONTVB is a body bias control circuit and MEM is a memory circuit that stores a value of body bias. ERCK is a circuit that measures speed performance of a circuit and a configuration thereof is the same as that shown in . CHVBN is a signal that specifies VBN being body bias of an n channel MOS transistor CHVBP is a signal that specifies VBP being body bias of a p channel MOS transistor ERROUT is an output signal from the circuit measuring speed performance. In the circuit the ERROUT signal outputted from the circuit measuring speed performance is used to control a value of VBN to a minimum and a value of VBP to a maximum so that reduction in power consumption can be achieved while satisfying required operation speed.

In in step a value of each of VBN and VBP is set to an initial value and control signals CHVBN and CHVBP are transmitted from the body bias control circuit CONTVB to the body bias generation circuits VBGEN and VBGEN so as to generate predetermined body bias so that bias voltage is set. In step a current body bias value control information is stored into MEM in . The body bias control circuit controls bias voltage in accordance with the value control information of body bias in MEM. In step body bias is changed. That is a signal is transmitted from the body bias control circuit CONTVB to the body bias generation circuit VBGEN so as to set a value of VBN to a value decreased by tens of millvolts to hundreds of millvolts from the value stored in the step so that VBN is set. Concurrently a signal is transmitted from the body bias control circuit CONTVB to the body bias generation circuit VBGEN so as to set a value of VBP to a value increased by tens of millvolts to hundreds of millvolts from the value stored in the step so that VBP is set. Instep data outputted through ERROUT is subjected to comparison. In case that a high level signal is outputted operation of step is performed. In case that a low level signal is outputted operation of the step is performed. In step the body bias values VBN and VBP are set to the values stored in MEM respectively. Operation from steps to is performed thereby power consumption can be minimized under a condition that a circuit operates at a predetermined operation speed.

In SOC a technique of FV control is generally known in which each of frequency and power voltage is changed so that required operation performance is secured in addition power voltage is decreased thereby power consumption is reduced. The circuit technology is further effective by being combined with the FV control. In addition when the technology is further combined with the circuit of embodiment 5 further reduction in power consumption of SOC can be made.

As hereinbefore according to the embodiment while speed performance required in LSI is secured the minimum power voltage can be set.

Hereinbefore the invention made by the inventor has been specifically described. However the invention is not limited to that and it will be appreciated that the invention can be variously altered or modified without departing from the gist of the invention.

In the above description the invention made by the inventor was described mainly on a case that the invention is applied to SOC being a field as a background of the invention. However the invention is not limited to that and may be widely applied to various semiconductor devices.

