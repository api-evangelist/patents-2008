---

title: Secure server certificate trust list update for client devices
abstract: A method, a network element, and a client device for creating a trusted connection with a network are disclosed. A client device  may attempt to access a sub-network . The client device  may determine that a certificate of the sub-network  is issued by a certification authority absent from a device certificate trust list. The client device  may receive via the sub-network  a certificate trust list update  from a certificate trust list provider 
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08584214&OS=08584214&RS=08584214
owner: Motorola Mobility LLC
number: 08584214
owner_city: Libertyville
owner_country: US
publication_date: 20080918
---
The present invention relates to a method and system for authenticating network elements. The present invention further relates to updating a certificate trust list.

A certification authority CA may issue a certificate to a communication entity such as a network sub network or website to ensure the trustworthiness of that entity. A client device that seeks access to the communication entity or receives information from the communication entity may request the certificate. The client device may then compare the certificate for the certification authority of the certificate with a certificate trust list stored by the client device. For simplicity in this situation the certificate authority may be referred to as being present on the certificate trust list. If the certification authority is present on the certificate trust list the client device may connect with the communication entity or accept the information received from the communication entity with full assurances. If the certification authority is not present on the certificate trust list the client device may choose to avoid connecting with the communication entity or accepting the information received from the communication entity till such time as the communication entity is vouched as safe. The absence of a certification authority from a certificate trust list may not necessarily mean that the communication entity is not safe as the certificate trust list may not be up to date.

Additional features and advantages of the invention will be set forth in the description which follows and in part will be obvious from the description or may be learned by practice of the invention. The features and advantages of the invention may be realized and obtained by means of the instruments and combinations particularly pointed out in the appended claims. These and other features of the present invention will become more fully apparent from the following description and appended claims or may be learned by the practice of the invention as set forth herein.

Various embodiments of the invention are discussed in detail below. While specific implementations are discussed it should be understood that this is done for illustration purposes only. A person skilled in the relevant art will recognize that other components and configurations may be used without parting from the spirit and scope of the invention.

The present invention comprises a variety of embodiments such as a method an apparatus and an electronic device and other embodiments that relate to the basic concepts of the invention. The electronic device may be any manner of computer mobile device or wireless communication device.

A method a network element and a client device for creating a trusted connection with a network are disclosed. A client device may attempt to access a sub network and receive a certificate from a network element of the sub network such as an authentication authorization and accounting AAA server. The client device may determine that a certificate of the sub network is untrustworthy due to the fact that the certificate or certificates is from an issuing certification authority absent from a device certificate store. Alternatively the entire chain of trust for the network element certificate may be missing from the device certificate store. The client device may receive via the sub network a certificate trust list update from a certificate trust list provider in a manner that may limit the interactions with the sub network to modification of the certificate trust list. The client may then attach to the sub network again and verify the identity of the sub network.

The client device may connect to the sub network via a network element . For one embodiment the network element may be a distributed set of servers in the network including an AAA server. The client device may be one of several types of handheld devices such as a mobile phone a laptop or a personal digital assistant PDA . For one embodiment the client device may be a WiFi capable device a WiMax capable device or other wireless devices. The wireless devices may transmit data using cellular packet data formats such as general packet radio service GPRS enhanced data rates for global evolution EDGE universal mobile telecommunications system UMTS evolution data optimized EvDO format or other cellular packet data formats. In one embodiment the client device may connect to the network via a wireline or virtual private network VPN access. The WiFi capable device may be used to access the network for data or by voice using voice over Internet protocol VOIP .

The controller processor may be any programmed processor known to one of skill in the art. However the method for authenticating a connection with a client device may also be implemented on a general purpose or a special purpose computer a programmed microprocessor or microcontroller peripheral integrated circuit elements an application specific integrated circuit or other integrated circuits hardware electronic logic circuits such as a discrete element circuit a programmable logic device such as a programmable logic array field programmable gate array or the like. In general any device or devices capable of implementing the method for authenticating a connection with a client device as described herein may be used to implement the system functions of this invention.

The memory may include volatile and nonvolatile data storage including one or more electrical magnetic or optical memories such as a random access memory RAM cache hard drive or other memory device. The memory may have a cache to speed access to specific data. The memory may also be connected to a compact disc read only memory CD ROM digital video disc read only memory DVD ROM DVD read write input tape drive or other removable memory device that allows media content to be directly uploaded into the system.

The network element may have an AAA server interface to interact with an AAA server. The network element may use the AAA server to regulate and control access of the sub network by the client device . The AAA server may store a certificate from a certification authority as well as any updates to the CTL. The AAA server may typically interact with the client device through the network element acting as a pass through entity. The AAA server may own a certificate issued by the certificate authority. The AAA server may present this certificate to the client device as part of an access control authentication process.

The transceiver may create a data connection with the client device . The I O device interface may be connected to one or more input devices that may include a keyboard mouse pen operated touch screen or monitor voice recognition device or any other device that accepts input. The I O device interface may also be connected to one or more output devices such as a monitor printer disk drive speakers or any other device provided to output data. The I O device interface may receive a data task or connection criteria from a network administrator.

The network interface may be connected to a communication device modem network interface card a transceiver or any other device capable of transmitting and receiving signals from the network . The network interface may act as a sub network interface. The network connection interface may be used to connect a client device to a network. The components of the network element may be connected via an electrical bus for example or linked wirelessly.

Client software and databases may be accessed by the controller processor from memory and may include for example database applications word processing applications as well as components that embody the functionality of the present invention. The network element may implement any operating system such as Microsoft Windows LINUX or UNIX for example. Client and server software may be written in any programming language such as C C Java or Visual Basic for example. Although not required the invention is described at least in part in the general context of computer executable instructions such as program modules being executed by the electronic device such as a general purpose computer. Generally program modules include routine programs objects components data structures etc. that perform particular tasks or implement particular abstract data types. Moreover those skilled in the art will appreciate that other embodiments of the invention may be practiced in network computing environments with many types of computer system configurations including personal computers hand held devices multi processor systems microprocessor based or programmable consumer electronics network PCs minicomputers mainframe computers and the like.

The client device may include a transceiver which is capable of sending and receiving data over the network or sub network . The client device may include a processor that executes stored programs. The client device may also include a data storage such as a volatile memory or a non volatile memory which are used by the processor . The client device may store a CTL in a certificate store in the non volatile memory . The client device may include a user input interface that may comprise elements such as a keypad display touch screen and the like. The client device may also include a user output device that may comprise a display screen and an audio interface that may comprise elements such as a microphone earphone and speaker. The client device also may include a component interface to which additional elements may be attached for example a universal serial bus USB interface. Finally the client device may include a power supply .

The CTL update may be stored upon the AAA server associated with the network element or maintained at the CTL provider . illustrates one embodiment of a CTL update . The CTL update may be signed by an authority with a certificate that the client device trusts. The CTL update may have a CTL provider identifier to allow a client device to identify the CTL provider and to protect the client device from receiving a spoofed CTL . The CTL update may have a CTL timestamp to allow a client device to determine if the CTL update predates the CTL stored by the client device in the non volatile memory . The CTL update may have a root certificate indicating the originating trusted source. The CTL provider may determine from a timestamp sent by the client device what new CAs are required by the client device and send just the new CAs to improve transmission efficiency.

The client device may amend the CTL based upon the CTL update Block . If the certificate for the sub network is issued by a certification authority on the updated device CTL Block then the client device may complete access to the sub network in an open access mode allowing unfettered access to the sub network Block . If the certificate for the sub network is issued by a certification authority absent from the update device CTL Block then the client device may refuse network entry and seek out an alternative sub network Block .

Much like network access service provided to a mobile wireless device configuration monitoring or specific software application access such as video may be considered a service provided to the device. In such scenarios internet protocol IP connectivity may have already been established but the device may seek information about a server providing a specific service or configuration or software. The device may seek to establish secure sessions with these servers before trusting the information received or making transactions.

Internet protocol television IPTV providers may use a remote configuration management server RCMS . The IPTV receiving device may receive information about various network servers from the RCMS. The address of the RCMS may be provided to the IPTV receiving devices. Dynamic host configuration protocol DHCP options may provide the address of the RCMS a CTL update a certificate check indicator or a certificate trust list provider location. If the IPTV receiving device is to establish a secure socket layer SSL transport layer security TLS session with or receive signed information from the RCMS server a trustworthy RCMS certificate may be useful. Thus potentially an IPTV receiving device may deal with an RCMS that possesses a certificate issued by a trust authority that is unrecognizable by the IPTV device.

In addition to using MAC messaging to deliver a CTL update before gaining network entry a network element may use a network configuration protocol to deliver the CTL as part of IP network connectivity establishment such as through DHCP or even after the IP network connectivity is established as part of a configuration protocol such as network configuration NETCONF . In such cases the network element may deliver the CTL update as an option or an extension to the network protocol.

One DHCP option may provide the uniform resource locater URL or other access information for the RCMS such as a subject name and CA name for the RCMS certificate. If the IPTV receiving device determines that it does not recognize the CA name the IPTV device may request that a CTL be downloaded as a different DHCP option to prevent SSL TLS failure.

NETCONF protocol may be used to manage network devices retrieve configuration data information and upload and manipulate new configuration data. The NETCONF protocol may allow the device to expose a full formal application programming interface API . Applications may use the API to send and receive full and partial configuration data sets. Any IPTV service that may use configuration information in order to set the service up may receive such information through setting up a NETCONF connection with the configuration or service providing servers.

The NETCONF protocol may use a remote procedure call RPC paradigm. A client may send one or more RPC requests to which the server may respond with a series of RPC replies. The RPC replies may communicate a CTL update a certificate check indicator or a certificate trust list provider location to the client device . NETCONF protocol exchanges may be typically carried over a transport protocol. The RPC requests and responses may be encoded in extendable markup language XML . As NETCONF connections may provide integrity and confidentially protection the NETCONF connections may be carried over TLS or secure shell SSH . When NETCONF connections are used for configuration the device may establish a TLS session to provide the underlying secure connection for a NETCONF connection with a NETCONF server with a recognizable and trustworthy certificate. After the TLS and NETCONF connection is set up the IPTV device may download the CTL as part of NETCONF protocol exchange and determine the address for a CTL provider through the NETCONF protocol. For example configuration data may be carried as part of a element that is formatted based on the specific data model used within the device. Alternatively the CTL and related information may be communicated to the device as a capability . The server may advertise the availability of a CTL download service for a variety of service providers treating the content of the element as opaque data.

The network element may include the CTL as a TLS extension to the TLS exchange. The client device may use the trusted CA indication extension to indicate to the server which CAs are trusted so the network element may use one of those CAs. Thus the network element may send the CTL update to the client device as a sub network access message such as a dynamic host configuration protocol option a NETCONF configuration protocol using a remote procedure call or a transport layer security exchange.

Embodiments within the scope of the present invention may also include computer readable media for carrying or having computer executable instructions or data structures stored thereon. Such computer readable media can be any available media that can be accessed by a general purpose or special purpose computer. By way of example and not limitation such computer readable media can comprise RAM ROM EEPROM CD ROM or other optical disk storage magnetic disk storage or other magnetic storage devices or any other medium which can be used to carry or store desired program code means in the form of computer executable instructions or data structures. When information is transferred or provided over a network or another communications connection either hardwired wireless or combination thereof to a computer the computer properly views the connection as a computer readable medium. Thus any such connection is properly termed a computer readable medium. Combinations of the above should also be included within the scope of the computer readable media.

Embodiments may also be practiced in distributed computing environments where tasks are performed by local and remote processing devices that are linked either by hardwired links wireless links or by a combination thereof through a communications network.

Computer executable instructions include for example instructions and data which cause a general purpose computer special purpose computer or special purpose processing device to perform a certain function or group of functions. Computer executable instructions also include program modules that are executed by computers in stand alone or network environments. Generally program modules include routines programs objects components and data structures etc. that perform particular tasks or implement particular abstract data types. Computer executable instructions associated data structures and program modules represent examples of the program code means for executing steps of the methods disclosed herein. The particular sequence of such executable instructions or associated data structures represents examples of corresponding acts for implementing the functions described in such steps.

Although the above description may contain specific details they should not be construed as limiting the claims in any way. Other configurations of the described embodiments of the invention are part of the scope of this invention. For example the principles of the invention may be applied to each individual user where each user may individually deploy such a system. This enables each user to utilize the benefits of the invention even if any one of the large number of possible applications do not need the functionality described herein. In other words there may be multiple instances of the electronic devices each processing the content in various possible ways. It does not necessarily need to be one system used by all end users. Accordingly the appended claims and their legal equivalents should only define the invention rather than any specific examples given.

