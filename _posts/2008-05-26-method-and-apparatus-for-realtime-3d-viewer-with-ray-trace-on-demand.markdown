---

title: Method and apparatus for real-time 3D viewer with ray trace on demand
abstract: A computer implemented method of providing a photo-realistic view on demand of a real-time interactive three dimensional simulation, the method comprising: providing a real-time interactive three dimensional simulation; selecting a camera position; and ray tracing the provided real-time interactive three dimensional simulation as a function of the selected camera position, the ray tracing providing the photo-realistic view.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08134556&OS=08134556&RS=08134556
owner: 
number: 08134556
owner_city: 
owner_country: 
publication_date: 20080526
---
This applications claims priority to U.S. Provisional Patent Application Ser. No. 60 940 728 filed May 30 2007 entitled Method and Apparatus for Real Time 3D Viewer with Ray Trace On Demand the entire content of which is incorporated herein by reference.

The invention relates generally to the field of computer graphics and in particular to a method of converting a real time interactive three dimensional graphic simulation to a photo realistic view on demand.

The use of interactive and dynamic 3D computer graphics is becoming prevalent in the computing world. Typically 3D visualization applications provide photo realistic results using techniques such as ray tracing radiosity global illumination and other shading shadowing and light reflection techniques. Unfortunately these techniques are computationally intensive and thus photo realistic results can not be viewed interactively they are only viewable as a single raster image or stored as a series of raster images compiled in a time ordered sequence which may be viewed as a single animated playback.

The computational intensiveness of the prior art does not allow for real time 3D interaction with models. The goal of these photo realistic techniques and technologies is to achieve the highest possible level of photo realism using many advanced and often computing intensive and therefore time consuming algorithms. These algorithms can take into account to a very high level of detail the subtle interactions of light geometry and materials to produce computer generated images for which most people would have difficulty discerning that the image was computer generated as opposed to a true photograph of the subject. Particularly in the architecture visualization field many software applications are available which use ray tracing scanline rendering radiosity caustics and global illumination techniques to produce ultra realistic results.

Engineering and design projects have a need for a technology which enables designers planners and developers to show in a virtual 3D world how a proposed project may look even before the first piece of construction equipment is brought onsite. The goal of the graphics engines behind these applications is to provide a realistic experience in the 3D graphic environment placing emphasis on enabling fluid and interactive motion. Such a goal is not met by the photo realistic computational intensive visualization methods described above.

U.S. patent application Ser. No. 11 538 103 filed Oct. 3 2006 to Elsberg et al the entire contents of which is incorporated herein by reference is addressed to a method of converting a computer aided design of a large scale project to a virtual reality based model. Advantageously such a virtual reality based model enables fluid and interactive motion and further enables investigation of line of sight and general geometric layout. Unfortunately no provision exists for displaying the virtual reality based model in a photo realistic manner.

There is often a need by users of an interactive 3D simulation for photo realistic views of the simulation for presentation marketing and sales needs. The real time 3D simulations of the prior art falls short in that they are unable to provide the ultra high level of photorealism needed to meet this objective.

Similarly an architect who may routinely employ photo realistic techniques may need to provide an interactive dynamic model of the design to quickly and efficiently review a proposed design with a client or colleague involved in the design. In such cases the overhead in time required to produce photo realistic results is unjustified.

There is thus a long felt need for a method of integrating a real time interactive three dimensional graphic simulation with a means for producing a photo realistic view.

In view of the discussion provided above and other considerations the present disclosure provides methods and apparatus to overcome some or all of the disadvantages of prior and present teletherapy systems and methods. Other new and useful advantages of the present methods and apparatus will also be described herein and can be appreciated by those skilled in the art. Embodiments hereof provide for an integrated system providing real time interactive 3D simulation and a mechanism for generating photo realistic views on demand of the 3D simulation. By combining the two technologies into one system the invention provides an innovative solution which addresses the needs for both interactive 3D simulations and photo realistic results in an automated system which can be operated effectively by a user with basic computer operating skills. Preferably an automated expert system is implemented to optimize the aesthetic results of the ray tracing process.

The invention provides for a computer implemented method of providing a photo realistic view on demand of a real time interactive three dimensional simulation the method comprising providing a real time interactive three dimensional simulation selecting a camera position and ray tracing the provided real time interactive three dimensional simulation as a function of the selected camera position the ray tracing providing the photo realistic view.

In one embodiment the real time interactive three dimensional simulation comprises objects and environment and wherein the ray tracing comprises drawing all objects of the provided real time interactive three dimensional simulation as a function of the selected camera position with no lighting and no textures reading the depth buffer values corresponding to the drawing with no lighting and no textures drawing environmental objects of the provided real time interactive three dimensional simulation as a function of the selected camera position with lighting and textures reading the current color buffer and storing it in a separate color buffer iterating the viewport pixel by pixel and performing in the event that the depth buffer of a particular pixel is less than one a ray tracing algorithm on the particular pixel.

Additional features and advantages of the invention will become apparent from the following drawings and description.

The present embodiments enable an integrated system providing real time interactive 3D simulation and a mechanism for generating photo realistic views on demand of the real time interactive 3D simulation. By combining the two technologies into one system the invention provides an innovative solution which addresses the needs for both real time interactive 3D simulations and photo realistic results in an automated system which can be operated effectively by a user with basic computer operating skills. Preferably an automated expert system is implemented to optimize the aesthetic results of the ray tracing process.

Before explaining at least one embodiment of the invention in detail it is to be understood that the invention is not limited in its application to the details of construction and the arrangement of the components set forth in the following description or illustrated in the drawings. The invention is applicable to other embodiments or of being practiced or carried out in various ways. Also it is to be understood that the phraseology and terminology employed herein is for the purpose of description and should not be regarded as limiting.

The term real time interactive three dimensional simulation as used herein includes but is not limited to real time three dimensional virtual reality simulations. The term real time interactive three dimensional simulation as used herein further includes but is not limited to three dimensional publishing and real time three dimensional visualization software such as Adobe Acrobat 3D software available from Adobe Systems Inc. San Jose Calif. and the DWF viewer available from Autodesk Inc. San Rafael Calif.

User input device is illustrated as a keyboard however this is not meant to be limiting in any way. The use of any or all of a pointing device a voice input or a touch screen is equally applicable and is specifically included. Memory is illustrated as being internal to computing device however this is not meant to be limiting in any way. Memory may be provided external to computing device such as a network server without exceeding the scope of the invention. Memory comprises a scene graph preferably based on 3D CAD geometry located in other memory locations and computing device is operative to convert the scene graph to real time interactive 3D virtual reality images for viewing on monitor . Memory of computing device is further operative to store the method according the principle of the invention in computer readable format for execution by computing device .

In operation computing device loads a scene graph from memory and translates the scene graph to a real time interactive 3D simulation to be continuously rendered. In an exemplary embodiment the scene graph is translated in accordance with the teaching of U.S. patent application Ser. No. 11 538 103 filed Oct. 3 2006 to Elsberg et al referenced above. User inputs are obtained via user input device to move the camera of the real time interactive 3D simulation to a desired position and to request a photo realistic view responsive to the current camera position.

Processor of computing device is operative to ray trace the real time interactive 3D simulation responsive to the camera position and present the resulting photo realistic view of the real time interactive 3D simulation on a view port of monitor . The real time interactive 3D simulation typically comprises physical objects and environmental objects. Preferably processor uses an automated expert system to reduce the processing time of the ray trace. In particular the automated expert system first draws the physical objects of the scene of the real time interactive 3D simulation as a function of the camera position with no lighting and no textures utilizing graphics card . The depth buffer values are then read by processor from graphics card and stored on depth buffer . Preferably this is performed using an OpenGL application programming interface API . OpenGL is a standard for graphics programming available from the OpenGL Architecture Review Board care of the Kronos Group Chillicothe Ohio.

Processor then draws the environmental objects such as a sky dome and or a ground plane with full lighting and textures utilizing graphics card . The drawn environmental objects are then stored in color buffer of memory responsive to processor .

Processor then iterates the scene pixel by pixel and for each pixel iterated processor examines the contents of depth buffer associated therewith. In the event the associated contents of depth buffer of memory is smaller than one i.e. there is a physical object rendered at that pixel processor performs a ray trace algorithm on the pixel. Ray trace algorithms are well known to those skilled in the art and therefore in the interest of brevity are not detailed. In the event that the associated contents of depth buffer at the pixel is one i.e. the pixel reflects an environmental object only the color for that pixel is selected from color buffer of memory . When the iteration of all pixels is complete the resulting pixel buffer is presented in the view port for display on monitor .

In stage the scene is continuously rendered as a real time interactive 3D simulation preferably using OpenGL API. Typically the scene being continuously rendered comprises both physical objects and environmental objects. The use of OpenGL API reduces the computational intensiveness required of processor by transferring the load to graphics card . In stage the user is enabled to move a virtual camera into a desired position on the scene rendered in stage . In particular the user moves the virtual camera via user input device . In stage when the user has determined that the virtual camera is in the desired position for which a photorealistic view is required a user command is input via user input device to produce a photorealistic view of the real time interactive 3D simulation at the current camera position.

The above has been described in an embodiment in which the photorealistic view is responsive to the current camera position however this is not meant to be limiting in any way. In another embodiment the user selects a particular view via the user input device without requiring the use of the virtual camera.

In stage the scene rendered in is ray traced as a function of the camera position of stage . In one embodiment the rendering of a photo realistic image is accomplished in accordance with methods known to the prior art. In a preferred embodiment ray tracing is accomplished in accordance with the method of to be described further hereinto below. In stage the resulting photorealistic view of the ray tracing of stage is presented in a view port on monitor .

Thus the method of converts a scene graph loaded from a file to a photorealistic view responsive to a user command and the virtual camera position.

In stage the physical objects of the scene of stages are drawn with no lighting and no texture. Preferably the physical objects of the scene are drawn using OpenGL API to reduce the computational intensiveness required of processor by transferring the load to graphics card . In stage the depth buffer values of the drawn physical objects of stage are read by processor from graphics card and preferably stored in depth buffer of memory .

In stage the environmental objects of the scene of stages are drawn with full lighting and texture. Preferably the physical objects of the scene are drawn using OpenGL API to reduce the computational intensiveness required of processor by transferring the computational load to graphics card . In stage the color buffer values of the drawn environmental objects of stage are read by processor from graphics card and stored in color buffer of memory separate from the depth buffer values stored in stage .

In stage a pixel pointer is initialized. The pixel pointer is used in cooperation with stages to be described further below to iterate the viewport pixel by pixel. In stage the value of depth buffer associated with the current pixel as stored in stage is compared with one. It is to be understood that a depth buffer value of one is indicative of infinity i.e. that no physical objects occur at the current pixel and only an environmental object is present. In the event that in stage the value of depth buffer associated with the current pixel is less than one in stage ray tracing is performed on the pixel indicated by the current pixel pointer. Ray tracing algorithms are well known to those skilled in the art and thus in the interest of brevity are not detailed.

In stage the current pixel pointer is compared with a last pixel indicator. In the event that a last pixel has not yet been iterated in stage the pixel point is iterated and stage as described above is performed. In the event that in stage a last pixel has been iterated i.e. the scene has been fully prepared in stage the method of returns.

In the event that in stage the value of depth buffer associated with the current pixel is equal to one in stage the pixel color is selected from color buffer associated with the environmental objects stored in stage . Thus ray tracing is not performed for pixels reflecting environmental objects thereby reducing the computational intensiveness of the ray tracing of the scene of stage of .

Thus the present embodiments enable an integrated system providing real time interactive 3D simulation and a mechanism for generating photo realistic views on demand of the real time interactive 3D simulation. By combining the two technologies into one system the invention provides an innovative solution which addresses the needs for both real time interactive 3D simulations and photo realistic results in an automated system which can be operated effectively by a user with basic computer operating skills. Preferably an automated expert system is implemented to optimize the aesthetic results of the ray tracing process.

It is appreciated that certain features of the invention which are for clarity described in the context of separate embodiments may also be provided in combination in a single embodiment. Conversely various features of the invention which are for brevity described in the context of a single embodiment may also be provided separately or in any suitable sub combination.

Unless otherwise defined all technical and scientific terms used herein have the same meanings as are commonly understood by one of ordinary skill in the art to which this invention belongs. Although methods similar or equivalent to those described herein can be used in the practice or testing of the present invention suitable methods are described herein.

All publications patent applications patents and other references mentioned herein are incorporated by reference in their entirety. In case of conflict the patent specification including definitions will prevail. In addition the materials methods and examples are illustrative only and not intended to be limiting.

It will be appreciated by persons skilled in the art that the present invention is not limited to what has been particularly shown and described hereinabove. Rather the scope of the present invention is defined by the appended claims and includes both combinations and sub combinations of the various features described hereinabove as well as variations and modifications thereof which would occur to persons skilled in the art upon reading the foregoing description.

