---

title: Services using globally distributed infrastructure for secure content management
abstract: Secure content management is enabled as a cloud-based service through which security protection and policy enforcement may be implemented for both on-premise network users and roaming users. The global SCM service integrates the security functionalities—such as anti-virus, spyware, and phishing protection, firewall, intrusion detection, centralized management, and the like—that are typically provided by enterprise network SCM appliance hardware or servers into a cloud-based service that users reach via Internet-based points-of-presence (“POPs”). The POPs are configured with forward proxy servers, and in some implementations, caching and network acceleration components, and coupled to hubs which provide configuration management and identity management services such as active directory services.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08296178&OS=08296178&RS=08296178
owner: Microsoft Corporation
number: 08296178
owner_city: Redmond
owner_country: US
publication_date: 20080814
---
This application claims the benefit of U.S. Provisional Patent Application Ser. No. 61 019 739 filed Jan. 8 2008 entitled Globally Distributed Infrastructure for Secure Content Management the disclosure of which is incorporated by reference with the same effect as if set forth at length herein.

Secure Content Management or SCM is a term that is commonly used to describe the functionality provided by security products and appliances that are utilized to protect the IT information technology assets of an enterprise such as a business company or other organization. Such functionality can include for example filtering network traffic into and out of the enterprise for malicious code such as viruses and worms limiting access to inappropriate external content on the Internet from inside the enterprise and preventing attacks and other intrusions on the enterprise network. SCM can also reduce the vulnerability of the enterprise to client side exploits spam e mail and phishing schemes where valuable and or confidential information can be stolen.

Enterprises will often implement security policies that govern asset utilization to meet their particular business needs. These policies typically cover how information in the enterprise is handled who may access information what kinds of information may be accessed and when that information may be accessed permissible and impermissible behaviors auditing practices and the like.

SCM can generally provide excellent protection against known and unknown Internet borne threats for IT assets that are located within the perimeter of the enterprise. However many enterprises are increasingly utilizing mobile IT assets such as laptop computers having for example Wi Fi or other network connectivity functionality. Portable computing devices like smartphones which may support both voice and wireless data communication features such as e mail are also seeing widespread usage.

Existing SCM solutions typically require roaming users to connect back to their company s enterprise network in order to access the Internet. This is often impractical if the roaming user is not close to the enterprise network because of the high latency that would typically be experienced or for other reasons such as lack of support for localization of the user experience. As a result roaming users and other users outside the enterprise network may utilize Internet access provided by Internet service providers ISPs and use public points of access such as Wi Fi hotspots where security protection may not be as comprehensive as protection provided in the enterprise network. This can be a drawback to existing SCM solutions because such mobile IT assets can become vulnerable to security threats and are not subject to the enforcement of the company s security policies when operated outside the premises of the protected enterprise network. In addition while SCM currently provides comprehensive security solutions for business based users SCM solutions for the consumer market have not been developed with the same level of effectiveness.

This Background is provided to introduce a brief context for the Summary and Detailed Description that follow. This Background is not intended to be an aid in determining the scope of the claimed subject matter nor be viewed as limiting the claimed subject matter to implementations that solve any or all of the disadvantages or problems presented above.

Secure content management is enabled as a cloud based service through which security protection and policy enforcement may be implemented for both on premise network users and roaming users. The global SCM service integrates the security functionalities such as anti virus spyware and phishing protection firewall intrusion detection information leakage prevention centralized management and the like that are typically provided by enterprise network SCM appliance hardware or servers into a cloud based service that users reach via Internet based points of presence POPs . The POPs are configured with forward proxy servers and in some implementations caching and network acceleration optimization components and coupled to hubs which provide configuration management and identity management services such as active directory services.

The POPs can be distributed on a large scale basis to ensure that users can access the global SCM service virtually anywhere using a co located POP. Such co location where the POP is relatively close to the global SCM service user enables a high quality user experience with low network latency while simultaneously providing for localization of the experience so that accessed resources such as web pages are appropriately supported in terms of language characters sets currency time zone and other localization criteria.

The global SCM service advantageously provides for securing every interaction e.g. every click of a mouse or pointing device with resources on the Internet regardless of the user s location. The same level of protection quality of security and security policies can be applied to all enterprise IT assets both on premise and mobile in exactly the same way. In addition to extending protection beyond the boundaries of the enterprise network in some implementations by shifting the focus of security away from SCM appliances to one supported by a service model the size of the vulnerability window is reduced as malware signatures may be identified and deployed to the POPs quickly. In addition total costs of ownership can often decrease and deployment of the SCM security solution across all IT assets is simplified when utilized as a service and bandwidth consumption on target resource servers is reduced because the global SCM service load balances users across the POPs and can also filter traffic to the servers through policy enforcement.

In various illustrative examples the global SCM service is arranged to support consumer users who desire to use cloud based security protection. The global SCM service can protect the consumer s networkable computing devices that may be located in the home outside the home while roaming for example at a Wi Fi hotspot at a public library or shopping center or outside the home when a family member takes a laptop away to college. In all these scenarios user preferences parental controls and other options can be maintained by the global SCM service irrespective of where the devices are located much like policies in a business setting can be enforced. In addition the global SCM service provides comprehensive security protection against malware hackers and other threats.

A secure search service may be supported by the global SCM service. In this example the service can check or clean links to the web pages returned as search results to frustrate hackers or spammers who artificially boost rankings of their sites in an attempt to draw users to them.

In cases where a user experience with an Internet based resource such as a website requires a particular resource that a user does not have on the user s local IT device or may be prohibited from using it locally due to policy restrictions the global SCM service can provide the resource on a POP. For example a user may not have a current version of a needed word processing application on the user s local laptop computer or policy prevents a word processing document from opening on the laptop due to concerns for macro viruses. The global SCM may be arranged to open the document at the POP and render the user interface to the document using a Microsoft Terminal Services session HTTP HyperText Transfer Protocol rendering or other remote application deployment.

The global SCM service may implement an enterprise security assessment sharing ESAS arrangement in which a semantic abstraction called a security assessment is created to enable sharing of security related information among different ESAS enabled security endpoints in a POP or among ESAS enabled endpoints in different POPs that are deployed with the SCM service. The security assessments existing in the environment function to provide a security context that gives an ESAS enabled endpoint with a new way to look at its own locally available information. The security context enables an ESAS enabled endpoint to combine or correlate evidence from security assessments received from a variety of different sources and across object types in order to significantly enhance the quality of its detection of potential security incidents and reduces the level of false positive and false negative identifications of security incidents in the enterprise network. The global SCM service can thus extend the advantages and benefits of ESAS to users who are outside the enterprise network i.e. roaming or off premise users while also increasing the number of ESAS enabled endpoints that are available to detect potential security threats.

In addition to security functionality the global SCM service may be arranged to enable users to select a user profiling feature where user clicks captured by SCM service enable the generation of user profile. User specific or profile specific content or processes may then be selected and provided to the user based on the profile to provide an enhanced user experience and or more relevant information.

The global SCM service may be provided under a variety of business models. For businesses the global SCM service may be included in the purchase price of on premise security solutions or provided as attached service which complements the on premise solution typically on a subscription basis. For consumer users the global SCM service may be integrated as a complementary offering to bundled security services that typically provide anti virus anti spyware and firewall protection.

This Summary is provided to introduce a selection of concepts in a simplified form that are further described below in the Detailed Description. This Summary is not intended to identify key features or essential features of the claimed subject matter nor is it intended to be used as an aid in determining the scope of the claimed subject matter.

Like reference numerals indicate like elements in the drawings. Elements in the drawings are not drawn to scale unless otherwise indicated.

Clients to the global SCM service establish access as indicated by reference numerals to the Internet in order to interact with cloud based resources . These cloud based resources may include for example websites FTP file transfer protocol sites databases libraries and the like. As shown in this interaction is facilitated by the global SCM service .

In this illustrative business computing environment three sets of business oriented users are shown users in an enterprise network that generally use fixed IT assets roaming users using mobile IT assets and home based and or telecommuting users that can use both fixed and mobile IT assets. The fixed IT assets typically include personal computers PCs hosts workstations and servers. Mobile IT assets may include networkable devices such as laptop PCs pocket PCs handheld computers smartphones portable e mail clients like Research In Motion s Blackberry devices mobile phones PDAs personal data assistants and the like.

Enterprise network users are subject to security policies which govern the utilization of assets in the enterprise network . In particular the security policies are typically enforced at least in part by one or more security appliances which are also commonly called security gateways which function as network endpoints that operate within the enterprise network . The security policies typically govern which users may access information what kinds of information may be accessed and when permissible and impermissible behaviors auditing practices in the enterprise etc.

The appliances may include for example security products that monitor assess and take action with respect to different parts of security related data within the enterprise. For example the enterprise network may utilize a combination of security products such as a product that protects host computers in the enterprise an edge firewall product a network intrusion detection system NIDS product a network access protection NAP product one or more specialized line of business security gateways information leakage protection gateways and other discrete security products in order to provide security for the various different parts of the enterprise network .

A commercial example of the host security product is the Microsoft Threat Management Gateway TMG product which provides unified malware protection for the enterprise s desktops laptops and server operating systems. An edge firewall is a security product that is arranged to protect the enterprise network from Internet based threats while providing users with remote access to applications and data. The edge firewall may be embodied by for example a Microsoft Internet Security and Acceleration ISA server. The NAP security product performs computer health policy validation by ensuring ongoing compliance with health policies defined by an administrator. Typically access is restricted for computers monitored by the NAP security product that do not comply with system health requirements. The NIDS security product analyzes traffic. The NIDS security product operates to detect malicious activity such as denial of service attacks port scans by monitoring network traffic inside the enterprise network . The line of business security products protect various line of business applications including for example an e mail application such as Microsoft Exchange that is used in the enterprise to provide anti virus and anti spam protection.

Other security appliances that may typically be utilized in the enterprise network include web application protection products UTM Unified Threat Management products SEM SIM Security Event Management Security Incident Management products and operational heath monitoring and configuration management products e.g. Microsoft Windows Software Update Services .

Also operating in the enterprise network are an identity management server e.g. Microsoft Active Directory and an operations management console . The operations management console may be implemented for example using the Microsoft Operations Manager MOM to provide event driven operations monitoring performance tracking security policy enforcement and auditing capabilities. In many implementations the operations management console will be connected to a corresponding functionality that is based in the global SCM service to enable a unified management experience that extends across the local and cloud based security functionalities.

In the present global SCM service arrangement the security functionality provided by the security appliances may be supplemented or replaced by security functionality enabled through the global SCM service . The particular balance between local and cloud based security functionality for a given enterprise network can be selected to meet the needs of that particular implementation.

Currently consumer users typically use host based security applications such as PC based firewalls and anti virus products to provide security protection rather than rely on dedicated security appliances or endpoints that are commonly used in the business computing environment . By comparison in the present consumer computing environment shown in such host based security may be supplemented or replaced by security protection that is provided via the global SCM service .

As shown in the global SCM service is configured with a multiplicity of POPs that are distributed in this example over a comparatively large geographic area. As noted above and described in more detail below in the text accompanying each POP integrates the security functionalities that are typically provided by the SCM appliances in the enterprise network into a cloud based service. Using a multiplicity of POPs in such a distribution enables diversely located users of the service to be served by a POP that is substantially co located. The term co location as used here means that a given POP is close enough to the user to provide a degree of optimization of network operations to minimize latency for example while also providing for appropriate localization of the user experience.

In this example the global SCM service is configured to serve multiple users and user types including both the business based and consumer users shown respectively in . In alternative configurations it may be desirable to have SCM service serve only a specific user type or otherwise be tailored to that user type. Users reach the global SCM service by accessing the Internet as indicated by reference numerals .

In most implementations of the present global SCM service two or more POPs will be distributed over an area or region that is large enough that a single POP would not provide satisfactory network performance or localization. That is as the distance to a POP increases network latency typically increases. In addition as each POP uses forward proxy servers it can become difficult to maintain appropriate localization of the user experience when for example a user is located in one country while the POP is located in another. Accordingly the term global as used here refers to multiple POPs that are distributed to serve multiple local areas. However the term does not necessarily imply worldwide or unlimited coverage in all implementations. The size of the footprint for the distribution of POPs the number of POPs utilized and their geographic location may vary to meet the requirements of a particular implementation.

The POPs are backed by hubs that provide additional functionality and support for the global SCM service . Typically the hubs will be deployed in fewer numbers compared with the POPs so that each hub will support multiple POPs. While the precise ratio of POPs to hubs can be expected to vary according to the needs of a specific implementation in a typical large scale roll out if hundreds of POPs are utilized then perhaps dozens of hubs could be deployed. An operations center is also utilized in the global SCM service . While a single operations center is shown in this is merely illustrative as more than one operations center may be utilized depending upon the requirements of a specific application of the present arrangement.

In this example each POP includes a Microsoft ISA server that provides integrated firewall forward proxy and network performance enhancement features. The firewall function includes for example HTTP application layer filtering to govern HTTP inbound and outbound access to the cloud based resources according to rules or policies as described below. URL Universal Resource Locator filtering and anti virus functions may also be directly supported in the firewall. As a forward proxy the ISA server stands in the way of the Internet and receives data from users bound for the Internet and forwards it on their behalf. The network performance features of the ISA servers include among others object caching HTTP compression to eliminate redundant data during transmission of HTTP packets and packet prioritization using quality of service QoS enforcement methodologies. Configuration and management information for the ISA servers are stored in the enterprise management system EMS servers in the hubs .

POPs are also configured to include policy databases which contain security policies that govern access to and interaction with cloud based resources by users of the global SCM service . In accordance with the present cloud based service paradigm the policies can be tailored to specific users and groups of users. Thus for example a company operating IT assets in the business computing environment shown in can duplicate its policies from its own enterprise network onto the Internet cloud via the global SCM service . The duplicated polices would then be enforced for example for roaming users and home based and or telecommuting users when they access the cloud based resources when outside the perimeter of the enterprise network . In an alternative configuration the policy databases or portions thereof may be centralized within one or more of the hubs as indicated by the dashed lines. The policies in databases may also be managed by the EMS servers in the hubs. However the POPs will generally be configured to replicate all functionality necessary to implement security and policy enforcement in case a connection to a hub is broken.

In this example operations management consoles are supported in the POPs . The functions provided by the consoles are essentially similar to those provided by their counterparts in the enterprise network . Operation management consoles enable the security products and policies in a POP to be configured monitored and audited according to an enterprise network administrator s instructions or service agreement with the enterprise. While supported in the POPs the operations management consoles can typically be expected to be operated from the hubs . In some implementations the operations management consoles will either be solely deployed in the hubs or replicated in the hubs so that the operations management functionality is replicated in both the POPs and the hubs . As noted above the operations management console functionalities can be extended and unified to enable administrative functions to be performed on remote devices as if they were co located on the premises of a given enterprise.

In some implementations the operations management functionalities or subsets thereof can be configured for remote access by administrators. In other implementations operations management functionalities in the POPs are reserved for use by global SCM service provider personnel.

User profiling functions are also supported in the POPs . User profiling is described in more detail below in the text accompanying .

Hubs may include active directory servers or other types of identity stores that support respective Active Directory and other identity management services for managing identities and relationships for users in the business computing environment shown in . The Active Directory service enables for example user authorization and authentication as well as single sign on capabilities for cross domain resource access. Typically Active Directory data will be synchronized with the Active Directory server in the enterprise network to a hub . In this case synchronization between the servers can be implemented using a one way or two way trust arrangement to enable policies and reports for example to be expressed using the same user name and groups.

Active Directory services may also be utilized to support authentication and authorization for users in the consumer computing environment shown in who use or subscribe to the global SCM service . Alternatively user and or subscription information may be supported in subscriber databases in the hubs as required to implement identity management for the consumer users of the global SCM service using for example the Microsoft Live ID service formerly known as Microsoft .NET Passport or federated identification services.

The hubs are supported by the operations center which contains one or more operations servers to facilitate the overall configuration management and monitoring of the global SCM service from a central location.

In the first arrangement roaming users are respectively using a smartphone and laptop that uses an intermediate device such as a wireless PC card or mobile phone as shown as a modem. The wireless mobile data network could be for example one of GPRS General Packet Radio Service EVDO Evolution Data Optimized or UMTS Universal Mobile Telecommunications System . The devices wirelessly connect through a nearby cell tower to the data network to establish access to the Internet as indicated by reference numeral .

In the second arrangement a roaming laptop user establishes Internet access as indicated by reference numeral through a public Wi Fi hotspot which provides a network bridge to a network gateway operated by the ISP . A home based PC user on a local area network running Ethernet for example makes an Internet connection through a network bridge like a cable modem or DSL digital subscriber line connection to the ISP gateway . Although a single ISP and gateway are shown in it is noted that the present global SCM service can work with any form of Internet access that a particular IT device or user employs. Accordingly multiple different ISPs can be utilized depending on the requirements of a given implementation. ISPs commonly provide Internet access to both consumers and businesses although the equipment connection type and service agreements for the service will typically vary.

As shown in the flowchart shown in in both access arrangements shown in once an Internet connection is established a user may access the global SCM service by pre provisioning unified host name for example HTTP scmproxy.com . This host name is resolved using a DNS Domain Name System lookup to an IP Internet Protocol address for a global load balancer not shown in the drawings . The global load balancer ascertains the geographical location of the user so that the user may be redirected to the an appropriate POP . It is noted that location may be one of several factors that may be utilized in determining to which particular POP a user is redirected. For example restrictions imposed by licensing and other commercial considerations security consideration and other factors may also be used in various implementations.

The location of the user may be determined in a variety of different ways. For users who gain Internet access using the wireless mobile data network in the location of the user can be determined by coordinates of the cell tower . Alternatively some mobile devices are equipped with GPS Global Positioning System features which can also be utilized to identify the location of a user.

For users gaining access using an ISP a number of techniques exist for identifying a geographical location of the user based on IP address supplied by the ISP. Typically a geographical location at the country or region level may be readily determined by mapping the IP address to locations contained in a geo location database. While location may be resolved with even more specificity e.g. to the city or ISP location accuracy typically falls off and not all geo location databases are complete and reliable for all locations in the world. However accuracy is typically sufficient to redirect the user to a co located POP for purposes of network optimization and localization.

Another technique for locating a user based on IP address uses the LOC record for an ISP s server as described in RFC 1876 Request for Comment by the Internet Engineering Task Force or IETF . More particularly location information of a server including latitude and longitude is often placed on the DNS registration page. By performing a reverse DNS lookup a server associated with a given IP address can be determined and the LOC record for that server retrieved. While not all servers have LOC records this technique may still be useful in some implementations or to supplement other IP address geo location techniques. However it is noted that such techniques are intended to be illustrative and that other techniques and methods may also be used depending on the requirements of a particular implementation.

Once redirected to an appropriate POP the user is authenticated and authorized for example using the Active Directory service as described above or via a Live ID service or federated identity management service. The user may then take advantage of the features and functionalities provided by the global SCM service including for example security policy enforcement and profiling which can be applied to every user interaction or click on the cloud based resources shown in .

An illustrative example in which an ESAS arrangement is implemented using the present global SCM service is now presented. In an enterprise computing environment for example an office of a business a number of personal computers workstations servers and the like along with other devices such as mass storage subsystems internal network interfaces and external network interfaces are typically interconnected to provide an integrated environment in which information may be generated accessed from external sources and shared among various users. Commonly users perform a variety of operations including order receipt manufacturing shipping billing inventory control document preparation and management e mail web browsing and other operations in which creation access and sharing of data is beneficial.

Currently security is typically provided for an enterprise using a variety of different security products e.g. security products in that are each normally arranged to monitor only a partial portion of enterprise wide data. That is security products are arranged as separate local islands where each product monitors assesses and takes action with respect to different parts of the data within the enterprise. For example the host security product edge firewall product NIDS product NAP product and other discrete security products typically provide security for the various different parts of the enterprise.

While these security products often perform satisfactorily in many applications detection of security incidents often suffers from undesirably high levels of false positive and false negative occurrences as a result of the monitoring of only partial enterprise security data. It has also been difficult to provide effective common management across all the enterprise security product islands. Current attempts to correlate enterprise wide security data have high management and maintenance costs and have problems in scaling. Accordingly ESAS provides a single enterprise wide view to enable security administrators to define and enforce clear simple and unified enterprise wide policies for automatic responses to security incidents.

As noted in the Summary section above ESAS relies upon a semantic abstraction called a security assessment that enables sharing of security related information between different security products called endpoints in an enterprise security environment. A security assessment is defined as a tentative assignment by an endpoint of broader contextual meaning to information i.e. data in some context that is collected about an object of interest in the environment such as a computer user service e.g. a website data or the enterprise as a whole. The security assessment utilizes a concise vocabulary for an endpoint to declare that an object in the environment falls into a particular assessment category such as compromised or under attack along with the severity e.g. low medium high critical of the detected incident.

A security assessment is tentative because it is subject to some uncertainty and is valid for a limited period of time. The tentative nature of a security assessment is reflected in two of its components a fidelity field which expresses the level of confidence the endpoint has in its assignment of contextual meaning and a time to live TTL field which reflects the endpoint s estimate of the time period for which the security assessment is expected to be valid. Thus for example a security assessment may be used by an endpoint to declare in light of that endpoint s current understanding of one or more security incidents that a particular machine is compromised with a critical level of severity with medium fidelity and having a TTL of 30 minutes. A variety of types of security assessments may be used in any given enterprise security environment having for example various combinations of assessment category and object type.

Endpoints are enabled with functionality to publish security assessments onto a security assessment channel operating in the environment as well as subscribe to a subset of available security assessments published by other endpoints. The security assessments existing in the environment that are active i.e. those having a TTL which indicates the assessments are still valid function to provide a security context that gives such ESAS enabled endpoint a new way to look at its own locally available information. That is the security context enables the ESAS enabled endpoint to combine or correlate evidence from security assessments received from a variety of different sources and across object types in order to significantly enhance the quality of its detection of potential security incidents. The ESAS enabled endpoint then makes a decision as to what local action or response is appropriate for each type of security assessment whether received from another endpoint or internally generated by the endpoint itself in accordance with a set of response policies. Incident detection is both efficient and cost effective because the security context enables distributed processing of enterprise wide information in the form of security assessments without the burden of sharing large amounts of raw data throughout the enterprise most of which is completely irrelevant due to the lack of any context . ESAS enabled endpoints are further arranged to roll back the local action upon expiration of the security assessment that prompted the local action i.e. when the security assessment exceeds the time to live specified in the TTL field .

In most typical ESAS implementations a specialized endpoint called an ESAS central server is utilized. The ESAS central server is coupled to the security assessment channel and performs as a centralized audit point by subscribing to all security assessments logging the security assessments and also logging the local actions taken by endpoints in response to security incidents in the environment. The ESAS central server provides administrators with a comprehensive view of the history and current status of the enterprise as a whole and of each ESAS enabled endpoint. The utilization of the security assessments enables an administrator to compactly and efficiently configure response policies to incidents that are detected across the entire enterprise. The security assessments function as natural anchors or starting points to define enterprise wide security response policies. A streamlined and consistent management interface is thus enabled to define the desired responses for each type of security assessment across the entire enterprise.

The ESAS arrangement provides a number of advantages. By employing a security assessment having a concise vocabulary overall data complexity in the enterprise is drastically reduced and only meaningful information is shared between endpoints. Use of the security assessment also eliminates the need to collect large amounts of raw data in a central storage location and thereby enables highly scalable enterprise security solutions to be built on a very cost effective basis. In addition a new endpoint may be readily deployed with on demand extensibility. Security assessments may be shared between the new endpoint and existing endpoints without the need to reconfigure any of the response policies within existing endpoints. The new endpoint simply functions as a new source of security assessments using a semantic abstraction that the existing endpoints already understand. The utilization of security assessments also enables enterprise wide security policies to be established using a very compact and clear methodology without needing to understand all of the possible security events that every endpoint may generate in the enterprise and then try to describe the responsive action for each event.

Turning now to an illustrative ESAS arrangement deployed in the enterprise network is shown in which a security assessment channel is provided to enable a security assessment to be shared among multiple endpoints using a language protocol that is commonly utilized at each endpoint. The security assessment channel facilitates a publish subscribe model used by the endpoints for connecting the sources of security assessments publishers to the consumers of the security assessments subscribers . As shown both the publishers and subscribers on the security assessment channel are endpoints .

The endpoints are isolated from the mechanics of the actual transport and management of the publish subscribe model through a semantic abstraction layer that is arranged to simplify interactions with the security assessment channel . The abstraction layer comprises tables describing the security assessment types to which the endpoints subscribe and tables describing the security assessment types that endpoints publish as described below not all endpoints generally subscribe to all security assessment types . In addition the abstraction layer provides an API application programming interface for reading received security assessments and an API for generating security assessments.

A specialized endpoint ESAS central server is coupled to the security assessment channel and performs as a centralized audit point for the ESAS arrangement . Accordingly the ESAS central server subscribes to all security assessments and permanently logs them. ESAS central server also receives and logs messages from the endpoints that indicate the local actions that are taken by an endpoint. The ESAS central server thus provides administrators with security assessment monitoring functionality that gives a comprehensive view of the history and current status of the enterprise as a whole and each ESAS enabled endpoint.

Third the subscribing endpoints and the ESAS central server which receive the security assessment apply their specific security expertise through the application of their own correlation rules and locally available data to trigger an appropriate action. As collectively indicated by reference numeral in the host security endpoint performs an on demand scan. The NAP endpoint revokes the IP security certificate for the identified compromised client and implements a port shutdown. The line of business security endpoint temporarily suspends instant messaging IM traffic to the compromised client based on the received security assessment. The ESAS central server raises an alert for a security analyst e.g. an administrator and also logs all of the security assessments and actions invoked.

The first illustrative scenario described above provides a case where the endpoint detecting the suspicious incident generates a security assessment with high severity and high fidelity i.e. the endpoint has a high degree of confidence that it has validly detected a serious incident . By comparison is a diagram of a second illustrative scenario in which a low fidelity security assessment is sent over the security assessment channel that triggers the generation of a high fidelity assessment by a receiving endpoint which also performs cross object mapping.

This second illustrative scenario is also described in three stages. As indicated by reference numeral the edge firewall first detects a large number of client connections to the perimeter network . However unlike the first illustrative scenario shown in and described in the accompanying text the number of connections being established by the client is not so high that the edge firewall can be absolutely certain that the client has been compromised. In current enterprise security systems when an endpoint sees such data it generally just drops the data and takes no action as there is not enough evidence to warrant the typically harsh response such as disconnecting the machine. By comparison in the present scenario the edge firewall in the second stage sends a security assessment over the security assessment channel that indicates that the particular client is compromised with medium severity and low fidelity as indicated by reference numeral .

Here the subscribing endpoints to the particular object referenced in the security assessment generated by the edge firewall include the host security endpoint and the ESAS central server . While such a low fidelity data normally does not trigger an action to be taken at an endpoint in current security products in accordance with the present enterprise security assessment sharing the host security endpoint looks at its own local data differently in light of the received security assessment from the edge firewall . In this case the local data resulting from an on demand scan at the host security endpoint and the information contained in the security assessment from the edge firewall are used to generate new assessments and . Thus the host security endpoint has information that by itself does not warrant the generation of a new security assessment but when reinforced with even a low fidelity assessment from another endpoint as in this case there is sufficient evidence to justify the creation of the new security assessments and which each have high fidelity.

The host security endpoint places the new security assessments and onto the security assessment channel . The new security assessments and are received over the security assessment channel by the subscribing endpoints which in this illustrative scenario include the edge firewall and the ESAS central server for security assessment and line of business endpoint for security assessment .

Note that the line of business endpoint was not a subscriber to the original security assessment produced by the edge firewall because the reference object type is a machine and the line of business endpoint by virtue of its role in protecting e mail is typically concerned with the users. However in this second illustrative scenario the host security endpoint maps from a host object type to a user object type when it generates a new security assessment . Such cross object mapping capability may be beneficial in many scenarios as it is contemplated that a high severity incident such as malware or malicious activity that potentially compromises the data confidentiality or integrity of a host computer may also potentially compromise the user as well. A security assessment may be generated that cross maps the high severity incident from the host object type to a user object type with a certain degree of fidelity. Similarly a critical severity incident in which malware or malicious activity has actually caused a loss of data integrity on a host computer a security assessment for a user object type may be generated with even higher fidelity.

In stage three the new security assessments and trigger a variety of respective actions at the receiving endpoints as collectively indicated by reference numeral . Specifically the edge firewall blocks all access by the compromised client with the exception of software updates and or mission critical access. The line of business endpoint temporarily suspends outgoing e mails. And as with the first illustrative scenario the ESAS central server continues to log all assessments and actions. As noted above such restrictions are enforced only during the period of time for which the TTL associated with the new security assessments and remains valid. When the new security assessments expire the actions taken by the respective endpoints are rolled back unless the TTL is extended or a new security assessment which invokes the restrictive actions is received.

The host security endpoint reviews the received security assessment and applies its specific security expertise using correlation rules and any relevant locally available data. In this illustrative example the host security endpoint responsively generates a new security assessment containing a user object type to which the line of business security endpoint subscribes.

In the third stage of the scenario the remediation techniques employed by the endpoints are considered expensive in terms of their potential impact on business operations within the enterprise environment . For example as indicated by reference numeral the line of business security endpoint implements a response policy that entails temporarily suspending outgoing e mail. In addition the host security endpoint performs an on demand scan and if no results are achieved performs a deep scan. While such remediation techniques can be very effective in addressing malware malicious users and other problems they typically impart significant expense to the enterprise. For example a user whose outgoing e mail is suspended will be less productive and deep scanning typically requires one or more reboots which will remove the machine from service for a period of time.

The ESAS arrangement advantageously enables these effective albeit expensive remediation techniques to be applied in a targeted manner and not merely in a general way or across the board which can be unjustified for some machines and or users. Only objects in the environment that are deemed suspicious using pre defined criteria will be subject to these particular remediation techniques.

As shown in the global SCM service may be advantageously utilized to optionally extend and expand the ESAS security channel shown in and described in the accompanying text. In particular the security assessment channel may be extended into the Internet cloud to couple to security endpoints i.e. security products that are located in the POPs as indicated by reference numeral . While shows the POPs being coupled to the extended ESAS security channel there is no requirement that each and every POP used in a particular implementation of the global SCM service be so coupled. In addition it may also be possible to use a dedicated ESAS security channel that is not an extension from an existing ESAS security channel in an enterprise.

The global SCM service enables the extension of ESAS to include security assessments to be both sent and received by security endpoints that are located in the POPs . The enhanced security that ESAS provides can thus be applied to the enterprise s IT assets that are located outside the perimeter of the enterprise network including the home based and or telecommuting users and roaming users . In addition the ESAS system itself may be enhanced by increasing the number of deployed sensors that are available to detect potential security threats.

In this illustrative example the ISA server in POP generates a security assessment when it detects for example a potentially compromised laptop being operated by one of the roaming users . The security assessment indicates that the laptop is compromised with high severity and high fidelity with a TTL value of 30 minutes. The security assessment is published into the extended ESAS security assessment channel and received by the subscribing endpoints including endpoints and the ESAS central server in the enterprise network as well as those in other POPs as indicated by the arrows in . The security assessment will also typically be shared locally among endpoints in the POP over a locally deployed security assessment channel as shown in more detail in and described in the accompanying text. Endpoints receiving the security assessment will take responsive local actions perform cross object mapping implement targeted remediation etc. as described above in the text accompanying according to local response policies.

As shown in endpoints in POPs may use the extended ESAS security channel to subscribe to and receive security assessments that are generated by security endpoints in the enterprise network . Here an illustrative security assessment is generated by the edge firewall when a security incident affecting a computer in the enterprise network is detected. The security assessment indicates that the computer is compromised with high severity and high fidelity with a TTL value of 30 minutes.

Subscribing endpoints in the enterprise network and in the POPs receive the security assessment from the security assessment channel as extended by the global SCM service . In this example in accordance with response policies the host security products in the enterprise network and POPs perform on demand scans of the IT assets respectively used by users in the enterprise network the home based and or telecommuting users and the roaming users .

In addition to being usable to complement the extended ESAS functionality described above in the text accompanying the local ESAS arrangement may be used independently of ESAS implementations used in an enterprise network environment. For example as shown in multiple households or groups of consumer users are connected to the global SCM service . Each household can take advantage of ESAS by virtue of the comprehensive suite of security products in the POP and the widespread distribution of sensors for detecting security incidents that accompanies the global scale of the SCM service.

As the global SCM infrastructure is shared among the consumer user groups and the individual households can be aggregated as ESAS clients consumers gain the benefit of improved security incident detection and handling in a cost effective manner. For example a security incident detected affecting an IT device in one household can trigger a scan of IT devices in a second household . Without the aggregation provided through the global SCM service and the benefits of ESAS it allows the IT devices in the second household might otherwise be vulnerable.

In some implementations where an ESAS architecture is locally implemented in one or more POPs in the global SCM service security assessments and local responses can take into account such factors or characteristics for example as demographics user profile Internet use habits or user preferences. Such factors may provide additional security context or affect how a particular local response is implemented to enhance the quality of the security protection for the consumer. In addition consumers having similar characteristics may be grouped for purposes of security assessment generation and sharing so that security detection and responses are well tailored to meet particular consumer needs. Use of such factors or characteristics is optional. When utilized the consumer may be informed that some data about the user will be collected for the purposes of enhancing security and the consumer is given the opportunity to provide consent before any data is collected.

The ESAS architecture that is locally implemented in a POP as shown in may also be extended to other POPs in the global SCM service as shown in . In this illustrative example a global security assessment channel is established between two or more POPs . Security assessments such as an illustrative security assessment may be generated and shared among security endpoints in different POPs . Utilization of security assessments over the global security assessment channel enables ESAS to be distributed among users over larger geographic area than is served by a single POP .

In this example the user accesses and interacts with cloud based resources through the global SCM service as described above. Because each interaction or click may be monitored by the global SCM service through the POP as indicated by reference numeral a user profile for users of the service may be generated and stored. User specific or profile specific content may be responsively generated and provided to the user as indicated by reference numeral to increase the relevancy of the content to the user. Such content and processes may include for example targeted advertising and search results advanced caching such as pre fetching on a personalized user profile basis or personalized web based experiences. By having the ability to see every user click on the Internet more accurate user profiles can be generated so that the provided content or processes are better suited to the specific user.

Although the subject matter has been described in language specific to structural features and or methodological acts it is to be understood that the subject matter defined in the appended claims is not necessarily limited to the specific features or acts described above. Rather the specific features and acts described above are disclosed as example forms of implementing the claims.

