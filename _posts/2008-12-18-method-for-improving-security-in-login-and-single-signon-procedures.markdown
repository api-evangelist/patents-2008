---

title: Method for improving security in login and single sign-on procedures
abstract: In a method for improving client's login and sign-on security in accessing services offered by service providers over shared network resources such as Internet and particularly working within the framework of the www, a password is created for the client at a first attempt to access the service provider. The client's password is generated either at an authentication authority in trust relationship with the service provider and transmitted to the client, or the client is allowed to create his or her password on the basis of random character sequences transmitted from the authentication authority. For subsequent access to the service provider the authentication authority presents a client for characters in ordered sequences or in a diagram containing in an appropriate order a single occurrence of each password character. The client performs a selection of the password for validation and transmits the validation back to the authentication authority, which verifies the password and informs the service provider of the verification. In a most preferred embodiment the password characters are never transmitted between the authentication authority and the client in a validation and verification procedure, and the former is wholly disconnected from either the client's credentials or any transactions subsequently to be undertaken between the service provider and the client.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08453221&OS=08453221&RS=08453221
owner: Microsoft International Holdings B.V.
number: 08453221
owner_city: Amsterdam
owner_country: NL
publication_date: 20081218
---
This application claims priority under 35 U.S.C. 119 to application NO 20076550 filed Dec. 19 2007 which is hereby incorporated in its entirety by reference.

To be able to build a so called ecosystem around services offered on the World Wide Web www every participant in the ecosystem needs to be authenticated before accessing resources controlled by the service provider. This requires a single sign on system.

There are numerous challenges to single sign on scenarios. One of the hardest is the challenge of preventing fake input forms at malicious websites for usernames and passwords. A fake site with a fake login form can acquire the username and password of any user. A normal user or client would typically not hesitate to input his credentials if the input form looked visibly like the input form he or she uses at other sites.

The present invention concerns a method for improving clients login and sign on security in accessing services offered by service providers on shared network resources such as Internet and particularly from service providers working within the framework of the world wide web wherein a client in order to gain access to the goods and services offered by the service provider initiates a creation of an account in the client s name at the service provider wherein the client sends the service provider a chosen user name when receiving a message that an account has been created wherein all communication in connection with transactions carried out between a client and a service provider takes place on shared network resources.

A typical login page as would be offered on a web service is shown in which is the login page for Yahoo s mail.

Presently it is acknowledged that in order to provide a secure sign on the site must be able to validate itself to the user and the validation should be done in such a way that the user cannot skip or overlook that part. For instance a frequently used schema where the user needs to verify the URL Uniform Resource Locator and SSL Secure Socket Layer padlock icon will not suffice. Further in order to be generally usable by the web or client community secure sign on should rely on basic web technologies.

Microsoft Passport has no solution to this problem and it has been one of the main reasons why Microsoft drew back its support for Passport login at 3party sites. For this reason currently only Microsoft or Microsoft partner companies use Passport.

Yahoo has just released what they call BBAuth Browser Based Authentication . BBAuth features sign on seal which is a very simple mechanism for enabling the user to verify the login site. Typically a user selects a color and this color is displayed every time the user logs in. If the color is not displayed the user must not enter his password because that indicates that he is not connected to the correct server.

The Yahoo approach is insufficient in numerous ways. The most important point is that it is up to the user to do the authentication. Typically users do not do this authentication. The sign on seal could simply be replaced with blank space or a message saying something like the cookies on your computer are not accessible and therefore the sign on seal is not visible .

The Yahoo solution also gives the user a new sign on seal for each computer the user uses. It can then be very confusing and not easy to remember which colors are good and which are not. Also if cookies are lost the sign on seal is also lost and it can be very hard to separate between a malicious site and just lost cookies.

Current web services offered on shared resource networks like Internet have seen a phenomenal growth in the later years and today have hundreds of millions of users worldwide. A comparable amount of transactions involving networking is likewise carried out every day in connection with the use of web services. Since a huge amount of these transactions is of a commercial nature or involves transfers of funds and buying and selling securities valuables goods and services these web services have increasingly been made the victims of phishing which is the attempt to criminally and fraudulently acquire sensitive information particularly usernames passwords and credit and banking card details as commonly used for securing and paying for transactions involving web services. Typically phishing entails masking as a trustworthy entity in an electronic communication situation and is typically carried out by email and instant messaging. As shown in it often directs user to enter details at web sites. An improved password protection would thus be desirable and severely curtail phishing attacks on a user s banking and commercial activities involving web and networking services.

In view of the weaknesses and shortcomings of currently used login and sign on procedures it is a main object of the present invention to provide a method for improving the security in single sign on SSO procedures.

Another object of the present invention is to avoid an inadvertent disclosure of a client s password when the latter signs on to an account or web service via any shared network resource e.g. Internet. The above objects as well as further features and advantages are realized with a method according to the invention which is characterized by steps for

In an advantageous embodiment of the method according to the present invention the password is created in step b at the authentication authority and the password is transmitted to the client via a secure electronic mail connection or as an SMS.

In another advantageous embodiment of the method according to the present invention the password is created in step b at the client by transmitting an ordered sequence of strings of random characters such that no string contains the same character twice and the client is allowed to select one character from each string to form a password of characters ordered in the same sequence as the strings whereafter the client transmits the selected password to the authentication authority.

In yet another advantageous embodiment of the method according to the present invention one or more dummy strings are generated with same number of random characters as the strings comprising the password characters such that the dummy strings contain no occurrence of a password character said one or more dummy string s being interspersed as dummy columns in the array at arbitrary chosen positions whereby said one or more dummy string s on aligning the columns comprising the password can be arbitrarily displaced relative to each and every other column of the array.

A particularly preferred embodiment of the method according to the invention shall now be described in more detail. This embodiment envisages that method is implemented on a system for user or client identification and authentication and comprising the following three agents.

In order for the method to work properly the following relationships between the agents are recognized.

The problem to be solved in order to provide a secure single sign on method can then be formulated as follows. How can the client identify himself or herself to the initially untrusted service provider by using the authentication authority without exposing the authentication credentials i.e. the password to the untrusted service provider 

The solution to the problem is to make the creation of the login page dependent on already knowing the client credentials. The login page should be created in such a way that it is impossible for the client to expose his credentials if it is not created correctly. That way a service provider that does not already know the credentials of the client cannot create the login page on which the client is able to expose his credentials.

Service providers that have entered into an agreement with the authentication authority have a trust relationship with this authority and can get the pre created login page from the authentication authority and display it to the end user.

Service providers that have not entered into an agreement with the authentication authority and that have no trust relationship with the authentication authority cannot get a pre created login page from the authentication authority.

Since the creation of the login page is dependent on already knowing the client credentials service providers that do not have a trust relationship with the authentication authority cannot get hold of a pre created login page.

Since an incorrectly generated login page makes it impossible for the client to enter his or her credentials the credentials are not exposed to untrusted parties and thus they stay protected.

The preferred embodiment will typically be performed in a web service ecosystem. Assuming a client wants to establish an account with a service provider the client will upon request enter at a user name and may create a client profile comprising various client credentials. The service provider then from a web server requests the authentication authority to generate a password for the client. The password is generated initially as a finite sequence of characters. Typically the characters is selected from a subset of characters defined in the standard or extended ASCII code and can thus be taken as alphabet upper and lower case letters the integers 0 9 as well as a number of other graphic symbols.

The authentication authority would then store the created password in a protected server memory and send the password once to the client using a secure link for the transmission for instance a secure email link or relaying the password via SMS Short Message Service to the client s mobile device supporting such a transmission. In any case the password shall not be known to the service provider.

When a client then subsequently accesses the web server of the service provider for login the client will be requested to enter an already given username. Now instead of asking the client to enter his password the service provider according to present invention requests the authentication authority to transmit the password to the client for verification.

In the following the above stated particularly preferred embodiment shall be discussed with emphasis on its technical implementation.

The transmission of the password is done as follows. The authentication authority having established a trust relationship with the service provider creates a number of sequences or strings of random characters chosen from the same code as used the for the creation of the password and with a number of strings being at least equal to the number of characters in the already created password such that each string in a generated order contains one and only one character from the password. Typically each string of random characters could be created as a string of ten characters as shown in . The strings are in the order given by the sequence of password 30 characters which here are shown as ato afor the first string bto bfor the second string and so on. The created password is shown indicated in bold type. Each string comprises one and only one occurrence of a password character. The strings can now be presented in a login page submitted to the user from the authentication authority when the latter is requested by the web service to present the already generated password to the user. The client can then from the strings of random characters presented in the correct order select each character of his already received password by clicking on the symbol of the string in the correct order. Thus with the password example above the user must click on respectively ain the first string bin the second string cin the third string din the fourth string and ein the fifth string. It is of course to be understood that the characters a b c etc. as shown represent different characters chosen e.g. among a subset of characters in the ASCII code with the understanding that no a or b or c etc. is identical i.e. all characters of a string are different.

The input of the password to authentication authority is not based on the keyboard with the exception of arrow keys TAB and ENTER but rather on the position of each character selected in the character strings as presented for the client.

In order to facilitate the client s password validation procedure the character strings could be represented as an array diagram as shown in . Again the same random sequence of characters is used for each string as in and the password example is the same. The login page presents this to the client on his or her computer screen or display device as an array of five columns and ten rows containing fifty randomly selected characters taken for instance from the ASCII code. Note that the only requirement is that each string shall be in the correct order and contain only one occurrence of each character of the password character sequence but there is no requirement that different characters otherwise should be used for the different strings or columns of the array as shown in . For instance may a character that is used in the first position in the password also appear in random position in any of the other strings or columns as shown in .

The client now clicks on the correct character in each string or alternatively displace each column vertically forming the correct abcdepassword aligned in one and the same row as shown in . A specific pattern or diagram is formed by the displaced strings or columns or as they also could be called sliders. This pattern is of course dependent upon the client selecting the correct password and moreover the correct alignment of that password here shown as characters abcde. The pattern created by the client completing the selection of characters of the password by a correct displacement of the sliders or columns is relayed back to the authentication authority as a positional code or simply as an image which anyway would be the preferred mode of communicating the array as disclosed herein between the authentication authority and the client. Again of course no keyboard input is used in entering the password as this simply is done by dragging the columns or sliders to align the correct password character on one and the same row.

As persons skilled in the aft will realize it is assumed that the authentication authority who created the password initially shall know the password so the characters making up the sequence in each string shall include one occurrence of the correct password character of the string while the remaining 9 characters are selected at random and the actual positioning of the password also chosen randomly. What is needed for the client to validate the password by a correct selection of the characters thereof and as presented while the authentication authority performs the verification. The client cannot freely input any credentials and thus the client s credentials will not be exposed in the communication taking place for validating and verifying a password.

For ensuring strict security this preferred embodiment always relies upon an authentication authority up to the creation of the masked password or presentation diagram in the login page but password verification might also involve the service provider in a straightforward manner.

However in order to optimize the security only the authentication authority s verification of the client s password is provided to service provider. This is advisable since the service provider in order to perform any required transaction must be in the possession of the client s credentials usually what is termed the client profile including details concerning payment methods credit cards etc. as well as the username and mail addresses. No credentials of this kind is presented by the client to the authentication authority which only is in possession of knowledge of the password and the verification of the password as selected by the client from the presentation form in the login page. No transmission of the client s credentials is involved in the password creation validation and verification procedures. On the other hand the service provider need not necessarily know the client s password only that this has been verified. Only the dialog between a service provider and a client can transfer to the transaction stage.

If it is required by the service provider to authenticate the client s password no communication of the password from the service provider to any other party shall take place and in any case password acknowledgment by the client and the verification by any other party shall be completely decoupled from the client s credentials. The password characters as transmitted from say the authentication authority will be masked in the random symbol sequence making up each string in or each column if it is sent in the form of a presentation diagram as illustrated in . The password being masked in this manner shall make it very hard to reveal by a phishing attempt.

In another but perhaps less preferable embodiment of the present invention the client is allowed to create his own password. As before upon a first attempt to login or on an attempt of establishing an account with the service provider or a web service for the first time the latter sends a command to the authentication authority in order to have the client s password created. Instead of now creating the password at the authentication authority the authentication authority instead for instance selects an appropriate number of random characters taken from e.g. as before a subset of the ASCII code and transmit the strings of random characters to the client preferably presented in the form of an array as shown in . The client is now allowed to select the password by choosing one character from each of the strings or columns as presented. As with the validation of an already created password the selection of a password can take place by an appropriate mutual displacement of the columns of the matrix in to form for instance the password as the sequence abcdeas indicated by bold characters in . The diagram is transmitted from the client back to the authentication authority as a positional code or image with the provision that the position of at least one preferably not more than one character of the password in a column must be indicated. The positional code is usually given with reference to the first column but the position as indicated for one of the password characters could refer to a position in a specific column. For instance for column the password characters will intrinsically be at position but for instance at 4 if the position of the first character in the first column is taken as 0. Of course there is always an alternative to transmit the client created password as the sequence of the selected characters via a secure link or as an SMS message to the authentication authority. This embodiment has the advantage that the client cannot freely choose the characters for the password but is obliged to select the characters from each one of strings of random characters. Thus the inherent tendency of users and clients to select password with altogether easily recognizable mnemonic patterns is largely avoided.

In order to further increase the security in the password validation an arbitrary number of dummy strings could employed by the authentication authority and these dummy strings could then be interspersed as additional columns in the array as shown in . An array with dummy columns would then appear as shown in where three dummy columns have been added to the five columns containing the password characters. The characters of the dummy columns are chosen in the same manner as they are for the passwords shown in the above mentioned figures. In the diagram of columns and are dummies and preferably comprise no characters occurring in the password. When the client is presented with the array as shown in for validating the given password as abcde the alignment of the password characters is done in the same manner as discussed in connection with the password containing columns or sliders are displaced such that the password characters from each column appear aligned on one and the same row. The dummy columns can then be ignored as the client will not find any password character in these. Nevertheless the dummy columns can also be displaced arbitrarily but preferably such that at least two or more rows of the array extend unbroken over all columns constituting the array. On returning the transformed pattern or image as shown in with the correct password indicated to the authentication authority the client s validation of the password is verified from the pattern as the authentication authority ignores the known dummy columns and reconstitutes the correct pattern from the columns and containing the correct password characters as aligned by the client. Anyway the arrangement with dummy strings included to form the columns of the array shown in shall enhance the security as it would be impossible to know the actual number of characters in the password and although an aligned row comprises the password characters there are more characters on this aligned row than the actual number of characters in the password. In addition there will of course be other rows that are aligned but the client performing the alignment of the columns by displacing or sliding the latter shall not reveal the actual constitution of password. Verification at the authentication authority takes place on identifying the correct pattern of displaced columns and a verification statement issued to the service provider or web service.

If the seven bit ASCII code is used the authentication authority will have at its disposal a subset of about 9S characters to choose from and without any repetitions there will be 95 85 3.7 10possibilities for a random sequence of characters ignoring the ASCII control code and performing the character selection without return. The allowable permutations can be calculated for the other columns keeping in mind to remove one pattern from the second column two patterns from the third column and so on as no two patterns shall repeat. Moreover it is easily seen that for any chosen set of random patterns or characters in each column the array comprising five columns and ten randomly selected characters in each column offers 10possible configurations of the arrangement of characters and an equal number of possible patterns for creating an password character sequence.

It is also possible to envisage that the set of characters is substantially lower than the largest possible subset offered by the 7 bit or 8 bit ASCII code but still the number of allowable permutations of characters will be astronomically high.

The same considerations also apply when the client is allowed to create the password as the chosen password then must be transmitted back to the authorization authority on a secure connection. It is worth noting that usually the diagrams i.e. the matrices as shown in and in practice always will be transmitted as images and this of course also applies to these characters as selected. Also when a client has selected the correct password for validation the selected password can be transmitted back either as an image or a positional code but the latter can easily be derived and generated automatically from the image.

The method of the present invention scheme also allows for a better integration with partner sites and allow for a more integrated approach to the branding of the site compared to the redirect approach of Microsoft and Yahoo where the user is redirected away from the site and the whole browser goes to the login pages of Yahoo or Microsoft for authentication and then returns to the partner site . An example of an integrated login integration screenshot is shown in using the mDisk service of the present assignee as an example.

It shall thus be understood that the authentication authority may well be integrated with a server provider or web service although the verification procedure then still is completely disconnected from the service offered as such from the service provider. The only necessary connection is the transmission of a request for verification and the subsequent message that verification has been undertaken and succeeded or failed. If as stated above a login attempt failed five times in a row the authentication authority could default initiate the creation of a new password for a client possibly also with the simultaneous relaying of this information to the service provider so that the client can be informed via the service provider or the web service e.g. by using the home page or the presentation page thereof.

As disclosed hereinabove it will be obvious to persons skilled in the art that different embodiments shall be possible within the scope and conceptual framework of the invention as disclosed by the appended claims. When the validation of the password takes place in the dedicated session between the user and the authentication authority which moreover is completely decoupled from any transaction session between the user and the service provider no characters of the password is sent more than once namely if a password is created initially by the authentication authority or the client in which case it has to be transmitted respectively to the client or the authentication authority on a secure connection which must be different from that used for validation session.

To prevent brute force attacks a new password is generated as mentioned above and sent by email or SMS to the client or authentication authority depending on whose password was generated if there are 5 consecutive failed login attempts.

To avoid unauthorized eavesdroppers and subsequent replay attacks the individual characters of the sliders are preferably always images as mentioned above not the actual characters. Each image is assigned an identification code that is generated especially for the browser session and has no meaning for other sessions. On the authentication authority side the session object holds the mapping of the image identifications and the actual character values. An attacker must then be able to perform OCR Optical Character Recognition on the characters but even so his attempts to contact the server would fail because his browser session would not have the same mapping of image identification and characters. Furthermore in order to prevent over the shoulder attacks the action of the client can be masked by blanking or hiding the password character and also the current string immediately after selection.

A person skilled in the art shall be able to implement the required verification and sign on procedures according to the present invention by means of the HyperText Transfer Protocol HTTP . Alternatively the implementation of these procedures could take place by means of cookies and it should be well known that cookie programs in some client server systems are run during user logon.

Further the verification and sign on procedures as disclosed herein could be based on a scripting language such as JavaScript which shall be included in a Web page to enable a required API Application Programming Interface but it would require a JavaScript compliant browser to run the JavaScript code. Finally an open standard such as Secure Sockets Layer SSL could be used to establish a secure communication channel for the messaging required to set up and implement the method according to the present invention.

All the above mentioned technologies for implementation are presently commonly used for client server communications over the World Wide Web. Particularly has SSL been widely used to enable secure electronic financial transactions on the World Wide Web.

From the above it is seen that the method of the present invention shall allow for a marked improvement of prior art methods for single sign on to service providers web services and the like. Prominent features of the method of the present invention is inter alia that it is impossible for a client to enter the password if the authentication authority not already knows the password and that the selection of password whether undertaken by the authentication authority or the client himself or herself is based on random sequences of characters and thus ensures what would be termed very good password as they shall not be based on say mnemonic or other subjective preferences of the client. Furthermore the present invention is conceptually in a sense very similar to presently used procedures involving a username and a password and thus would be easy to adopt for clients familiar with the prior solutions. Also by resorting to transmitting the password as a diagram in the form of an image implies that the characters of the password never are transferred between the authentication authority or the client although it might look like that for the latter.

