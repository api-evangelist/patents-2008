---

title: Method and apparatus for mapping an IP address to an MSISDN number within a wireless application processing network
abstract: In one embodiment, there is disclosed a system and method for providing access to an IP number or a subscriber identity number associated with a mobile device in a network, the method comprising associating a mobile device with a subscriber identity number; generating a temporary IP number for the mobile device; linking the subscriber identity number with the temporary IP number; storing the subscriber identity number and the temporary IP number in a database; and providing a pull application program interface to extract from the database either the subscriber identity number or the IP address for mobile device when requested by an application program.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07969961&OS=07969961&RS=07969961
owner: Telefonaktiebolaget (publ)
number: 07969961
owner_city: Stockholm
owner_country: SE
publication_date: 20080212
---
This application is a continuation of co pending U.S. patent application Ser. No. 10 891 641 filed Jul. 15 2004 now U.S. Pat. No. 7 339 920 which is a continuation of U.S. patent application Ser. No. 09 596 802 filed Jun. 19 2000 now U.S. Pat. No. 6 775 262 which claims the benefit of U.S. Provisional Application No. 60 188 437 filed Mar. 10 2000.

The present invention relates to wireless application protocol WAP systems and more particularly to the mapping of temporary IP addresses to established MSISDN numbers.

Wireless application protocol WAP is positioned at the conversions of two rapidly evolving network technologies wireless data and the Internet. Both the wireless data market and the Internet are growing very quickly and are continuously reaching new customers. The explosive growth of the Internet has fueled the creation of new and exciting information services. Most of the technology developed for the Internet has been designed for desktop and larger computers and medium to high bandwidth networks.

Hand held wireless devices present a more constrained computing environment compared to desktop computers. They have less powerful CPU s and memory than desktop systems. Similarly wireless data networks present a more constrained communications environment compared to wired networks. Wireless networks have fundamental limitations with respect to power available spectrum and mobility. The WAP specification has been developed to address mobile network characteristics by adapting existing network technologies for the Internet to the specialized requirements of hand held wireless data devices.

Access to a wireless application protocol system utilizing WAP technologies is provided via a WAP gateway node. The WAP gateway node is normally located within an Internet service provider ISP providing access to the Internet for mobile terminals. However the WAP gateway node may alternatively be provided by a mobile services operator. In order to obtain access to the WAP gateway node a user must be authenticated. There are two possible authentication points for a user. The first authentication point is during setup of a data call. This authentication is handled by the integrated access system IAS located within a mobile switching center utilized by the mobile terminal and or a remote authentication dial in user service RADIUS authentication server located in the WAP network.

The user may also be authenticated when accessing particular servers within the WAP network. This manner of authentication may be handled in two different ways. Proxy authentication may be used wherein the WAP gateway returns a status code of 407 to a WAP browser. This initiates the same type of basic authentication as occurs for a hypertext transport protocol HTTP message. A user ID and password are entered by the user in response to this status code and this data is included within every IP packet from the browser.

A WAP gateway supports several different types of bearer messages for example IP SMS USSD etc. A MSISDN is used within the WAP gateway to determine if a user is allowed to use the WAP gateway node to charge for using the WAP gateway node and to enable charges for specific content to be transmitted. If SMS or USSD bearer protocols are used the MSISDN is always included within the data packet and this poses no identification problems for the WAP gateway. However when using the IP protocol the integrated access system within the mobile switching center allocates a temporary IP address to the mobile terminal. This IP address is included within messages transmitted to the WAP gateway. The WAP gateway has no way at present to determine the MSISDN number associated with a particular IP address. Thus some manner for enabling the WAP gateway to associate the temporary IP addresses with a fixed MSISDN number is desired.

The present invention overcomes the foregoing and other problems with a system and method for associating an MSISDN number of a mobile terminal with a temporarily assigned IP address for use with authentication billing and personalization processes in a network. In response to a wireless network access request by a mobile terminal a first server located within the wireless network generates a start packet. The start packet contains an MSISDN of the mobile terminal and an IP address assigned to the mobile terminal by the first server. The start packet is transmitted to a second server within a wireless application protocol network wherein a second server extracts the MSISDN and the assigned IP address from the start packet and stores the MSISDN and the assigned IP address within a database. The database enables storage of the MSISDN and the IP address together such that the database may be accessed using an interface to determine an MSISDN associated with the IP address.

The first server may also generate stop packets responsive to disconnection of the mobile terminal from the wireless network. The stop packet also contains the MSISDN and assigned IP address of the mobile terminal and responsive to receipt of the stop packet the second server determines the MSISDN and IP address from the stop packet and deletes these entries from the database.

Referring now to the drawings and more particular to there is illustrated a WAP network . A micro browser within a wireless terminal enables the user to access world wide web servers on the Internet via a WAP gateway server . The WAP gateway comprises a protocol gateway which translates requests from a WAP protocol WSP WTP WTLS and WDP to a WWW protocol HTTP and TCP IP . This is accomplished via content encoders and decoders within the WAP gateway server .

Referring now to there is illustrated a block diagram of a system which utilizes radius accounting messages as a manner for mapping IP addresses to an MSISDN number. While the following description of mapping an IP address to an MSISDN number is done with respect to an authentication process the system and method may also be used with a billing process personalization process etc. The system includes a mobile terminal which may comprise a mobile telephone portable computer personal data assistant or any other mobile electronic device capable of communicating with a MSC VLR via a wireless radio network . It should be well understood by one skilled in the art that the wireless radio network for communicating between the mobile terminal and MSC VLR would consist of a base transceiver station base station and other components necessary within a wireless radio network.

While the described embodiment uses RADIUS Accounting messages to carry out the described invention other systems performing similar functions may be used. When a client is configured to use RADIUS Accounting at the start of service delivery the client will generate an Accounting Start packet describing the type of service being delivered and the user to whom the service is being delivered. The Accounting start packet is sent to the RADIUS Accounting server which will send back an acknowledgment that the packet has been received. At the end of service delivery the client will generate an Accounting Stop packet describing the type of service that was delivered and optionally statistics such as elapsed time input and output octets or input and output packets. The client will send that to the RADIUS Accounting server which will send back an acknowledgment that the packet has been received. By the present invention RADIUS is used for transmitting IP address and MSISDN at session start. Other types of information can also be transmitted e.g. by using RADIUS Accounting for billing or personalization procedures. Other systems capable of transmitting the IP address and MSISDN information between the networks might also be used in place of a RADIUS system.

The MSC VLR includes a remote authentication dial in user service RADIUS server configured to transmit a RADIUS accounting message from the MSC VLR to the WAP gateway . The RADIUS accounting messages are transported to the WAP gateway through routers interconnecting the MSC VLR and the WAP gateway . A RADIUS accounting server is located within the WAP gateway . The RADIUS accounting server is responsive to the received RADIUS accounting messages from the MSC VLR and upon receipt of these messages updates a mapping session database within the WAP gateway . The mapping session database includes a plurality of storage locations for an assigned temporary IP address and an associated MSISDN of the mobile terminal .

The RADIUS accounting messages comprise packets of data which describe the type of service being delivered and the user to which the service is to be delivered. Information in the packet includes among other things the MSISDN number number of frames and the IP address of the mobile terminal . The information within a packet relating to IP address and MSISDN number is used to update the database within the WAP gateway . RADIUS accounting messages indicating the stoppage of a connection between a mobile terminal and the WAP gateway cause the database to be updated such that the MSISDN and IP address for the mobile terminal are no longer stored and associated together in the database.

Once a mobile terminal has been properly authenticated by the WAP gateway and the IP address and the IP address and MSISDN of the mobile terminal stored in the database the mobile terminal may access applications within the WAP network. The RADIUS authentication server in collaboration with a translation application program API interface provides a conduit for the database enabling applications to access and determine a MSISDN associated with an IP address for the mobile terminal .

Referring now to there is provided a first example of a signaling diagram utilizing the method for mapping a MSISDN number to a temporarily assigned IP address for a mobile terminal accessing a WAP gateway . The process illustrated in describes when a mobile terminal requests use of a WAP application residing upon a web server on the Internet. The mobile terminal transmits a message to the access server in order to establish a connection to the access server using the point to point protocol PPP . Before establishing a connection with the mobile terminal the access server performs an authentication process wherein the mobile terminal transmits authentication information including the PPP User ID of the mobile terminal and a password to the access server using a password authentication procedure PAP .

The access server residing within the mobile switching center generates an access request message for transmission to the RADIUS Authentication server located within the WAP gateway . The access request message includes the PPP User ID and password transmitted to the access server by the mobile terminal . The access request message comprises a request from the access server to the RADIUS server requesting user access to a particular site. The RADIUS server replies to the access server with an access accept message to indicate that access has been granted to the mobile terminal .

Next a PPP connection is established between the access server and the mobile terminal . IP packets are transmitted over the connection. The only information included about the sender within the IP packets transmitted over the PPP connection is the IP address of the source mobile terminal . The IP address cannot alone be used as a user ID since the IP address is dynamically allocated to the mobile terminal by the access server or the RADIUS server during the PPP connection setup.

To overcome this problem the IP address and the MSISDN of the mobile terminal are transmitted over the PPP connection from the access server to the WAP gateway as an accounting request message to enable mapping between these identifiers. The IP address and the MSISDN are stored as a record within the mapping session database within the WAP gateway . The WAP gateway replies to the accounting request message by means of a mandatory accounting response message to the access server using the RADIUS protocol. Once this connection is established the user may generate a request for access to a particular WAP application service on a web server. This request is forwarded from the mobile terminal to the WAP gateway . The WAP gateway forwards the mobile terminal request to the requested application . The WAP gateway may determine the IP address of the mobile terminal by examining the IP packet header to determine the IP address of the mobile terminal. The MSISDN of the mobile terminal is determined by examining the mapping session database and the associated IP address via the application program interface . The determined MSISDN is placed in an HTTP header of packets used to contact the WAP application .

Referring now to there is illustrated a signaling diagram wherein a mobile terminal with an established PPP connection to the access server terminates the PPP connection. Initially the mobile station terminates at the PPP connection with the access server . In response to the termination of the PPP connection the access server transmits an accounting request stop message to the WAP gateway . This request includes the MSISDN and IP address of the mobile terminal . In response to the accounting request stop message the WAP gateway removes the entry within the mapping session database associated with the MSISDN number and IP address. The WAP gateway responds to the accounting request stop message by means of an accounting response message acknowledging cancellation of the PPP connection.

The previous description is of a preferred embodiment for implementing the invention and the scope of the invention should not necessarily be limited by this description. The scope of the present invention is instead defined by the following claims.

