---

title: Image processing apparatus, image processing method and computer-readable medium
abstract: An image processing apparatus includes a first detecting unit and a second detecting unit. The first detecting unit detects a leading end portion of an information image based on a first criterion and a ratio of a width of a certain white image area in the information image to a width of a black image area being detected prior to the certain white image area. The second detecting unit takes one of the black image areas and white image areas as an image area of interest and detects a portion, other than the leading end portion, of the information image based on a second criterion and at least one of ratios of a width of the image area of interest to widths of black and white image areas being detected prior to the image area of interest.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08196836&OS=08196836&RS=08196836
owner: Fuji Xerox Co., Ltd.
number: 08196836
owner_city: Tokyo
owner_country: JP
publication_date: 20080627
---
This application is based on and claims priority under 35 U.S.C. 119 from Japanese Patent Application Nos. 2007 170350 filed Jun. 28 2007 and 2008 101471 filed on Apr. 9 2008 .

The invention relates to an image processing apparatus an image processing method and a computer readable medium.

Various information processing technologies have been developed which use a barcode that is one type of an information image. In particular there is a technology that extracts a barcode image from an input image.

The barcode is a code that represents information using a combination of parallel vertical lines having different widths and spaces therebetween. The barcode is optically read by transverse scanning. Types of the barcode include JAN code NW 7 ITF CODE 39 CODE 128 postal customer code EAN 128 and the like.

According to an aspect of the invention an image processing apparatus includes a first detecting unit and a second detecting unit. The first detecting unit detects a leading end portion of the information image that represents information using black image areas and white image areas based on i a first criterion and ii a ratio of a width of a certain white image area in the information image to a width of a black image area which is detected by scanning prior to the certain white image area or a ratio of a width of a certain black image area in the information image to a width of a white image area which is detected by scanning prior to the certain black image area. The second detecting unit takes one of the black image areas and white image areas as an image area of interest and detects a portion other than the leading end portion of the information image based on i a second criterion being different from the first criterion and ii at least one of ratios of a width of the image area of interest to widths of black image areas and white image areas which are detected by scanning prior to the image area of interest.

Hereinafter various exemplary embodiments suitable for realizing the invention will be described with reference to the accompanying drawings.

The term module generally represents a component such as software computer program or hardware that can be logically separated. Therefore the modules in this exemplary embodiment refer to a module having a hardware configuration as well as a module in a computer program. For this reason description on this exemplary embodiment will serve as description on a computer program a system and a method. Although store cause something to store or other equivalent terminologies are used for the sake of explanation when this exemplary embodiment is embodied as a computer program these terminologies refer to controlling a storage device to store the computer program. The modules generally correspond to functions in a one to one correspondence relation. In implementation one module may be configured by one program. Alternatively a plurality of modules may be configured by one program. Conversely one module may be configured by a plurality of programs. Moreover a plurality of modules may be executed by one computer or one module may be executed by a plurality of computers in a distributed or parallel computing environment. One module may include another module. In the following descriptions the term connection is used to include not only physical connection but also logical connection such as transmission reception of data instruction a referencing relationship between data .

The term system apparatus or device refer to one in which a plurality of computers hardware devices or the like are connected to each other via a communication unit such as a network including communication connection in a one to one correspondence and one in which the system apparatus or device is realized by one unit of a computer hardware an device and the like. The term predetermined refers to being determined in advance and also refers to in accordance with a condition status at that time or in accordance with a preceding condition status.

The term information image refers to a code that represents information using black image areas and white image areas and that is systematically created to represent electronic data in a machine readable form. Specifically examples of the information image include a one dimensional barcode a stacked two dimensional code and the like.

An information image detecting module of the first exemplary embodiment is configured to extract an information image in an image by scanning the image. As shown in the information image detecting module includes a first detecting module a second detecting module and a third detecting module .

The first detecting module is connected to the second detecting module and is configured to detect a start code of a barcode based on i a first criterion and ii a ratio of a width of a certain white bar in the barcode to a width of a black bar which is scanned prior to the certain white bar. Particularly the ratio used by the first detecting module may be a ration of a width of a black bar that has been first found in the line to be scanned to a width of a next white bar being adjacent to the first black bar . Alternatively the first detecting module may use a ratio of a width of a certain black bar in the barcode to a width of a white bar which is scanned prior to the certain black bar instead of the ratio of the width of the certain white bar in the barcode to the width of the black bar which is scanned prior to the certain white bar.

The second detecting module is connected to the first detecting module and the third detecting module . The second detecting module is configured to take one of the black bars and white bars as a bar of interest and detect a portion other than the leading end portion of the barcode based on i a second criterion being different from the first criterion and ii at least one of ratios of a width of the bar of interest to widths of black bars and white bars which are scanned prior to the bar of interest. Here the term portion other than the leading end portion refers to a decodable area that is in the barcode image and follows the leading end portion.

The third detecting module is connected to the second detecting module and is configured to detect the number of the black bars or the number of the white bars in the barcode having the portion which is other than the leading end portion and which is detected by the second detecting module .

White the image is being scanned to detect the black bars and the white bars subsequently the first and second detecting unit and may perform the detecting process. Also if the first detecting unit detects the leading end portion of the barcode during scanning of a certain line of the images the first detecting module does not perform the detecting process but the second detecting module and the third detecting module perform the detecting processes during the scanning after the first detecting unit detects the leading end portion of the barcode.

As shown in the information image detecting module according to another aspect of the first exemplary embodiment includes a first determining module a second determining module a third determining module a fourth determining module a candidate area updating module and a fifth determining module .

The first determining module is connected to the second determining module and is configured to determine as to whether or not a width of a white bar of interest i is equal to or less than two times a width of a bar that has been detected just before the white bar of interest and ii is equal to or larger than a half of the width of the bar which has been detected just before the white bar of interest. That is the width of the first bar is compared with the width of the subsequent white bar i.e. the first white bar . If this criterion is met there is a possibility that the start code of the barcode is detected. If this criterion is not met the first bar does not form a part of a barcode. The consecutive area of the bars and the white bars which meets this criterion is processed by the second determining module .

The second determining module is connected to the first determining module and the third determining module . The second determining unit is configured to make a determination for the barcodes which meets the criterion of the first determining module as to whether or not a width of a bar of interest or a white bar of interest i is equal to or less than four times the minimum width of the bars or the white bars which have been scanned before the bar of interest or the white bar of interest and ii is equal to or larger than a quarter of the maximum width of the bars or the white bars which have been scanned before the bar of interest or the white bar of interest. The consecutive area of the bars and the white bars which meets this criterion is processed by the third determining module .

The second determining module may make the determination for each bar or each white bar. That is the second determining module may determine as to whether or not the width of the bar of interest i is equal to or less than four times the minimum width of the bars which have been scanned before the bar of interest and ii is equal to or larger than a quarter of the maximum width of the bars which have been scanned before the bar of interest. Alternatively the second determining module may determine as to whether or not the width of the white bar of interest i is equal to or less than four times the minimum width of the white bars which have been scanned before the white bar of interest and ii is equal to or larger than a quarter of the maximum width of the white bars which have been scanned before the white bar of interest. In some cases the bars are printed with the being thickened uniformly. The above determination is suitable for such a printed matter.

The third determining module is connected to the second determining module and the fourth determining module . The third determining module is configured to make a determination for the consecutive area of the bars and the white bars which meets the criterion of the second determining module as to whether or not the bar of interest causes the number of the bars which have already appeared to reach the minimal number of bars of the barcode. The consecutive area of the bars and the white bars in which the number of the bars having already appeared satisfies the minimal number of bar requirement of the barcode is processed by the fourth determining module .

The fourth determining module is connected to the third determining module and the candidate area updating module . The fourth determining module is configured to detect a stop code of the barcode in accordance with the number of bars detected by the third determining module and based on i the width of the bar or the white bar in the barcode having the portion other than the leading end portion detected by the second determining module and ii a criterion different from those of the first and second detecting modules and . Specifically the fourth determining module determines as to whether or not the width of the white bar of interest is equal to or less than 1 times the maximum width of the white bars which have been scanned before the white bar of interest. The purpose of this is to determine as to whether or not the white bar of interest is a trailing end portion of the barcode.

The candidate area updating module is connected to the fourth determining module and the fifth determining module and is configured to add the bar of interest as a bar belonging to a candidate barcode area.

The fifth determining module is connected to the candidate area updating module and is configured to determine as to whether the candidate barcode area continues plural lines.

Next an overall module configuration of the first exemplary embodiment will be described with reference to . The entirety of the first exemplary embodiment is configured to include an image input module the information image detecting module a barcode decoding module and a decoding result processing module .

The image input module is connected to the information image detecting module and is configured to receive an input image that contains a barcode. The image input module transmits the input image to the information image detecting module . The input image may contain a plurality of barcodes and the barcodes may be of a plurality of types and have an inclination with respect to a scanning direction.

The information image detecting module is connected to the image input module and the barcode decoding module . The information image detecting module is configured to detect a barcode that is the information image from the input image transmitted from the image input module . The information image detecting module transmits the detected barcode image to the barcode decoding module .

The barcode decoding module is connected to the information image detecting module and the decoding result processing module . The barcode decoding module is configured to extract information by analyzing the barcode image received from the information image detecting module . That is the barcode decoding module serves as a decoder that decodes the barcode. The barcode decoding module transmits the extracted information to the decoding result processing module .

The decoding result processing module is connected to the barcode decoding module and is configured to process the information received from the barcode decoding module . For example the decoding result processing module extracts an electronic document that is electronic information of an image based on a document name represented by a barcode contained in the image.

First one dimensional barcodes are classified into one type having two widths narrow and wide bars and the other type having four widths. For this reason if a bar appears which has a width i larger than four times the minimum width of bards that have been detected before or ii less than a quarter of the maximum width of the bars which have been detected before during bar detection it can be determined that the barcode area is discontinued.

If an allowable width ratio is set to a range of to 4 when a bar in the leading end portion is detected there is a possibility that an area other than the barcode area may be detected as the barcode area. Such a case will be described with reference to .

In this case the first scanning operation detects the rule line prior to the bars to of the true barcode. However since a width of a space between the rule line and the starting bar of the barcode is less than four times a width of the rule line the rule line is also detected as the barcode area.

When these character configurations are studied it can be found that a distance between the first bar and the second bar that is a width of the first white bar is never larger than four times the width of the first bar and never less than a quarter of the width of the first bar. Therefore the allowable width ratio should be decreased when detecting a bar following the first bar. In this exemplary embodiment the allowable width ratio is set such that the width of the first white bar is i equal to or less than twice the width of the preceding bar and ii equal to or larger than a half of the width of the preceding bar. The example of shows that the UPC EAN or JAN code includes an intermediate code as well as the start code and the stop code.

If the number of bars detected meets the minimal number of bars requirements of a single barcode it is highly likely that most types of the bars of different sizes widths have appeared at least once. If the detection operation is continued without adjusting the allowable width ratio that a width of a bar of interest should be i equal to or less than four times the minimum width of bars that have been scanned before and ii equal to or larger than a quarter of the maximum width of the bars which have been scanned before it is likely that the bar detection operation is continued in an area outside the barcode when a quiet zone at the end of the barcode is small. The quiet zone is a blank white area before and after a barcode which is essential to barcode detection and also known as a margin. In general if other patterns such as the rule line or the like are in the quiet zone the barcode may not be recognizable. Such a case will be described with reference to .

As shown in when the bars in the last portion a detection area of the barcode are being detected a distance between the final bar of the barcode and a frame of the adjacent rule line satisfies the relation that i being equal to or less than four times the minimum width of the bars which have been scanned before and ii equal to or larger than a quarter of the maximum width of the bars which have been scanned before . Therefore the rule line is erroneously detected as a bar of the barcode. For this reason the allowable width ratio is decreased when the number of bars encountered satisfies the minimal number of bars requirements of a single barcode.

On the other hand when a start code for the CODE128 having four width types of codes appears only bars of width 1 to 3 have appeared and there is a possibility that a bar of a width 4 may appear later. In this case although the width ratio is calculated as 4 3 1.33 an allowable width ratio of 1.5 is used considering measurement errors.

Accordingly if a space having a width greater than 1.5 times the maximum width of the bars which have been scanned before appears it is determined that the scanning operation reaches the end of the barcode area.

In this way the allowable width ratio is changed in accordance with the number of bars detected and the detection is stopped when a bar does not satisfy the allowable width ratio. With such a process it is possible to extract only the barcode while the quiet zone at the end of the barcode is detected as the quiet zone not as the bar of the barcode.

Some barcodes are configured such that a single character is composed of 6 to 9 bars and the start code and the stop code are always included therein. Therefore each barcode has the minimal number of bars requirements.

For example the minimal number of bars including the start code and the stop code is 29 for CODE 39 23 for NW7 and 19 for CODE 128.

Therefore it is determined as to whether or not the number of bars detected satisfies the minimal number of bar requirement of the barcode i.e. in the case of CODE 128 whether or not the number of bars detected amounts to 19 . If satisfied the bars are registered as a candidate barcode area.

After the candidate barcode area has been detected by scanning one line the scanning operation is performed for the subsequent line. If the candidate barcode area detected in the subsequent line overlaps with the candidate barcode area detected in the previous line the two candidate barcode areas are combined with each other. Whether or not the areas overlap with each other is determined based on the X coordinates coordinates in the scanning direction of the areas. That is if the X coordinates are the same the areas are determined to overlap with each other.

If the candidate barcode areas obtained after repeated scanning operations occupy more than a predetermined number of successive lines the areas are combined with each other to be determined as the barcode area.

Next a flow of an exemplary process that is performed by the information image detecting module of the first exemplary embodiment will be described with reference to a flowchart shown in .

First in step S the image input module receives the image which is input and binarized and scans the image line by line. Thereafter after one bar is detected a width of the next bar is sequentially judged to determine as to whether or not the detected bars meet the minimal number of bar requirement of the barcode.

If it is the first bar Yes in step S the flow proceeds to step S. Otherwise No in step S the flow proceeds to step S.

In step S the scan operation proceeds to a white bar following the current black bar. Then it is determined as to whether or not a width of the white bar is i equal to or less than twice a width of the preceding bar and ii equal to or larger than a half of the width of the preceding bar. This process corresponds to the first determining module shown in the example of . If the width of the white bar is out of this range No in step S the flow proceeds to step S because the current bar does not belong to the barcode area. If the width of the white bar is within this range Yes in step S the flow proceeds to step S to add the bar of interest and the white bar to a candidate barcode area and then proceeds to step S. That is if a start code of the barcode is detected it is attempted to extract a next bar in the same line without performing the processes in steps S S and S step S . In this case in scanning after the start code is detected in the line of interest the process in step S is not performed but the processes in steps S and S are performed and a process in step S is performed depending on circumstances.

If it is determined in step S that the detected bar is not the first bar of the barcode area the flow proceeds to step S and it is determined in step S as to whether or not a width of the bar of interest is i equal to or less than four times the minimum width of bars that have been scanned before and ii equal to or larger than a quarter of the maximum width of the bars which have been detected before. This process corresponds to the second determining module shown in the example of . If No in S the flow proceeds to step S because the scanning operation reaches the end of the barcode area. If Yes in S the flow proceeds to step S. The determination in step S may be made based on the width of the white bar.

In step S it is determined as to whether the number of bars in the area detected so far satisfies the minimal number of bar requirement of a barcode. This process corresponds to the third determining module shown in the example of . If satisfied Yes in step S the flow proceeds to step S. If not satisfied No in step S the flow proceeds to step S.

In step S it is determined as to whether or not a width of a white bar is equal to or less than 1.5 times the maximum width of the white bars that have been scanned before. This process corresponds to the fourth determining module shown in the example of . If Yes in step S the flow proceeds to step S because the barcode area continues. In step S the current bar is registered as a bar forming the candidate barcode area. If No in step S the flow proceeds to step S because the scanning operation reaches the end of the barcode area.

In step S the current bar is registered as the bar forming the candidate barcode area. Then the flow proceeds to step S.

In step S it is checked as to whether or not a next bar exists on the scanning line. If exist Yes in step S the flow returns to step S to detect the next bar. If not exist No in step S the flow proceeds to step S.

The flow reaches step S when the continuous barcode area comes to its end. In step S it is determined as to whether or not the number of bars contained in the candidate area detected so far satisfies the minimal number of bar requirement of the barcode. If satisfied Yes in step S the flow proceeds to step S. If not satisfied No in step S the candidate area is discarded and the flow proceeds to step S.

In step S in addition to the above determination criterion relating to the number of bars it may be further determined as to whether or not thicknesses of the bars or the white bards are two types or four types. That is if the number of bars contained in the candidate area detected so far satisfies the minimal number of bar requirement of the barcode Yes and if the thicknesses of the bars or the white bars are two types or four types the flow proceeds to step S. Otherwise the flow proceeds to step S. To make this determination a grouping process is performed for the thicknesses of the black bars or the white barks. This grouping process determines that bars white bars which have thicknesses within a predetermined range from a certain reference thickness belong to one group and forms a group. Then the number of groups corresponds to the number of types of thicknesses.

In step S an area that has been detected as a bar of a barcode so far is set to the candidate barcode area.

In step S detection of a subsequent bar is performed. If exists Yes in step S the flow returns to step S and repeats the above described steps. If not exists No in step S the flow proceeds to step S.

In step S it is determined as to whether or not there is a subsequent scanning line. If exists Yes in step S the flow returns to step S. If not exists No in step S the flow proceeds to step S.

In step S it is determined as to whether or not the candidate barcode area detected in each of the scanning lines occupies predetermined plural scanning lines. This process corresponds to the fifth determining module shown in the example of . If the candidate barcode area occupies the predetermined plurality of scanning lines Yes in step S the flow proceeds to step S. Otherwise No in step S the flow proceeds to step S.

In step S the candidate area is output as a barcode area to a decoder. The barcode area output in this step is not necessarily all of the individual barcodes illustrated in but only needs to be a barcode decodable area. For example in the case of JAN code shown in the lengths of the bars are not constant some bars are longer than other bars. In such a code system a part of the bars including the bars longer than the other bars are not necessarily used as the barcode area but only need to use an area having the same length as the other bars as the barcode area to be output to the decoder.

In step S it is determined that there is no barcode area because the candidate barcode area does not occupy the predetermined plural scanning lines.

To cope with the case in which a plurality of barcodes exist on one scanning line ID numbers may be assigned to the candidate barcode areas detected so as to identify each barcode area using its X coordinate.

Next an exemplary image to be processed in the first exemplary embodiment will be described with reference to .

In the example of images of a plurality of form sheets and that respectively contain barcodes and are sequentially input to the image input module using an automatic document feeding device or the like. The respective barcodes are of different types. The input images are process targets of the first exemplary embodiment.

In the first exemplary embodiment the processes are performed line by line. In the second exemplary embodiment processes are performed every predetermined lines. Also in order to keep accuracy of barcode extraction while omitting some process a process performed by a fifth determining module is added.

As shown in the information image detecting module includes a target line setting module a first determining module a second determining module a third determining module a fourth determining module a candidate area updating module and the fifth determining module . Also the fifth determining module includes a distribution information detecting module a comparison module and a barcode adding generating module .

The target line setting module is connected to the first determining module and sets a line to be scanned scan target line in an image of interest target image . Then the target line setting module transmits the set line to the first determining module . For example the target line setting module may set the scan target line every ten lines.

The first determined module is connected to the target line setting module and the second determining module and performs the process which is similar to that being performed in the first exemplary embodiment for the line which is set by the target line setting module .

The distribution information detecting module is connected to the comparison module . After the fourth determining module detects a stop code the distribution information detecting module detects information hereinafter may be referred to as distribution information relating to a distribution of bars or white bars from a start code detected by the first determining module to the stop code detected by the fourth determining module . For example the distribution information may include any of thicknesses of the bars or the white bars the number of the bars or the white bars or statistical information such as average or variance of the bars or the white bars. In a barcode thicknesses of bars or white bars or the number of bars or white bars are is constant and therefore the distribution information thereof is constant. However in a character area other than a barcode distribution information thereof is not constant. Particularly if a detection operation is performed every predetermined lines distribution information of the respective lines are different because the lines are not adjacent to each other. With this method barcodes and character areas are distinguished.

The comparison module is connected to the distribution information detecting module and the barcode adding generating module . The comparison module compares the distribution information detected by the distribution information detecting module with distribution information of a line that has already been scanned. For example the comparison module calculates differences in thickness of bars or white bars and in number of bars or white bars and outputs the differences as comparison results.

The barcode adding generating module is connected to the comparison module . The barcode adding generating module adds a barcode a barcode of a single line which may be referred to as a latter barcode of a line being currently scanned current scan target line to a barcode a barcode of a single line or plural lines which may be referred to as former barcodes of lines which have already been scanned based on the distribution information detected by the distribution information detecting module to generate a barcode. The process of the barcode adding generating module is performed repeatedly. Therefore the generated barcode becomes the barcode of the lines which have already been scanned. In this manner the barcode is generated gradually that is extracted gradually. If bars are arranged in a longitudinal direction the candidate area updating module generates a barcode in a lateral direction by adding a target bar as a bar of the barcode candidate area. The barcode adding generating module generates a barcode in the longitudinal direction. Also the barcode adding generating module may generate a barcode based on the comparison results of the comparison module . That is if the comparison module determines that the distribution information detected by the distribution information detecting module matches the distribution information of the barcode of the lines which have already been scanned the barcode adding generating module may generate a barcode. The expression distribution information of both matches each other includes not only the case where the both distribution information are exactly identical to each other but also the case where one distribution information is within a predetermined range from the other. For example the expression distribution information of both matches each other includes the case where a difference which is the comparison result of the comparison module is equal to or less than a predetermined threshold value.

Before generating a barcode the barcode adding generating module may further causes the distribution information detecting module and the comparison module depending on circumstances to detect distribution information of an intermediate line that is located between the former barcode and the latter barcode to obtain its comparison result results of comparing between the distribution information of former latter barcodes and the distribution information of the intermediate line or a result of comparing between the distribution information of the latter barcode and the distribution information of the intermediate line . Then the barcode adding generating module may generate a barcode using such a comparison result. Also this further process may be performed if the comparison result is equal to or less than another predetermined threshold value second threshold value which is different from the predetermined threshold value first threshold value . For example the second threshold value is less than the first threshold value and is close to the first threshold value. Also the intermediate line may be a line that bisects a part between the former and latter barcodes or be selected randomly so long as it is located between the former and latter barcodes. Furthermore the intermediate line is not limited to one but may be plural.

Next a flow of an exemplary process that is performed by the information image detecting module of the second exemplary embodiment will be described with reference to flowcharts shown in and exemplary processes shown in .

Processes from steps S to S correspond to the processes from S to S of the flowchart of the first exemplary embodiment shown in and thus description thereon will be omitted.

First in step S the image input module receives the image which is input and binarized and scans the line which is set by the target line setting module .

The processes from the steps S to S generate a barcode candidate area in the scan target line. That is after one bar is detected a thickness of a next bar is determined and it is determined in sequence as to whether or not the bar of interest constitutes a barcode.

For example as shown in in a line of the first row of a target image barcode candidate areas and are extracted. The barcode candidate area is a barcode but the barcode candidate area is a character area. In the next process that is in the processes from the step S to S after the second step S sets 1 N th line to the scan target line a barcode candidate area is newly extracted as shown in an example of .

In step S it is determined as to whether or not a barcode candidate area is detected based on a result of scanning a single line that is based on a result of the processes from the steps S to S for the line of interest. If it is determined that the barcode candidate area is detected Yes in step S the flow proceeds to step S. Otherwise No in step S the flow proceeds to step S.

In step S it is determined as to whether or not a positional coordinate of the barcode candidate area which is detected in the current scan line in the lateral direction scan line direction is within a predetermined range from that of the barcode candidate area which is detected in the previous scan line. If it is determined that the positional coordinate of the barcode candidate area which is detected in the current scan line is within the predetermined range Yes in step S the flow proceeds to S. Otherwise No in step S the flow proceeds to step S. That is step S determines as to whether or not the two barcode candidate areas constitute one barcode based on the positions of them. For example the positional coordinate in the lateral direction of the barcode candidate area shown in the example of is within the predetermined range from that of the barcode candidate area . Therefore the flow proceeds to step S. It is noted that the barcode candidate area is not within the predetermined range from the barcode candidate area . Also the optional coordinate in the lateral direction refers to coordinates of a barcode in right and left ends thereof and may refer to a coordinate of a barcode only in a right end thereof or only in a left end thereof.

In step S obtained are the distribution information of the barcode candidate area of the preceding scan lines and that of the barcode candidate area of the current scan line. The distribution information detecting module may detect the distribution of the both. Also with regard to the distribution information of the barcode candidate area of the preceding scan lines the distribution information which have already been detected by the distribution information detecting module may be used.

In step S it is determined as to whether or not the distribution information of the both are within a predetermined range. If it is determined that the distribution information of the both are within a predetermined range Yes in step S the flow proceeds to step S. Otherwise No in step S the flow proceeds to step S. That is step S determines based on the distribution information as to whether or not the two barcode candidate areas constitute one barcode. For example the distribution information of the barcode candidate area shown in the example of is in the predetermined range from that of the barcode candidate area . Therefore the flow proceeds to step S.

In step S the barcode candidate area of the current scan line is added to the barcode candidate area of the preceding scan lines. That is the barcode candidate area of the preceding scan lines is extended to the barcode candidate area of the current scan line to thereby generate a rectangle barcode. For example as shown in the example of the barcode candidate area is extended to the barcode candidate area to thereby generate a barcode candidate area .

In step S it is determined as to whether or not there is a barcode candidate area that belongs to the barcode candidate area being detected in the preceding scan lines but is not connected to the barcode candidate area being detected in the current scan line. If it is determined that there is such a barcode candidate area Yet in step S the flow proceeds to step S. Otherwise No in step S the flow proceeds to S. That is it is determined as to whether or not the flow is in the middle of barcode detection.

In step S it is determined as to whether or not a height of the barcode candidate area being detected so far is equal to or larger than a predetermined height. If it is determined the height is equal to or larger than the predetermined height Yes in step S the flow proceeds to S. Otherwise No in step S the flow proceeds to S. That is when there is a barcode candidate area based on which it can be determined that the previous scan line is the end of a barcode region the flow reaches step S. In step S it is determined as to whether or not the barcode candidate area has a height that is required to constitute a barcode to thereby determine as to whether or not detection of a barcode is completed. Since the barcode candidate area shown in the example does not have the predetermined height the flow proceeds to step S and a process in step S is not performed. Therefore the barcode candidate area is not registered as a barcode area.

In step S the barcode candidate area of interest is registered as a barcode area. That is the barcode candidate area of interest is detected as a barcode.

In step S it is determined as to whether or not a next scan line exists. If exist Yes in step S the flow returns to step S and the processes are repeated for the next target line. If no next scan line exists the flow is completed and the barcode candidate area s which is registered in step S so far is are the barcode area s in the image.

Next an exemplary hardware configuration in accordance with the exemplary embodiments of the invention will be described with reference to . The hardware configuration shown in is configured for example by a personal computer PC or the like and is provided with a data reading unit such as a scanner and a data output unit such as a printer.

A CPU central processing unit is a control unit that executes processes in accordance with a computer program having described therein the execution sequences of various modules described in the exemplary embodiments such as the first detecting module the second detecting module the third detecting module and the like.

A ROM read only memory stores programs calculation parameters or the like that the CPU uses. A RAM random access memory stores programs used in an execution performed by the CPU or parameters that appropriately change in the execution. The CPU the ROM and the RAM are connected to each other by a host bus that is configured as a CPU bus or the like.

The host bus is connected to an external bus such as a PCI peripheral component interconnect interface bus through a bridge .

A pointing device such as a keyboard or a mouse is an input device that is operated by a user. A display is formed of a liquid crystal display apparatus a CRT cathode ray tube or the like and displays various pieces of information as text or images.

An HDD hard disc drive drives a hard disc installed therein to record or reproduce programs that are executed by the CPU and information into or from the hard disc. The hard disc stores an input image or the barcode image that is detected by the information image detecting module . In addition various computer programs such as data processing programs are stored in the hard disc.

A drive reads data or a program recorded in a recoding medium loaded therein such as a magnetic disc an optical disc a magneto optical disc or a semiconductor memory and sends the data or program to the RAM connected thereto through an interface the external bus the bridge and the host bus . The removable recording medium can be used as the same data recording area as the hard disc.

A connection port is a port for connection to an external connection device and has a connection portion such as USB or IEEE 1394. The connection port executes a data communication process for communication with the external devices or apparatuses by being connected to the CPU or the like via the interface the external bus the bridge and the host bus . The data reading unit is a scanner for example and executes a document reading process. The data output unit is a printer for example and executes a document data output process.

The hardware configuration shown in is only one example of possible configurations of the invention. The exemplary embodiments of the invention are not limited to that shown in . Any configuration can be employed as long as the configuration employed can execute the functions of the modules described in the exemplary embodiments. For example some modules may be configured by a specific purpose hardware for example ASIC application specific integrated circuit and other modules are located in an external system so that the modules are connected to each other by a communication line. Alternatively a plurality of the system shown in may be connected to each other by a communication line so that the systems can operate in a cooperating manner. In addition the modules of the exemplary embodiment of the invention may be installed in a copier a fax machine a scanner a printer or a multi functional device an image processing apparatus having two or more functions of the scanner printer copier fax machine or the like .

In the above described embodiments of the invention the information image detecting module and the barcode decoding module are separated from each other and the process of the barcode decoding module is performed after performing the process of the information image detecting module . However the information image detecting module and the barcode decoding module may be combined with each other and the barcode decoding process may be performed simultaneously with the barcode detecting process.

The processes related to the width of the bar may be substituted by the processes related to the width of the white bar and vice versa.

The specific numeric value used in connection with the width ratio described in the exemplary embodiments of the invention may be adjusted to have a wide allowable range in consideration of noise.

The program may be provided as a recording medium storing the program or may be provided by a communication unit. In this case the program may be embodied as the invention of a computer readable recording medium having a program recorded therein. 

The term a computer readable recording medium having a program recorded therein refers to a computer readable recording medium having a program recorded therein used for the purpose of install execution or distribution of the program.

Examples of the recording medium include a DVD digital versatile disc of which the format includes DVD R DVD RW and DVD RAM which are approved by the DVD Forum and DVD R and DVD RW which are approved formats of DVD RW a CD compact disc such as CD ROM read only memory CD R recordable or CD RW rewritable a magneto optical disc MO a flexible disc FD a magnetic tape a hard disc a read only memory ROM an electrically erasable programmable read only memory EEPROM a flash memory a random access memory RAM and the like.

Part or the entire program may be recorded in the recording medium for the purpose of storage of distribution. Alternatively the program may be transmitted via a transmission medium including for example a wired network that is used in a local area network LAN a metropolitan area network MAN a wide area network WAN an internet an intranet an extranet or the like a wireless communication network or a combination of the wired network and the wireless communication network. Alternatively the program may be embodied in a carrier wave.

The program may be a part of another program or may be recorded in a recording medium along with a separate program. Alternatively the program may be partitioned into subprograms and the subprograms are recorded in a plurality of recording media. Moreover the data recorded in the recording medium may be in any form including a compressed form and an encoded form as long as the data can be decompressed and decoded.

