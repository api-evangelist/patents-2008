---

title: Multiple location estimators for wireless location
abstract: A wireless location system is disclosed that may be configured as a gateway for receiving a plurality of requests for locating mobile stations for, e.g., E911 requests, vehicle location or tracking. For each mobile station (MS) location request, the system: (a) activates one or more location estimators for locating the MS, (b) receives one or more MS location estimates from the estimators, and (c) transmits a resulting location estimate(s) to an identified destination. MS locations are determined using one or more locating technologies based on, e.g.: computed offsets from terrestrial base stations, satellite transmissions, indoor antennas, low range base stations, and/or signal fingerprinting. The system may: adapt with environmental changes, evaluate MS locations using heuristics/constraints, and/or adjust MS estimates for more reliable and accurate estimates. The system is useful for 911 emergencies, tracking, routing (e.g., to desired products/services), people and animal location including applications for confinement to and exclusion from certain areas.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08032153&OS=08032153&RS=08032153
owner: TracBeam LLC
number: 08032153
owner_city: Golden
owner_country: US
publication_date: 20080114
---
The present application is a continuation of U.S. application Ser. No. 09 194 367 filed Nov. 24 1998 which is the National Stage of International Application No. PCT US97 15892 filed Sep. 8 1997 which claims the benefit of the following three provisionals U.S. Provisional Application No. 60 056 590 filed Aug. 20 1997 U.S. Provisional Application No. 60 044 821 filed Apr. 25 1997 and U.S. Provisional Application No. 60 025 855 filed Sep. 9 1996.

The present invention is directed generally to a system and method for locating people and or objects and in particular to a network gateway for receiving a plurality of requests for locating mobile stations for e.g. E911 requests and vehicle location or tracking and requesting locations of the mobile stations from one or more of a plurality of mobile station location estimators wherein such estimators may be based on e.g. coverage area GPS TDOA and AOA location techniques and or signal pattern recognition matching.

Wireless communications systems are becoming increasingly important worldwide. Wireless cellular telecommunications systems are rapidly replacing conventional wire based telecommunications systems in many applications. Cellular radio telephone networks CRT and specialized mobile radio and mobile data radio networks are examples. The general principles of wireless cellular telephony have been described variously for example in U.S. Pat. No. 5 295 180 to Vendetti et al which is incorporated herein by reference.

There is great interest in using existing infrastructures for wireless communication systems for locating people and or objects in a cost effective manner. Such a capability would be invaluable in a variety of situations especially in emergency or crime situations. Due to the substantial benefits of such a location system several attempts have been made to design and implement such a system.

Systems have been proposed that rely upon signal strength and trilateralization techniques to permit location include those disclosed in U.S. Pat. Nos. 4 818 998 and 4 908 629 to Apsell et al. the Apsell patents and 4 891 650 to Sheffer the Sheffer patent . However these systems have drawbacks that include high expense in that special purpose electronics are required. Furthermore the systems are generally only effective in line of sight conditions such as rural settings. Radio wave surface reflections refractions and ground clutter cause significant distortion in determining the location of a signal source in most geographical areas that are more than sparsely populated. Moreover these drawbacks are particularly exacerbated in dense urban canyon city areas where errors and or conflicts in location measurements can result in substantial inaccuracies.

Another example of a location system using time of arrival and triangulation for location are satellite based systems such as the military and commercial versions of the Global Positioning Satellite system GPS . GPS can provide accurate position determination i.e. about 100 meters error for the commercial version of GPS from a time based signal received simultaneously from at least three satellites. A ground based GPS receiver at or near the object to be located determines the difference between the time at which each satellite transmits a time signal and the time at which the signal is received and based on the time differentials determines the object s location. However the GPS is impractical in many applications. The signal power levels from the satellites are low and the GPS receiver requires a clear line of sight path to at least three satellites above a horizon of about 60 degrees for effective operation. Accordingly inclement weather conditions such as clouds terrain features such as hills and trees and buildings restrict the ability of the GPS receiver to determine its position. Furthermore the initial GPS signal detection process for a GPS receiver is relatively long i.e. several minutes for determining the receiver s position. Such delays are unacceptable in many applications such as for example emergency response and vehicle tracking.

Differential GPS or DGPS systems offer correction schemes to account for time synchronization drift. Such correction schemes include the transmission of correction signals over a two way radio link or broadcast via FM radio station subcarriers. These systems have been found to be awkward and have met with limited success.

Additionally GPS based location systems have been attempted in which the received GPS signals are transmitted to a central data center for performing location calculations. Such systems have also met with limited success. In brief each of the various GPS embodiments have the same fundamental problems of limited reception of the satellite signals and added expense and complexity of the electronics required for an inexpensive location mobile station or handset for detecting and receiving the GPS signals from the satellites.

The behavior of a mobile radio signal in the general environment is unique and complicated. Efforts to perform correlations between radio signals and distance between a base station and a mobile station are similarly complex. Repeated attempts to solve this problem in the past have been met with only marginal success. Factors include terrain undulations fixed and variable clutter atmospheric conditions internal radio characteristics of cellular and PCS systems such as frequencies antenna configurations modulation schemes diversity methods and the physical geometries of direct refracted and reflected waves between the base stations and the mobile. Noise such as man made externally sources e.g. auto ignitions and radio system co channel and adjacent channel interference also affect radio reception and related performance measurements such as the analog carrier to interference ratio C I or digital energy per bit Noise density ratio E and are particular to various points in time and space domains.

Before discussing real world correlations between signals and distance it is useful to review the theoretical premise that of radio energy path loss across a pure isotropic vacuum propagation channel and its dependencies within and among various communications channel types. illustrates a definition of channel types arising in communications 

Over the last forty years various mathematical expressions have been developed to assist the radio mobile cell designer in establishing the proper balance between base station capital investment and the quality of the radio link typically using radio energy field strength usually measured in microvolts meter or decibels. First consider Hata s single ray model. A simplified radio channel can be described as Equation 1 where G system gain in decibels

Free space path loss Las discussed in Mobile Communications Design Fundamentals William C. Y. Lee 2nd Ed across the propagation channel is a function of distance d frequency f for f values 

This suggests that the free propagation path loss is 20 dB per decade. However frequencies between 1 GHz and 2 GHz experience increased values in the exponent ranging from 2 to 4 or 20 to 40 dB decade which would be predicted for the new PCS 1.8 1.9 GHz band. One consequence from a location perspective is that the effective range of values for higher exponents is an increased at higher frequencies thus providing improved granularity of ranging correlation.

Actual data collected in real world environments uncovered huge variations with respect to the free space path loss equation giving rise to the creation of many empirical formulas for radio signal coverage prediction. Clutter either fixed or stationary in geometric relation to the propagation of the radio signals causes a shadow effect of blocking that perturbs the free space loss effect. Perhaps the best known model set that characterizes the average path loss is Hata s Empirical Formula for Propagation Loss in Land Mobile Radio M. Hata IEEE Transactions VT 29 pp. 317 325 August 1980 three pathloss models based on Okumura s measurements in and around Tokyo Field Strength and its Variability in VHF and UHF Land Mobile Service Y. Okumura et al Review of the Electrical Communications laboratory Vol 16 pp 825 873 September October 1968.

The typical urban Hata model for Lwas defined as L L 69.55 26.16 log 13.82 log 44.9 6.55 log log dB Equation 4 where L path loss Hata urban

The typical rural model modified the urban formula differently as seen below 4.78 log 18.33 log 40.94 dB Equation 8 

Although the Hata model was found to be useful for generalized RF wave prediction in frequencies under 1 GHz in certain suburban and rural settings as either the frequency and or clutter increased predictability decreased. In current practice however field technicians often have to make a guess for dense urban an suburban areas applying whatever model seems best then installing a base stations and begin taking manual measurements. Coverage problems can take up to a year to resolve.

Having previously established a relationship between d and P reference equation 2 above d represents the distance between the mobile station MS and the base station BS Prepresents the received power in free space for a given set of unchanging environmental conditions it may be possible to dynamically measure Pand then determine d.

In 1991 U.S. Pat. No. 5 055 851 to Sheffer taught that if three or more relationships have been established in a triangular space of three or more base stations BSs with a location database constructed having data related to possible mobile station MS locations then arculation calculations may be performed which use three distinct Pmeasurements to determine an X Y two dimensional location which can then be projected onto an area map. The triangulation calculation is based on the fact that the approximate distance of the mobile station MS from any base station BS cell can be calculated based on the received signal strength. Sheffer acknowledges that terrain variations affect accuracy although as noted above Sheffer s disclosure does not account for a sufficient number of variables such as fixed and variable location shadow fading which are typical in dense urban areas with moving traffic.

Most field research before about 1988 has focused on characterizing with the objective of RF coverage prediction the RF propagation channel i.e. electromagnetic radio waves using a single ray model although standard fit errors in regressions proved dismal e.g. 40 80 dB . Later multi ray models were proposed and much later certain behaviors were studied with radio and digital channels. In 1981 Vogler proposed that radio waves at higher frequencies could be modeled using optics principles. In 1988 Walfisch and Bertoni applied optical methods to develop a two ray model which when compared to certain highly specific controlled field data provided extremely good regression fit standard errors of within 1.2 dB.

In the Bertoni two ray model it was assumed that most cities would consist of a core of high rise buildings surrounded by a much larger area having buildings of uniform height spread over regions comprising many square blocks with street grids organizing buildings into rows that are nearly parallel. Rays penetrating buildings then emanating outside a building were neglected. provides a basis for the variables.

After a lengthy analysis it was concluded that path loss was a function of three factors 1 the path loss between antennas in free space 2 the reduction of rooftop wave fields due to settling and 3 the effect of diffraction of the rooftop fields down to ground level. The last two factors were summarily termed L given by 

However a substantial difficulty with the two ray model in practice is that it requires a substantial amount of data regarding building dimensions geometries street widths antenna gain characteristics for every possible ray path etc. Additionally it requires an inordinate amount of computational resources and such a model is not easily updated or maintained.

Unfortunately in practice clutter geometries and building heights are random. Moreover data of sufficient detail has been extremely difficult to acquire and regression standard fit errors are poor i.e. in the general case these errors were found to be 40 60 dB. Thus the two ray model approach although sometimes providing an improvement over single ray techniques still did not predict RF signal characteristics in the general case to level of accuracy desired 

Work by Greenstein has since developed from the perspective of measurement based regression models as opposed to the previous approach of predicting first then performing measurement comparisons. Apparently yielding to the fact that low power low antenna e.g. 12 25 feet above ground height PCS microcell coverage was insufficient in urban buildings Greenstein et al authored Performance Evaluations for Urban Line of sight Microcells Using a Multi ray Propagation Model in IEEE Globecom Proceedings 12 91. This paper proposed the idea of formulating regressions based on field measurements using small PCS microcells in a lineal microcell geometry i.e. geometries in which there is always a line of sight LOS path between a subscriber s mobile and its current microsite .

Additionally Greenstein studied the communication channels variable Bit Error Rate BER in a spatial domain which was a departure from previous research that limited field measurements to the RF propagation channel signal strength alone. However Greenstein based his finding on two suspicious assumptions 1 he assumed that distance correlation estimates were identical for uplink and downlink transmission paths and 2 modulation techniques would be transparent in terms of improved distance correlation conclusions. Although some data held very correlations other data and environments produced poor results. Accordingly his results appear unreliable for use in general location context.

In 1993 Greenstein et al authored A Measurement Based Model for Predicting Coverage Areas of Urban Microcells in the IEEE Journal On Selected Areas in Communications Vol. 11 No. 7 9 93. Greenstein reported a generic measurement based model of RF attenuation in terms of constant value contours surrounding a given low power low antenna microcell environment in a dense rectilinear neighborhood such as New York City. However these contours were for the cellular frequency band. In this case LOS and non LOS clutter were considered for a given microcell site. A result of this analysis was that RF propagation losses or attenuations when cell antenna heights were relatively low provided attenuation contours resembling a spline plane curve depicted as an asteroid aligned with major street grid patterns. Further Greenstein found that convex diamond shaped RF propagation loss contours were a common occurrence in field measurements in a rectilinear urban area. The special plane curve asteroid is represented by the formula x y r. However these results alone have not been sufficiently robust and general to accurately locate an MS due to the variable nature of urban clutter spatial arrangements.

At Telesis Technology in 1994 Howard Xia et al authored Microcellular Propagation Characteristics for Personal Communications in Urban and Suburban Environments in IEEE Transactions of Vehicular Technology Vol. 43 No. 3 8 94 which performed measurements specifically in the PCS 1.8 to 1.9 GHz frequency band. Xia found corresponding but more variable outcome results in San Francisco Oakland urban and the Sunset and Mission Districts suburban .

The physical radio propagation channel perturbs signal strength frequency causing rate changes phase delay signal to noise ratios e.g. C I for the analog case or E RF energy per bit over average noise density ratio for the digital case and Doppler shift. Signal strength is usually characterized by 

Loss due to slow fading includes shadowing due to clutter blockage sometimes included in Lp . Fast fading is composed of multipath reflections which cause 1 delay spread 2 random phase shift or Rayleigh fading and 3 random frequency modulation due to different Doppler shifts on different paths.

Summing the path loss and the two fading margin loss components from the above yields a total path loss of 

Referring to the figure illustrates key components of a typical cellular and PCS power budget design process. The cell designer increases the transmitted power Pby the shadow fading margin Lwhich is usually chosen to be within the 1 2 percentile of the slow fading probability density function PDF to minimize the probability of unsatisfactorily low received power level Pat the receiver. The Plevel must have enough signal to noise energy level e.g. 10 dB to overcome the receiver s internal noise level e.g. 118 dBm in the case of cellular 0.9 GHz for a minimum voice quality standard. Thus in the example Pmust never be below 108 dBm in order to maintain the quality standard.

Additionally the short term fast signal fading due to multipath propagation is taken into account by deploying fast fading margin L which is typically also chosen to be a few percentiles of the fast fading distribution. The 1 to 2 percentiles compliment other network blockage guidelines. For example the cell base station traffic loading capacity and network transport facilities are usually designed for a 1 2 percentile blockage factor as well. However in the worst case scenario both fading margins are simultaneously exceeded thus causing a fading margin overload.

In Roy Steele s text Mobile Radio Communications IEEE Press 1992 estimates for a GSM system operating in the 1.8 GHz band with a transmitter antenna height of 6.4 m and an MS receiver antenna height of 2 m and assumptions regarding total path loss transmitter power would be calculated as follows 

In contrast Xia s measurements in urban and suburban California at 1.8 GHz uncovered flat land shadow fades on the order of 25 30 dB when the mobile station MS receiver was traveling from LOS to non LOS geometries. In hilly terrain fades of 5 to 50 dB were experienced. Thus it is evident that attempts to correlate signal strength with MS ranging distance suggest that error ranges could not be expected to improve below 14 dB with a high side of 25 to 50 dB. Based on 20 to 40 dB per decade Corresponding error ranges for the distance variable would then be on the order of 900 feet to several thousand feet depending upon the particular environmental topology and the transmitter and receiver geometries.

The following definitions are provided for convenience. In general the definitions here are also defined elsewhere in this document as well.

The present disclosure relates to a wireless mobile station location system and in particular various subsystems related thereto such as a wireless location gateway and the combining or hybriding of a plurality of wireless location techniques.

Regarding a wireless location gateway this term refers to e.g. a communications network node whereat a plurality of location requests are received for locating various mobile stations from various sources e.g. for E911 requests for stolen vehicle location for tracking of vehicles traveling cross country etc. and for each such request and the corresponding mobile station to be located this node a activates one or more wireless location estimators for locating the mobile station b receives one or more location estimates of the mobile station from the location estimators and c transmits a resulting location estimate s to e.g. an application which made the request. Moreover such a gateway typically will likely activate location estimators according to the particulars of each individual wireless location request e.g. the availability of input data needed by particular location estimators. Additionally such a gateway will typically have sufficiently well defined uniform interfaces so that such location estimators can be added and or deleted to e.g. provide different location estimators for performing wireless location different coverage areas.

The present disclosure encompasses such wireless location gateways. Thus for locating an identified mobile station the location gateway embodiments of the present disclosure may activate one or more of a plurality of location estimators depending on e.g. a the availability of particular types of wireless location data for locating the mobile station and b the location estimators accessable by the location gateway. Moreover a plurality of location estimators may be activated for locating the mobile station in a single location or different ones of such location estimators may be activated to locate the mobile station at different locations. Moreover the location gateway of the present disclosure may have incorporated therein one or more of the location estimators and or may access geographically distributed location estimators via requests through a communications network such as the Internet.

In particular the location gateway of the present disclosure may access in various instances of locating mobile stations various location estimators that utilize one or more of the following wireless location techniques 

Accordingly some embodiments of the present disclosure may be viewed as platforms for integrating wireless location techniques in that wireless location computational models denoted first order models or FOMs hereinbelow may be added and or deleted from such embodiments of the disclosure without changing the interface to further downstream processes. That is one aspect of the disclosure is the specification of a common data interface between such computational models and subsequent location processing such as processes for combining of location estimates tracking mobile stations and or outputting location estimates to location requesting applications.

Moreover it should be noted that the present disclosure also encompasses various hybrid approaches to wireless location wherein various combinations of two or more of the location techniques a through g immediately above may be used in locating a mobile station at substantially a single location. Thus location information may be obtained from a plurality of the above location techniques for locating a mobile station and the output from such techniques can be synergistically used for deriving therefrom an enhanced location estimate of the mobile station.

The present disclosure describes a low cost location system and method adaptable to wireless telephony systems for using simultaneously a plurality of location techniques for synergistically increasing MS location accuracy and consistency.

The present disclosure contemplates at least some of the following MS location techniques can be utilized by various embodiments of the present disclosure 

The present disclosure describes location estimates in terms of time vectors which can be used to establish motion speed and an extrapolated next location in cases where the MS signal subsequently becomes unavailable.

Embodiments of the present disclosure may be used to wirelessly locate a mobile station a from which a 911 emergency call is performed b for tracking a mobile station e.g. a truck traveling across country c for routing a mobile station and d locating people and or animals including applications for confinement to and or exclusion from certain areas.

Embodiments of the present disclosure may be decomposed into i a first low level wireless signal processing subsystem for receiving organizing and conditioning low level wireless signal measurements from a network of base stations cooperatively linked for providing wireless communications with mobile stations MSs and ii a second high level signal processing subsystem for performing high level data processing for providing most likelihood location estimates for mobile stations.

Thus the present disclosure also provides a novel signal processor that includes at least the functionality for the high level signal processing subsystem mentioned hereinabove. Accordingly assuming an appropriate ensemble of wireless signal measurements characterizing the wireless signal communications between a particular MS and a networked wireless base station infrastructure have been received and appropriately filtered of noise and transitory values such as by an embodiment of the low level signal processing subsystem disclosed in a copending PCT patent application PCT US97 15933 titled Wireless Location Using A Plurality of Commercial Network Infrastructures by F. W. LeBlanc et. al. filed Sep. 8 1997 from which U.S. Pat. No. 6 236 365 filed Jul. 8 1999 is the U.S. national counterpart these two references being herein fully incorporated by reference the present disclosure uses the output from such a low level signal processing system for determining a most likely location estimate of an MS.

That is once the following steps are appropriately performed e.g. by the LeBlanc U.S. Pat. No. 6 236 365 

Referring now to 4.3 above the filtered and aggregated wireless signal characteristic values are provided to a number of location hypothesizing models denoted First Order Models or FOMs each of which yields a location estimate or location hypothesis related to the location of the target MS. In particular there are location hypotheses for both providing estimates of where the target MS is likely to be and where the target MS is not likely to be. Moreover it is an aspect of the present disclosure that confidence values of the location hypotheses are provided as a continuous range of real numbers from e.g. 1 to 1 wherein the most unlikely areas for locating the target MS are given a confidence value of 1 and the most likely areas for locating the target MS are given a confidence value of 1. That is confidence values that are larger indicate a higher likelihood that the target MS is in the corresponding MS estimated area wherein 1 indicates that the target MS is absolutely NOT in the estimated area 0 indicates a substantially neutral or unknown likelihood of the target MS being in the corresponding estimated area and 1 indicates that the target MS is absolutely within the corresponding estimated area.

Referring to 4.4 above it is an aspect of the present disclosure to provide location hypothesis enhancing and evaluation techniques that can adjust target MS location estimates according to historical MS location data and or adjust the confidence values of location hypotheses according to how consistent the corresponding target MS location estimate is a with historical MS signal characteristic values b with various physical constraints and c with various heuristics. In particular the following capabilities are provided by the present disclosure 

As also mentioned above in 3.3 the present disclosure utilizes adaptive signal processing techniques. One particularly important utilization of such techniques includes the automatic tuning so that e.g. such tuning can be applied to adjusting the values of location processing system parameters that affect the processing performed by embodiments of the present disclosure. For example such system parameters as those used for determining the size of a geographical area to be specified when retrieving location signal data of known MS locations from the historical location signature data base can substantially affect the location processing. In particular a system parameter specifying a minimum size for such a geographical area may if too large cause unnecessary inaccuracies in locating an MS. Accordingly to accomplish a tuning of such system parameters an adaptation engine is included in at least one embodiment of the present disclosure for automatically adjusting or tuning parameters used. Note that in one embodiment the adaptation engine is based on genetic algorithm techniques.

A novel aspect of the present disclosure relies on the discovery that in many areas where MS location services are desired the wireless signal measurements obtained from communications between the target MS and the base station infrastructure are extensive enough to provide sufficiently unique or peculiar values so that the pattern of values alone may identify the location of the target MS. Further assuming a sufficient amount of such location identifying pattern information is captured in the composite wireless signal characteristic values for a target MS and that there is a technique for matching such wireless signal patterns to geographical locations then a wireless location computational model or estimator referred to herein as a first order model or FOM based on this technique may generate a reasonably accurate target MS location estimate. Moreover if an embodiment of the present disclosure e.g. the location signature data base described hereinbelow has captured sufficient wireless signal data from location communications between MSs and the base station infrastructure wherein the locations of the MSs are also verified and captured then this captured data e.g. location signatures can be used to train or calibrate such models to associate the location of a target MS with the distinctive signal characteristics between the target MS and one or more base stations. Accordingly at least one embodiment of the present disclosure includes one or more FOMs that may be generally denoted as classification models wherein such FOMs are trained or calibrated to associate particular composite wireless signal characteristic values with a geographical location where a target MS could likely generate the wireless signal samples from which the composite wireless signal characteristic values are derived. Further at least one embodiment of the present disclosure includes the capability for training calibrating and retraining recalibrating such classification FOMs to automatically maintain the accuracy of these models even though substantial changes to the radio coverage area may occur such as the construction of a new high rise building or seasonal variations due to for example foliage variations .

Note that such classification FOMs that are trained or calibrated to identify target MS locations by the wireless signal patterns produced constitute a particularly novel aspect of the present disclosure. It is well known in the wireless telephony art that the phenomenon of signal multipath and shadow fading renders most analytical location computational techniques such as time of arrival TOA or time difference of arrival TDOA substantially useless in urban areas and particularly in dense urban areas. However this same multipath phenomenon also may produce substantially distinct or peculiar signal measurement patterns wherein such a pattern coincides with a relatively small geographical area. Thus embodiments of the present disclosure utilizes multipath as an advantage for increasing accuracy where for previous location systems multipath has been a source of substantial inaccuracies. Moreover it is worthwhile to note that the utilization of classification FOMs in high multipath environments is especially advantageous in that high multipath environments are typically densely populated. Thus since such environments are also capable of yielding a greater density of MS location signal data from MSs whose actual locations can be obtained there can be a substantial amount of training or calibration data captured by an embodiment of the present disclosure for training or calibrating such classification FOMs and for progressively improving the MS location accuracy of such models. Moreover since it is also a related aspect of an embodiment of the present disclosure to include a plurality stationary low cost low power location detection base stations LBS each having both restricted range MS detection capabilities and a built in MS a grid of such LBSs can be utilized for providing location signal data from the built in MS for re training or re calibrating such classification FOMs.

In one embodiment of the present disclosure one or more classification FOMs may each include a learning module such as an artificial neural network ANN for associating target MS location signal data with a target MS location estimate. Additionally one or more classification FOMs may be statistical prediction models based on such statistical techniques as for example principle decomposition partial least squares or other regression techniques.

It is a further aspect of the present disclosure that the personal communication system PCS infrastructures currently being developed by telecommunication providers offer an appropriate localized infrastructure base upon which to build various personal location systems PLS employing an embodiment of the present disclosure and or utilizing the techniques disclosed herein. In particular an embodiment of the present disclosure is especially suitable for the location of people and or objects using code division multiple access CDMA wireless infrastructures although other wireless infrastructures such as time division multiple access TDMA infrastructures and GSM are also contemplated. Note that CDMA personal communications systems are described in the Telephone Industries Association standard IS 95 for frequencies below 1 GHz and in the Wideband Spread Spectrum Digital Cellular System Dual Mode Mobile Station Base Station Compatibility Standard for frequencies in the 1.8 1.9 GHz frequency bands both of which are incorporated herein by reference. Furthermore CDMA general principles have also been described for example in U.S. Pat. No. 5 109 390 to Gilhousen et al filed Nov. 7 1989 and CDMA Network Engineering Handbook by Qualcomm Inc. each of which is also incorporated herein by reference.

Notwithstanding the above mentioned CDMA references a brief introduction of CDMA is given here. Briefly CDMA is an electromagnetic signal modulation and multiple access scheme based on spread spectrum communication. Each CDMA signal corresponds to an unambiguous pseudorandom binary sequence for modulating the carrier signal throughout a predetermined spectrum of bandwidth frequencies. Transmissions of individual CDMA signals are selected by correlation processing of a pseudonoise waveform. In particular the CDMA signals are separately detected in a receiver by using a correlator which accepts only signal energy from the selected binary sequence and despreads its spectrum. Thus when a first CDMA signal is transmitted the transmissions of unrelated CDMA signals correspond to pseudorandom sequences that do not match the first signal. Therefore these other signals contribute only to the noise and represent a self interference generated by the personal communications system.

As mentioned in the discussion of classification FOMs above an embodiment of the present disclosure can substantially automatically retrain and or recalibrate itself to compensate for variations in wireless signal characteristics e.g. multipath due to environmental and or topographic changes to a geographic area serviced by such an embodiment. For example an embodiment of the present disclosure optionally includes low cost low power base stations denoted location base stations LBS above providing for example CDMA pilot channels to a very limited area about each such LBS. The location base stations may provide limited voice traffic capabilities but each is capable of gathering sufficient wireless signal characteristics from an MS within the location base station s range to facilitate locating the MS. Thus by positioning the location base stations at known locations in a geographic region such as for instance on street lamp poles and road signs additional MS location accuracy can be obtained. That is due to the low power signal output by such location base stations for there to be signaling control communication e.g. pilot signaling and other control signals between a location base station and a target MS the MS must be relatively near the location base station. Additionally for each location base station not in communication with the target MS it is likely that the MS is not near to this location base station. Thus by utilizing information received from both location base stations in communication with the target MS and those that are not in communication with the target MS an embodiment of the present disclosure can substantially narrow the possible geographic areas within which the target MS is likely to be. Further by providing each location base station LBS with a co located stationary wireless transceiver denoted a built in MS above having similar functionality to an MS the following advantages are provided 

It is also an aspect of embodiments of the present disclosure to automatically re calibrate as in 6.3 above with signal characteristics from other known or verified locations. In one embodiment of the present disclosure portable location verifying electronics are provided so that when such electronics are sufficiently near a located target MS the electronics i detect the proximity of the target MS ii determine a highly reliable measurement of the location of the target MS iii provide this measurement to other location determining components of an embodiment of the present disclosure so that the location measurement can be associated and archived with related signal characteristic data received from the target MS at the location where the location measurement is performed. Thus the use of such portable location verifying electronics allows an embodiment of the present disclosure to capture and utilize signal characteristic data from verified substantially random locations for location system calibration as in 6.3 above. Moreover it is important to note that such location verifying electronics can verify locations automatically wherein it is unnecessary for manual activation of a location verifying process.

One embodiment of the present disclosure includes the location verifying electronics as a mobile location base station MBS that can be for example incorporated into a vehicle such as an ambulance police car or taxi. Such a vehicle can travel to sites having a transmitting target MS wherein such sites may be randomly located and the signal characteristic data from the transmitting target MS at such a location can consequently be archived with a verified location measurement performed at the site by the mobile location base station. Moreover it is important to note that such a mobile location base station as its name implies also includes base station electronics for communicating with mobile stations though not necessarily in the manner of a conventional infrastructure base station. In particular a mobile location base station may only monitor signal characteristics such as MS signal strength from a target MS without transmitting signals to the target MS. Alternatively a mobile location base station can periodically be in bi directional communication with a target MS for determining a signal time of arrival or time difference of arrival measurement between the mobile location base station and the target MS. Additionally each such mobile location base station includes components for estimating the location of the mobile location base station such mobile location base station location estimates being important when the mobile location base station is used for locating a target MS via for example time of arrival or time difference of arrival measurements as one skilled in the art will appreciate. In particular a mobile location base station can include 

Furthermore a mobile location base station includes modules for integrating or reconciling distinct mobile location base station location estimates that for example can be obtained using the components and devices of 7.1 through 7.4 above. That is location estimates for the mobile location base station may be obtained from GPS satellite data mobile location base station data provided by the location processing center deadreckoning data obtained from the mobile location base station vehicle deadreckoning devices and location data manually input by an operator of the mobile location base station.

The location estimating system of the present disclosure offers many advantages over existing location systems. The system of the present disclosure for example is readily adaptable to existing wireless communication systems and can accurately locate people and or objects in a cost effective manner. In particular the present disclosure requires few if any modifications to commercial wireless communication systems for implementation. Thus existing personal communication system infrastructure base stations and other components of for example commercial CDMA infrastructures are readily adapted to an embodiment of the present disclosure. An embodiment of the present disclosure can be used to locate people and or objects that are not in the line of sight of a wireless receiver or transmitter can reduce the detrimental effects of multipath on the accuracy of the location estimate can potentially locate people and or objects located indoors as well as outdoors and uses a number of wireless stationary transceivers for location. An embodiment of the present disclosure employs a number of distinctly different location computational models for location which provides a greater degree of accuracy robustness and versatility than is possible with existing systems. For instance the location models provided include not only the radius radius TOA and TDOA techniques but also adaptive artificial neural net techniques. Further an embodiment of the present disclosure is able to adapt to the topography of an area in which location service is desired. An embodiment of the present disclosure is also able to adapt to environmental changes substantially as frequently as desired. Thus an embodiment of the present disclosure is able to take into account changes in the location topography over time without extensive manual data manipulation. Moreover an embodiment of the present disclosure can be utilized with varying amounts of signal measurement inputs. Thus if a location estimate is desired in a very short time interval e.g. less than approximately one to two seconds then the present location estimating system can be used with only as much signal measurement data as is possible to acquire during an initial portion of this time interval. Subsequently after a greater amount of signal measurement data has been acquired additional more accurate location estimates may be obtained. Note that this capability can be useful in the context of 911 emergency response in that a first quick coarse wireless mobile station location estimate can be used to route a 911 call from the mobile station to a 911 emergency response center that has responsibility for the area containing the mobile station and the 911 caller. Subsequently once the 911 call has been routed according to this first quick location estimate by continuing to receive additional wireless signal measurements more reliable and accurate location estimates of the mobile station can be obtained.

Moreover there are numerous additional advantages of the system of the present disclosure when applied in CDMA communication systems. The location system of the present disclosure readily benefits from the distinct advantages of the CDMA spread spectrum scheme namely these advantages include the exploitation of radio frequency spectral efficiency and isolation by a monitoring voice activity b management of two way power control c provisioning of advanced variable rate modems and error correcting signal encoding d inherent resistance to fading e enhanced privacy and f multiple rake digital data receivers and searcher receivers for correlation of signal multipaths.

At a more general level it is an aspect of the present disclosure to demonstrate the utilization of various novel computational paradigms such as 

Note that the multiple hypothesis architecture provided herein is useful in implementing solutions in a wide range of applications. For example the following additional applications are within the scope of the present disclosure 

For instance in weather prediction applications it is not uncommon for computational models to require large amounts of computational resources. Thus such models running at various remote computational facilities can transfer weather prediction hypotheses e.g. the likely path of a hurricane to a site that performs hypothesis adjustments according to i past performance of the each model ii particular constraints and or heuristics and subsequently outputs a most likely estimate for a particular weather condition.

In an alternative embodiment of the present disclosure the processing following the generation of location hypotheses each having an initial location estimate by the first order models may be such that this processing can be provided on Internet user nodes and the first order models may reside at Internet server sites. In this configuration an Internet user may request hypotheses from such remote first order models and perform the remaining processing at his her node.

In other embodiments of the present disclosure a fast albeit less accurate location estimate may be initially performed for very time critical location applications where approximate location information may be required. For example less than 1 second response for a mobile station location embodiment of the present disclosure may be desired for 911 emergency response location requests. Subsequently once a relatively coarse location estimate has been provided a more accurate most likely location estimate can be performed by repeating the location estimation processing a second time with e.g. additional with measurements of wireless signals transmitted between a mobile station to be located and a network of base stations with which the mobile station is communicating thus providing a second more accurate location estimate of the mobile station.

Additionally note that it is within the scope of the present disclosure to provide one or more central location development sites that may be networked to for example geographically dispersed location centers providing location services according to the present disclosure wherein the FOMs may be accessed substituted enhanced or removed dynamically via network connections via e.g. the Internet with a central location development site. Thus a small but rapidly growing municipality in substantially flat low density area might initially be provided with access to for example two or three FOMs for generating location hypotheses in the municipality s relatively uncluttered radio signaling environment. However as the population density increases and the radio signaling environment becomes cluttered by for example thermal noise and multipath additional or alternative FOMs may be transferred via the network to the location center for the municipality.

Note that in some embodiments of the present disclosure since there is a lack of sequencing between the FOMs and subsequent processing of location hypotheses the FOMs can be incorporated into an expert system if desired. For example each FOM may be activated from an antecedent of an expert system rule. Thus the antecedent for such a rule can evaluate to TRUE if the FOM outputs a location hypothesis and the consequent portion of such a rule may put the output location hypothesis on a list of location hypotheses occurring in a particular time window for subsequent processing by the location center. Alternatively activation of the FOMs may be in the consequents of such expert system rules. That is the antecedent of such an expert system rule may determine if the conditions are appropriate for invoking the FOM s in the rule s consequent.

Of course other software architectures may also to used in implementing the processing of the location center without departing from scope of the present disclosure. In particular object oriented architectures are also within the scope of the present disclosure. For example the FOMs may be object methods on an MS location estimator object wherein the estimator object receives substantially all target MS location signal data output by the signal filtering subsystem. Alternatively software bus architectures are contemplated by the present disclosure as one skilled in the art will understand wherein the software architecture may be modular and facilitate parallel processing.

Further features and advantages of the present disclosure are provided by the accompanying figures together with the detailed description and the appendices provided hereinbelow.

Various digital wireless communication standards have been introduced such as Advanced Mobile Phone Service AMPS Narrowband Advanced Mobile Phone Service NAMPS code division multiple access CDMA and Time Division Multiple Access TDMA e.g. Global Systems Mobile GSM . These standards provide numerous enhancements for advancing the quality and communication capacity for wireless applications. Referring to CDMA this standard is described in the Telephone Industries Association standard IS 95 for frequencies below 1 GHz and in J STD 008 the Wideband Spread Spectrum Digital Cellular System Dual Mode Mobile Station Base station Compatibility Standard for frequencies in the 1.8 1.9 GHz frequency bands. Additionally CDMA general principles have been described for example in U.S. Pat. No. 5 109 390 Diversity Receiver in a CDMA Cellular Telephone System by Gilhousen. There are numerous advantages of such digital wireless technologies such as CDMA radio technology. For example the CDMA spread spectrum scheme exploits radio frequency spectral efficiency and isolation by monitoring voice activity managing two way power control provision of advanced variable rate modems and error correcting signal design and includes inherent resistance to fading enhanced privacy and provides for multiple rake digital data receivers and searcher receivers for correlation of multiple physical propagation paths resembling maximum likelihood detection as well as support for multiple base station communication with a mobile station i.e. soft or softer hand off capability. When coupled with a location center as described herein substantial improvements in radio location can be achieved. For example the CDMA spread spectrum scheme exploits radio frequency spectral efficiency and isolation by monitoring voice activity managing two way power control provision of advanced variable rate modems and error correcting signal design and includes inherent resistance to fading enhanced privacy and provides for multiple rake digital data receivers and searcher receivers for correlation of multiple physical propagation paths resembling maximum likelihood detection as well as support for multiple base station communication with a mobile station i.e. soft hand off capability. Moreover this same advanced radio communication infrastructure can also be used for enhanced radio location. As a further example the capabilities of IS 41 and AIN already provide a broad granularity of wireless location as is necessary to for example properly direct a terminating call to an MS. Such information originally intended for call processing usage can be re used in conjunction with the location center described herein to provide wireless location in the large i.e. to determine which country state and city a particular MS is located and wireless location in the small i.e. which location plus or minus a few hundred feet within one or more base stations a given MS is located .

Since location base stations can be located on e.g. each floor of a multi story building the wireless location technology described herein can be used to perform location in terms of height as well as by latitude and longitude.

In operation an MS may utilize one or more of the wireless technologies CDMA TDMA AMPS NAMPS or GSM for wireless communication with a one or more infrastructure base stations b mobile base station s or c an LBS .

Referring to again additional detail is provided of typical base station coverage areas sectorization and high level components within a radio coverage area including the MSC . Although base stations may be placed in any configuration a typical deployment configuration is approximately in a cellular honeycomb pattern although many practical tradeoffs exist such as site availability versus the requirement for maximal terrain coverage area. To illustrate three such exemplary base stations BSs are A B and C each of which radiate referencing signals within their area of coverage to facilitate mobile station MS radio frequency connectivity and various timing and synchronization functions. Note that some base stations may contain no sectors e.g. E thus radiating and receiving signals in a 360 degree omnidirectional coverage area pattern or the base station may contain smart antennas which have specialized coverage area patterns. However the generally most frequent base stations have three sector coverage area patterns. For example base station A includes sectors additionally labeled a b and c. Accordingly each of the sectors radiate and receive signals in an approximate 120 degree arc from an overhead view. As one skilled in the art will understand actual base station coverage areas stylistically represented by hexagons about the base stations generally are designed to overlap to some extent thus ensuring seamless coverage in a geographical area. Control electronics within each base station are used to communicate with a mobile stations . Information regarding the coverage area for each sector such as its range area and holes or areas of no coverage within the radio coverage area may be known and used by the location center to facilitate location determination. Further during communication with a mobile station the identification of each base station communicating with the MS as well as any sector identification information may be known and provided to the location center .

In the case of the base station types and communicating location information a base station or mobility controller BSC controls processes and provides an interface between originating and terminating telephone calls from to mobile station MS and the mobile switch center MSC . The MSC on the other hand performs various administration functions such as mobile station registration authentication and the relaying of various system parameters as one skilled in the art will understand.

The base stations may be coupled by various transport facilities such as leased lines frame relay T Carrier links optical fiber links or by microwave communication links.

When an MS such as a CDMA AMPS NAMPS mobile telephone is powered on and in the idle state it constantly monitors the pilot signal transmissions from each of the base stations located at nearby cell sites. Since base station sector coverage areas may often overlap such overlapping enables an MS to detect and in the case of certain wireless technologies communicate simultaneously along both the forward and reverse paths with multiple base stations and or sectors . In the constantly radiating pilot signals from base station sectors such as sectors a b and c of BS A are detectable by MSs within the coverage area for BS A. That is such a mobile station can scan for pilot channels corresponding to given base station sector identifiers IDs for determining which coverage area i.e. cell the mobile station is contained. This is performed by comparing signal strengths of pilot signals transmitted from these particular cell sites.

The mobile station then initiates a registration request with the MSC via the base station controller . The MSC determines whether or not the mobile station is allowed to proceed with the registration process except e.g. in the case of a 911 call wherein no registration process is required . Once any required registration is complete calls may be originated from the mobile station or calls or short message service messages can be received from the network. Note that the MSC communicates as appropriate with a class 4 5 wireline telephony circuit switch or other central offices connected to the PSTN network. Such central offices connect to wireline terminals such as telephones or any communication device compatible with a wireline. The PSTN may also provide connections to long distance networks and other networks.

The MSC may also utilize IS 41 data circuits or trunks connecting to signal transfer point which in turn connects to a service control point via Signaling System 7 SS7 signaling links e.g. trunks for intelligent call processing as one skilled in the art will understand. In the case of wireless AIN services such links are used for call routing instructions of calls interacting with the MSC or any switch capable of providing service switching point functions and the public switched telephone network PSTN with possible termination back to the wireless network.

Still referring to the location center gateway LC interfaces with the MSC either via dedicated transport facilities using e.g. any number of LAN WAN technologies such as Ethernet fast Ethernet frame relay virtual private networks etc. or via the PSTN . The LC may receive autonomous e.g. unsolicited command response messages regarding for example a the state of the wireless network of each service provider utilizing the LC for wireless location services b MS and BS radio frequency RF measurements c communications with any MBSs and d location applications requesting MS locations using the location center gateway . Conversely the LC may provide data and control information to each of the above components in a d . Additionally the LC may provide location information to an MS via a BS . Moreover in the case of the use of a mobile base station MBS several communications paths may exist with the LC .

The MBS may act as a low cost partially functional moving base station and is in one embodiment situated in a vehicle where an operator may engage in MS searching and tracking activities. In providing these activities using CDMA the MBS provides a forward link pilot channel for a target MS and subsequently receives unique BS pilot strength measurements from the MS . The MBS also includes a mobile station for data communication with the LC via a BS . In particular such data communication includes telemetering at least the geographic position or estimates thereof of the MBS as well as various RF measurements related to signals received from the target MS and in some embodiments MBS estimates of the location of the target MS . In some embodiments the MBS may utilize multiple beam fixed antenna array elements and or a moveable narrow beam antenna such as a microwave dish . The antennas for such embodiments may have a known orientation in order to further deduce a radio location of the target MS with respect to an estimated current location of the MBS . As will be described in more detail herein below the MBS may further contain a global positioning system GPS distance sensors deadreckoning electronics as well as an on board computing system and display devices for locating both the MBS itself as well as tracking and locating the target MS . The computing and display provides a means for communicating the position of the target MS on a map display to an operator of the MBS .

Each location base station LBS is a low cost location device. Each such LBS communicates with one or more of the infrastructure base stations using one or more wireless technology interface standards. In some embodiments to provide such LBS s cost effectively each LBS only partially or minimally supports the air interface standards of the one or more wireless technologies used in communicating with both the BSs and the MSs . Each LBS when put in service is placed at a fixed location such as at a traffic signal lamp post etc. and wherein the location of the LBS may be determined as accurately as for example the accuracy of the locations of the infrastructure BSs . Assuming the wireless technology CDMA is used each BS uses a time offset of the pilot PN sequence to identify a forward CDMA pilot channel. In one embodiment each LBS emits a unique time offset pilot PN sequence channel in accordance with the CDMA standard in the RF spectrum designated for BSs such that the channel does not interfere with neighboring BSs cell site channels nor would it interfere with neighboring LBSs . However as one skilled in the art will understand time offsets in CDMA chip sizes may be re used within a PCS system thus providing efficient use of pilot time offset chips thereby achieving spectrum efficiency. Each LBS may also contain multiple wireless receivers in order to monitor transmissions from a target MS . Additionally each LBS contains mobile station electronics thereby allowing the LBS to both be controlled by the LC and to transmit information to the LC via at least one neighboring BS .

As mentioned above when the location of a particular target MS is desired the LC can request location information about the target MS from for instance one or more activated LBSs in a geographical area of interest. Accordingly whenever the target MS is in such an area or is suspected of being in the area either upon command from the LC or in a substantially continuous fashion the LBS s pilot channel appears to the target MS as a potential neighboring base station channel and consequently is placed for example in the CDMA neighboring set or the CDMA remaining set of the target MS as one familiar with the CDMA standards will understand .

During the normal CDMA pilot search sequence of the mobile station initialization state in the target MS the target MS will if within range of such an activated LBS detect the LBS pilot presence during the CDMA pilot channel acquisition substrate. Consequently the target MS performs RF measurements on the signal from each detected LBS . Similarly an activated LBS can perform RF measurements on the wireless signals from the target MS . Accordingly each LBS detecting the target MS may subsequently telemeter back to the LC measurement results related to signals from to the target MS . Moreover upon command the target MS will telemeter back to the LC its own measurements of the detected LBSs and consequently this new location information in conjunction with location related information received from the BSs can be used to locate the target MS .

It should be noted that an LBS will normally deny hand off requests since typically the LBS does not require the added complexity of handling voice or traffic bearer channels although economics and peak traffic load conditions would dictate preference here. Note that GPS timing information needed by any CDMA base station is either achieved via a the inclusion of a local GPS receiver or via a telemetry process from a neighboring conventional BS which contains a GPS receiver and timing information. Since energy requirements are minimal in such an LBS rechargeable batteries or solar cells may be used to power the LBSs. Further no expensive terrestrial transport link is typically required since two way communication is provided by an included MS or an electronic variation thereof within each LBS. Thus LBSs may be placed in numerous locations such as 

A location application programming interface or L API see and including L API Loc APP L API MSC and L API SCP shown in may be provided between the location center gateway LC and the mobile switch center MSC network element type in order to send and receive various control signals and data messages. The L API should be implemented using a preferably high capacity physical layer communications interface such as IEEE standard 802.3 10 baseT Ethernet although other physical layer interfaces could be used such as fiber optic ATM frame relay etc. At least two forms of L API implementation are possible. In a first case the signal control and data messages are provided using the MSC vendor s native operations messages inherent in the product offering without any special modifications. In a second case the L API includes a full suite of commands and messaging content specifically optimized for wireless location purposes which may require some although minor development on the part of an MSC vendor.

Referring to the signal processing subsystem such a signal processing subsystem may a receive control messages and signal measurements from one or more wireless service provider networks and b transmit appropriate control messages to such wireless networks via the location applications programming interface referenced earlier for wireless location purposes. The signal processing subsystem additionally provides various signal identification conditioning and pre processing functions including buffering signal type classification signal filtering message control and routing functions to the location estimating modules or FOMs.

There can be several combinations of Delay Spread Signal Strength sets of measurements made available to the signal processing subsystem . In some cases a mobile station may be able to detect up to three or four pilot channels representing three to four base stations or as few as one pilot channel depending upon the environment and wireless network configuration. Similarly possibly more than one BS can detect a mobile station transmitter signal as evidenced by the provision of cell diversity or soft hand off in the CDMA standards and the fact that multiple CMRS base station equipment commonly will overlap coverage areas.

For each mobile station or BS transmitted signal detected by a receiver group at a station multiple delayed signals or fingers may be detected and tracked resulting from multipath radio propagation conditions from a given transmitter.

In typical spread spectrum diversity CDMA receiver design the first finger represents the most direct or least delayed multipath signal. Second or possibly third or fourth fingers may also be detected and tracked assuming the mobile station contains a sufficient number of data receivers. Although traditional TOA and TDOA methods would discard subsequent fingers related to the same transmitted finger collection and use of these additional values can prove useful to reduce location ambiguity and are thus collected by the Signal Processing subsystem in the Location Center .

From the mobile receiver s perspective a number of combinations of measurements could be made available to the Location Center. Due to the disperse and near random nature of CDMA radio signals and propagation characteristics traditional TOA TDOA location methods have failed in the past because the number of signals received in different locations are different. In a particularly small urban area of say less than 500 square feet the number of RF signals and their multipath components may vary by over 100 percent.

Due to the large capital outlay costs associated with providing three or more overlapping base station coverage signals in every possible location most practical digital PCS deployments result in fewer than three base station pilot channels being reportable in the majority of location areas thus resulting in a larger more amorphous location estimate. This consequence requires a family of location estimate location modules each firing whenever suitable data has been presented to a model thus providing a location estimate to a backend subsystem which resolves ambiguities.

In one embodiment of this invention using backend hypothesis resolution by utilizing existing knowledge concerning base station coverage area boundaries such as via the compilation a RF coverage database either via RF coverage area simulations or field tests the location error space is decreased. Negative logic Venn diagrams can be generated which deductively rule out certain location estimate hypotheses.

Although the forward link mobile station s received relative signal strength RRSS of detected nearby base station transmitter signals can be used directly by the location estimate modules the CDMA base station s reverse link received relative signal strength RRSS of the detected mobile station transmitter signal must be modified prior to location estimate model use since the mobile station transmitter power level changes nearly continuously and would thus render relative signal strength useless for location purposes.

One adjustment variable and one factor value are required by the signal processing subsystem in the CDMA air interface case 1 instantaneous relative power level in dBm IRPL of the mobile station transmitter and 2 the mobile station Power Class. By adding the IRPL to the RRSS a synthetic relative signal strength SRSS of the mobile station signal detected at the BS is derived which can be used by location estimate model analysis as shown below SRSS RRSS IRPL in dBm .

Accordingly SRSSis a corrected indication of the effective path loss in the reverse direction mobile station to BS and therefore is now comparable with RRSSand can be used to provide a correlation with either distance or shadow fading because it now accounts for the change of the mobile station transmitter s power level. Note that the two signal measurements RRSSand SRSScan now be processed in a variety of ways to achieve a more robust correlation with distance or shadow fading.

Although Rayleigh fading appears as a generally random noise generator essentially destroying the correlation value of either RRSSor SRSSmeasurements with distance individually several mathematical operations or signal processing functions can be performed on each measurement to derive a more robust relative signal strength value overcoming the adverse Rayleigh fading effects. Examples include averaging taking the strongest value and weighting the strongest value with a greater coefficient than the weaker value then averaging the results. This signal processing technique takes advantage of the fact that although a Rayleigh fade may often exist in either the forward or reverse path it is much less probable that a Rayleigh fade also exists in the reverse or forward path respectively. A shadow fade however similarly affects the signal strength in both paths.

At this point a CDMA radio signal direction independent of net relative signal strength measurement can be derived which can be used to establish a correlation with either distance or shadow fading or both. Although the ambiguity of either shadow fading or distance cannot be determined other means can be used in conjunction such as the fingers of the CDMA delay spread measurement and any other TOA TDOA calculations from other geographical points. In the case of a mobile station with a certain amount of shadow fading between its BS the first finger of a CDMA delay spread signal is most likely to be a relatively shorter duration than the case where the mobile station and BS are separated by a greater distance since shadow fading does not materially affect the arrival time delay of the radio signal.

By performing a small modification in the control electronics of the CDMA base station and mobile station receiver circuitry it is possible to provide the signal processing subsystem reference within the location center with data that exceed the one to one CDMA delay spread fingers to data receiver correspondence. Such additional information in the form of additional CDMA fingers additional multipath and all associated detectable pilot channels provides new information which is used to enhance the accuracy of the location center s location estimate location estimate modules.

This enhanced capability is provided via a control message sent from the location center to the mobile switch center and then to the base station s in communication with or in close proximity with mobile stations to be located. Two types of location measurement request control messages are needed one to instruct a target mobile station i.e. the mobile station to be located to telemeter its BS pilot channel measurements back to the primary BS and from there to the mobile switch center and then to the location system . The second control message is sent from the location system to the mobile switch center then to first the primary BS instructing the primary BS s searcher receiver to output i.e. return to the initiating request message source the detected target mobile station transmitter CDMA pilot channel offset signal and their corresponding delay spread finger peak values and related relative signal strengths.

The control messages are implemented in standard mobile station and BS CDMA receivers such that all data results from the search receiver and multiplexed results from the associated data receivers are available for transmission back to the location center . Appropriate value ranges are required regarding mobile station parameters T ADD T DROP and the ranges and values for the Active Neighboring and Remaining Pilot sets registers held within the mobile station memory. Further mobile station receiver details have been discussed above.

In the normal case without any specific multiplexing means to provide location measurements exactly how many CDMA pilot channels and delay spread fingers can or should be measured vary according to the number of data receivers contained in each mobile station . As a guide it is preferred that whenever RF characteristics permit at least three pilot channels and the strongest first three fingers are collected and processed. From the BS perspective it is preferred that the strongest first four CDMA delay spread fingers and the mobile station power level be collected and sent to the location system for each of preferably three BSs which can detect the mobile station . A much larger combination of measurements is potentially feasible using the extended data collection capability of the CDMA receivers.

Input queues are required in order to stage the rapid acceptance of a significant amount of RF signal measurement data used for either location estimate purposes or to accept autonomous location data. Each location request using fixed base stations may in one embodiment contain from 1 to 128 radio frequency measurements from the mobile station which translates to approximately 61.44 kilobytes of signal measurement data to be collected within 10 seconds and 128 measurements from each of possibly four base stations or 245.76 kilobytes for all base stations for a total of approximately 640 signal measurements from the five sources or 307.2 kilobytes to arrive per mobile station location request in 10 seconds. An input queue storage space is assigned at the moment a location request begins in order to establish a formatted data structure in persistent store. Depending upon the urgency of the time required to render a location estimate fewer or more signal measurement samples can be taken and stored in the input queue s accordingly.

The signal processing subsystem supports a variety of wireless network signaling measurement capabilities by detecting the capabilities of the mobile and base station through messaging structures provided by the location application programming interface L API . Detection is accomplished in the signal classifier by referencing a mobile station database table within the signal processor database which provides given a mobile station identification number mobile station revision code other mobile station characteristics. Similarly a mobile switch center table provides MSC characteristics and identifications to the signal classifier filter . The signal classifier filter adds additional message header information that further classifies the measurement data which allows the digital signal processor and image filter components to select the proper internal processing subcomponents to perform operations on the signal measurement data for use by the location estimate modules.

Regarding service control point messages of L API SCP interface autonomously received from the input queue the signal classifier filter determines via a signal processing database query whether such a message is to be associated with a home base station module. Thus appropriate header information is added to the message thus enabling the message to pass through the digital signal processor unaffected to the output queue and then to the router distributor . The router distributor then routes the message to the HBS first order model. Those skilled in the art will understand that associating location requests from Home Base Station configurations require substantially less data the mobile identification number and the associated wireline telephone number transmission from the home location register are on the order of less than 32 bytes. Consequentially the home base station message type could be routed without any digital signal processing.

Output queue s are required for similar reasons as input queues relatively large amounts of data must be held in a specific format for further location processing by the location estimate modules .

The router and distributor component is responsible for directing specific signal measurement data types and structures to their appropriate modules. For example the HBS FOM has no use for digital filtering structures whereas the TDOA module would not be able to process an HBS response message.

The controller is responsible for staging the movement of data among the signal processing subsystem components input queue digital signal processor router distributor and the output queue and to initiate signal measurements within the wireless network in response from an Internet location request message in via the location application programming interface.

In addition the controller receives autonomous messages from the MSC via the location applications programming interface or L API and the input queue whenever a 9 1 1 wireless call is originated. The mobile switch center provides this autonomous notification to the location system as follows by specifying the appropriate mobile switch center operations and maintenance commands to surveil calls based on certain digits dialed such as 9 1 1 the location applications programming interface in communications with the MSCs receives an autonomous notification whenever a mobile station user dials 9 1 1. Specifically a bi directional authorized communications port is configured usually at the operations and maintenance subsystem of the MSCs or with their associated network element manager system s with a data circuit such as a DS 1 with the location applications programming interface . Next the call trace capability of the mobile switch center is activated for the respective communications port. The exact implementation of the vendor specific man machine or Open Systems Interface OSI command s and their associated data structures generally vary among MSC vendors however the trace function is generally available in various forms and is required in order to comply with Federal Bureau of Investigation authorities for wire tap purposes. After the appropriate surveillance commands are established on the MSC such 9 1 1 call notifications messages containing the mobile station identification number MIN and in U.S. FCC phase 1 E9 1 1 implementations a pseudo automatic number identification a.k.a. pANI which provides an association with the primary base station in which the 9 1 1 caller is in communication. In cases where the pANI is known from the onset the signal processing subsystem avoids querying the MSC in question to determine the primary base station identification associated with the 9 1 1 mobile station caller.

After the signal processing controller receives the first message type the autonomous notification message from the mobile switch center to the location system containing the mobile identification number and optionally the primary base station identification the controller queries the base station table in the signal processor database to determine the status and availability of any neighboring base stations including those base stations of other CMRS in the area. The definition of neighboring base stations include not only those within a provisionable hop based on the cell design reuse factor but also includes in the case of CDMA results from remaining set information autonomously queried to mobile stations with results stored in the base station table. Remaining set information indicates that mobile stations can detect other base station sector pilot channels which may exceed the hop distance yet are nevertheless candidate base stations or sectors for wireless location purposes. Although cellular and digital cell design may vary hop distance is usually one or two cell coverage areas away from the primary base station s cell coverage area.

Having determined a likely set of base stations which may both detect the mobile station s transmitter signal as well as to determine the set of likely pilot channels i.e. base stations and their associated physical antenna sectors detectable by the mobile station in the area surrounding the primary base station sector the controller initiates messages to both the mobile station and appropriate base stations sectors to perform signal measurements and to return the results of such measurements to the signal processing system regarding the mobile station to be located. This step may be accomplished via several interface means. In a first case the controller utilizes for a given MSC predetermined storage information in the MSC table to determine which type of commands such as man machine or OSI commands are needed to request such signal measurements for a given MSC. The controller generates the mobile and base station signal measurement commands appropriate for the MSC and passes the commands via the input queue and the locations application programming interface in to the appropriate MSC using the authorized communications port mentioned earlier. In a second case the controller communicates directly with base stations within having to interface directly with the MSC for signal measurement extraction.

Upon receipt of the signal measurements the signal classifier in examines location application programming interface provided message header information from the source of the location measurement for example from a fixed BS a mobile station a distributed antenna system in or message location data related to a home base station provided by the location applications programming interface L API via the input queue in and determines whether or not device filters or image filters are needed and assesses a relative priority in processing such as an emergency versus a background location task in terms of grouping like data associated with a given location request. In the case where multiple signal measurement requests are outstanding for various base stations some of which may be associated with a different CMRS network and additional signal classifier function includes sorting and associating the appropriate incoming signal measurements together such that the digital signal processor processes related measurements in order to build ensemble data sets. Such ensembles allow for a variety of functions such as averaging outlier removal over a time period and related filtering functions and further prevent association errors from occurring in location estimate processing.

Another function of the signal classifier low pass filter component is to filter information that is not useable or information that could introduce noise or the effect of noise in the location estimate modules. Consequently low pass matching filters are used to match the in common signal processing components to the characteristics of the incoming signals. Low pass filters match Mobile Station base station CMRS and MSC characteristics as well as to classify Home Base Station messages.

The signal processing subsystem contains a base station database table which captures the maximum number of CDMA delay spread fingers for a given base station.

The base station identification code or CLLI or common language level identification code is useful in identifying or relating a human labeled name descriptor to the Base Station. Latitude Longitude and elevation values are used by other subsystems in the location system for calibration and estimation purposes. As base stations and or receiver characteristics are added deleted or changed with respect to the network used for location purposes this database table must be modified to reflect the current network configuration.

Just as an upgraded base station may detect additional CDMA delay spread signals newer or modified mobile stations may detect additional pilot channels or CDMA delay spread fingers. Additionally different makes and models of mobile stations may acquire improved receiver sensitivities suggesting a greater coverage capability. A table may establish the relationships among various mobile station equipment suppliers and certain technical data relevant to this location invention.

Although not strictly necessary the MIN can be populated in this table from the PCS Service Provider s Customer Care system during subscriber activation and fulfillment and could be changed at deactivation or anytime the end user changes mobile stations. Alternatively since the MIN manufacturer model number and software revision level information is available during a telephone call this information could extracted during the call and the remaining fields populated dynamically based on manufacturer s specifications information previously stored in the signal processing subsystem . Default values are used in cases where the MIN is not found or where certain information must be estimated.

A low pass mobile station filter contained within the signal classifier low pass filter of the signal processing subsystem uses the above table data to perform the following functions 1 act as a low pass filter to adjust the nominal assumptions related to the maximum number of CDMA fingers pilots detectable and 2 to determine the transmit power class and the receiver thermal noise floor. Given the detected reverse path signal strength the required value of SRSS a corrected indication of the effective path loss in the reverse direction mobile station to BS can be calculated based on data contained within the mobile station table stored in the signal processing database .

The effects of the maximum number of CDMA fingers allowed and the maximum number of pilot channels allowed essentially form a low pass filter effect wherein the least common denominator of characteristics are used to filter the incoming RF signal measurements such that a one for one matching occurs. The effect of the transmit power class and receiver thermal noise floor values is to normalize the characteristics of the incoming RF signals with respect to those RF signals used.

The signal classifier filter is in communication with both the input queue and the signal processing database . In the early stage of a location request the signal processing subsystem shown in e.g. and will receive the initiating location request from either an autonomous 911 notification message from a given MSC or from a location application for which mobile station characteristics about the target mobile station is required. Referring to a query is made from the signal processing controller to the signal processing database specifically the mobile station table to determine if the mobile station characteristics associated with the MIN to be located is available in table . If the data exists then there is no need for the controller to query the wireless network in order to determine the mobile station characteristics thus avoiding additional real time processing which would otherwise be required across the air interface in order to determine the mobile station MIN characteristics. The resulting mobile station information my be provided either via the signal processing database or alternatively a query may be performed directly from the signal processing subsystem to the MSC in order to determine the mobile station characteristics.

Referring now to another location application programming interface L API CCS to the appropriate CMRS customer care system provides the mechanism to populate and update the mobile station table within the database . The L API CCS contains its own set of separate input and output queues or similar implementations and security controls to ensure that provisioning data is not sent to the incorrect CMRS and that a given CMRS cannot access any other CMRS data. The interface to the customer care system for CMRS A provides an autonomous or periodic notification and response application layer protocol type consisting of add delete change and verify message functions in order to update the mobile station table within the signal processing database via the controller . A similar interface is used to enable provisioning updates to be received from CMRS B customer care system

Although the L API CCS application message set may be any protocol type which supports the autonomous notification message with positive acknowledgment type the T1M1.5 group within the American National Standards Institute has defined a good starting point in which the L API CCS could be implemented using the robust OSI TMN X interface at the service management layer. The object model defined in Standards proposal number T1M1.5 96 22R9 Operations Administration Maintenance and Provisioning OAM P Model for Interface Across Jurisdictional Boundaries to Support Electronic Access Service Ordering Inquiry Function can be extended to support the L API CCS information elements as required and further discussed below. Other choices in which the L API CCS application message set may be implemented include ASCII binary or any encrypted message set encoding using the Internet protocols such as TCP IP simple network management protocol http https and email protocols.

Referring to the digital signal processor DSP in communication with the signal classifier LP filter the DSP provides a time series expansion method to convert non HBS data from a format of an signal measure data ensemble of time series based radio frequency data measurements collected as discrete time slice samples to a three dimensional matrix location data value image representation. Other techniques further filter the resultant image in order to furnish a less noisy training and actual data sample to the location estimate modules.

After 128 samples in one embodiment of data are collected of the delay spread relative signal strength RF data measurement sample mobile station RX for BS 1 are grouped into a quantization matrix where rows constitute relative signal strength intervals and columns define delay intervals. Each measurement row column pair which could be represented as a complex number or Cartesian point pair is added to their respective values to generate a Z direction of frequency of recurring measurement value pairs or a density recurrence function. By next applying a grid function to each x y and z value a three dimensional surface grid is generated which represents a location data value or unique print of that 128 sample measurement.

In the general case where a mobile station is located in an environment with varied clutter patterns such as terrain undulations unique man made structure geometries thus creating varied multipath signal behaviors such as a city or suburb although the first CDMA delay spread finger may be the same value for a fixed distance between the mobile station and BS antennas as the mobile station moves across such an area different finger data are measured. In the right image for the defined BS antenna sector location classes or squares numbered one through seven are shown across a particular range of line of position LOP .

A traditional TOA TDOA ranging method between a given BS and mobile station only provides a range along an arc thus introducing ambiguity error. However a unique three dimensional image can be used in this method to specifically identify with recurring probability a particular unique location class along the same Line Of Position as long as the multipath is unique by position but generally repeatable thus establishing a method of not only ranging but also of complete latitude longitude location estimation in a Cartesian space. In other words the unique shape of the mountain image enables a correspondence to a given unique location class along a line of position thereby eliminating traditional ambiguity error.

Although man made external sources of interference Rayleigh fades adjacent and co channel interference and variable clutter such as moving traffic introduce unpredictability thus no mountain image would ever be exactly alike three basic types of filtering methods can be used to reduce matching comparison error from a training case to a location request case 1 select only the strongest signals from the forward path BS to mobile station and reverse path mobile station to BS 2 convolute the forward path sample image with the reverse path sample image and 3 process all image samples through various digital image filters to discard noise components.

In one embodiment convolution of forward and reverse images is performed to drive out noise. This is one embodiment that essentially nulls noise completely even if strong and recurring as long as that same noise characteristic does not occur in the opposite path.

The third embodiment or technique of processing CDMA delay spread profile images through various digital image filters provides a resultant image enhancement in the sense of providing a more stable pattern recognition paradigm to the neural net location estimate model. For example image histogram equalization can be used to rearrange the images intensity values or density recurrence values so that the image s cumulative histogram is approximately linear.

Other methods which can be used to compensate for a concentrated histogram include 1 Input Cropping 2 Output Cropping and 3 Gamma Correction. Equalization and input cropping can provide particularly striking benefits to a CDMA delay spread profile image. Input cropping removes a large percentage of random signal characteristics that are non recurring.

Other filters and or filter combinations can be used to help distinguish between stationary and variable clutter affecting multipath signals. For example it is desirable to reject multipath fingers associated with variable clutter since over a period of a few minutes such fingers would not likely recur. Further filtering can be used to remove recurring at least during the sample period and possibly strong but narrow pencils of RF energy. A narrow pencil image component could be represented by a near perfect reflective surface such as a nearby metal panel truck stopped at a traffic light.

On the other hand stationary clutter objects such as concrete and glass building surfaces adsorb some radiation before continuing with a reflected ray at some delay. Such stationary clutter affected CDMA fingers are more likely to pass a 4 4 neighbor Median filter as well as a 40 to 50 percent Input Crop filter and are thus more suited to neural net pattern recognition. However when subjected to a 4 4 neighbor Median filter and 40 percent clipping pencil shaped fingers are deleted. Other combinations include for example a 50 percent cropping and 4 4 neighbor median filtering. Other filtering methods include custom linear filtering adaptive Weiner filtering and custom nonlinear filtering.

The DSP may provide data ensemble results such as extracting the shortest time delay with a detectable relative signal strength to the router distributor or alternatively results may be processed via one or more image filters with subsequent transmission to the router distributor . The router distributor examines the processed message data from the DSP and stores routing and distribution information in the message header. The router distributor then forwards the data messages to the output queue for subsequent queuing then transmission to the appropriate location estimator FOMs.

At a very high level the location center computes location estimates for a wireless Mobile Station denoted the target MS or MS by performing the following steps 

In order to describe how the steps 23.1 through 23.5 are performed in the sections below some introductory remarks related to the data denoted above as location hypotheses will be helpful. Additionally it will also be helpful to provide introductory remarks related to historical location data and the data base management programs associated therewith.

For each target MS location estimate generated and utilized by the present invention the location estimate is provided in a data structure or object class denoted as a location hypothesis illustrated in Table LH 1 . Although brief descriptions of the data fields for a location hypothesis is provided in the Table LH 1 many fields require additional explanation. Accordingly location hypothesis data fields are further described as noted below.

As can be seen in the Table LH 1 each location hypothesis data structure includes at least one measurement denoted hereinafter as a confidence value or simply confidence that is a measurement of the perceived likelihood that an MS location estimate in the location hypothesis is an accurate location estimate of the target MS . Since such confidence values are an important aspect of the present disclosure much of the description and use of such confidence values are described below however a brief description is provided here. Each such confidence value is in the range 1.0 to 1.0 wherein the larger the value the greater the perceived likelihood that the target MS is in or at a corresponding MS location estimate of the location hypothesis to which the confidence value applies. As an aside note that a location hypothesis may have more than one MS location estimate as will be discussed in detail below and the confidence value will typically only correspond or apply to one of the MS location estimates in the location hypothesis. Further values for the confidence value field may be interpreted as a 1.0 may be interpreted to mean that the target MS is NOT in such a corresponding MS area estimate of the location hypothesis area b 0 may be interpreted to mean that it is unknown as to the likelihood of whether the MS in the corresponding MS area estimate and c 1.0 may be interpreted to mean that the MS is perceived to positively be in the corresponding MS area estimate.

Additionally note that it is within the scope of the present disclosure that the location hypothesis data structure may also include other related perception measurements related to a likelihood of the target MS being in a particular MS location area estimate. For example it is within the scope of the present disclosure to also utilize measurements such as a sufficiency factors for indicating the likelihood that an MS location estimate of a location hypothesis is sufficient for locating the target MS b necessity factors for indicating the necessity that the target MS be in an particular area estimate. However to more easily describe the present disclosure a single confidence field is used.

Additionally in utilizing location hypotheses in for example the location evaluator as in 23.4 above it is important to keep in mind that each location hypothesis confidence value is a relative measurement. That is for confidences cfand cf if cf

For the present description of the invention the function as defined in c immediately above is utilized. However for obtaining a general understanding of the present disclosure the simpler confidence score function of a may be more useful. It is important to note though that it is within the scope of the present disclosure to use other functions for the confidence score function.

The notion of area type as related to wireless signal transmission characteristics has been used in many investigations of radio signal transmission characteristics. Some investigators when investigating such signal characteristics of areas have used somewhat naive area classifications such as urban suburban rural etc. However it is desirable for the purposes of the present disclosure to have a more operational definition of area types that is more closely associated with wireless signal transmission behaviors.

To describe embodiments of the an area type scheme used in an embodiment of the present disclosure some introductory remarks are first provided. Note that the wireless signal transmission behavior for an area depends on at least the following criteria 

Accordingly a description of wireless signal characteristics for determining area types could potentially include a characterization of wireless signaling attributes as they relate to each of the above criteria. Thus an area type might be hilly treed suburban having no buildings above 50 feet with base stations spaced apart by two miles. However a categorization of area types is desired that is both more closely tied to the wireless signaling characteristics of the area and is capable of being computed substantially automatically and repeatedly over time. Moreover for a wireless location system the primary wireless signaling characteristics for categorizing areas into at least minimally similar area types are thermal noise and more importantly multipath characteristics e.g. multipath fade and time delay .

Focusing for the moment on the multipath characteristics it is believed that 23.8.1 and 23.8.3 immediately above are in general more important criteria for accurately locating an MS than 23.8.2 . That is regarding 23.8.1 multipath tends to increase as the density of nearby vertical area changes increases. For example multipath is particularly problematic where there is a high density of high rise buildings and or where there are closely spaced geographic undulations. In both cases the amount of change in vertical area per unit of area in a horizontal plane for some horizontal reference plane may be high. Regarding 23.8.3 the greater the density of base stations the less problematic multipath may become in locating an MS . Moreover the arrangement of the base stations in the radio coverage area in may affect the amount and severity of multipath.

Accordingly it would be desirable to have a method and system for straightforwardly determining area type classifications related to multipath and in particular multipath due to 23.8.1 and 23.8.3 . The present disclosure provides such a determination by utilizing a novel notion of area type hereinafter denoted transmission area type or area type when both a generic area type classification scheme and the transmission area type discussed hereinafter are intended for classifying similar areas wherein each transmission area type class or category is intended to describe an area having at least minimally similar wireless signal transmission characteristics. That is the novel transmission area type scheme of the present disclosure is based on a the terrain area classifications e.g. the terrain of an area surrounding a target MS b the configuration of base stations in the radio coverage area and c characterizations of the wireless signal transmission paths between a target MS location and the base stations .

In one embodiment of a method and system for determining such transmission area type approximations a partition denoted hereinafter as P is imposed upon the radio coverage area for partitioning for radio coverage area into subareas wherein each subarea is an estimate of an area having included MS locations that are likely to have is at least a minimal amount of similarity in their wireless signaling characteristics. To obtain the partition Pof the radio coverage area the following steps are performed 

Now assuming Phas been obtained the subareas of Pare provided with a first classification or categorization as follows 

Note that other transmission signal characteristics may be incorporated into the transmission area types. For example thermal noise characteristics may be included by providing a third radio coverage area partition P in addition to the partitions of Pand Pgenerated in 23.8.4.1 and 23.8.4.2 respectively. Moreover the time varying characteristics of 23.8.2 may be incorporated in the transmission area type frame work by generating multiple versions of the transmission area types such that the transmission area type for a given subarea of Pmay change depending on the combination of time varying environmental characteristics to be considered in the transmission area types. For instance to account for seasonality four versions of the partitions Pand Pmay be generated one for each of the seasons and subsequently generate a potentially different partition Pfor each season. Further the type and or characteristics of base station antennas may also be included in an embodiment of the transmission area type.

Accordingly in one embodiment of the present invention whenever the term area type is used hereinbelow transmission area types as described hereinabove are intended.

It is an aspect of the present disclosure that MS location processing performed by the location center should become increasingly better at locating a target MS both by a building an increasingly more detailed model of the signal characteristics of locations in the service area for an embodiment of the present disclosure and also b by providing capabilities for the location center processing to adapt to environmental changes.

One way these aspects of the present disclosure are realized is by providing one or more data base management systems and data bases for 

 a storing and associating wireless MS signal characteristics with known locations of MSs used in providing the signal characteristics. Such stored associations may not only provide an increasingly better model of the signal characteristics of the geography of the service area but also provide an increasingly better model of more changeable signal characteristics affecting environmental factors such as weather seasons and or traffic patterns 

 b adaptively updating the signal characteristic data stored so that it reflects changes in the environment of the service area such as for example a new high rise building or a new highway.

Referring again to of the collective representation of these data bases is the location information data bases . Included among these data bases is a data base for providing training and or calibration data to one or more trainable calibratable FOMs as well as an archival data base for archiving historical MS location information related to the performance of the FOMs. These data bases will be discussed as necessary hereinbelow. However a further brief introduction to the archival data base is provided here. Accordingly the term location signature data base is used hereinafter to denote the archival data base and or data base management system depending on the context of the discussion. The location signature data base shown in for example and labeled is a repository for wireless signal characteristic data derived from wireless signal communications between an MS and one or more base stations wherein the corresponding location of the MS is known and also stored in the location signature data base . More particularly the location signature data base associates each such known MS location with the wireless signal characteristic data derived from wireless signal communications between the MS and one or more base stations at this MS location. Accordingly it is an aspect of the present disclosure to utilize such historical MS signal location data for enhancing the correctness and or confidence of certain location hypotheses as will be described in detail in other sections below.

There are four fundamental entity types or object classes in an object oriented programming paradigm utilized in the location signature data base . Briefly these data entities are described in the items 24.1 through 24.4 that follow 

It is important to note that a loc sig is in one embodiment an instance of the data structure containing the signal characteristic measurements output by the signal filtering and normalizing subsystem also denoted as the signal processing subsystem describing the signals between i a specific base station BS and ii a mobile station MS wherein the BS s location is known and the MS s location is assumed to be substantially constant during a 2 5 second interval in one embodiment of the present disclosure during communication with the MS for obtaining a single instance of loc sig data although the MS location may or may not be known. Further for notational purposes the BS and the MS for a loc sig hereinafter will be denoted the BS associated with the loc sig and the MS associated with the loc sig respectively. Moreover the location of the MS at the time the loc sig data is obtained will be denoted the location associated with the loc sig this location possibly being unknown .

Additionally note that at least in one embodiment of the signal topography characteristics 25.7 above such a first surface may be generated for the forward signals from the base station to the target MS and a second such surface may be generated for or alternatively the first surface may be enhanced by increasing its dimensionality with the signals from the MS to the base station denoted the reverse signals .

Additionally in some embodiments the location hypothesis may include an estimated error as a measurement of perceived accuracy in addition to or as a substitute for the confidence field discussed hereinabove. Moreover location hypotheses may also include a text field for providing a reason for the values of one or more of the location hypothesis fields. For example this text field may provide a reason as to why the confidence value is low or provide an indication that the wireless signal measurements used had a low signal to noise ratio.

Referring now to the composite location objects and verified location signature clusters of 24.3 and 24.2 respectively the following information is contained in these aggregation objects 

Note a verified composite location object is designated as incomplete if a loc sig initially referenced by the verified composite location object is deleted from the location signature data base e.g. because of a confidence that is too low . Further note that if all loc sigs for a composite location object are deleted then the composite object is also deleted from the location signature data base . Also note that common fields between loc sigs referenced by the same composite location object may be provided in the composite location object only e.g. timestamp etc. .

Accordingly a composite location object that is complete i.e. not incomplete is a verified location signature cluster as described in 24.2 .

It is important to note that the architecture for the location center and the location engine provided by the present disclosure is designed for extensibility and flexibility so that MS location accuracy and reliability may be enhanced as further location data become available and as enhanced MS location techniques become available. In addressing the design goals of extensibility and flexibility the high level architecture for generating and processing MS location estimates may be considered as divided into the following high level functional groups described hereinbelow.

 H.2 Low Level Wireless Signal Processing Subsystem for Receiving and Conditioning Wireless Signal Measurements

A first functional group of location engine modules is for performing signal processing and filtering of MS location signal data received from a conventional wireless e.g. CDMA infrastructure as discussed in the steps 23.1 and 23.2 above. This group is denoted the signal processing subsystem herein. One embodiment of such a subsystem is described in the PCT patent application titled Wireless Location Using A Plurality of Commercial Network Infrastructures by F. W. LeBlanc Dupray and Karr filed Jan. 22 1999 and having application Ser. No. 09 230 109 now U.S. Pat. No. 6 236 365 which is fully incorporated herein by reference.

A second functional group of location engine modules is for generating various target MS location initial estimates as described in step 23.3 . Accordingly the modules here use input provided by the signal processing subsystem . This second functional group includes one or more signal analysis modules or models each hereinafter denoted as a first order model FOM for generating location hypotheses for a target MS to be located. Note that it is intended that each such FOM use a different technique for determining a location area estimate for the target MS . A brief description of some types of first order models is provided immediately below. Note that illustrates another more detailed view of the location system for the present invention. In particular this figure illustrates some of the FOMs contemplated by the present invention and additionally illustrates the primary communications with other modules of the location system for the present invention. However it is important to note that the present invention is not limited to the FOMs shown and discussed herein. That is it is a primary aspect of the present invention to easily incorporate FOMs using other signal processing and or computational location estimating techniques than those presented herein. Further note that each FOM type may have a plurality of its models incorporated into an embodiment of the present invention.

For example as will be described in further detail below one such type of model or FOM hereinafter models of this type are referred to as distance models may be based on a range or distance computation and or on a base station signal reception angle determination between the target MS from each of one or more base stations. Basically such distance models determine a location estimate of the target MS by determining a distance offset from each of one or more base stations possibly in a particular direction from each some of the base stations so that an intersection of each area locus defined by the base station offsets may provide an estimate of the location of the target MS. Distance model FOMs may compute such offsets based on 

Another type of FOM is a statistically based first order model wherein a statistical technique such as regression techniques e.g. least squares partial least squares principle decomposition or e.g. Bollenger Bands e.g. for computing minimum and maximum base station offsets . In general models of this type output location hypotheses that are determined by performing one or more statistical techniques or comparisons between the verified location signatures in location signature data base and the wireless signal measurements from a target MS. Models of this type are also referred to hereinafter as a stochastic signal first order model or a stochastic FOM or a statistical model. 

In one embodiment such a stochastic signal model may output location hypotheses determined by one or more statistical comparisons with loc sigs in the Location Signature database e.g. comparing MS location signals with verified signal characteristics for predetermined geographical areas .

Still another type of FOM is an adaptive learning model such as an artificial neural net or a genetic algorithm wherein the FOM may be trained to recognize or associate each of a plurality of locations with a corresponding set of signal characteristics for communications between the target MS at the location and the base stations . Moreover typically such a FOM is expected to accurately interpolate extrapolate target MS location estimates from a set of signal characteristics from an unknown target MS location. Models of this type are also referred to hereinafter variously as artificial neural net models or neural net models or trainable models or learning models. Note that a related type of FOM is based on pattern recognition. These FOMs can recognize patterns in the signal characteristics of communications between the target MS at the location and the base stations and thereby estimate a location area of the target MS. However such FOMs may not be trainable.

In one embodiment an adaptive learning model such as a model based on an artificial neural network may determine an MS location estimate using base station IDs data on signal to noise other signal data e.g. a number of signal characteristics including e.g. all CDMA fingers . Moreover the output from such a model may include a latitude and longitude for a center of a circle having radius R R may be an input to such an artificial neural network and is in the output format of the distance model s .

Yet another type of FOM can be based on a collection of dispersed low power low cost fixed location wireless transceivers also denoted location base stations hereinabove that are provided for detecting a target MS in areas where e.g. there is insufficient base station infrastructure coverage for providing a desired level of MS location accuracy. For example it may uneconomical to provide high traffic wireless voice coverage of a typical wireless base station in a nature preserve or at a fair ground that is only populated a few days out of the year. However if such low cost location base stations can be directed to activate and deactivate via the direction of a FOM of the present type then these location base stations can be used to both locate a target MS and also provide indications of where the target MS is not. For example if there are location base stations populating an area where the target MS is presumed to be then by activating these location base stations evidence may be obtained as to whether or not the target MS is actually in the area e.g. if the target MS is detected by a location base station then a corresponding location hypothesis having a location estimate corresponding to the coverage area of the location base station may have a very high confidence value. Alternatively if the target MS is not detected by a location base station then a corresponding location hypothesis having a location estimate corresponding to the coverage area of the location base station may have a very low confidence value. Models of this type are referred to hereinafter as location base station models. 

Yet another type of FOM can be based on input from a mobile base station wherein location hypotheses may be generated from target MS location data received from the mobile base station . In one embodiment such a mobile base station model may provide output similar to the distance FOM described hereinabove.

Still other types of FOM can be based on various techniques for recognizing wireless signal measurement patterns and associating particular patterns with locations in the coverage area . For example artificial neural networks or other learning models can be used as the basis for various FOMs.

Note that the FOM types mentioned here as well as other FOM types are discussed in detail hereinbelow. Moreover it is important to keep in mind that a novel aspect of the present invention is the simultaneous use or activation of a potentially large number of such first order models wherein such FOMs are not limited to those described herein. Thus the present invention provides a framework for incorporating MS location estimators to be subsequently provided as new FOMs in a straightforward manner. For example a FOM based on wireless signal time delay measurements from a distributed antenna system for wireless communication may be incorporated into the present invention for locating a target MS in an enclosed area serviced by the distributed antenna system such a FOM is more fully described in the U.S. Pat. No. 6 236 365 filed Jul. 8 1999 which is incorporated fully by reference herein . Accordingly by using such a distributed antenna FOM FIG. an embodiment of the present disclosure may determine the floor of a multi story building from which a target MS is transmitting. Thus MSs can be located in three dimensions using such a distributed antenna FOM .

Additionally FOMs for detecting certain registration changes within for example a public switched telephone network can also be used for locating a target MS . For example for some MSs there may be an associated or dedicated device for each such MS that allows the MS to function as a cordless phone to a line based telephone network when the device detects that the MS is within signaling range. In one use of such a device also denoted herein as a home base station the device registers with a home location register of the public switched telephone network when there is a status change such as from not detecting the corresponding MS to detecting the MS or visa versa as one skilled in the art will understand. Accordingly by providing a FOM denoted the Home Base Station First Order Model in FIG. that accesses the MS status in the home location register the location engine can determine whether the MS is within signaling range of the home base station or not and generate location hypotheses accordingly.

Moreover other FOMs based on for example chaos theory and or fractal theory are also within the scope of the present invention.

A third functional group of location engine modules evaluates location hypotheses output by the first order models and thereby provides a most likely target MS location estimate. The modules for this functional group are collectively denoted the hypothesis evaluator .

A primary purpose of the hypothesis evaluator is to mitigate conflicts and ambiguities related to location hypotheses output by the first order models and thereby output a most likely estimate of an MS for which there is a request for it to be located. In providing this capability there are various related embodiments of the hypothesis evaluator that are within the scope of the present disclosure. Since each location hypothesis includes both an MS location area estimate and a corresponding confidence value indicating a perceived confidence or likelihood of the target MS being within the corresponding location area estimate there is a monotonic relationship between MS location area estimates and confidence values. That is by increasing an MS location area estimate the corresponding confidence value may also be increased in an extreme case the location area estimate could be the entire coverage area and thus the confidence value may likely correspond to the highest level of certainty i.e. 1.0 . Accordingly given a target MS location area estimate of a location hypothesis an adjustment to its accuracy may be performed by adjusting the MS location area estimate and or the corresponding confidence value. Thus if the confidence value is for example excessively low then the area estimate may be increased as a technique for increasing the confidence value. Alternatively if the estimated area is excessively large and there is flexibility in the corresponding confidence value then the estimated area may be decreased and the confidence value also decreased. Thus if at some point in the processing of a location hypothesis if the location hypothesis is judged to be more less accurate than initially determined then i the confidence value of the location hypothesis can be increased decreased and or ii the MS location area estimate can be decreased increased .

In a first class of embodiments the hypothesis evaluator evaluates location hypotheses and adjusts or modifies only their confidence values for MS location area estimates and subsequently uses these MS location estimates with the adjusted confidence values for determining a most likely MS location estimate for outputting. Accordingly the MS location area estimates are not substantially modified. Alternatively in a second class of embodiments for the hypothesis evaluator MS location area estimates can be adjusted while confidence values remain substantially fixed. Of course hybrids between the first two embodiments can also be provided. Note that the present embodiment provided herein adjusts both the areas and the confidence values.

Note that the hypothesis evaluator may accomplish the above tasks 30.1 30.7 by employing various data processing tools including but not limited to fuzzy mathematics genetic algorithms neural networks expert systems and or blackboard systems.

Additionally note that as can be seen in the hypothesis evaluator includes the following four high level modules for processing output location hypotheses from the first order models a context adjuster a hypothesis analyzer an MS status repository and a most likelihood estimator . These four modules are briefly described hereinbelow.

The context adjuster module enhances both the comparability and predictability of the location hypotheses output by the first order models . In particular this module modifies location hypotheses received from the FOMs so that the resulting location hypotheses output by the context adjuster may be further processed uniformly and substantially without concern as to differences in accuracy between the first order models from which location hypotheses originate. In providing this capability the context adjuster may adjust or modify various fields of the input location hypotheses. In particular fields giving target MS location estimates and or confidence values for such estimates may be modified by the context adjuster . Further this module may determine those factors that are perceived to impact the perceived accuracy e.g. confidence of the location hypotheses a differently between FOMs and or b with substantial effect. For instance environmental characteristics may be taken into account here such as time of day season month weather geographical area categorizations e.g. dense urban urban suburban rural mountain etc. area subcategorizations e.g. heavily treed hilly high traffic area etc. . A detailed description of one embodiment of this module is provided in APPENDIX D hereinbelow. Note that the embodiment described herein is simplified for illustration purposes such that only the geographical area categorizations are utilized in adjusting i.e. modifying location hypotheses. But it is an important aspect of the present disclosure that various categorizations such as those mentioned immediately above may be used for adjusting the location hypotheses. That is categories such as for example 

Accordingly the present disclosure is not limited to the factors explicitly mentioned here. That is it is an aspect of the present disclosure to be extensible so that other environmental factors of the coverage area affecting the accuracy of location hypotheses may also be incorporated into the context adjuster .

It is also an aspect of the context adjuster that the methods for adjusting location hypotheses provided in this module may be generalized and thereby also utilized with multiple hypothesis computational architectures related to various applications wherein a terrain surface volume or other geometric interpretation e.g. a metric space of statistical samples may be placed on a large body of stored application data for relating hypothesized data to verified data. Moreover it is important to note that various techniques for visualizing data may provide such a geometric interpretation. Thus the methods herein may be utilized in applications such as sonar radar x ray or infrared identification of objects such as occurs in robotic navigation medical image analysis geological and radar imaging.

More generally the novel computational paradigm of the context adjuster may be utilized in a number of applications wherein there is a large body of archived information providing verified or actual application process data related to the past performance of the application process.

It is worth mentioning that the computational paradigm used in the context adjuster is a hybrid of a hypothesis adjuster and a data base query mechanism. For example the context adjuster uses an input location hypothesis both as an hypothesis and as a data base query or index into the location signature data base for constructing a related but more accurate location hypothesis. Accordingly substantial advantages are provided by this hybrid architecture such as the following two advantages.

As a first advantage the context adjuster reduces the likelihood that a feedback mechanism is necessary to the initial hypothesis generators i.e. FOMs for periodically adjusting default evaluations of the goodness or confidence in the hypotheses generated. That is since each hypothesis generated is in effect an index into a data base or archive of verified application e.g. location data the context adjuster in turn generates new corresponding hypotheses based on the actual or verified data retrieved from an archival data base. Thus as a result this architecture tends to separate the computations of the initial hypothesis generators e.g. the FOMs in the present MS location application from any further processing and thereby provide a more modular maintainable and flexible computational system.

As a second advantage the context adjuster tends to create hypotheses that are more accurate than the hypotheses generated by the initial hypotheses generators. That is for each hypothesis H provided by one of the initial hypothesis generators G e.g. a FOM a corresponding enhanced hypothesis provided by the context adjuster is generated by mapping the past performance of G into the archived verified application data as will be discussed in detail hereinbelow . In particular the context adjuster hypothesis generation is based on the archived verified or known performance application data that is related to both G and H. For example in the present wireless location application if a FOM G substantially consistently generates in a particular geographical area location hypotheses that are biased approximately 1000 feet north of the actual verified MS location then the context adjuster can generate corresponding hypotheses without this bias. Thus the context adjuster tends to filter out inaccuracies in the initially generated hypotheses.

Therefore in a multiple hypothesis architecture where typically the generated hypotheses may be evaluated and or combined for providing a most likely result it is believed that a plurality of relatively simple and possibly inexact initial hypothesis generators may be used in conjunction with the hybrid computational paradigm represented by the context adjuster for providing enhanced hypotheses with substantially greater accuracy.

Additionally note that this hybrid paradigm applies to other domains that are not geographically based. For instance this hybrid paradigm applies to many prediction and or diagnostic applications for which 

 a the application data and the application are dependent on a number of parameters whose values characterize the range of outputs for the application. That is there is a set of parameters p p p . . . pfrom which a parameter space p p p . . . pis derived whose points characterize the actual and estimated or predicted outcomes. As examples in the MS location system p latitude and p longitude 

 b there is historical data from which points for the parameter space p p p . . . pcan be obtained wherein this data relates to or indicates the performance of the application and the points obtained from this data are relatively dense in the space at least around the likely future actual outcomes that the application is expected to predict or diagnose . For example such historical data may associate the predicted outcomes of the application with corresponding actual outcomes 

 c there is a metric or distance like evaluation function that can be applied to the parameter space for indicating relative closeness or accuracy of points in the parameter space wherein the evaluation function provides a measurement of closeness that is related to the actual performance of the application.

Note that there are numerous applications for which the above criteria are applicable. For instance computer aided control of chemical processing plants are likely to satisfy the above criteria. Certain robotic applications may also satisfy this criteria. In fact it is believed that a wide range of signal processing applications satisfy this criteria.

The MS status repository is a run time storage manager for storing location hypotheses from previous activations of the location engine as well as for storing the output most likely target MS location estimate s so that a target MS may be tracked using target MS location hypotheses from previous location engine activations to determine for example a movement of the target MS between evaluations of the target MS location.

As shown in the hypothesis analyzer module receives potentially modified location hypotheses from the context adjuster and performs additional location hypothesis processing that is likely to be common and generic in analyzing most location hypotheses. More specifically the hypothesis analyzer may adjust either or both of the target MS estimated location and or the confidence of a location hypothesis. In brief the hypothesis analyzer receives target MS location hypotheses from the context analyzer and depending on the time stamps of newly received location hypotheses and any previous i.e. older target MS location hypotheses that may still be currently available to the hypothesis analyzer the hypothesis analyzer may 

Note that both the newly received location hypotheses and the previous location hypotheses that are updated i.e. extrapolated and still remain in the hypothesis analyzer will be denoted as current location hypotheses or currently active location hypotheses .

The modules within the location hypothesis analyzer use various types of application specific knowledge likely substantially independent from the computations by the FOMs when providing the corresponding original location hypotheses. That is since it is an aspect of at least one embodiment of the present disclosure that the FOMs be relatively straightforward so that they may be easily to modified as well as added or deleted the processing for example in the hypothesis analyzer as with the context adjuster is intended to compensate when necessary for this straightforwardness by providing substantially generic MS location processing capabilities that can require a greater breadth of application understanding related to wireless signal characteristics of the coverage area .

Accordingly the hypothesis analyzer may apply various heuristics that for example change the confidence in a location hypothesis depending on how well the location hypothesis and or a series of location hypotheses from e.g. the same FOM a conforms with the laws of physics b conforms with known characteristics of location signature clusters in an area of the location hypothesis MS estimate and c conforms with highly likely heuristic constraint knowledge. In particular as illustrated best in the location hypothesis analyzer may utilize at least one of a blackboard system and or an expert system for applying various application specific heuristics to the location hypotheses output by the context adjuster . More precisely the location hypothesis analyzer includes in one embodiment a blackboard manager for managing processes and data of a blackboard system. Additionally note that in a second embodiment where an expert system is utilized instead of a blackboard system the location hypothesis analyzer provides an expert system inference engine for the expert system. Note that additional detail on these aspects of the invention are provided hereinbelow.

Additionally note that the hypothesis analyzer may activate one or more extrapolation procedures to extrapolate target MS location hypotheses already processed. Thus when one or more new location hypotheses are supplied by the context adjuster having a substantially more recent timestamp the hypothesis analyzer may invoke an extrapolation module i.e. location extrapolator for adjusting any previous location hypotheses for the same target MS that are still being used by the location hypothesis analyzer so that all target MS location hypotheses for the same target MS being concurrently analyzed are presumed to be for substantially the same time. Accordingly such a previous location hypothesis that is for example 15 seconds older than a newly supplied location hypothesis from perhaps a different FOM may have both a an MS location estimate changed e.g. to account for a movement of the target MS and b its confidence changed e.g. to reflect a reduced confidence in the accuracy of the location hypothesis .

It is important to note that the architecture of the present disclosure is such that the hypothesis analyzer has an extensible architecture. That is additional location hypothesis analysis modules may be easily integrated into the hypothesis analyzer as further understanding regarding the behavior of wireless signals within the service area becomes available. Conversely some analysis modules may not be required in areas having relatively predictable signal patterns. Thus in such service areas such unnecessary modules may be easily removed or not even developed.

The most likelihood estimator is a module for determining a most likely location estimate for a target MS being located by the location engine . The most likelihood estimator receives a collection of active or relevant location hypotheses from the hypothesis analyzer and uses these location hypotheses to determine one or more most likely estimates for the target MS .

Still referring to the hypothesis evaluator it is important to note that not all the above mentioned modules are required in all embodiments of the present disclosure. In particular for some coverage areas the hypothesis analyzer may be unnecessary. Accordingly in such an embodiment the enhanced location hypotheses output by the context adjuster are provided directly to the most likelihood estimator .

A fourth functional group of location engine modules is the control and output gating modules which includes the location center control subsystem and the output gateway . The location control subsystem provides the highest level of control and monitoring of the data processing performed by the location center . In particular this subsystem performs the following functions 

Referring now to the output gateway this module routes target MS location estimates to the appropriate location application s . For instance upon receiving a location estimate from the most likelihood estimator the output gateway may determine that the location estimate is for an automobile being tracked by the police and therefore must be provided according to a particular protocol.

A fifth functional group of location engine modules provides the ability to enhance the MS locating reliability and or accuracy by providing it with the capability to adapt to particular operating configurations operating conditions and wireless signaling environments without performing intensive manual analysis of the performance of various embodiments of the location engine . That is this functional group automatically enhances the performance of the location engine for locating MSs within a particular coverage area using at least one wireless network infrastructure therein. More precisely this functional group allows embodiments of the present disclosure to adapt by tuning or optimizing certain system parameters according to location engine location estimate accuracy and reliability.

There are a number location engine system parameters whose values affect location estimation and it is an aspect of the present disclosure that the MS location processing performed should become increasingly better at locating a target MS not only through building an increasingly more detailed model of the signal characteristics of location in the coverage area such as discussed above regarding the location signature data base but also by providing automated capabilities for the location center processing to adapt by adjusting or tuning the values of such location center system parameters.

Accordingly the present disclosure includes a module denoted herein as an adaptation engine that performs an optimization procedure on the location center system parameters either periodically or concurrently with the operation of the location center in estimating MS locations. That is the adaptation engine directs the modifications of the system parameters so that the location engine increases in overall accuracy in locating target MSs . In one embodiment the adaptation engine includes an embodiment of a genetic algorithm as the mechanism for modifying the system parameters. Genetic algorithms are basically search algorithms based on the mechanics of natural genetics. The genetic algorithm utilized herein is included in the form of pseudo code in APPENDIX B. Note that to apply this genetic algorithm in the context of the location engine architecture only a coding scheme and a fitness function are required as one skilled in the art will appreciate. Moreover it is also within the scope of the present disclosure to use modified or different adaptive and or tuning mechanisms. For further information regarding such adaptive mechanisms the following references are incorporated herein by reference Goldberg D. E. 1989 Genetic algorithms for search optimization and machine learning Reading Mass. Addison Wesley Publishing Company and Holland J. H. 1975 Adaptation in natural and artificial systems Ann Arbor Mich. The University of Michigan Press.

As discussed in the Location Center Architecture Overview section herein above distance models determine a presumed direction and or distance that a target MS is from one or more base stations . In some embodiments of distance models the target MS location estimate s generated are obtained using radio signal analysis techniques that are quite general and therefore are not capable of taking into account the peculiarities of the topography of a particular radio coverage area. For example substantially all radio signal analysis techniques using conventional procedures or formulas are based on signal characteristic measurements such as 

Taking a CDMA or TDMA base station network as an example each base station BS is required to emit a constant signal strength pilot channel pseudo noise PN sequence on the forward link channel identified uniquely in the network by a pilot sequence offset and frequency assignment. It is possible to use the pilot channels of the active candidate neighboring and remaining sets maintained in the target MS for obtaining signal characteristic measurements e.g. TOA and or TDOA measurements between the target MS and the base stations in one or more of these sets.

Based on such signal characteristic measurements and the speed of signal propagation signal characteristic ranges or range differences related to the location of the target MS can be calculated. Using TOA and or TDOA ranges as exemplary these ranges can then be input to either the radius radius multilateration or the time difference multilateration algorithms along with the known positions of the corresponding base stations to thereby obtain one or more location estimates of the target MS . For example if there are four base stations in the active set the target MS may cooperate with each of the base stations in this set to provide signal arrival time measurements. Accordingly each of the resulting four sets of three of these base stations may be used to provide an estimate of the target MS as one skilled in the art will understand. Thus potentially assuming the measurements for each set of three base stations yields a feasible location solution there are four estimates for the location of the target MS . Further since such measurements and BS positions can be sent either to the network or the target MS location can be determined in either entity.

Since many of the signal measurements utilized by embodiments of distance models are subject to signal attenuation and multipath due to a particular area topography. Many of the sets of base stations from which target MS location estimates are desired may result in either no location estimate or an inaccurate location estimate.

Accordingly some embodiments of distance FOMs may attempt to mitigate such ambiguity or inaccuracies by e.g. identifying discrepancies or consistencies between arrival time measurements and other measurements e.g. signal strength these discrepancies or consistencies may be used to filter out at least those signal measurements and or generated location estimates that appear less accurate. In particular such identifying by filtering can be performed by for example an expert system residing in the distance FOM.

A second approach for mitigating such ambiguity or conflicting MS location estimates is particularly novel in that each of the target MS location estimates is used to generate a location hypothesis regardless of its apparent accuracy. Accordingly these location hypotheses are input to an alternative embodiment of the context adjuster that is substantially but not identical to the context adjuster as described in detail in APPENDIX D so that each location hypothesis may be adjusted to enhance its accuracy. In contradistinction to the embodiment of the context adjuster of APPENDIX D where each location hypothesis is adjusted according to past performance of its generating FOM in an area of the initial location estimate of the location hypothesis the area e.g. determined as a function of distance from this initial location estimate this alternative embodiment adjusts each of the location hypotheses generated by a distance first order model according to a past performance of the model as applied to signal characteristic measurements from the same set of base stations as were used in generating the location hypothesis. That is instead of only using only an identification of the distance model i.e. its FOM ID to for example retrieve archived location estimates generated by the model in an area of the location hypothesis estimate when determining the model s past performance the retrieval retrieves only the archived location estimates that are in addition derived from the signal characteristics measurement obtained from the same collection of base stations as was used in generating the location hypothesis. Thus the adjustment performed by this embodiment of the context adjuster adjusts according to the past performance of the distance model and the collection of base stations used.

Radio coverage area of individual base stations may be used to generate location estimates of the target MS . Although a first order model based on this notion may be less accurate than other techniques if a reasonably accurate RF coverage area is known for each or most of the base stations then such a FOM denoted hereinafter as a coverage area first order model or simply coverage area model may be very reliable. To determine approximate maximum radio frequency RF location coverage areas with respect to BSs antennas and or sector coverage areas for a given class or classes of e.g. CDMA or TDMA mobile station s location coverage should be based on an MS s ability to adequately detect the pilot channel as opposed to adequate signal quality for purposes of carrying user acceptable traffic in the voice channel. Note that more energy is necessary for traffic channel activity typically on the order of at least 94 to 104 dBm received signal strength to support voice than energy needed to simply detect a pilot channel s presence for location purposes typically a maximum weakest signal strength range of between 104 to 110 dBm thus the Location Coverage Area will generally be a larger area than that of a typical Voice Coverage Area although industry studies have found some occurrences of no coverage areas within a larger covered area. An example of a coverage area including both a dead zone i.e. area of no coverage and a notch of also no coverage is shown in .

The approximate maximum RF coverage area for a given sector of more generally angular range about a base station may be represented as a set of points representing a polygonal area potentially with e.g. holes therein to account for dead zones and or notches . Note that if such polygonal RF coverage area representations can be reliably determined and maintained over time for one or more BS signal power level settings then such representations can be used in providing a set theoretic or Venn diagram approach to estimating the location of a target MS . Coverage area first order models utilize such an approach.

In one embodiment a coverage area model utilizes both the detection and non detection of base stations by the target MS conversely of the MS by one or more base stations to define an area where the target MS may likely be. A relatively straightforward application of this technique is to 

In the location base station LBS model FOM a database is accessed which contains electrical radio propagation and coverage area characteristics of each of the location base stations in the radio coverage area. The LBS model is an active model in that it can probe or excite one or more particular LBSs in an area for which the target MS to be located is suspected to be placed. Accordingly the LBS model may receive as input a most likely target MS location estimate previously output by the location engine of the present disclosure and use this location estimate to determine which if any LBSs to activate and or deactivate for enhancing a subsequent location estimate of the target MS. Moreover the feedback from the activated LBSs may be provided to other FOMs as appropriate as well as to the LBS model. However it is an important aspect of the LBS model that when it receives such feedback it may output location hypotheses having relatively small target MS location area estimates about the active LBSs and each such location hypothesis also has a high confidence value indicative of the target MS positively being in the corresponding location area estimate e.g. a confidence value of 0.9 to 1 or having a high confidence value indicative of the target MS not being in the corresponding location area estimate i.e. a confidence value of 0.9 to 1 . Note that in some embodiments of the LBS model these embodiments may have functionality similar to that of the coverage area first order model described above. Further note that for LBSs within a neighborhood of the target MS wherein there is a reasonable chance that with movement of the target MS may be detected by these LBSs such LBSs may be requested to periodically activate. Note that it is not assumed that such LBSs have an on line external power source e.g. some may be solar powered . Moreover in the case where an LBS includes sufficient electronics to carry voice communication with the target MS and is the primary BS for the target MS or alternatively in the active or candidate set then the LBS model will not deactivate this particular LBS during its procedure of activating and deactivating various LBSs .

The stochastic first order models may use statistical prediction techniques such as principle decomposition partial least squares or other regression techniques for predicting for example expected minimum and maximum distances of the target MS from one or more base stations e.g. Bollenger Bands. Additionally some embodiments may use Markov processes and Random Walks predicted incremental MS movement for determining an expected area within which the target MS is likely to be. That is such a process measures the incremental time differences of each pilot as the MS moves for predicting a size of a location area estimate using past MS estimates such as the verified location signatures in the location signature data base .

Regarding FOMs using pattern recognition or associativity techniques there are many such techniques available. For example there are statistically based systems such as CART an acronym for Classification and Regression Trees by ANGOSS Software International Limited of Toronto Canada that may be used for automatically detecting or recognizing patterns in data that were unprovided and likely previously unknown . Accordingly by imposing a relatively fine mesh or grid of cells on the radio coverage area wherein each cell is entirely within a particular area type categorization such as the transmission area types discussed in the section Coverage Area Area Types And Their Determination above the verified location signature clusters within the cells of each area type may be analyzed for signal characteristic patterns. Accordingly if such characteristic pattern is found then it can be used to identify at least a likely area type in which a target MS is likely to be located. That is one or more location hypotheses may be generated having target MS location estimates that cover an area having the likely area type wherein the target MS is located. Further note that such statistically based pattern recognition systems as CART include software code generators for generating expert system software embodiments for recognizing the patterns detected within a training set e.g. the verified location signature clusters .

Accordingly although an embodiment of a FOM as described here may not be exceedingly accurate it may be very reliable. Thus since a fundamental aspect of the present disclosure is to use a plurality MS location techniques for generating location estimates and to analyze the generated estimates likely after being adjusted to detect patterns of convergence or clustering among the estimates even large MS location area estimates are useful. For example it can be the case that four different and relatively large MS location estimates each having very high reliability have an area of intersection that is acceptably precise and inherits the very high reliability from each of the large MS location estimates from which the intersection area was derived.

A similar statistically based FOM to the one above may be provided wherein the radio coverage area is decomposed substantially as above but in addition to using the signal characteristics for detecting useful signal patterns the specific identifications of the base station providing the signal characteristics may also be used. Thus assuming there is a sufficient density of verified location signature clusters in some of the mesh cells so that the statistical pattern recognizer can detect patterns in the signal characteristic measurements an expert system may be generated that outputs a target MS location estimate that may provide both a reliable and accurate location estimate of a target MS .

The term adaptive is used to describe a data processing component that can modify its data processing behavior in response to certain inputs that are used to change how subsequent inputs are processed by the component. Accordingly a data processing component may be explicitly adaptive by modifying its behavior according to the input of explicit instructions or control data that is input for changing the component s subsequent behavior in ways that are predictable and expected. That is the input encodes explicit instructions that are known by a user of the component. Alternatively a data processing component may be implicitly adaptive in that its behavior is modified by other than instructions or control data whose meaning is known by a user of the component. For example such implicitly adaptive data processors may learn by training on examples by substantially unguided exploration of a solution space or other data driven adaptive strategies such as statistically generated decision trees. Accordingly it is an aspect of the present disclosure to utilize not only explicitly adaptive MS location estimators within FOMs but also implicitly adaptive MS location estimators. In particular artificial neural networks also denoted neural nets and ANNs herein are used in some embodiments as implicitly adaptive MS location estimators within FOMs. Thus in the sections below neural net architectures and their application to locating an MS is described.

Artificial neural networks may be particularly useful in developing one or more first order models for locating an MS since for example ANNs can be trained for classifying and or associatively pattern matching of various RF signal measurements such as the location signatures. That is by training one or more artificial neural nets using RF signal measurements from verified locations so that RF signal transmissions characteristics indicative of particular locations are associated with their corresponding locations such trained artificial neural nets can be used to provide additional target MS location hypotheses. Moreover it is an aspect of the present disclosure that the training of such artificial neural net based FOMs ANN FOMs is provided without manual intervention as will be discussed hereinbelow.

It is as an aspect of the present disclosure to use an adaptive neural network architecture which has the ability to explore the parameter or matrix weight space corresponding to a ANN for determining new configurations of weights that reduce an objective or error function indicating the error in the output of the ANN over some aggregate set of input data ensembles. Accordingly in one embodiment a genetic algorithm is used to provide such an adaptation capability. However it is also within the scope of the present disclosure to use other adaptive techniques such as for example simulated annealing cascade correlation with multistarts gradient descent with multistarts and truncated Newton s method with multistarts as one skilled in the art of neural network computing will understand.

Although there have been substantial advances in artificial neural net computing in both hardware and software it can be difficult to choose a particular ANN architecture and appropriate training data for yielding high quality results. In choosing a ANN architecture at least the following three criteria are chosen either implicitly or explicitly 

However the architecture of the present disclosure allows substantial flexibility in the implementation of ANN for FOMs . In particular there is no need to choose only one artificial neural net architecture and or implementation in that a plurality of ANNs may be accommodated by the architecture of the location engine . Furthermore it is important to keep in mind that it may not be necessary to train an ANN for a FOM as rigorously as is done in typical ANN applications since the accuracy and reliability in estimating the location of a target MS with an embodiment of the present disclosure may come from synergistically utilizing a plurality of different MS location estimators each of which may be undesirable in terms of accuracy and or reliability in some areas but when their estimates are synergistically used as in the location engine accurate and reliable location estimates can be attained. Accordingly one embodiment of the present disclosure may have a plurality of moderately well trained ANNs having different neural net architectures such as multilayer perceptrons adaptive resonance theory models and radial basis function networks.

Additionally many of the above mentioned ANN architecture and implementation decisions can be addressed substantially automatically by various commercial artificial neural net development systems such as 

It is worthwhile to discuss the data representations for the inputs and outputs of a ANN used for generating MS location estimates. Regarding ANN input representations recall that the signal processing subsystem may provide various RF signal measurements as input to an ANN such as the RF signal measurements derived from verified location signatures in the location signature data base . For example a representation of a histogram of the frequency of occurrence of CDMA fingers in a time delay versus signal strength 2 dimensional domain may be provided as input to such an ANN. In particular a 2 dimensional grid of signal strength versus time delay bins may be provided so that received signal measurements are slotted into an appropriate bin of the grid. In one embodiment such a grid is a six by six array of bins such as illustrated in the left portion of . That is each of the signal strength and time delay axes are partitioned into six ranges so that both the signal strength and the time delay of RF signal measurements can be slotted into an appropriate range thus determining the bin.

Note that RF signal measurement data i.e. location signatures slotted into a grid of bins provides a convenient mechanism for classifying RF measurements received over time so that when each new RF measurement data is assigned to its bin a counter for the bin can be incremented. Thus in one embodiment the RF measurements for each bin can be represented pictorially as a histogram. In any case once the RF measurements have been slotted into a grid various filters may be applied for filtering outliers and noise prior to inputting bin values to an ANN. Further various amounts of data from such a grid may be provided to an ANN. In one embodiment the tally from each bin is provided to an ANN. Thus as many as 108 values could be input to the ANN two values defining each bin and a tally for the bin . However other representations are also possible. For instance by ordering the bin tallies linearly only 36 need be provided as ANN input. Alternatively only representations of bins having the highest tallies may be provided as ANN input. Thus for example if the highest bins and their tallies were provided as ANN input then only 20 inputs need be provided i.e. 10 input pairs each having a single bin identifier and a corresponding tally .

In addition note that the signal processing subsystem may also obtain the identifications of other base stations for which their pilot channels can be detected by the target MS i.e. the forward path or for which the base stations can detect a signal from the target MS i.e. the reverse path . Thus in order to effectively utilize substantially all pertinent location RF signal measurements i.e. from location signature data derived from communications between the target MS and the base station infrastructure a technique is provided wherein a plurality of ANNs may be activated using various portions of an ensemble of location signature data obtained. However before describing this technique it is worthwhile to note that a naive strategy of providing input to a single ANN for locating target MSs throughout an area having a large number of base stations e.g. is likely to be undesirable. That is given that each base station antenna sector nearby the target MS is potentially able to provide the ANN with location signature data the ANN would have to be extremely large and therefore may require inordinate training and retraining. For example since there may be approximately 30 to 60 ANN inputs per location signature an ANN for an area having even twenty base stations can require at least 600 input neurons and potentially as many as 1 420 i.e. 20 base stations with 70 inputs per base station and one input for every one of possibly 20 additional surrounding base stations in the radio coverage area that might be able to detect or be detected by a target MS in the area corresponding to the ANN .

Accordingly the technique described herein limits the number of input neurons in each ANN constructed and generates a larger number of these smaller ANNs. That is each ANN is trained on location signature data or more precisely portions of location signature clusters in an area A hereinafter also denoted the net area wherein each input neuron receives a unique input from one of 

Thus by generating an ANN for each of a plurality of net areas potentially overlapping a local environmental change in the wireless signal characteristics of one net area is unlikely to affect more than a small number of adjacent or overlapping net areas. Accordingly such local environmental changes can be reflected in that only the ANNs having net areas affected by the local change need to be retrained. Additionally note that in cases where RF measurements from a target MS are received across multiple net areas multiple ANNs may be activated thus providing multiple MS location estimates. Further multiple ANNs may be activated when a location signature cluster is received for a target MS and location signature cluster includes location signature data corresponding to wireless transmissions between the MS and e.g. more base stations antenna sectors than needed for the collection B described in the previous section. That is if each collection B identifies four base stations antenna sectors and a received location signature cluster includes location signature data corresponding to five base stations antenna sectors then there may be up to five ANNs activated to each generate a location estimate.

Moreover for each of the smaller ANNs it is likely that the number of input neurons is on the order of 330 i.e. 70 inputs per each of four location signatures i.e. 35 inputs for the forward wireless communications and 35 for the reverse wireless communications plus 40 additional discrete inputs for an appropriate area surrounding A plus 10 inputs related to the type of MS power levels etc. However it is important to note that the number of base stations or antenna sectors having corresponding location signature data to be provided to such an ANN may vary. Thus in some subareas of the coverage area location signature data from five or more base stations antenna sectors may be used whereas in other subareas three or less may be used.

Regarding the output from ANNs used in generating MS location estimates there are also numerous options. In one embodiment two values corresponding to the latitude and longitude of the target MS are estimated. Alternatively by applying a mesh to the coverage area such ANN output may be in the form of a row value and a column value of a particular mesh cell and its corresponding area where the target MS is estimated to be. Note that the cell sizes of the mesh need not be of a particular shape nor of uniform size. However simple non oblong shapes are desirable. Moreover such cells should be sized so that each cell has an area approximately the size of the maximum degree of location precision desired. Thus assuming square mesh cells 250 to 350 feet per cell side in an urban suburban area and 500 to 700 feet per cell side in a rural area may be desirable.

The following are steps provide one embodiment for training a location estimating ANN according to the present disclosure.

Regarding d immediately above less accuracy may be required in training an ANN used for generating a location hypothesis in a FOM for the present invention than in most applications of ANNs or other trainable adaptive components since in most circumstances when signal measurements are provided for locating a target MS the location engine will activate a plurality location hypothesis generating modules corresponding to one or more FOMs for substantially simultaneously generating a plurality of different location estimates i.e. hypotheses . Thus instead of training each ANN so that it is expected to be e.g. 92 or higher in accuracy it is believed that synergies with MS location estimates from other location hypothesis generating components will effectively compensate for any reduced accuracy in such a ANN or any other location hypothesis generating component . Accordingly it is believed that training time for such ANNs may be reduced without substantially impacting the MS locating performance of the location engine .

In one traditional artificial neural network training process a relatively tedious set of trial and error steps may be performed for configuring an ANN so that training produces effective learning. In particular an ANN may require configuring parameters related to for example input data scaling test training set classification detecting and removing unnecessary input variable selection. However an embodiment of the present disclosure reduces this tedium. That is an embodiment of the present disclosure uses mechanisms such as genetic algorithms or other mechanisms for avoiding non optimal but locally appealing i.e. local minimum solutions and locating near optimal solutions instead. In particular such mechanism may be used to adjust the matrix of weights for the ANNs so that very good near optimal ANN configurations may be found efficiently. Furthermore since the signal processing system uses various types of signal processing filters for filtering the RF measurements received from transmissions between an MS and one or more base stations antenna sectors such mechanisms for finding near optimal solutions may be applied to selecting appropriate filters as well. Accordingly in one embodiment of the present disclosure such filters are paired with particular ANNs so that the location signature data supplied to each ANN is filtered according to a corresponding filter description for the ANN wherein the filter description specifies the filters to be used on location signature data prior to inputting this data to the ANN. In particular the filter description can define a pipeline of filters having a sequence of filters wherein for each two consecutive filters fand f fpreceding f in a filter description the output of fflows as input to f. Accordingly by encoding such a filter description together with its corresponding ANN so that the encoding can be provided to a near optimal solution finding mechanism such as a genetic algorithm it is believed that enhanced ANN locating performance can be obtained. That is the combined genetic codes of the filter description and the ANN are manipulated by the genetic algorithm in a search for a satisfactory solution i.e. location error estimates within a desired range . This process and system provides a mechanism for optimizing not only the artificial neural network architecture but also identifying a near optimal match between the ANN and one or more signal processing filters. Accordingly the following filters may be used in a filter pipeline of a filter description Sobel median mean histogram normalization input cropping neighbor Gaussian Weiner filters.

One embodiment for implementing the genetic evolving of filter description and ANN pairs is provided by the following steps that may automatically performed without substantial manual effort 

Note that artificial neural network genotypes may be formed by selecting various types of artificial neural network architectures suited to function approximation such as fast back propagation as well as characterizing several varieties of candidate transfer activation functions such as Tan h logistic linear sigmoid and radial basis. Furthermore ANNs having complex inputs may be selected as determined by a filter type in the signal processing subsystem for the genotypes.

Examples of genetic parameters include a maximum population size typical default 300 b generation limit typical default 50 c selection criteria such as a certain percentage to survive typical default 0.5 or roulette wheel d population refilling such as random or cloning default e mating criteria such as tail swapping default or two cut swapping f rate for a choice of mutation criterion such as random exchange default 0.25 or section reversal g population size of the concatenated artificial neural network filter combinations h use of statistical seeding on the initial population to bias the random initialization toward stronger first order relating variables and i neural node influence factors e.g. input nodes and hidden nodes. Such parameters can be used as weighting factors that influences the degree the system optimizes for accuracy versus network compactness. For example an input node factor greater than 0 provides a means to reward artificial neural networks constructed that use fewer input variables nodes . A reasonable default value is 0.1 for both input and hidden node factors.

Examples of neural net filter description system control parameters include a accuracy of modeling parameters such as relative accuracy R squared mean squared error root mean squared error or average absolute error default and b stopping criteria parameters such as generations run elapsed time best accuracy found and population convergence.

When using an artificial neural network for estimating a location of an MS it is important that the artificial neural network be provided with as much accurate RF signal measurement data regarding signal transmissions between the target MS and the base station infrastructure as possible. In particular assuming ANN inputs as described hereinabove it is desirable to obtain the detection states of as many surrounding base stations as possible. Thus whenever the location engine is requested to locate a target MS and in particular in an emergency context such as an emergency 911 call the location center automatically transmits a request to the wireless infrastructure to which the target MS is assigned for instructing the MS to raise its transmission power to full power for a short period of time e.g. 100 milliseconds in a base station infrastructure configuration an optimized for such requests to 2 seconds in a non optimized configuration . Note that the request for a change in the transmission power level of the target MS has a further advantage for location requests such as emergency 911 that are initiated from the MS itself in that a first ensemble of RF signal measurements can be provided to the location engine at the initial 911 calling power level and then a second ensemble of RF signal measurements can be provided at a second higher transmission power level. Thus in one embodiment of the present disclosure an artificial neural network can be trained not only on the location signature cluster derived from either the initial wireless 911 transmissions or the full power transmissions but also on the differences between these two transmissions. In particular the difference in the detection states of the discrete ANN inputs between the two transmission power levels may provide useful additional information for more accurately estimating a location of a target MS.

It is important to note that when gathering RF signal measurements from a wireless base station network for locating MSs the network should not be overburdened with location related traffic. Accordingly note that network location data requests for data particularly useful for ANN based FOMs is generally confined to the requests to the base stations in the immediate area of a target MS whose location is desired. For instance both collections of base stations B and b discussed in the context of training an ANN are also the same collections of base stations from which MS location data would be requested. Thus the wireless network MS location data requests are data driven in that the base stations to queried for location data i.e. the collections B and b are determined by previous RF signal measurement characteristics recorded. Accordingly the selection of the collections B and b are adaptable to changes in the wireless environmental characteristics of the coverage area .

Before proceeding with a description of other levels of the present disclosure as described in 24.1 through 24.3 above in this section further detail is provided regarding the location signature data base . Note that a brief description of the location signature data base was provided above indicating that this data base stores MS location data from verified and or known locations optionally with additional known environmental characteristic values for use in enhancing current target MS location hypotheses and for comparing archived location data with location signal data obtained from a current target MS. However the data base management system functionality incorporated into the location signature data base is an important aspect of the present disclosure and is therefore described in this section. In particular the data base management functionality described herein addresses a number of difficulties encountered in maintaining a large archive of signal processing data such as MS signal location data. Some of these difficulties can be described as follows 

It is an aspect of the present disclosure that the data base management functionality of the location signature data base addresses each of the difficulties mentioned immediately above. For example regarding a the location signature data base is self cleaning in that by associating a confidence value with each loc sig in the data base and by reducing or increasing the confidences of archived verified loc sigs according to how well their signal characteristic data compares with newly received verified location signature data the location signature data base maintains a consistency with newly verified loc sigs.

The following data base management functional descriptions describe some of the more noteworthy functions of the location signature data base . Note that there are various ways that these functions may be embodied. So as to not overburden the reader here the details for one embodiment is provided in APPENDIX C. through present a table providing a brief description of the attributes of the location signature data type stored in the location signature data base .

The following program updates the random loc sigs in the location signature data base . In one embodiment this program is invoked primarily by the Signal Processing Subsystem.

The following program reduces the confidence of verified loc sigs in the location signature data base that are likely to be no longer accurate i.e. in agreement with comparable loc sigs in the data base . If the confidence is reduced low enough then such loc sigs are removed from the data base. Further if for a location signature data base verified location composite entity i.e. a collection of loc sigs for the same location and time this entity no longer references any valid loc sigs then it is also removed from the data base. Note that this program is invoked by Update Loc Sig DB .

The following program increases the confidence of verified Location Signature loc sigs that are seemingly of higher accuracy i.e. in agreement with comparable loc sigs in the location signature data base . Note that this program is invoked by Update Loc Sig DB .

The following program determines the consistency of location hypotheses with verified location information in the location signature data base . Note that in the one embodiment of the present disclosure this program is invoked primarily by a module denoted the historical location reasoner described sections hereinbelow. Moreover the detailed description for this program is provided with the description of the historical location reasoner hereinbelow for completeness.

The following program compares a1 loc sigs that are contained in or derived from the loc sigs in target loc sig bag with b1 loc sigs computed from verified loc sigs in the location signature data base . That is each loc sig from a1 is compared with a corresponding loc sig from b1 to obtain a measurement of the discrepancy between the two loc sigs. In particular assuming each of the loc sigs for target loc sig bag correspond to the same target MS location wherein this location is target loc this program determines how well the loc sigs in target loc sig bag fit with a computed or estimated loc sig for the location target loc that is derived from the verified loc sigs in the location signature data base . Thus this program may be used a2 for determining how well the loc sigs in the location signature cluster for a target MS target loc sig bag compares with loc sigs derived from verified location signatures in the location signature data base and b2 for determining how consistent a given collection of loc sigs target loc sig bag from the location signature data base is with other loc sigs in the location signature data base. Note that in b2 each of the one or more loc sigs in target loc sig bag have an error computed here that can be used in determining if the loc sig is becoming inapplicable for predicting target MS locations.

The following program receives a collection of loc sigs and computes a loc sig that is representative of the loc sigs in the collection. That is given a collection of loc sigs loc sig bag wherein each loc sig is associated with the same predetermined Base Station this program uses these loc sigs to compute a representative or estimated loc sig associated with the predetermined Base Station and associated with a predetermined MS location loc for estimation . Thus if the loc sigs in loc sig bag are from the verified loc sigs of the location signature data base such that each of these loc sigs also has its associated MS location relatively close to loc for estimation then this program can compute and return a reasonable approximation of what a measured loc sig between an MS at loc for estimation and the predetermined Base Station ought to be. This program is invoked by Determine Location Signature Fit Errors .

The following program determines and returns a representation of a geographic area about a location loc wherein a the geographic area has associated MS locations for an acceptable number i.e. at least a determined minimal number of verified loc sigs from the location signature data base and b the geographical area is not too big. However if there are not enough loc sigs in even a largest acceptable search area about loc then this largest search area is returned. DB Loc Sig Error Fit 

This program compares two location signatures target loc sig and comparison loc sig both associated with the same predetermined Base Station and the same predetermined MS location or hypothesized location . This program determines a measure of the difference or error between the two loc sigs relative to the variability of the verified location signatures in a collection of loc sigs denoted the comparison loc sig bag obtained from the location signature data base. It is assumed that target loc sig comparison loc sig and the loc sigs in comparison loc sig bag are all associated with the same base station. This program returns an error record object error rec having an error or difference value and a confidence value for the error value. Note the signal characteristics of target loc sig and those of comparison loc sig are not assumed to be similarly normalized e.g. via filters as per the filters of the Signal Processing Subsystem prior to entering this function. It is further assumed that typically the input loc sigs satisfy the search criteria . This program is invoked by the program Determine Location Signature Fit Errors described above.

The context adjuster performs the first set of potentially many adjustments to at least the confidences of location hypotheses and in some important embodiments both the confidences and the target MS location estimates provided by FOMs may be adjusted according to previous performances of the FOMs. More particularly as mentioned above the context adjuster adjusts confidences so that assuming there is a sufficient density verified location signature clusters captured in the location signature data base the resulting location hypotheses output by the context adjuster may be further processed uniformly and substantially without concern as to differences in accuracy between the first order models from which location hypotheses originate. Accordingly the context adjuster adjusts location hypotheses both to environmental factors e.g. terrain traffic time of day etc. as described in 30.1 above and to how predictable or consistent each first order model FOM has been at locating previous target MS s whose locations were subsequently verified.

Of particular importance is the novel computational paradigm utilized herein. That is if there is a sufficient density of previous verified MS location data stored in the location signature data base then the FOM location hypotheses are used as an index into this data base i.e. the location signature data base for constructing new target MS location estimates. A more detailed discussion of this aspect of the present disclosure is given hereinbelow. Accordingly only a brief overview is provided here. Thus since the location signature data base stores previously captured MS location data including 

Note that in satisfying the above two criteria the context adjuster at least in one embodiment may use heuristic fuzzy logic rules to adjust the confidence values of location hypotheses from the first order models. Additionally the context adjuster may also satisfy the following criteria 

A first embodiment of the context adjuster is discussed immediately hereinbelow and in APPENDIX D. However the present disclosure also includes other embodiments of the context adjuster. A second embodiment is also described in Appendix D so as to not overburden the reader and thereby chance losing perspective of the overall invention.

A description of the high level functions in an embodiment of the context adjuster follows. Details regarding the implementation of these functions are provided in APPENDIX D. Also many of the terms used hereinbelow are defined in APPENDIX D. Accordingly the program descriptions in this section provide the reader with an overview of this first embodiment of the context adjuster .

This function adjusts the location hypotheses on the list loc hyp list so that the confidences of the location hypotheses are determined more by empirical data than default values from the First Order Models . That is for each input location hypothesis its confidence and an MS location area estimate may be exclusively determined here if there are enough verified location signatures available within and or surrounding the location hypothesis estimate.

This function creates a new list of location hypotheses from the input list loc hyp list wherein the location hypotheses on the new list are modified versions of those on the input list. For each location hypothesis on the input list one or more corresponding location hypotheses will be on the output list. Such corresponding output location hypotheses will differ from their associated input location hypothesis by one or more of the following a the image area field see may be assigned an area indicative of where the target MS is estimated to be b if image area is assigned then the confidence field will be the confidence that the target MS is located in the area for image area c if there are not sufficient nearby verified location signature clusters in the location signature data base to entirely rely on a computed confidence using such verified location signature clusters then two location hypotheses having reduced confidences will be returned one having a reduced computed confidence for image area using the verified clusters in the Location Signature data base and one being substantially the same as the associated input location hypothesis except that the confidence for the field area est is reduced to reflect the confidence in its paired location hypothesis having a computed confidence for image area . Note also in some cases the location hypotheses on the input list may have no change to its confidence or the area to which the confidence applies.

This function returns a list or more generally an aggregation object of one or more location hypotheses related to the input location hypothesis loc hyp . In particular the returned location hypotheses on the list are adjusted versions of loc hyp in that both their target MS location estimates and confidence placed in such estimates may be adjusted according to archival MS location information in the location signature data base . Note that the steps herein are also provided in flowchart form in through

The function get adjusted loc hyp list for and functions called by this function presuppose a framework or paradigm that requires some discussion as well as the defining of some terms. Note that some of the terms defined hereinbelow are illustrated in .

Define the term the the cluster set to be the set of all MS location point estimates e.g. the values of the pt est field of the location hypothesis data type for the present FOM such that 

Define the term image cluster set for a given First Order Model identified by loc hyp.FOM ID to mean the set of verified location signature clusters whose MS location point estimates are in the cluster set .

Note that an area containing the image cluster set will be denoted as the image cluster set area or simply the image area in some contexts. Further note that the image cluster set area will be a small area encompassing the image cluster set . In one embodiment the image cluster set area will be the smallest covering of cells from the mesh for the present FOM that covers the convex hull of the image cluster set. Note that preferably each cell of each mesh for each FOM is substantially contained within a single transmission area type.

Thus the present FOM provides the correspondences or mapping between elements of the cluster set and elements of the image cluster set.

This function returns a confidence value indicative of the target MS being in the area for image area . Note that the steps for this function are provided in flowchart form in and

The function confidence adjuster and functions called by this function presuppose a framework or paradigm that requires some discussion as well as the defining of terms.

Define the term mapped cluster density to be the number of the verified location signature clusters in an image cluster set per unit of area in the image cluster set area .

It is believed that the higher the mapped cluster density the greater the confidence can be had that a target MS actually resides in the image cluster set area when an estimate for the target MS by the present FOM is in the corresponding the cluster set .

Thus the mapped cluster density becomes an important factor in determining a confidence value for an estimated area of a target MS such as for example the area represented by image area . However the mapped cluster density value requires modification before it can be utilized in the confidence calculation. In particular confidence values must be in the range 1 1 and a mapped cluster density does not have this constraint. Thus a relativized mapped cluster density for an estimated MS area is desired wherein this relativized measurement is in the range 1 1 and in particular for positive confidences in the range 0 1 . Accordingly to alleviate this difficulty for the FOM define the term prediction mapped cluster density as a mapped cluster density value MCD for the FOM and image cluster set area wherein 

It is believed that the prediction mapped cluster density will typically be dependent on one or more area types. In particular it is assumed that for each area type there is a likely range of prediction mapped cluster density values that is substantially uniform across the area type. Accordingly as discussed in detail hereinbelow to calculate a prediction mapped cluster density for a particular area type an estimate is made of the correlation between the mapped cluster densities of image areas from cluster set areas and the likelihood that if a verified MS location a has a corresponding FOM MS estimate in the cluster set and b is also in the particular area type then the verified MS location is also in the image area.

Thus if an area is within a single area type then such a relativized mapped cluster density measurement for the area may be obtained by dividing the mapped cluster density by the prediction mapped cluster density and taking the smaller of the resulting ratio and 1.0 as the value for the relativized mapped cluster density.

In some perhaps most cases however an area e.g. an image cluster set area may have portions in a number of area types. Accordingly a composite prediction mapped cluster density may be computed wherein a weighted sum is computed of the prediction mapped cluster densities for the portions of the area that is in each of the area types. That is the weighting for each of the single area type prediction mapped cluster densities is the fraction of the total area that this area type is. Thus a relativized composite mapped cluster density for the area here may also be computed by dividing the mapped cluster density by the composite prediction mapped cluster density and taking the smaller of the resulting ratio and 1.0 as the value for the relativized composite mapped cluster density.

Accordingly note that as such a relativized composite mapped cluster density for an image cluster set area increases decreases it is assumed that the confidence of the target MS being in the image cluster set area should increase decrease respectively.

The present function determines a composite prediction mapped cluster density by determining a composite prediction mapped cluster density for the area represented by image area and for the First Order Model identified by FOM ID .

The present function determines an approximation to a prediction mapped cluster density D for an area type such that if an image cluster set area has a mapped cluster density D then there is a high expectation that the target MS is in the image cluster set area. Note that there are a number of embodiments that may be utilized for this function. The steps herein are also provided in flowchart form in through

It is important to note that the computation here for the prediction mapped cluster density may be more intense than some other computations but the cluster densities computed here need not be performed in real time target MS location processing. That is the steps of this function may be performed only periodically e.g. once a week for each FOM and each area type thereby precomputing the output for this function. Accordingly the values obtained here may be stored in a table that is accessed during real time target MS location processing. However for simplicity only the periodically performed steps are presented here. However one skilled in the art will understand that with sufficiently fast computational devices some related variations of this function may be performed in real time. In particular instead of supplying area type as an input to this function a particular area A may be provided such as the image area for a cluster set area or the portion of such an image area in a particular area type. Accordingly wherever area type is used in a statement of the embodiment of this function below a comparable statement with A can be provided.

Referring now to an embodiment of the Hypothesis Analyzer is illustrated. The control component is denoted the control module . Thus this control module manages or controls access to the run time location hypothesis storage area . The control module and the run time location hypothesis storage area may be implemented as a blackboard system and or an expert system. Accordingly in the blackboard embodiment and the control module determines when new location hypotheses may be entered onto the blackboard from other processes such as the context adjuster as well as when location hypotheses may be output to the most likelihood estimator .

The following is a brief description of each submodule included in the location hypothesis analyzer .

In the blackboard system embodiment of the location hypothesis analyzer a blackboard system is the mechanism by which the last adjustments are performed on location hypotheses and by which additional location hypotheses may be generated. Briefly a blackboard system can be described as a particular class of software that typically includes at least three basic components. That is 

Note that this blackboard system may be commercial however the knowledge sources i.e. daemons have been developed specifically for an embodiment of the present disclosure. For further information regarding such blackboard systems the following references are incorporated herein by reference a Jagannathan V. Dodhiawala R. Baum L. S. 1989 . Blackboard architectures and applications. Boston Mass. Harcourt Brace Jovanovich Publishers b Engelmore R. Morgan T. 1988 . Blackboard systems. Reading Mass. Addison Wesley Publishing Company.

Alternatively the control module and the run time location hypothesis storage area may be implemented as an expert system or as a fuzzy rule inferencing system wherein the control module activates or fires rules related to the knowledge domain in the present case rules relating to the accuracy of MS location hypothesis estimates and wherein the rules provide a computational embodiment of for example constraints and heuristics related to the accuracy of MS location estimates. Thus the control module for the present embodiment is also used for orchestrating coordinating and controlling the activity of the individual rule bases of the location hypothesis analyzer e.g. as shown in the analytical reasoner module the hypothesis generating module the historical location reasoner module and the location extrapolator module . For further information regarding such expert systems the following reference is incorporated herein by reference Waterman D. A. 1970 . A guide to expert systems. Reading Mass. Addison Wesley Publishing Company.

The MS status repository is a run time storage manager for storing location hypotheses from previous activations of the location engine as well as the output target MS location estimate s so that a target MS may be tracked using target MS location hypotheses from previous location engine activations to determine for example a movement of the target MS between evaluations of the target MS location. Thus by retaining a moving window of previous location hypotheses used in evaluating positions of a target MS measurements of the target MS s velocity acceleration and likely next position may be determined by the location hypothesis analyzer . Further by providing accessibility to recent MS location hypotheses these hypotheses may be used to resolve conflicts between hypotheses in a current activation for locating the target MS e.g. MS paths may be stored here for use in extrapolating a new location

The most likelihood estimator is a module for determining a most likely location estimate for a target MS being located e.g. as in 30.7 above . In one embodiment the most likelihood estimator performs an integration or summing of all location hypothesis confidence values for any geographic region s of interest having at least one location hypothesis that has been provided to the most likelihood estimator and wherein the location hypothesis has a relatively or sufficiently high confidence. That is the most likelihood estimator determines the area s within each such region having high confidences or confidences above a threshold as the most likely target MS location estimates.

In one embodiment of the most likelihood estimator this module utilizes an area mesh M over which to integrate wherein the mesh cells of M are preferably smaller than the greatest location accuracy desired. That is each cell c of M is assigned a confidence value indicating a likelihood that the target MS is located in c wherein the confidence value for c is determined by the confidence values of the target MS location estimates provided to the most likelihood estimator . Thus to obtain the most likely location determination s the following steps are performed 

Of course variations in the above algorithm are also within the scope of the present disclosure. For example some embodiments of the most likelihood estimator may 

Additionally in some embodiments the most likelihood estimator upon receiving one or more location hypotheses from the hypothesis analyzer also performs some or all of the following tasks 

The analytical reasoner applies constraint or sanity checks to the target MS estimates of the location hypotheses residing in the Run time Location Hypothesis Storage Area for adjusting the associated confidence values accordingly. In one embodiment these sanity checks involve path information. That is this module determines if or how well location hypotheses are consistent with well known physical constraints such as the laws of physics in an area in which the MS associated with the location hypothesis is estimated to be located. For example if the difference between a previous most likely location estimate of a target MS and an estimate by a current location hypothesis requires the MS to 

Notice from that the analytical reasoner can access location hypotheses currently posted on the Run time Location Hypothesis Storage Area. Additionally it interacts with the Pathway Database which contains information concerning the location of natural transportation pathways in the region highways rivers etc. and the Area Characteristics Database which contains information concerning for example reasonable velocities that can be expected in various regions for instance speeds of 80 mph would not be reasonably expected in dense urban areas . Note that both speed and direction can be important constraints e.g. even though a speed might be appropriate for an area such as 20 mph in a dense urban area if the direction indicated by a time series of related location hypotheses is directly through an extensive building complex having no through traffic routes then a reduction in the confidence of one or more of the location hypotheses may be appropriate.

One embodiment of the Analytical Reasoner illustrating how such constraints may be implemented is provided in the following section. Note however that this embodiment analyzes only location hypotheses having a non negative confidence value.

The path comparison module implements the following strategy the confidence of a particular location hypothesis is to be increased decreased if it is not predicting a path that lies along a known transportation pathway and the speed of the target MS is sufficiently high . For instance if a time series of target MS location hypotheses for a given FOM is predicting a path of the target MS that lies along an interstate highway the confidence of the currently active location hypothesis for this FOM should in general be increased. Thus at a high level the following steps may be performed 

The velocity acceleration calculation module computes velocity and or acceleration estimates for the target MS using currently active location hypotheses and previous location hypothesis estimates of the target MS. In one embodiment for each FOM having a currently active location hypothesis with positive confidences and a sufficient number of previous reasonably recent target MS location hypotheses a velocity and or acceleration may be calculated. In an alternative embodiment such a velocity and or acceleration may be calculated using the currently active location hypotheses and one or more recent most likely locations of the target MS output by the location engine . If the estimated velocity and or acceleration corresponding to a currently active location hypothesis is reasonable for the region then its confidence value may be incremented if not then its confidence may be decremented. The algorithm may be summarized as follows 

The attribute comparison module compares attribute values for location hypotheses generated from different FOMs and determines if the confidence of certain of the currently active location hypotheses should be increased due to a similarity in related values for the attribute. That is for an attribute A an attribute value for A derived from a set S of one or more location hypotheses generated by one FOM FOM is compared with another attribute value for A derived from a set Sof one or more location hypotheses generated by a different FOM FOM for determining if these attribute values cluster i.e. are sufficiently close to one another so that a currently active location hypothesis in S and a currently active location hypothesis in S should have their confidences increased. For example the attribute may be a target MS path data attribute wherein a value for the attribute is an estimated target MS path derived from location hypotheses generated by a fixed FOM over some recent time period. Alternatively the attribute might be for example one of a velocity and or acceleration wherein a value for the attribute is a velocity and or acceleration derived from location hypotheses generated by a fixed FOM over some recent time period.

Note that the phrase cluster sufficiently well above may have a number of technical embodiments including performing various cluster analysis techniques wherein any clusters according to some statistic must satisfy a system set threshold for the members of the cluster being close enough to one another. Further upon determining the any location hypotheses satisfying 38.1 there are various techniques that may be used in determining a change or delta in confidences to be applied. For example in one embodiment an initial default confidence delta that may be utilized is if cf denotes the confidence of such a currently active location hypothesis satisfying 38.1 then an increased confidence that still remains in the interval 0 1.0 may be cf 1 cf 1 cf or cf 1.0 cf n. 2 or cf a constant having a system tuned parameter as a factor . That is the confidence deltas for these examples are 1 cf 1 cf an additive delta and 1.0 cf a multiplicative delta and a constant. Additionally note that it is within the scope of the present disclosure to also provide such confidence deltas additive deltas or multiplicative deltas with factors related to the number of such location hypotheses in the cluster.

Moreover note that it is an aspect of the present disclosure to provide an adaptive mechanism i.e. the adaptation engine shown in and for automatically determining performance enhancing changes in confidence adjustment values such as the confidence deltas for the present module. That is such changes are determined by applying an adaptive mechanism such as a genetic algorithm to a collection of system parameters including parameters specifying confidence adjustment values as well as system parameters of for example the context adjuster in order to enhance performance of an embodiment of the present disclosure. More particularly such an adaptive mechanism may repeatedly perform the following steps 

Assuming this module adjusts confidences of currently active location hypotheses according to one or more of the attributes target MS path data target MS velocity and target MS acceleration the computation for this module may be summarized in the following steps 

Note that such confidence adjustment values are used later in the calculation of an aggregate confidence adjustment to particular currently active location hypotheses.

Given one or more currently active location hypotheses for the same target MS input to the analytical reasoner controller this controller activates for each such input location hypothesis the other submodules of the analytical reasoner module denoted hereinafter as adjustment submodules with this location hypothesis. Subsequently the analytical reasoner controller receives an output confidence adjustment value computed by each adjustment submodule for adjusting the confidence of this location hypothesis. Note that each adjustment submodule determines 

Subsequently the controller uses the output from the adjustment submodules to compute an aggregate confidence adjustment for the corresponding location hypothesis. In one particular embodiment of the present disclosure values for the eight types of confidence adjustment values described in sections above are output to the present controller for computing an aggregate confidence adjustment value for adjusting the confidence of the currently active location hypothesis presently being analyzed by the analytical reasoner module . As an example of how such confidence adjustment values may be utilized assuming a currently active location hypothesis is identified by i the outputs from the above described adjustment submodules may be more fully described as 

Additionally for each of the above confidence adjustments there is a corresponding location engine system setable parameter whose value may be determined by repeated activation of the adaptation engine . Accordingly for each of the confidence adjustment types T above there is a corresponding system setable parameter alpha T that is tunable by the adaptation engine . Accordingly the following high level program segment illustrates the aggregate confidence adjustment value computed by the Analytical Reasoner Controller.

The historical location reasoner module may be for example a daemon or expert system rule base. The module adjusts the confidences of currently active location hypotheses by using from location signature data base historical signal data correlated with a verified MS locations e.g. locations verified when emergency personnel co locate with a target MS location and b various environmental factors to evaluate how consistent the location signature cluster for an input location hypothesis agrees with such historical signal data.

This reasoner will increase decrease the confidence of a currently active location hypothesis depending on how well its associated loc sigs correlate with the loc sigs obtained from data in the location signature data base.

Note that the embodiment hereinbelow is but one of many embodiments that may adjust the confidence of currently active location hypotheses appropriately. Accordingly it is important to note other embodiments of the historical location reasoner functionality are within the scope of the present disclosure as one skilled in the art will appreciate upon examining the techniques utilized within this specification. For example calculations of a confidence adjustment factor may be determined using Monte Carlo techniques as in the context adjuster . Each such embodiment generates a measurement of at least one of the similarity and the discrepancy between the signal characteristics of the verified location signature clusters in the location signature data base and the location signature cluster for an input currently active location hypothesis loc hyp .

The embodiment hereinbelow provides one example of the functionality that can be provided by the historical location reasoner either by activating the following programs as a daemon or by transforming various program segments into the consequents of expert system rules . The present embodiment generates such a confidence adjustment by the following steps 

The program illustrated in APPENDIX E provides a more detailed embodiment of the steps immediately above.

The location extrapolator works on the following premise if for a currently active location hypothesis there is sufficient previous related information regarding estimates of the target MS e.g. from the same FOM or from using a most likely previous target MS estimate output by the location engine then an extrapolation may be performed for predicting future target MS locations that can be compared with new location hypotheses provided to the blackboard. Note that interpolation routines e.g. conventional algorithms such as Lagrange or Newton polynomials may be used to determine an equation that approximates a target MS path corresponding to a currently active location hypothesis.

Subsequently such an extrapolation equation may be used to compute a future target MS location. For further information regarding such interpolation schemes the following reference is incorporated herein by reference Mathews 1992 Numerical methods for mathematics science and engineering. Englewood Cliffs N.J. Prentice Hall.

Accordingly if a new currently active location hypothesis e.g. supplied by the context adjuster is received by the blackboard then the target MS location estimate of the new location hypothesis may be compared with the predicted location. Consequently a confidence adjustment value can be determined according to how well the new location hypothesis i fits with the predicted location. That is this confidence adjustment value will be larger as the new MS estimate and the predicted estimate become closer together. Note that in one embodiment of the present disclosure such predictions are based solely on previous target MS location estimates output by location engine . Thus in such an embodiment substantially every currently active location hypothesis can be provided with a confidence adjustment value by this module once a sufficient number of previous target MS location estimates have been output. Accordingly a value extrapolation chk i that represents how accurately the new currently active location hypothesis identified here by i matches the predicted location is determined.

The hypothesis generating module is used for generating additional location hypotheses according to for example MS location information not adequately utilized or modeled. Note location hypotheses may also be decomposed here if for example it is determined that a location hypothesis includes an MS area estimate that has subareas with radically different characteristics such as an area that includes an uninhabited area and a densely populated area. Additionally the hypothesis generating module may generate poor reception location hypotheses that specify MS location areas of known poor reception that are near or intersect currently active location hypotheses. Note that these poor reception location hypotheses may be specially tagged e.g. with a distinctive FOM ID value or specific tag field so that regardless of substantially any other location hypothesis confidence value overlapping such a poor reception area such an area will maintain a confidence value of unknown i.e. zero . Note that substantially the only exception to this constraint is location hypotheses generated from mobile base stations .

Any collection of mobile electronics denoted mobile location unit that is able to both estimate a location of a target MS and communicate with the base station network may be utilized by an embodiment of the present disclosure to more accurately locate the target MS. Such mobile location units may provide greater target MS location accuracy by for example homing in on the target MS and by transmitting additional MS location information to the location center . There are a number of embodiments for such a mobile location unit contemplated by the present disclosure. For example in a minimal version such the electronics of the mobile location unit may be little more than an onboard MS a sectored directional antenna and a controller for communicating between them. Thus the onboard MS is used to communicate with the location center and possibly the target MS while the antenna monitors signals for homing in on the target MS . In an enhanced version of the mobile location unit a GPS receiver may also be incorporated so that the location of the mobile location unit may be determined and consequently an estimate of the location of the target MS may also be determined. However such a mobile location unit is unlikely to be able to determine substantially more than a direction of the target MS via the sectored directional antenna without further base station infrastructure cooperation in for example determining the transmission power level of the target MS or varying this power level. Thus if the target MS or the mobile location unit leaves the coverage area or resides in a poor communication area it may be difficult to accurately determine where the target MS is located. None the less such mobile location units may be sufficient for many situations and in fact the present disclosure contemplates their use. However in cases where direct communication with the target MS is desired without constant contact with the base station infrastructure an embodiment of the present disclosure includes a mobile location unit that is also a scaled down version of a base station . Thus given that such a mobile base station or MBS includes at least an onboard MS a sectored directional antenna a GPS receiver a scaled down base station and sufficient components including a controller for integrating the capabilities of these devices an enhanced autonomous MS mobile location system can be provided that can be effectively used in for example emergency vehicles airplanes and boats. Accordingly the description that follows below describes an embodiment of an MBS having the above mentioned components and capabilities for use in a vehicle.

As a consequence of the MBS being mobile there are fundamental differences in the operation of an MBS in comparison to other types of BS s . In particular other types of base stations have fixed locations that are precisely determined and known by the location center whereas a location of an MBS may be known only approximately and thus may require repeated and frequent re estimating. Secondly other types of base stations have substantially fixed and stable communication with the location center via possibly other BS s in the case of LBSs and therefore although these BS s may be more reliable in their in their ability to communicate information related to the location of a target MS with the location center accuracy can be problematic in poor reception areas. Thus MBS s may be used in areas such as wilderness areas where there may be no other means for reliably and cost effectively locating a target MS i.e. there may be insufficient fixed location BS s coverage in an area .

Additionally many commercial wireless telephony technologies require all BS s in a network to be very accurately time synchronized both for transmitting MS voice communication as well as for other services such as MS location. Accordingly the MBS will also require such time synchronization. However since an MBS may not be in constant communication with the fixed location BS network and indeed may be off line for substantial periods of time on board highly accurate timing device may be necessary. In one embodiment such a device may be a commercially available ribidium oscillator as shown in .

Since the MBS includes a scaled down version of a BS denoted in it is capable of performing most typical BS tasks albeit on a reduced scale. In particular the base station portion of the MBS can 

Moreover the MBS has an additional advantage in that it can substantially increase the reliability of communication with a target MS in comparison to the base station infrastructure by being able to move toward or track the target MS even if this MS is in or moves into a reduced infrastructure base station network coverage area. Furthermore an MBS may preferably use a directional or smart antenna to more accurately locate a direction of signals from a target MS . Thus the sweeping of such a smart antenna physically or electronically provides directional information regarding signals received from the target MS . That is such directional information is determined by the signal propagation delay of signals from the target MS to the angular sectors of one of more directional antennas on board the MBS .

Before proceeding to further details of the MBS location subsystem an example of the operation of an MBS in the context of responding to a 911 emergency call is given. In particular this example describes the high level computational states through which the MBS transitions these states also being illustrated in the state transition diagram of . Note that this figure illustrates the primary state transitions between these MBS states wherein the solid state transitions are indicative of a typical ideal progression when locating or tracking a target MS and the dashed state transitions are the primary state reversions due for example to difficulties in locating the target MS .

Accordingly initially the MBS may be in an inactive state wherein the MBS location subsystem is effectively available for voice or data communication with the fixed location base station network but the MS locating capabilities of the MBS are not active. From the inactive state the MBS e.g. a police or rescue vehicle may enter an active state once an MBS operator has logged onto the MBS location subsystem of the MBS such logging being for authentication verification and journaling of MBS events. In the active state the MBS may be listed by a 911 emergency center and or the location center as eligible for service in responding to a 911 request. From this state the MBS may transition to a ready state signifying that the MBS is ready for use in locating and or intercepting a target MS . That is the MBS may transition to the ready state by performing the following steps 

Thus while in the ready state as the MBS moves it has its location repeatedly re estimated via for example GPS signals location center location estimates from the base stations and and an on board deadreckoning subsystem having an MBS location estimator according to the programs described hereinbelow. However note that the accuracy of the base station time synchronization via the ribidium oscillator and the accuracy of the MBS location may need to both be periodically recalibrated according to 1a and 1b above.

Assuming a 911 signal is transmitted by a target MS this signal is transmitted via the fixed location base station infrastructure to the 911 emergency center and the location center and assuming the MBS is in the ready state if a corresponding 911 emergency request is transmitted to the MBS via the base station infrastructure from the 911 emergency center or the location center then the MBS may transition to a seek state by performing the following steps 

Subsequently when the MBS is in the seek state the MBS may commence toward the target MS location estimate provided. Note that it is likely that the MBS is not initially in direct signal contact with the target MS. Accordingly in the seek state the following steps may be for example performed 

Assuming that the MBS and target MS detect one another which typically occurs when the two units are within 0.25 to 3 miles of one another the MBS enters a contact state when the target MS enters a soft hand off state with the MBS. Accordingly in the contact state the following steps are for example performed 

When the target MS detects that the MBS pilot channel is sufficiently strong the target MS may switch to using the MBS as its primary base station. When this occurs the MBS enters a control state wherein the following steps are for example performed 

Note there can be more than one MBS tracking or locating an MS . There can also be more than one target MS to be tracked concurrently and each target MS being tracked may be stationary or moving.

An MBS uses MS signal characteristic data for locating the MS . The MBS may use such signal characteristic data to facilitate determining whether a given signal from the MS is a direct shot or an multipath signal. That is in one embodiment the MBS attempts to determine or detect whether an MS signal transmission is received directly or whether the transmission has been reflected or deflected. For example the MBS may determine whether the expected signal strength and TOA agree in distance estimates for the MS signal transmissions. Note other signal characteristics may also be used if there are sufficient electronics and processing available to the MBS i.e. determining signal phase and or polarity as other indications of receiving a direct shot from an MS .

In one embodiment the MBS includes an MBS controller for controlling the location capabilities of the MBS . In particular the MBS controller initiates and controls the MBS state changes as described in above. Additionally the MBS controller also communicates with the location controller wherein this latter controller controls MBS activities related to MBS location and target MS location e.g. this performs the program mobile base station controller described in APPENDIX A hereinbelow. The location controller receives data input from an event generator for generating event records to be provided to the location controller . For example records may be generated from data input received from a the vehicle movement detector indicating that the MBS has moved at least a predetermined amount and or has changed direction by at least a predetermined angle or b the MBS signal processing subsystem indicating that the additional signal measurement data has been received from either the location center or the target MS . Note that the MBS signal processing subsystem in one embodiment is similar to the signal processing subsystem of the location center . Moreover also note that there may be multiple command schedulers. In particular a scheduler for commands related to communicating with the location center a scheduler for commands related to GPS communication via GPS receiver a scheduler for commands related to the frequency and granularity of the reporting of MBS changes in direction and or position via the MBS deadreckoning subsystem note that this scheduler is potentially optional and that such commands may be provided directly to the deadreckoning estimator and a scheduler for communicating with the target MS s being located. Further it is assumed that there is sufficient hardware and or software to perform commands in different schedulers substantially concurrently.

In order to display an MBS computed location of a target MS a location of the MBS must be known or determined. Accordingly each MBS has a plurality of MBS location estimators or hereinafter also simply referred to as location estimators for determining the location of the MBS. Each such location estimator computes MBS location information such as MBS location estimates changes to MBS location estimates or an MBS location estimator may be an interface for buffering and or translating a previously computed MBS location estimate into an appropriate format. In particular the MBS location module which determines the location of the MBS may include the following MBS location estimators also denoted baseline location estimators 

Additionally note that a plurality of MBS location technologies and their corresponding MBS location estimators are utilized due to the fact that there is currently no single location technology available that is both sufficiently fast accurate and accessible in substantially all terrains to meet the location needs of an MBS . For example in many terrains GPS technologies may be sufficiently accurate however GPS technologies a may require a relatively long time to provide an initial location estimate e.g. greater than 2 minutes b when GPS communication is disturbed it may require an equally long time to provide a new location estimate c clouds buildings and or mountains can prevent location estimates from being obtained d in some cases signal reflections can substantially skew a location estimate. As another example an MBS may be able to use triangulation or trilateralization technologies to obtain a location estimate however this assumes that there is sufficient fixed location infrastructure BS coverage in the area the MBS is located. Further it is well known that the multipath phenomenon can substantially distort such location estimates. Thus for an MBS to be highly effective in varied terrains an MBS is provided with a plurality of location technologies each supplying an MBS location estimate.

In fact much of the architecture of the location engine could be incorporated into an MBS . For example in some embodiments of the MBS the following FOMs may have similar location models incorporated into the MBS 

However for those MBS location models requiring communication with the base station infrastructure an alternative embodiment is to rely on the location center to perform the computations for at least some of these MBS FOM models. That is since each of the MBS location models mentioned immediately above require communication with the network of fixed location BS s it may be advantageous to transmit MBS location estimating data to the location center as if the MBS were another MS for the location center to locate and thereby rely on the location estimation capabilities at the location center rather than duplicate such models in the MBS . The advantages of this approach are that 

As will be discussed further below in one embodiment of the MBS there are confidence values assigned to the locations output by the various location estimators . Thus the confidence for a manual entry of location data by an MBS operator may be rated the highest and followed by the confidence for any GPS location data followed by the confidence for any location center location estimates followed by the confidence for any location estimates using signal characteristic data from LBSs. However such prioritization may vary depending on for instance the radio coverage area . In an one embodiment of the present disclosure it is an aspect of the present disclosure that for MBS location data received from the GPS and location center their confidences may vary according to the area in which the MBS resides. That is if it is known that for a given area there is a reasonable probability that a GPS signal may suffer multipath distortions and that the location center has in the past provided reliable location estimates then the confidences for these two location sources may be reversed.

In one embodiment of the present disclosure MBS operators may be requested to occasionally manually enter the location of the MBS when the MBS is stationary for determining and or calibrating the accuracy of various MBS location estimators.

There is an additional important source of location information for the MBS that is incorporated into an MBS vehicle such as a police vehicle that has no comparable functionality in the network of fixed location BS s. That is the MBS may use deadreckoning information provided by a deadreckoning MBS location estimator whereby the MBS may obtain MBS deadreckoning location change estimates. Accordingly the deadreckoning MBS location estimator may use for example an on board gyroscope a wheel rotation measurement device e.g. odometer and optionally an accelerometer not shown . Thus such a deadreckoning MBS location estimator periodically provides at least MBS distance and directional data related to MBS movements from a most recent MBS location estimate. More precisely in the absence of any other new MBS location information the deadreckoning MBS location estimator outputs a series of measurements wherein each such measurement is an estimated change or delta in the position of the MBS between a request input timestamp and a closest time prior to the timestamp wherein a previous deadreckoning terminated. Thus each deadreckoning location change estimate includes the following fields 

Further the frequency of such measurements provided by the deadreckoning subsystem may be adaptively provided depending on the velocity of the MBS and or the elapsed time since the most recent MBS location update. Accordingly the architecture of at least some embodiments of the MBS location subsystem must be such that it can utilize such deadreckoning information for estimating the location of the MBS .

In one embodiment of the MBS location subsystem described in further detail hereinbelow the outputs from the deadreckoning MBS location estimator are used to synchronize MBS location estimates from different MBS baseline location estimators. That is since such a deadreckoning output may be requested for substantially any time from the deadreckoning MBS location estimator such an output can be requested for substantially the same point in time as the occurrence of the signals from which a new MBS baseline location estimate is derived. Accordingly such a deadreckoning output can be used to update other MBS location estimates not using the new MBS baseline location estimate.

It is assumed that the error with deadreckoning increases with deadreckoning distance. Accordingly it is an aspect of the embodiment of the MBS location subsystem that when incrementally updating the location of the MBS using deadreckoning and applying deadreckoning location change estimates to a most likely area in which the MBS is believed to be this area is incrementally enlarged as well as shifted. The enlargement of the area is used to account for the inaccuracy in the deadreckoning capability. Note however that the deadreckoning MBS location estimator is periodically reset so that the error accumulation in its outputs can be decreased. In particular such resetting occurs when there is a high probability that the location of the MBS is known. For example the deadreckoning MBS location estimator may be reset when an MBS operator manually enters an MBS location or verifies an MBS location or a computed MBS location has sufficiently high confidence.

Thus due to the MBS having less accurate location information both about itself and a target MS and further that deadreckoning information must be utilized in maintaining MBS location estimates a first embodiment of the MBS location subsystem architecture is somewhat different from the location engine architecture. That is the architecture of this first embodiment is simpler than that of the architecture of the location engine . However it important to note that at a high level the architecture of the location engine may also be applied for providing a second embodiment of the MBS location subsystem as one skilled in the art will appreciate after reflecting on the architectures and processing provided at an MBS . For example an MBS location subsystem architecture may be provided that has one or more first order models whose output is supplied to for example a blackboard or expert system for resolving MBS location estimate conflicts such an architecture being analogous to one embodiment of the location engine architecture.

Furthermore it is also an important aspect of the present disclosure that at a high level the MBS location subsystem architecture may also be applied as an alternative architecture for the location engine . For example in one embodiment of the location engine each of the first order models may provide its MS location hypothesis outputs to a corresponding location track analogous to the MBS location tracks described hereinbelow and subsequently a most likely MS current location estimate may be developed in a current location track also described hereinbelow using the most recent location estimates in other location tracks.

Further note that the ideas and methods discussed here relating to MBS location estimators and MBS location tracks and the related programs hereinbelow are sufficiently general so that these ideas and methods may be applied in a number of contexts related to determining the location of a device capable of movement and wherein the location of the device must be maintained in real time. For example the present ideas and methods may be used by a robot in a very cluttered environment e.g. a warehouse wherein the robot has access a to a plurality of robot location estimators that may provide the robot with sporadic location information and b to a deadreckoning location estimator.

Each MBS additionally has a location display denoted the MBS operator visual user interface in where area maps that may be displayed together with location data. In particular MS location data may be displayed on this display as a nested collection of areas each smaller nested area being the most likely area within any encompassing area for locating a target MS . Note that the MBS controller algorithm below may be adapted to receive location center data for displaying the locations of other MBSs as well as target MSs .

Further the MBS may constrain any location estimates to streets on a street map using the MBS location snap to street module . For example an estimated MBS location not on a street may be snapped to a nearest street location. Note that a nearest street location determiner may use normal orientations of vehicles on streets as a constraint on the nearest street location particularly if an MBS is moving at typical rates of speed and acceleration and without abrupt changes in direction. For example if the deadreckoning MBS location estimator indicates that the MBS is moving in a northerly direction then the street snapped to should be a north south running street. Moreover the MBS location snap to street module may also be used to enhance target MS location estimates when for example it is known or suspected that the target MS is in a vehicle and the vehicle is moving at typical rates of speed. Furthermore the snap to street location module may also be used in enhancing the location of a target MS by either the MBS or by the location engine . In particular the location estimator or an additional module between the location estimator and the output gateway may utilize an embodiment of the snap to street location module to enhance the accuracy of target MS location estimates that are known to be in vehicles. Note that this may be especially useful in locating stolen vehicles that have embedded wireless location transceivers MSs wherein appropriate wireless signal measurements can be provided to the location center .

Assuming the existence of at least some of the location estimators that were mentioned above the discussion here refers substantially to the data structures and their organization as illustrated in .

The location estimates or hypotheses for an MBS determining its own location each have an error or range estimate associated with the MBS location estimate. That is each such MBS location estimate includes a most likely MBS point location within a most likely area . The most likely MBS point location is assumed herein to be the centroid of the most likely area. In one embodiment of the MBS location subsystem a nested series of most likely areas may be provided about a most likely MBS point location. However to simplify the discussion herein each MBS location estimate is assumed to have a single most likely area . One skilled in the art will understand how to provide such nested most likely areas from the description herein. Additionally it is assumed that such most likely areas are not grossly oblong i.e. area cross sectioning lines through the centroid of the area do not have large differences in their lengths. For example for any such most likely area A no two such cross sectioning lines of A may have lengths that vary by more than a factor of two.

Each MBS location estimate also has a confidence associated therewith providing a measurement of the perceived accuracy of the MBS being in the most likely area of the location estimate.

A MBS location track is a data structure or object having a queue of a predetermined length for maintaining a temporal timestamp ordering of location track entries such as the location track entries and wherein each such MBS location track entry is an estimate of the location of the MBS at a particular corresponding time.

There is an MBS location track for storing MBS location entries obtained from MBS location estimation information from each of the MBS baseline location estimators described above i.e. a GPS location track for storing MBS location estimations obtained from the GPS location estimator a location center location track for storing MBS location estimations obtained from the location estimator deriving its MBS location estimates from the location center an LBS location track for storing MBS location estimations obtained from the location estimator deriving its MBS location estimates from base stations and or and a manual location track for MBS operator entered MBS locations . Additionally there is one further location track denoted the current location track whose location track entries may be derived from the entries in the other location tracks described further hereinbelow . Further for each location track there is a location track head that is the head of the queue for the location track. The location track head is the most recent and presumably the most accurate MBS location estimate residing in the location track. Thus the GPS location track has location track head the location center location track has location track head the LBS location track has location track head the manual location track has location track head and the current location track has location track head . Additionally for notational convenience for each location track the time series of previous MBS location estimations i.e. location track entries in the location track will herein be denoted the path for the location track. Such paths are typically the length of the location track queue containing the path. Note that the length of each such queue may be determined using at least the following considerations 

For each MBS location track there are two categories of MBS location track entries that may be inserted into a MBS location track 

In order to be able to properly compare the track heads to determine the most likely MBS location estimate it is an aspect of the present invention that the track heads of all location tracks include MBS location estimates that are for substantially the same latest timestamp. However the MBS location information from each MBS baseline location estimator is inherently substantially unpredictable and unsynchronized. In fact the only MBS location information that may be considered predicable and controllable is the deadreckoning location change estimates from the deadreckoning MBS location estimator in that these estimates may reliably be obtained whenever there is a query from the location controller for the most recent estimate in the change of the location for the MBS . Consequently referring to synchronization records having at least a portion and in some cases also having a portion may be provided for updating each location track with a new MBS location estimate as a new track head. In particular each synchronization record includes a deadreckoning location change estimate to be used in updating all but at most one of the location track heads with a new MBS location estimate by using a deadreckoning location change estimate in conjunction with each MBS location estimate from an MBS baseline location estimator the location track heads may be synchronized according to timestamp. More precisely for each MBS location estimate E from an MBS baseline location estimator an embodiment of the present disclosure also substantially simultaneously queries the deadreckoning MBS location estimator for a corresponding most recent change in the location of the MBS . Accordingly E and the retrieved MBS deadreckoning location change estimate C have substantially the same latest timestamp . Thus the location estimate E may be used to create a new baseline track head for the location track having the corresponding type for E and C may be used to create a corresponding extrapolation entry as the head of each of the other location tracks. Accordingly since for each MBS location estimate E there is a MBS deadreckoning location change estimate C having substantially the same latest timestamp E and C will be hereinafter referred as paired. 

High level descriptions of an embodiment of the location functions performed by an MBS are provided in APPENDIX A hereinbelow.

It is assumed that with increasing continuous dead reckoning without additional MBS location verification the potential error in the MBS location increases.

It is assumed that each MBS location estimate includes a a most likely area estimate surrounding a central location and b a confidence value of the MBS being in the location estimate.

The confidence value for each MBS location estimate is a measurement of the likelihood of the MBS location estimate being correct. More precisely a confidence value for a new MBS location estimate is a measurement that is adjusted according to the following criteria 

It is assumed that with each MBS location estimate supplied by the Location Center there is a default confidence value supplied which the MBS may change.

In the algorithms below external parameter values needed are underlined. Note that in one embodiment of the present disclosure such parameters may be adaptively tuned using for example a genetic algorithm.

In particular comparisons are iteratively made here between each target loc sig near new loc obj and a population of loc sigs in the location signature data base such population typically including the loc sig for new loc obj for 

Note that this program may be invoked with a verified known random and or repeatable loc sig as input. Furthermore the target loc sigs to be updated may be selected from a particular group of loc sigs such as the random loc sigs or the repeatable loc sigs such selection being determined according to the input parameter selection criteria while the comparison population may be designated with the input parameter loc sig pop . For example to update confidence factors of certain random loc sigs near new loc obj selection criteria may be given a value indicating USE RANDOM LOC SIGS and loc sig pop may be given a value indicating USE REPEATABLE LOC SIGS . Thus if in a given geographic area the repeatable loc sigs from e.g. stationary transceivers in the area have recently been updated then by successively providing new loc obj with a loc sig for each of these repeatable loc sigs the stored random loc sigs can have their confidences adjusted.

Alternatively in one embodiment of the present disclosure the present function may be used for determining when it is desirable to update repeatable loc sigs in a particular area instead of automatically and periodically updating such repeatable loc sigs . For example by adjusting the confidence factors on repeatable loc sigs here provides a method for determining when repeatable loc sigs for a given area should be updated. That is for example when the area s average confidence factor for the repeatable loc sigs drops below a given potentially high threshold then the MSs that provide the repeatable loc sigs can be requested to respond with new loc sigs for updating the DB. Note however that the approach presented in this function assumes that the repeatable location information in the DB is maintained with high confidence by for example frequent DB updating. Thus the random verified DB location information may be effectively compared against the repeatable loc sigs in an area.

Further note that to provide more accurate estimates it is contemplated that Hata s three geographic categories and corresponding formulas may be used in a fuzzy logic framework with adaptive mechanisms such as the adaptation engine for adaptively determining the fuzzy logic classifications .

Additionally it is also within the scope of the present disclosure to use the techniques of L. E. Vogler as presented in The Attenuation of Electromagnetic Waves by Multiple Knife Edge Diffraction US Dept of Commerce NTIA nos 81 86 herein incorporated by reference in the present context for estimating a loc sig between the base station associated with loc sig bag and the location of loc for estimation . 

This function creates a new list of location hypotheses from the input list loc hyp list wherein the location hypotheses on the new list are modified versions of those on the input list. For each location hypothesis on the input list one or more corresponding location hypotheses will be on the output list. Such corresponding output location hypotheses will differ from their associated input location hypothesis by one or more of the following a the image area field see may be assigned an area indicative of where the target MS is estimated to be b if image area is assigned then the confidence field will be the confidence that the target MS is located in the area for image area c if there are not sufficient nearby verified location signature clusters in the location signature data base to entirely rely on a computed confidence using such verified location signature clusters then two location hypotheses having reduced confidences will be returned one having a reduced computed confidence for image area using the verified clusters in the Location Signature DB and one being substantially the same as the associated input location hypothesis except that the confidence for the field area est is reduced to reflect the confidence in its paired location hypothesis having a computed confidence for image area . Note also in some cases the location hypotheses on the input list may have no change to its confidence or the area to which the confidence applies. Note that the steps herein are also provided in flowchart form in and

Define the term the the cluster set to be the set of all MS location point estimates e.g. the values of the pt est field of the location hypothesis data type for the present FOM such that these estimates are within a predetermined corresponding area e.g. loc hyp.ptcovering being this predetermined corresponding area and these point estimates have verified location signature clusters in the location signature data base.

Define the term image cluster set for a given First Order Model identified by loc hyp.FOM ID to mean the set of verified location signature clusters whose MS location point estimates are in the cluster set .

Note that an area containing the image cluster set will be denoted as the image cluster set area or simply the image area in some contexts. Further note that the image cluster set area will be a small area encompassing the image cluster set . In one embodiment the image cluster set area will be the smallest covering of cells from the mesh for the present FOM that covers the convex hull of the image cluster set. Note that preferably each cell of each mesh for each FOM is substantially contained within a single transmission area type.

Thus the present FOM provides the correspondences or mapping between elements of the cluster set and elements of the image cluster set. 

Alternatively if the number of archived FOM MS estimates that are in area wherein each such MS estimate has a corresponding verified location signature clusters in image area is deemed too small to reliably use for computing a new confidence value and consequently ignoring the original target MS location estimate and confidence generated by the FOM then strategies such as the following may be implemented.

Although an important aspect of the present disclosure is that it provides increasingly more accurate MS location estimates as additional verified location signatures are obtained i.e. added to the location signature data base it may be the case that for some areas there is substantially no pertinent verified location signature clusters in the location signature data base e.g. image area may be undefined . Accordingly instead of using the original FOM generated location hypotheses in the same manner as the location hypotheses having target MS location estimates corresponding to image areas in subsequent MS location estimation processing these two types of location hypotheses may be processed separately. Thus a strategy is provided wherein two sets of one or more MS location estimates may result 

Define the term mapped cluster density to be the number of the verified location signature clusters in an image cluster set per unit of area in the image cluster set area .

It is believed that the higher the mapped cluster density the greater the confidence can be had that a target MS actually resides in the image cluster set area when an estimate for the target MS by the present FOM is in the corresponding the cluster set .

Thus the mapped cluster density becomes an important factor in determining a confidence value for an estimated area of a target MS such as for example the area represented by image area . However the mapped cluster density value requires modification before it can be utilized in the confidence calculation. In particular confidence values must be in the range 1 1 and a mapped cluster density does not have this constraint. Thus a relativized mapped cluster density for an estimated MS area is desired wherein this relativized measurement is in the range 1 1 and in particular for positive confidences in the range 0 1 . Accordingly to alleviate this difficulty for the FOM define the term prediction mapped cluster density as a mapped cluster density value MCD for the FOM and image cluster set area wherein 

It is believed that the prediction mapped cluster density will typically be dependent on one or more area types. In particular it is assumed that for each area type there is a likely range of prediction mapped cluster density values that is substantially uniform across the area type. Accordingly as discussed in detail hereinbelow to calculate a prediction mapped cluster density for a particular area type an estimate is made of the correlation between the mapped cluster densities of image areas from cluster set areas and the likelihood that if a verified MS location a has a corresponding FOM MS estimate in the cluster set and b is also in the particular area type then the verified MS location is also in the image area.

Thus if an area is within a single area type then such a relativized mapped cluster density measurement for the area may be obtained by dividing the mapped cluster density by the prediction mapped cluster density and taking the smaller of the resulting ratio and 1.0 as the value for the relativized mapped cluster density.

In some perhaps most cases however an area e.g. an image cluster set area may have portions in a number of area types. Accordingly a composite prediction mapped cluster density may be computed wherein a weighted sum is computed of the prediction mapped cluster densities for the portions of the area that is in each of the area types. That is the weighting for each of the single area type prediction mapped cluster densities is the fraction of the total area that this area type is. Thus a relativized composite mapped cluster density for the area here may also be computed by dividing the mapped cluster density by the composite prediction mapped cluster density and taking the smaller of the resulting ratio and 1.0 as the value for the relativized composite mapped cluster density.

Accordingly note that as such a relativized composite mapped cluster density for an image cluster set area increases decreases it is assumed that the confidence of the target MS being in the image cluster set area should increase decrease respectively. 

There are various embodiments that may be used to determine a confidence for the image area . In general such a confidence should vary monotonically with a and b below that is the confidence should increase decrease with 

As one skilled in the art will understand there are many functions for providing confidences that vary monotonically with a and b above. In particular for the cluster set area being loc hyp.pt covering one might be inclined to use the area size of the image cluster area as the value for a and the cardinality size of the image cluster set as the value for b . Then the following term might be considered for computing the confidence 

However since confidences are intended to be in the range 1 1 a normalization is also desirable for the values corresponding to a and b . Accordingly in one embodiment instead of using the above values for a and b ratios are used. That is assuming for a relevant area A e.g. including an image cluster set area of loc hyp.pt covering that there is a very high confidence that the target MS is in A the following term may be used in place of the term sizeof image area above min sizeof image area sizeof A 1.0. CA1.1 

Additionally for the condition b above a similar normalization may be provided. Accordingly to provide this normalization note that the term sizeof image area prediction mapped cluster density CA1.1.1 is analogous to sizeof A in CA1.1 . That is the expression of CA1.1.1 gives a threshold for the number of verified location signature clusters that are likely to be needed in order to have a high confidence or likelihood that the target MS is in the area represented by image area . Thus the following term may be used for the condition b min sizeof image cluster set sizeof image area prediction mapped cluster density 1.0 CA1.2 

As an aside note that sizeof image clusterset sizeof image area prediction mapped cluster density is equivalent to sizeof image cluster set sizeof image area prediction mapped cluster density and this latter term may be interpreted as the ratio of i the mapped cluster density for image area to ii an approximation of a cluster density providing a high expectation that the target MS is contained in image area .

Note that the product of CA1.1 and CA1.2 provide the above desired characteristics for calculating the confidence. However there is no guarantee that the range of resulting values from such products is consistent with the interpretation that has been placed on positive confidence values e.g. that a confidence of near 1.0 has a very high likelihood that the target MS is in the corresponding area. For example it can be that this product rarely is greater than 0.8 even in the areas of highest confidence. Accordingly a tuning function is contemplated which provides an additional factor for adjusting of the confidence. This factor is for example a function of the area types and the size of each area type in image area . Moreover such a tuning function may be dependent on a tuning coefficient per area type. Thus one such tuning function may be 

where tcis a tuning coefficient determined in background or off line processing e.g. by a Genetic Algorithm or Monte Carlo simulation or regression for the area type indexed by i .

Note that it is within the scope of the present disclosure that other tuning functions may also be used whose values may be dependent on for example Monte Carlo techniques or Genetic Algorithms.

It is interesting to note that in the product of CA1.1 and CA1.2 the image area size cancels out. This appears to conflict with the description above of a desirable confidence calculation. However the resulting typical computed value sizeof image cluster set max area prediction mapped cluster density CA1.3 is strongly dependent on image area since image cluster set is derived from image area and prediction mapped cluster density also depends on image area . Accordingly it can be said that the product CA1.3 above for the confidence does not depend on raw area size but rather depends on a relevant area for locating the target MS.

It is important to note that the computation here for the prediction mapped cluster density may be more intense than some other computations but the cluster densities computed here need not be performed in real time target MS location processing. That is the steps of this function may be performed only periodically e.g. once a week for each FOM and each area type thereby precomputing the output for this function. Accordingly the values obtained here may be stored in a table that is accessed during real time target MS location processing. However for simplicity only the periodically performed steps are presented here. However one skilled in the art will understand that with sufficiently fast computational devices some related variations of this function may be performed in real time. In particular instead of supplying area type as an input to this function a particular area A may be provided such as the image area for a cluster set area or the portion of such an image area in a particular area type. Accordingly wherever area type is used in a statement of the embodiment of this function below a comparable statement with A can be provided.

Note that in this second embodiment of the Context Adjuster it uses various heuristics to increment decrement the confidence value of the location hypotheses coming from the First Order Models. These heuristics are implemented using fuzzy mathematics wherein linguistic fuzzy if then rules embody the heuristics. That is each fuzzy rule includes terms in both the if and the then portions that are substantially described using natural language like terms to denote various parameter value classifications related to but not equivalent to probability density functions. Further note that the Context Adjuster and or the FOM s may be calibrated using the location information from LBSs i.e. fixed location BS transceivers via the Location Base Station Model since such LBS s have well known and accurate predetermined locations.

Regarding the heuristics of the present embodiment of the context adjuster the following is an example of a fuzzy rule that might appear in this embodiment of the Context Adjuster 

In the above sample rule Distance Model denotes a First Order Model utilized by an embodiment of the present disclosure. To apply this sample rule the fuzzy system needs a concrete definition of the term Fall. In traditional expert systems the term Fall would be described by a particular set of months for example September through November in which traditional set theory is applied. In traditional set theory an entity in this case a date is either in a set or it is not in a set e.g. its degree of membership in a set is either 0 indicating that the entity is not in a particular set or 1 indicating that the entity is in the set. However the traditional set theory employed in expert systems does not lend itself well to entities that fall on set boundaries. For example a traditional expert system could take dramatically different actions for a date of August 31 than it could for a date of September 1 because August 31 might belong to the set Summer while the date September 1 might belong to the set Fall. This is not a desirable behavior since it is extremely difficult if not impossible to determine such lines of demarcation so accurately. However fuzzy mathematics allows for the possibility of an entity belonging to multiple sets with varying degrees of confidence ranging from a minimum value of 0 indicating that the confidence the entity belongs to the particular set is minimum to 1 indicating that the confidence the entity belongs to the particular set is maximum . The fuzzy boundaries between the various sets are described by fuzzy membership functions which provide a membership function value for each value on the entire range of a variable. As a consequence of allowing entities to belong to multiple sets simultaneously the fuzzy rule base might have more than one rule that is applicable for any situation. Thus the actions prescribed by the individual rules are averaged via a weighting scheme where each rule is implemented in proportion to its minimum confidence. For further information regarding such fuzzy heuristics the following references are incorporated herein by reference McNeil and Freiberger 1993 Cox 1994 Klir and Folger 1999 Zimmerman 1991 .

Thus the rules defined in the fuzzy rule base in conjunction with the membership functions allow the heuristics for adjusting confidence values to be represented in a linguistic form more readily understood by humans than many other heuristic representations and thereby making it easier to maintain and modify the rules. The fuzzy rule base with its membership functions can be thought of as an extension to a traditional expert system. Thus since traditional expert systems are subsets of fuzzy systems an alternative to a fuzzy rule base is a traditional expert system and it is implicit that anywhere in the description of the current invention that a fuzzy rule base can be replaced with an expert system.

Also these heuristics may evolve over time by employing adaptive mechanisms including but not limited to genetic algorithms to adjust or tune various system values in accordance with past experiences and past performance of the Context Adjuster for increasing the accuracy of the adjustments made to location hypothesis confidence values. For example in the sample rule presented above 

In one embodiment the Context Adjuster alters the confidence values of location hypotheses according to one or more of the following environmental factors 1 the type of region e.g. dense urban urban rural etc. 2 the month of the year 3 the time of day and 4 the operational status of base stations e.g. on line or off line as well as other environmental factors that may substantially impact the confidence placed in a location hypothesis. Note that in this embodiment each environmental factor has an associated set of linguistic heuristics and associated membership functions that prescribe changes to be made to the confidence values of the input location hypotheses.

The context adjuster begins by receiving location hypotheses and associated confidence levels from the First Order Models. The Context Adjuster takes this information and improves and refines it based on environmental information using the modules described below.

As mentioned above each location hypothesis provides an approximation to the MS position in the form of a geometric shape and an associated confidence value a. The COA calculation module determines a center of area COA for each of the geometric shapes if such a COA is not already provided in a location hypothesis. The COA Calculation Module receives the following information from each First Order Model 1 a geometrical shape and 2 an associated confidence value a. The COA calculation is made using traditional geometric computations numerical algorithms are readily available . Thus following this step each location hypothesis includes a COA as a single point that is assumed to represent the most likely approximation of the location of the MS. The COA Calculation Module passes the following information to the fuzzification module 1 a geometrical shape associated with each first order model 2 an associated confidence value and 3 an associated COA.

A fuzzification module receives the following information from the COA Calculation Module 1 a geometrical shape associated with each First Order Model 2 an associated confidence value and 3 an associated COA. The Fuzzification Module uses this information to compute a membership function value for each of the M location hypotheses received from the COA calculation module where the individual models are identified with an i index for each of the N environmental factors identified with a j index . In addition to the information received from the COA Calculation Module the Fuzzification Module receives information from the Location Center Supervisor. The fuzzification module uses current environmental information such as the current time of day month of year and information about the base stations on line for communicating with the MS associated with a location hypothesis currently being processed this information may include but is not limited to the number of base stations of a given type e.g. location base stations and regular base stations that have a previous history of being detected in an area about the COA for a location hypothesis . The base station coverage information is used to compute a percentage of base stations reporting for each location hypothesis.

The fuzzification is achieved in the traditional fashion using fuzzy membership functions for each environmental factor as for example is described in the following references incorporated herein by reference McNeil and Freiberger 1993 Cox 1994 Klir and Folger 1999 Zimmerman 1991 .

Using the geographical area types for illustration purposes here the following procedure might be used in the Fuzzification Module. Each value of COA for a location hypothesis is used to compute membership function values for each of five types of areas 1 dense urban 2 urban 3 suburban 4 rural plain and 5 rural mountains . These membership function values provide the mechanism for representing degrees of membership in the area types these area types being determined from an area map that has been sectioned off. In accordance with fuzzy theory there may be geographical locations that include for example both dense urban and urban areas dense urban and rural plane areas dense urban urban and rural plane areas etc. Thus for a particular MS location area estimate described by a COA it may be both dense urban and urban at the same time. The resolution of any apparent conflict in applicable rules is later resolved in the Defuzzification Module using the fuzzy membership function values computed in the Fuzzification Module.

Any particular value of a COA can land in more than one area type. For example the COA may be in both dense urban and urban. Further in some cases a location hypothesis for a particular First Order Model i may have membership functions and wherein they all potentially have non zero values. Additionally each geographical area is contoured. Note that the membership function contours allow for one distinct value of membership function to be determined for each COA location i.e. there will be distinct values of and for any single COA value associated with a particular model i . For example the COA would have a dense urban membership function value equal to 0.5. Similar contours would be used to compute values of and .

Thus for each COA there now exists an array or series of membership function values there are K membership function values K number of descriptive terms for the specified environmental factor for each of M First Order Models. Each COA calculation has associated with it a definitive value for and . Taken collectively the M location hypotheses with membership function values for the K descriptive terms for the particular environmental factor results in a membership function value matrix. Additionally similar membership function values are computed for each of the N environmental factors thereby resulting in a corresponding membership function value matrix for each of the N environmental factors.

The Fuzzification Module passes the N membership function value matrices described above to the Rule Base Module along with all of the information it originally received from the COA Calculation Module.

The Rule Base Module receives from the Fuzzification Module the following information 1 a geometrical shape associated with each First Order Model 2 an associated confidence value 3 an associated COA and 4 N membership function value matrices. The Rule Base Module uses this information in a manner consistent with typical fuzzy rule bases to determine a set of active or applicable rules. Sample rules were provided in the general discussion of the Context Adjuster. Additionally references have been supplied that describe the necessary computations. Suffice it to say that the Rule Base Modules employ the information provided by the Fuzzification Module to compute confidence value adjustments for each of the m location hypotheses. Associated with each confidence value adjustment is a minimum membership function value contained in the membership function matrices computed in the Fuzzification Module.

For each location hypothesis a simple inference engine driving the rule base queries the performance database FIG. to determine how well the location hypotheses for the First Order Model providing the current location hypothesis has performed in the past for a geographic area surrounding the MS location estimate of the current location hypothesis under the present environmental conditions. For example the performance database is consulted to determine how well this particular First Order Model has performed in the past in locating an MS for the given time of day month of year and area type. Note that the performance value is a value between 0 and 1 wherein a value of 0 indicates that the model is a poor performer while a value of 1 indicates that the model is always or substantially always accurate in determining an MS location under the conditions and in the area being considered. These performance values are used to compute values that are attached to the current confidence of the current location hypothesis i.e. these performance values serve as the then sides of the fuzzy rules the First Order Models that have been effective in the past have their confidence levels incremented by large amounts while First Order Models that have been ineffective in the past have their confidence levels incremented by small amounts. This information is received from the Performance Database in the form of an environmental factor a First Order Model number and a performance value. Accordingly an intermediate value for the adjustment of the confidence value for the current location hypothesis is computed for each environmental condition used by Context Adjuster based on the performance value retrieved from the Performance Database. Each of these intermediate adjustment values are computed according to the following equation which is applicable to area information adjustment a performance value a where a is the confidence value of a particular location hypothesis performance value is the value obtained from the Performance Database ais a system parameter that accounts for how important the information is being considered by the context adjuster. Furthermore this parameter is initially provided by an operator in for example a system start up configuration and a reasonable value for this parameter is believed to be in the range 0.05 to 0.1 the subscript j represents a particular environmental factor and the superscript i represents a particular First Order Model. However it is an important aspect of the present disclosure that this value can be repeatedly altered by an adaptive mechanism such as a genetic algorithm for improving the MS location accuracy of an embodiment of the present disclosure. In this way and because the rules are written using current performance information as stored in the Performance Database the Rule Module is dynamic and becomes more accurate with time.

The Rule Base Module passes the matrix of adjustments to the Defuzzification Module along with the membership function value matrices received from the Fuzzification Module.

The Defuzzification Module receives the matrix of adjustments and the membership function value matrices from the Rule Base Module. The final adjustment to the First Order Model confidence values as computed by the Context Adjuster is computed according to 

The Context Adjuster uses environmental factor information and past performance information for each of i First Order Models to compute adjustments to the current confidence values. It retrieves information from the First Order Models interacts with the Supervisor and the Performance Database and computes adjustments to the confidence values. Further the Context Adjuster employs a genetic algorithm to improve the accuracy of its calculations. The algorithm for the Context Adjuster is included in algorithm BE.B below 

