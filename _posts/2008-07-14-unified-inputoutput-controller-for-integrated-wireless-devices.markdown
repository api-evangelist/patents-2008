---

title: Unified input/output controller for integrated wireless devices
abstract: A novel and useful apparatus for and method of a unified IO controller well suited for use in integrated wireless devices incorporating multiple functions. The unified IO controller is operative to provide a single host interface PHY/MAC that is shared among all functions on the controller. The invention provides an IO protocol handler comprising common and unified logic that provides IO access to any function on the device. The common and unified IO PHY interface logic is shared between multiple functions within the same device (e.g., WLAN, GPS, Bluetooth, etc.). This implementation provides optimized hardware partitioning in which common SDIO logic serves multiple functions thereby eliminating the need to provide a protocol handler for each function, reducing pin count, power consumption and die size, since the SDIO protocol handling is implemented in a shared module.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09483429&OS=09483429&RS=09483429
owner: TEXAS INSTRUMENTS INCORPORATED
number: 09483429
owner_city: Dallas
owner_country: US
publication_date: 20080714
---
The present invention relates to the field of data communications and more particularly relates to a unified IO controller particularly suitable for use with integrated wireless devices.

Currently there is huge demand for converged mobile devices which combine data telephony and other function capabilities. Technological advances such as extremely low power consumption improvements in form factor pricing and co existence technology for various wireless standards e.g. 802.11 WLAN and Bluetooth are fueling the demand.

A block diagram illustrating an example prior art multifunction mobile device in a wireless network system is shown in . The example wireless scenario generally referenced comprises a plurality of mobile devices in communication with a cellular base station . The mobile device comprises several functions in addition to the basic cellular transceiver including a Bluetooth radio FM receiver GPS receiver and WLAN radio.

As technology advances more and more functions are being integrated on the same chip e.g. Bluetooth Global Positioning System GPS Wireless LAN WLAN etc. Historically even when multiple functions were integrated on the same chip each function had a different dedicated host interface with an associated driver.

A block diagram illustrating the prior art multifunction mobile device in more detail is shown in . The mobile device generally referenced comprises a multifunction device in communication with host processor . The multifunction device comprises several functions each having its own separate host interface which may sometimes be a different type including Bluetooth radio associated antenna and host interface GPS receiver associated antenna and host interface FM receiver associated antenna and host interface and WLAN radio associated antenna and host interface . The drawback to this is the requirement of providing a separate host interface for each function with the consequent increase in pin count power consumption and die size for the host interface logic circuitry assuming a single host interface chip is used as well as increased complexity of host software due to the need to support multiple and sometimes different host interface drivers to connect to each function in the multifunction device.

Secure Digital SD is a commonly used flash non volatile memory card format developed by Matsushita SanDisk and Toshiba for use in portable devices. Today it is widely used in digital cameras handheld computers PDAs mobile phones GPS receivers and video game consoles. SD card capacities currently range from 8 MB to 4 GB and from 4 GB to 32 GB for SDHC cards.

A Secure Digital Input Output or SDIO card is an interface that extends the functionality of devices with SD card slots. A variety of SDIO cards are being developed such as a camera Bluetooth GPS and 802.11b modem digital TV tuner voice recorder scanner fingerprint recognition.

SD card slots can actually be used for more than flash memory cards. Devices that support SDIO such as PDAs laptops cell phones etc. can use small devices designed for the SD form factor like GPS receivers WiFi or Bluetooth adapters modems Ethernet adapters barcode readers IrDA adapters FM radio tuners TV tuners RFID readers digital cameras mass storage media such as hard drives RS 232 serial adapters fingerprint scanners SDIO to USB host slave adapters to allow an SDIO equipped handheld device to use USB peripherals and or interface to PCs magnetic strip readers combination Bluetooth WiFi GPS transceivers cellular modems e.g. PCS CDPD GSM etc. and APRS TNC adapters.

SDIO cards are fully compatible with SD Memory Card host controller including mechanical electrical power signaling and software . When an SDIO card is inserted into a non SDIO aware host it will not cause physical damage or disruption to the device or host controller. SPI bus topology is mandatory for SDIO unlike SD Memory. Most of the SD Memory commands are not supported in SDIO. SDIO cards can contain up to eight separate logical cards.

Thus the Secure Digital I O standard extends SD memory capable systems to also support I O peripherals such as bar code scanners cameras wireless adapters and GPS modules. The standard uses the same slot connector and slot mechanics and defines new I O signaling protocols over existing pins. SDIO defines the same SD maximal clock rate of 25 MHz and uses 1 or 4 data pins. It creates a register level view of an SDIO function or multiple functions through a set of common registers and application specific registers. Newer versions of SDIO e.g. SDIO2.0 are extending the maximal clock rate to 50 MHz thus increasing the peak throughput to adhere to the market needs to have quicker storage devices as well as the desire to support fast I O peripherals such as WLAN 802.11g.

A card has one to eight numbered 0 7 functions with function reserved for common configuration. Each function is assigned a 128 KB register address space for configuration and operation. The common control register CCR set is implemented on every SDIO card and resides in the card address space for function . An SD host configures various operational parameters of the SDIO card through the common register set. A card containing one or more functions may have separate software modules drivers that operate on registers located in their specific address space. A wireless card may implement multiple wireless protocols GPRS WLAN or Bluetooth with each radio existing as a separate I O function utilizing separate control software sometimes from different vendors .

SDIO data transactions are executed using CMD53 type commands. CMD53 can be used either in byte basis or block basis mode. When used in byte basis CMD53 is capable of carrying up to a maximum predefined number of bytes per command. This maximum number of bytes is set by host card negotiation that takes place when the host initializes the SDIO card. CMD53 can also be used in block basis mode during which consecutive blocks of data are all carried by the same CMD53. In the block basis mode case the size of each block shall be exactly identical to the maximal number of bytes as negotiated for the byte basis mode. In case the host wants to transfer data which is smaller in size to the above maximum number it must use byte basis transaction.

When the host reads data from the card the card is responsible for regulating the data the host waits for the card to drive the SDIO data line and signal Start Bit after which it reads the data. The card cannot stop once data read has begun and until the transaction ended for byte basis read or until the block ended for block basis read . At this point the card signals Stop Bit and can then hold the line until the next start bit. For host write transactions the card is responsible for sending CRC status once the transaction ended for byte basis operations or when any of the block write elapsed for block basis operations . When supplying the CRC status response the card is also allowed to drive the line to low value indicating busy response. The host is not allowed to start the next transaction until the card has released the bus.

A problem with multifunction IO such as SDIO however is that depending on the number of functions a large number of pins may be required to support the individual PHY interfaces. The integration of several functionalities within the same chip only exacerbates the problem considering the fact that chips are already mostly pin limited In addition besides the large pin count separate PHY interfaces also increase the power consumption and die size of the chip.

Currently most integrated chips implement one of two schemes 1 a physically separate host interface which is dedicated per each function or 2 a shared host interface at the physical level whereby the interface lines are shared only at the physical level but then are demultiplexed inside the device and distributed to each function. Although this solution does decrease the pin count it is expensive to implement in terms of implementation logic circuitry as it requires the use of multiple protocol handlers or parsers one for each function as well as logic circuitry to control the physical routing of the various interface lines.

There is thus a need for a partitioning scheme for a multifunction IO controller device that incorporates a common interface that is shared among all the functionalities on the chip. The multifunction IO controller device should enable the existence of multiple independent functions while sharing the same physical host interface thereby benefiting from the advantages of providing a shared interface to multiple functions.

The present invention is a novel and useful apparatus for and method of a unified IO controller well suited for use in integrated wireless devices incorporating multiple functions. The unified IO controller is operative to provide a single host interface PHY MAC that is shared among all functions on the controller. The invention provides an IO protocol handler comprising common and unified logic that provides IO access to any function on the device.

The common and unified IO PHY interface logic is shared between multiple functions within the same device e.g. WLAN GPS Bluetooth Near Field Communications NFC wUSB etc. . The unified IO slave controller is operative to handle all IO protocol aspects and presents a common and easily accessible interface to the various functions.

In one example embodiment the invention utilizes the SDIO capability to multiplex a number of independent IO functions on the same SDIO slave device. This implementation provides optimized hardware partitioning in which common SDIO logic serves multiple functions thereby eliminating the need to provide a protocol handler for each function reducing pin count power consumption and die size since the SDIO protocol handling is implemented in a shared module.

Although the mechanism of the present invention can be used in numerous types of communication systems to aid in illustrating the principles of the present invention the description of the multifunction IO controller is provided in the context of a communication device such as a cellular phone or mobile station incorporating one or more functions e.g. Bluetooth GPS etc. . It is appreciated however that the invention is not limited to the example applications presented whereas one skilled in the art can apply the principles of the invention to other communication systems as well without departing from the scope of the invention.

Several advantages of the unified multifunction IO controller of the present invention include 1 the interface is physically shared between functions 2 sharing a single common host interface maximizes the shared logic between the various functions thereby reducing die size 3 shared logic is operative to handle the IO PHY and link layers wherein all functions are seen as a single IO slave to the host which greatly reduces host software complexity 4 hardware power partitioning on the controller chip is optimized as only the minimal necessary logic resides on the always on power domain therefore allowing other hardware logic to be turned off which significantly reduces power consumption 5 the invention supports dynamic sleep by the various functions whereby each function can go to sleep while the IO remains functional for other functions 6 sharing a single common host interface requires a simplified host protocol stack and firmware driver implementation 7 the host interface PHY sharing mechanism can be expanded to any number of functions and 8 a well defined PHY MAC interface towards each of the multiple hardware functions within the controller enables an ecosystem in which new functions can be easily integrated or removed with minimal integration verification or host software design effort.

Note that some aspects of the invention described herein may be constructed as software objects that are executed in embedded devices as firmware software objects that are executed as part of a software application on either an embedded or non embedded computer system such as a digital signal processor DSP microcomputer minicomputer microprocessor etc. running a real time operating system such as WinCE Symbian OSE Embedded LINUX etc. or non real time operating system such as Windows UNIX LINUX etc. or as soft core realized HDL circuits embodied in an Application. Specific Integrated Circuit ASIC or Field Programmable Gate Array FPGA or as functionally equivalent discrete hardware components.

There is thus provided in accordance with the invention an input output I O controller comprising a common interface circuit coupled to and shared among one or more function modules and wherein the common interface circuit is operative to implement an I O protocol and provide a common interface between a host and the one or more function modules.

There is also provided in accordance with the invention a multifunction Input Output I O device comprising a plurality of function modules a common I O interface PHY coupled to and shared among the plurality of function modules and wherein the common I O interface PHY is operative to implement an I O protocol and provide a common interface between a host and the plurality of function modules.

There is further provided in accordance with the invention a Secure Digital Input Output SDIO controller comprising a common SDIO PHY coupled to and shared among one or more functions and wherein the common SDIO PHY is operative to implement an I O protocol and provide a common interface between a host and the one or more function modules.

There is also provided in accordance with the invention a Secure Digital Input Output SDIO device comprising a plurality of function modules a common SDIO PHY coupled to and shared among a plurality of functions and wherein the common SDIO PHY is operative to implement an I O protocol and provide a common interface between a host and plurality of functions.

There is further provided in accordance with the invention a mobile station comprising at least one radio transceiver for establishing a communications link to a remote device a multifunction Input Output I O device the multifunction I O device comprising a plurality of function modules a common I O interface PHY circuit coupled to and shared among the plurality of function modules and wherein the common I O interface PHY circuit is operative to implement an I O protocol and provide a common interface between a host and the plurality of function modules.

The present invention is a novel and useful apparatus for and method of a unified IO controller well suited for use in integrated wireless devices incorporating multiple functions. The unified IO controller is operative to provide a single host interface PHY MAC that is shared among all functions on the controller. The invention provides an IO protocol handler comprising common and unified logic that provides IO access to any function on the device.

The common and unified IO PHY interface logic is shared between multiple functions within the same device e.g. WLAN GPS Bluetooth etc. . The unified IO slave controller is operative to handle all IO protocol aspects and presents a common and easily accessible interface to the various functions.

Although the mechanism of the present invention can be used in numerous types of communication systems to aid in illustrating the principles of the present invention the description of the unified IO controller is provided in the context of a communication device such as a cellular phone or mobile station incorporating one or more SDIO functions e.g. Bluetooth GPS etc. . It is appreciated however that the invention is not limited to the example applications presented whereas one skilled in the art can apply the principles of the invention to other communication systems and IO systems other than SDIO as well without departing from the scope of the invention.

Note that throughout this document the term communications device is defined as any apparatus or mechanism adapted to transmit receive or transmit and receive data through a medium. The term communications transceiver or communications device is defined as any apparatus or mechanism adapted to transmit and receive data through a medium. The communications device or communications transceiver may be adapted to communicate over any suitable medium including wireless or wired media. Examples of wireless media include RF infrared optical microwave UWB Bluetooth WiMAX WiMedia WiFi or any other broadband medium etc. Examples of wired media include twisted pair coaxial optical fiber any wired interface e.g. USB Firewire Ethernet etc. . The term Ethernet network is defined as a network compatible with any of the IEEE 802.3 Ethernet standards including but not limited to 10Base T 100Base T or 1000Base T over shielded or unshielded twisted pair wiring. The terms communications channel link and cable are used interchangeably.

The term multimedia player or device is defined as any apparatus having a display screen and user input means that is capable of playing audio e.g. MP3 WMA etc. video AVI MPG WMV etc. and or pictures JPG BMP etc. . The user input means is typically formed of one or more manually operated switches buttons wheels or other user input means. Examples of multimedia devices include pocket sized personal digital assistants PDAs personal media player recorders cellular telephones handheld devices and the like.

Some portions of the detailed descriptions which follow are presented in terms of procedures logic blocks processing steps and other symbolic representations of operations on data bits within a computer memory. These descriptions and representations are the means used by those skilled in the data processing arts to most effectively convey the substance of their work to others skilled in the art. A procedure logic block process etc. is generally conceived to be a self consistent sequence of steps or instructions leading to a desired result. The steps require physical manipulations of physical quantities. Usually though not necessarily these quantities take the form of electrical or magnetic signals capable of being stored transferred combined compared and otherwise manipulated in a computer system. It has proven convenient at times principally for reasons of common usage to refer to these signals as bits bytes words values elements symbols characters terms numbers or the like.

It should be born in mind that all of the above and similar terms are to be associated with the appropriate physical quantities they represent and are merely convenient labels applied to these quantities. Unless specifically stated otherwise as apparent from the following discussions it is appreciated that throughout the present invention discussions utilizing terms such as processing computing calculating determining displaying or the like refer to the action and processes of a computer system or similar electronic computing device that manipulates and transforms data represented as physical electronic quantities within the computer system s registers and memories into other data similarly represented as physical quantities within the computer system memories or registers or other such information storage transmission or display devices.

The invention can take the form of an entirely hardware embodiment an entirely software embodiment or an embodiment containing a combination of hardware and software elements. In one embodiment a portion of the mechanism of the invention is implemented in software which includes but is not limited to firmware resident software object code assembly code microcode etc.

Furthermore the invention can take the form of a computer program product accessible from a computer usable or computer readable medium providing program code for use by or in connection with a computer or any instruction execution system. For the purposes of this description a computer usable or computer readable medium is any apparatus that can contain store communicate propagate or transport the program for use by or in connection with the instruction execution system apparatus or device e.g. floppy disks removable hard drives computer files comprising source code or object code flash semiconductor memory USB flash drives etc. ROM EPROM or other semiconductor memory devices.

A general block diagram illustrating a communication device shown generally as a mobile station or MS incorporating the shared I O interface of the present invention is shown in . Note that the mobile station may comprise any suitable wired or wireless device such as multimedia player mobile communication device cellular phone smartphone PDA Bluetooth device etc. For illustration purposes only the device is shown as a mobile station. Note that this example is not intended to limit the scope of the invention as the shared I O interface of the present invention can be implemented in a wide variety of communication devices.

The mobile station generally referenced comprises a host processor i.e. baseband processor or CPU having analog and digital portions. The MS may comprise a plurality of RF transceivers and associated antennas . RF transceivers for the basic cellular link and any number of other wireless standards and radio access technologies RATs may be included. Examples include but are not limited to Global System for Mobile Communication GSM GPRS EDGE 3 G CDMA WiMAX for providing WiMAX wireless connectivity when within the range of a WiMAX wireless network using OFDMA techniques Bluetooth for providing Bluetooth wireless connectivity when within the range of a Bluetooth wireless network WLAN for providing wireless connectivity when in a hot spot or within the range of an ad hoc infrastructure or mesh based wireless LAN network near field communications 60 GHz device UWB etc. One or more of the RF transceivers may comprise a plurality of antennas to provide antenna diversity which yields improved radio performance. The mobile station may also comprise internal RAM and ROM memory flash memory and external memory .

Several user interface devices include microphone s speaker s and associated audio codec or other multimedia codecs a keypad for entering dialing digits vibrator for alerting a user camera and related circuitry a TV tuner and associated antenna display s and associated display controller . A USB or other interface connection e.g. SPI SDIO PCI etc. provides a serial link to a user s PC or other device. SIM card provides the interface to a user s SIM card for storing user data such as address book entries etc. Note that the SIM card shown is intended to represent any type of smart card used for holding user related information such as identity and contact information Authentication Authorization and Accounting AAA profile information etc. Different standards use different names for example SIM for GSM USIM for UMTS and ISIM for IMS and LTE.

The mobile station also comprises a multifunction module or device which implements one or more functions such as Bluetooth WLAN GPS FM receiver etc. In accordance with the invention the multifunction module comprises a unified IO interface controller that interfaces all the functions to the host processor. The unified IO interface is adapted to implement the common shared IO interface mechanism of the present invention as described in more detail infra. In operation shared IO interface controller may be implemented as hardware firmware software or as a combination of hardware and firmware software. Implemented as a firmware software task the program code operative to implement the shared IO interface mechanism of the present invention is stored in one or more memories or or local memories within the host processor.

Portable power is provided by the battery coupled to power management circuitry . External power is provided via USB power or an AC DC adapter connected to the battery management circuitry which is operative to manage the charging and discharging of the battery .

In one example embodiment the invention utilizes the SDIO capability to multiplex a number of independent IO functions on the same SDIO slave device. This implementation provides optimized hardware partitioning in which common SDIO logic serves multiple functions thereby eliminating the need to provide a protocol handler for each function reducing pin count power consumption and die size since the SDIO protocol handling is implemented in a shared module.

A block diagram illustrating an example embodiment of a multifunction device incorporating the I O sharing interface of the present invention is shown in . The multifunction device generally referenced comprises a shared SDIO interface I F a Bluetooth module IP core and additional modules . The Bluetooth module Function is shown for example purposes only. The additional modules through comprise Functions through e.g. WLAN GPS etc.

The shared SDIO I F comprises an SDIO PHY MAC block Function common configuration block and additional Functions through blocks . Note that the SDIO standard can support up to eight functions with Function being the common configuration shared by Functions to . Note that the PHY MAC comprises only Function . Transactions to Functions through are routed to the appropriate attachment module. The shared SDIO I F communicates with Function blocks to via a bus . The bus may comprise any suitable bus and is not critical to operation of the invention. For example the bus may comprise the well known Open Core Protocol OCP bus. The SDIO is operative interface all the Functions to the host via one set of SDIO physical interface lines .

The Bluetooth module comprises a Bluetooth SDIO attachment module in communication with Bluetooth logic and circuitry via bus . The Bluetooth SDIO attachment module comprises one or more buffers and one or more configuration registers .

As shown in the Bluetooth Function module every Function module in the multifunction device comprises an attachment module. The attachment module interfaces the particular function to the shared SDIO I F. The host acts as an SDIO master to all of the Function modules interfacing through the shared PHY MAC module.

The shared SDIO PHY interface is operative to provide protocol handling for each IP module i.e. SDIO function in the controller. All IP modules however share the same SDIO interface. The physical SDIO module SDIO PHY is not implemented in the IP core but rather is extracted to top level. A special interface is defined out of the SDIO PHY towards the various IP modules e.g. Bluetooth WLAN GPS etc . This interface enables sharing the PHY between different modules and is SDIO Function Aware in the sense that only the SDIO transactions that carry the proper function number are forwarded to the module with the same function.

For example only SDIO transactions that carry Function number i.e. Bluetooth are forwarded to the Bluetooth module. The Bluetooth SDIO module is attached to the OCP in the Bluetooth IP core . This attachment unit provides a bridge between the OCP and the SDIO PHY interfaces. The Bluetooth SDIO module implements the SDIO buffers and function specific features.

The SDIO specification defines several global per card characteristics for example the supported SDIO version the supported bus width etc. As these are global characteristics that are common to all functions within the card they are all located on a special function namely Function . This is the only function that is accessible after the card has been initialized. Using Function the host processor reads the common card information including global characteristics as described above. Function also serves to enable the additional protocol specific functions e.g. Bluetooth WLAN GPS etc. and to provide pointers to their specific configuration registers.

A block diagram illustrating an example embodiment of the software firmware architecture of the present invention is shown in . The architecture generally referenced comprises on the multifunction device side SDIO host controller slave hardware and on the host side SDIO host controller master module SDIO low level driver multifunction driver Bluetooth driver WLAN driver and any additional drivers for other functions e.g. GPS FM etc. .

It is important to note that the drivers are SDIO unaware. In operation the multifunction driver serves to take the place of multiple drivers. Thus the SDIO low level driver sees a single common driver rather than multiple drivers one driver for each function .

The multifunction SDIO driver functions to manage the SDIO protocol logical layer and is responsible for the host driver initialization sequence. The multifunction SDIO driver provides standard transport read and write functionalities to any of the upper layer drivers e.g. WLAN driver Bluetooth driver etc. and translates any read or write request by the upper layer drivers into SDIO commands targeted to the proper function. The fact that the multifunction driver exposes standard read write interface towards the upper layer drivers allows these drivers to be SDIO unaware therefore minimizing driver implementation code. The multiple SDIO driver arbitrates between simultaneous requests by any of the upper layer drivers and therefore allows sharing the SDIO bus between the function drivers.

The Low Level SDIO driver is usually operating system OS and hardware dependant and used to translate the multifunction SDIO driver read write requests into a specific hardware sequence that enables the SDIO host controller master hardware module to send the appropriate transaction on the SDIO bus.

A block diagram illustrating an example embodiment multifunction device incorporating a shared SDIO interface is shown in . In this example the multifunction device generally refereneced comprises only two functions Bluetooth Function and WLAN Function . The multifunction device comprises shared SDIO PHY interconnect bus Bluetooth Function SDIO attachment module WLAN Function SDIO attachment module power reset clock and management PRCM module .

The shared SDIO interface communciates with the host via physical interface lines . WLAN and Bluetooth IRQ lines are also input to the host for handling interrupts generated by the WLAN and Bluetooth modules respectively.

The interface between the host and the multifunction device is a standard SDIO interface such as constructed in accordance with the SD Specifications Version 2.0 Draft October 2006.

The Function block is located on the top level chip partition. Function registers can be read by and written to by each IP module using the access bus . Note that the IP modules only write to Function register bits that are not shared among other functions e.g. the Bluetooth Function Enable bit. Specific definitions of Function properties that are controlled by the Bluetooth and WLAN functions are provided infra.

In this example embodiment the SDIO interface is used for WLAN Bluetooth or the combination of both WLAN and Bluetooth in multifunction mode in which the same physical interface is used for the two IPs. The Bluetooth IP module is assigned Function and the WLAN IP module is assigned Function . Function is used for the common I O area.

In accordance with the invention the SDIO implementation is partitioned into two entities. One is the shared SDIO PHY which is located in the top level and responsible for decoding host commands and routing the relevant data to from the selected IP module. The second is SDIO block inside each IP module which is responsible for pushing and pulling data to and from the shared SDIO interface. The SDIO PHY in the top level also comprises the necessary Function registers since it is the common I O area Card Information Structure or CIS that serves all IP modules i.e. Bluetooth and WLAN and can be accessed by the host even if the independent Functions are disabled i.e. turned OFF .

The shared SDIO PHY in the top level supports three interfaces with the IP modules 1 a dedicated data flow OCP bus for each IP module runs on the SDIO clock 2 an InterConnect OCP bus the top level bus used for SDIO PHY configuration by the IP modules runs on the TOP clock and 3 sideband signals used for any other reason such as to convey specific real time and other information between the SDIO PHY module and each IP module one set for each IP module according to the partitioning described below.

The SDIO interface is designed to run at the SDIO host clock domain as the host supplies a clock along with the SDIO interface lines. The host may stop the clock when the interface is idle in most cases hosts will actually drive the clock only during active SDIO transaction . From the data interface perspective it is preferable to isolate the local IP clock domain from the SDIO clock domain in the data buffers inside the SDIO attachment module of the IP module. In addition since the chip modules can be put to sleep i.e. local clock shut down it is essential to have all the global Function registers work on the host clock domain so that they are accessible even when the Bluetooth module itself is sleeping or has not been initialized yet. Therefore the SDIO PHY module including SDIO PHY and Function registers is adapted to work on the SDIO host clock domain while the synchronization to the local clock domain of each module is performed within each specific module. Note that the protocol specific function e.g. the Bluetooth SDIO Function is protected by sleep protocol and not expected to be accessed by the host before the protocol specific wakeup sequence is completed. The Wakeup sequence allows the module some time to turn on its clock before the host performs any data access.

The Function configuration interface allows access to all Function registers. The SDIO PHY allows configuration of Function by any attachment module. Apart for the generic configuration interface the SDIO PHY provides specific information to each of the IP modules using distinct lines such as the side band signals . A Function Enable line is provided to each Function s module. A Function Ready signal is received from each Function s module. A Card Reset line is provided to each Function s module. Block Size is provided to each Function s module via the bus .

A Common I O Area CIA is implemented in the shared SDIO interface. The CIA is accessed by the host via I O reads and writes to Function . The registers within the CIA are provided to control the card configuration global as well as per function . The CIA contains three distinct register structures 1 The Card Common Control Register CCCR 2 Function Basic Registers FBR and 3 Card Information Structure CIS .

Details of the properties of Function will now be described. For each property an owner entity is listed that is responsible for configuring it. A property owner may comprise either firmware within any of the chip IP modules or top level hardware. The Function CCCR and FBR properties including their owners are described below in Table 1. Note that the term SDIO PHY indicates the shared logic.

A diagram illustrating the Card Information Structure CIS and Function Basic Registers FBR is shown in . The Function Basic registers FBR for Function are listed in block while the Cad Information Structure CIS is listed in block . The shared SDIO PHY comprises a Card Information Structure CIS in the form of Tuples. The CIS provides more complete information about the multifunction device and the individual Functions. The CIS is constructed in the form of a linked list of Tuples. The first Tuples in the list describe the common card configuration. Following the common Tuples a per function linked list is provided for each existing function Functions to for SDIO . Using the Address Pointer to Function CIS field in the FBR see Table 1 supra for each Function the host can directly access the head of a function specific Tuple linked list. For a non existing function the address pointer is set to point to the end of the linked list. By inserting a NULL Tuple at the end of the list the host can identify non existing functions.

Note that the SDIO PHY is operative immediately after reset without firmware intervention . The Tuples can be changed as part of the generic configuration bus. This is needed especially for the WLAN IP module which is a RAM device that is booted through the SDIO interface.

All Tuples within the CIS are typically handled by the top level logic in order to permit the SDIO PHY is operative immediately after reset without any firmware intervention. The Tuples however are accessible as a part of the generic configuration interface address space.

Note that for different applications a different CIS is constructed. For example in one example embodiment the CIS indicates two operative functions i.e. WLAN at Function and SDIO at Function . In another example embodiment the CIS indicates only one available function i.e. Bluetooth at Function . Note also that the content of the CIS either the common or per function Tuples is assumed to be fixed as it describes hardware characteristics.

A block diagram illustrating an example Bluetooth module incorporating an example embodiment Bluetooth SDIO attachment module is shown in . The Bluetooth module i.e. headset cell phone etc. generally referenced comprises Bluetooth SDIO attachment module in communication the SDIO PHY MAC block via bus e.g. OCP bus . The SDIO PHY MAC block is operative to implement the unified IO interface mechanism of the present invention. The SDIO PHY MAC block interfaces with the host device . Note that the DSIO PHY MAC block may be external as shown to the Bluetooth module or may be incorporated within it along with the OCP bus .

The Bluetooth module also comprises baseband processor MAC memory PHY circuit Bluetooth radio controller and power management module . The radio circuitry comprises an RF switch bandpass filter RF front end circuitry bandpass filter etc. not shown . The PHY circuit comprises I and Q signal analog to digital converters ADCs and I and Q signal digital to analog converters DACs not shown . The memory comprises any memory devices such as EEPROM static RAM FLASH memory etc. necessary for operation of the processor MAC. Note that in one embodiment the mechanism of the invention is implemented as firmware software that resides in memory and executed on the baseband processor or other controller device or is implemented in hardware in the MAC layer in the processor . Alternatively the mechanism may be implemented in the host or a combination of the host and baseband processor or may be implemented in the controller .

The RF front end circuit with the radio functions to filter and amplify RF signals and perform RF to IF conversion to generate I and Q data signals for the ADCs and DACs in the PHY. The baseband processor functions to modulate and demodulate I and Q data perform carrier sensing transmission and receiving of frames. The medium access controller MAC functions to control the communications i.e. access between the host device and applications. The power management circuit is adapted to receive power via a wall adapter battery and or power via the host interface . The host interface may comprise PCI CardBus or USB interfaces.

The terminology used herein is for the purpose of describing particular embodiments only and is not intended to be limiting of the invention. As used herein the singular forms a an and the are intended to include the plural forms as well unless the context clearly indicates otherwise. It will be further understood that the terms comprises and or comprising when used in this specification specify the presence of stated features integers steps operations elements and or components but do not preclude the presence or addition of one or more other features integers steps operations elements components and or groups thereof.

The corresponding structures materials acts and equivalents of all means or step plus function elements in the claims below are intended to include any structure material or act for performing the function in combination with other claimed elements as specifically claimed. The description of the present invention has been presented for purposes of illustration and description but is not intended to be exhaustive or limited to the invention in the form disclosed. As numerous modifications and changes will readily occur to those skilled in the art it is intended that the invention not be limited to the limited number of embodiments described herein. Accordingly it will be appreciated that all suitable variations modifications and equivalents may be resorted to falling within the spirit and scope of the present invention. The embodiments were chosen and described in order to best explain the principles of the invention and the practical application and to enable others of ordinary skill in the art to understand the invention for various embodiments with various modifications as are suited to the particular use contemplated.

