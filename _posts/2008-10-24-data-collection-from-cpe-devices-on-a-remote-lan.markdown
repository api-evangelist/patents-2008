---

title: Data collection from CPE devices on a remote LAN
abstract: Methods, systems, and computer-readable media for collecting data from CPE devices located on a remote LAN are provided. Communication is established over a WAN with a gateway attached to the LAN. The gateway is then used to enumerate the CPE devices on the LAN. A firewall pinhole is created in the gateway for each CPE device on the LAN, and communication is established through the pinholes to the CPE devices to collect the desired data.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07969975&OS=07969975&RS=07969975
owner: AT&T Intellectual Property I, L.P.
number: 07969975
owner_city: Atlanta
owner_country: US
publication_date: 20081024
---
This disclosure relates generally to the field of network management. More specifically the disclosure provided herein relates to remotely accessing customer premises equipment CPE devices located on a local area network LAN across a connected wide area network WAN .

Many network service providers NSP have leveraged their Internet Protocol IP WAN to provide an expanded line of services to customers beyond traditional Internet connectivity such as television and telephone services. This has resulted in an increase in the number and diversity of CPE devices located in a customer s home or office. These CPE devices are often located on a LAN on the customer s premises that is connected to the NSP s WAN through a gateway. The gateway often acts as a firewall between the WAN and the LAN making the CPE devices inaccessible remotely for administration or collection of operational status and performance data by the NSP.

Protocols and standards exist for accessing and managing CPE devices located on a remote customer premises LAN such as that described in the Broadband Forum s Technical Report TR 069 entitled CPE WAN Management Protocol. However these protocols often require that the gateway and the CPE devices implement uniform protocol stacks and technology requiring the manufacturers of the various devices to work together to implement the standard. In addition these solutions may not be scalable or may require too much overhead for implementation by a large NSP.

It should be appreciated that this Summary is provided to introduce a selection of concepts in a simplified form that is further described below in the Detailed Description. This Summary is not intended to identify key features or essential features of the claimed subject matter nor is it intended to be used to limit the scope of the claimed subject matter.

Embodiments of the disclosure presented herein include methods systems and computer readable media for collecting data from CPE devices located on a remote LAN. According to one aspect a method is provided that entails establishing communication over a WAN with a gateway attached to the LAN. The gateway is then used to enumerate the CPE devices on the LAN. A firewall pinhole is created in the gateway for each CPE device on the LAN and communication is established through the pinholes to the CPE devices to collect the desired data.

In another aspect a system for collecting data from CPE devices on a remote LAN is provided. The system includes a gateway connected between a WAN and the LAN that is capable of enumerating the CPE devices connected to the LAN and establishing firewall pinholes for allowing communication from the WAN to the CPE devices on the LAN. The system also includes a collector module that communicates with the gateway over the WAN to enumerate the CPE devices on the LAN configure the firewall pinholes in the gateway for each CPE device and establish communication with the CPE devices through the firewall pinholes to collect the desired data from the devices.

In yet a further aspect a computer readable storage medium is provided that contains executable instructions that cause a computer to collect data from CPE devices located on a remote LAN. The computer establishes communication over a WAN with a gateway attached to the LAN and uses facilities of the gateway to enumerate the CPE devices on the LAN. The computer then determines a data collection interface for each CPE device based on the type of the device and configures a firewall pinhole in the gateway for communication with the CPE device using a communication protocol corresponding to the data collection interface. The computer establishes communication with the CPE device through the pinhole using the communication protocol and collects the desired data from the device. The collected data is stored in a CPE device datastore.

Other systems methods and or computer program products according to embodiments will be or become apparent to one with skill in the art upon review of the following drawings and detailed description. It is intended that all such additional systems methods and or computer program products be included within this description be within the scope of the present invention and be protected by the accompanying claims.

The following detailed description is directed to methods systems and computer readable media for collecting data over a WAN from CPE devices located on a remote private LAN. Utilizing the technologies described herein an NSP can establish communication over the WAN to each CPE device on a customer s premises LAN to collect operational performance and configuration data while utilizing the existing functionality and capabilities of the CPE devices thereby eliminating the need to implement a complex and consistent set of protocols and interfaces across different device types and manufacturers.

In the following detailed description references are made to the accompanying drawings that form a part hereof and that show by way of illustration specific embodiments or examples. In referring to the drawings it is to be understood that like numerals represent like elements through the several figures and that not all components described and illustrated with reference to the figures are required for all embodiments. Referring now to an illustrative operating environment and several hardware and software components for collecting data from CPE devices located on a remote LAN is shown according to embodiments.

The environment includes a wide area network WAN . According to one embodiment the WAN is a an Internet Protocol IP backbone network such as that provided by a network service provider NSP upon which flows a variety of Internet traffic including but not limited to Web browsing email instant messaging IM file sharing Voice over IP VoIP IP television IPTV and streaming media. In addition the NSP may also provide closed or proprietary services across the WAN including telephone television teleconferencing media services content distribution credit card processing virtual private networks VPN and other services.

The operating environment also includes a local area network LAN . In one embodiment the LAN is located on a customer s premises and may consist of a wired Ethernet network a wireless Wi Fi network a HomePNA network a power line network such as HOMEPLUG from HomePlug Powerline Alliance Inc. of San Ramon Calif. or any combination of these and other physical networking components known in the art.

The LAN is connected to the WAN by a gateway according to embodiments. The gateway provides the routing of IP and other network traffic between the LAN and the WAN . The gateway may be an individual device that incorporates both the network routing functionality as well as a network bridge such as a DSL modem or cable modem or it may consist of two or more separate devices. In one embodiment the gateway also acts as a firewall preventing unauthorized access to devices on the LAN from the WAN as will be described in more detail below in regard to .

A number of customer premises equipment CPE devices A D referred to herein collectively as CPE devices are attached to the LAN according to exemplary embodiments. Each of the CPE devices may be designed to access a particular service provided by the NSP across the WAN . For example one CPE device A may be a personal computer PC with a network interface adapter that is used to access the Internet across the WAN for Web browsing email IM etc. Another CPE device B may be an IP telephone which allows telephone calls to be placed over the WAN utilizing VoIP services provided by the NSP. In a further example one CPE device C may be a set top box STB designed to access television and other media content over the WAN utilizing an IPTV service of the NSP. It will be appreciated that any number and type of CPE devices known in the art may be attached to the customer s LAN beyond those described herein.

Communication of the CPE devices on the LAN with the corresponding services on the WAN may be facilitated by the gateway . For example the gateway may forward IP traffic from a particular CPE device such as the PC CPE device A to the WAN using network address translation NAT . Some of the CPE devices attached to the LAN may also act as sub gateways to additional devices incorporating network bridge and or routing functionality within the device. For example one CPE device D may be a wireless access point WAP and router that routes IP and other network traffic between the LAN and a Wi Fi network. Other CPE devices such as the STB CPE device C described above may communicate with the corresponding services on the WAN by communicating wirelessly through the WAP CPE device D onto the LAN and then through the gateway onto the WAN as further illustrated in .

In order to manage the network it may be desirable for a NSP to collect data from the CPE devices located on the customer s LAN . This data may include but is not limited to operational data indicating the status and health of the CPE devices performance data including logs and performance statistics indicating the operational efficiency of the devices and the network and configuration data indicating the capabilities and configuration of the devices. The data may be used to measure the performance of the network establish quality of service QoS levels identify devices or services that require troubleshooting or modification or any number of other purposes that would be apparent to one skilled in the art.

A data collector connected to the WAN communicates with the CPE devices to collect the desired data according to embodiments. The data collector may be an application software module executing on a network server computer or it may a specialty device connected to the WAN . The data collector connects to a data collection interface on each of the CPE devices to collect the desired data as will be described in more detail below in regard to . The collected data is then stored in a CPE device datastore . The CPE device datastore may be located in non volatile storage within the network server executing the data collector or it may be located in a storage mechanism external to the data collector.

As described above the gateway may act as a firewall between the WAN and the LAN preventing the data collector from being able to communicate directly with the CPE devices on the LAN. According to one embodiment in order for the data collector to communicate with the CPE devices a firewall pinhole is established in the firewall for each of the CPE devices with which the data collector will communicate. As illustrated in a firewall pinhole such as the firewall pinholes A D referred to herein collectively as firewall pinholes is a port in a firewall such as the firewalls A B that allows applications external to the firewall such as the data collector to communicate with devices inside the firewall such as the CPE devices A D.

For example in order for the data collector to communicate with the CPE device A the firewall pinhole A is established in the firewall A of the gateway . Similarly the firewall pinholes B and C are established in the firewall A to facilitate communication between the data collector and the CPE devices B and D respectively. When the CPE device C is located behind a sub gateway such as the WAP CPE device D described above in regard to the additional firewall pinhole D may need to be established in the firewall B of the sub gateway CPE device D in order to allow communication from the data collector to reach the remote CPE device C as further illustrated in .

The gateway facilitates the configuration of the firewall pinholes required by the data collector according to one embodiment. The configuration of each of the firewall pinholes may consist of creating a mapping between an external port number with which the data collector will communicate and an internal address and port number to which the communication will be forwarded. The specific parameter values of the mapping will depend on a number of factors including the internal addresses assigned to the CPE devices on the LAN and the communication protocol to be used by the data collector to access the data collection interface of each CPE device as will be described in more detail below in regard to . It will be appreciated by one skilled in the art that the firewall pinholes may be established using additional or differing parameters than those described above and that the TCP IP port forwarding functionality required by the data collector may be accomplished using other methods than the firewall pinholes described herein. It is intended that all such configurations and methods be included within the scope of the present invention.

Referring now to additional aspects regarding the operation of the components and software modules described above in regard to will be provided. It should be appreciated that the logical operations described herein are implemented 1 as a sequence of computer implemented acts or program modules running on a computing system and or 2 as interconnected machine logic circuits or circuit modules within the computing system. The implementation is a matter of choice dependent on the performance and other requirements of the computing system. Accordingly the logical operations described herein are referred to variously as operations structural devices acts or modules. These operations structural devices acts and modules may be implemented in software in firmware in special purpose digital logic and any combination thereof.

It should also be appreciated that while the operations are depicted in as occurring in a sequence various operations described herein may be performed by different components or modules at different times. In addition more or fewer operations may be performed than shown and the operations may be performed in a different order than illustrated in .

According to embodiments the gateway provides an administration interface that the data collector uses to communicate with the gateway. The protocol used by the administration interface depends on the type of gateway utilized by the customer and or the NSP. For example one gateway may provide a Web based administration interface that is accessed by the data collector to collect data enumerate the CPE devices and configure the firewall pinholes as is described in more detail below in regard to operations and . It will be appreciated that the gateway may support any number of protocols or methods for communication from the data collector including but not limited to Web services remote procedure calls RPCs or a simple network management protocol SNMP interface. In addition the data collector may be programmed to recognize and communicate with a number of different types of gateways located on the WAN .

Once communication with the gateway has been established the routine proceeds from operation to operation where the data collector may collect data from the gateway . For the same reasons that data is collected from the individual CPE devices on the customer s LAN the NSP may desire to collect operational performance and configuration data from the gateway in order to measure the performance of the network establish QoS levels or identify devices or services that require troubleshooting. The collected data is stored in the CPE device datastore .

From operation the routine proceeds to operation where the data collector detects the CPE devices on the customer s LAN . In one embodiment the detection of the CPE devices is accomplished by using the administration interface of the gateway to enumerate the attached CPE devices . In order to provide IP routing functionality DHCP functionality NAT functionality and or other services the gateway may maintain a list of connected devices including the media access control MAC address and any assigned IP address of the device. In one embodiment the data collector accesses the list of connected devices on the gateway to enumerate the CPE devices on the LAN as well as to determine the appropriate data collection interface to use with each device in order to collect the desired data.

According to embodiments each of the CPE devices provides a data collection interface utilized by the data collector to collect the desired data. A data collection interface may be an administrative Website built into the CPE device which can be accessed by the data collector to collect the data or the CPE device may implement a set of Web services that the data collector may utilize to retrieve the data. It will be appreciated that the CPE devices may incorporate a wide variety of data collection interfaces known in the art including but not limited to an SNMP interface a file transfer protocol FTP interface for downloading log files or an application programming interface API implemented through RPCs. All of the CPE devices connected to the customer s LAN may use a standard consistent data collection interface or each device may have a different data collection interface depending on the manufacturers and types of devices present. Just as in the case of the gateway the data collector may be programmed to collect data from a number of different data collection interfaces on a variety of CPE devices .

In one embodiment the data collector determines the appropriate data collection interface to use with each of the CPE devices by analyzing the MAC address of each device. For example convention provides that the first three bytes of a standard 6 byte MAC address is an organizationally unique identifier OUI that uniquely identifies the manufacturer of the device. Many manufacturers may further use the fourth byte of the MAC address to identify the device type. Therefore after extracting the OUI from the MAC address of a particular CPE device to determine the manufacturer the data collector can then use a lookup list to find the device type from the fourth byte of the MAC address for the manufacturer and retrieve the appropriate data collection interface to be used to collect data from the device.

The routine proceeds from operation to operation where the data collector establishes a firewall pinhole such as the firewall pinholes for each of the CPE devices on the LAN based upon the data collection interface determined for the device in operation . According to embodiments each data collection interface will have a corresponding communication protocol that is required to utilize the data collection interface. For example a CPE device with a data collection interface consisting of a built in administrative Website or set of Web services will require the data collector to utilize the hypertext transfer protocol HTTP to collect data from the device through the data collection interface. The CPE devices implementing FTP or SNMP based data collection interfaces will require communication through the FTP or SNMP communication protocols respectively.

The configuration of each of the firewall pinholes depends upon the communication protocol required to communicate with the associated CPE device. For example for the CPE device C that requires the HTTP communication protocol the data collector establishes the firewall pinhole C in the gateway specifying the assigned IP address of the CPE device as the internal address and a port number of 80 as the internal port number. It will be appreciated that the manufacturer of a particular CPE device may require a different port number be utilized to access the data collection interface determined for the device using the HTTP protocol such as 8080.

The external port number configured for the firewall pinhole C may be any valid port number that is unique on the gateway for the associated CPE device C. In this way each of the CPE devices on the customer s LAN connected to the gateway will have its own unique external port number allowing the data collector to communicate with a particular CPE device over the WAN by specifying the WAN IP address of the gateway and the external port number of the firewall pinhole associated with the CPE device. For example the data collector may utilize an external port number of 10 001 in configuring the firewall pinhole C in the gateway to allow communication with the CPE device C. When the data collector wishes to collect data from the CPE device C on the LAN the data collector can communicate with the device by connecting to the WAN IP address of the gateway and the port number of 10 001.

In one embodiment the data collector may select a random number between 10 001 and 49 151 as the external port number for each of the CPE devices on the LAN. This provides a level of security for the CPE devices through obscurity of the external port numbers of the firewall pinholes making discovery of the firewall pinholes and the associated internal CPE devices more difficult. It will be appreciated that an NSP may employ other security mechanisms known in the art to secure the firewall pinholes and the associated CPE devices on the LAN from invasion from the WAN including but not limited to configuring the firewall pinholes with access control lists limiting connections to the devices to servers belonging to the NSP.

According to another embodiment once the CPE devices attached to the customer s premises LAN have been enumerated the data collection interface for each device has been determined and the firewall pinholes for the devices have been established the data collector stores a list of the CPE devices along with the data collection interface and assigned external port number for each in the CPE device datastore and associates the list with the customer s gateway address. In this way in subsequent attempts by the data collector to collect data from the CPE devices the data collector need only retrieve the device collection interface and external port number from the CPE device datastore for each CPE device in order to communicate with and collect data from the device.

From operation the routine proceeds to operation where the data collector establishes communication with each of the CPE devices over the WAN. The data collector utilizes the communication protocol corresponding to data collection interface determined for each of the CPE devices to connect to the WAN IP address of the gateway and the external port number assigned to the firewall pinhole associated with the device. Once communication is established with each of the CPE devices the routine proceeds to operation where the data collector utilizes the data collection interface to collect the desired data from the device. The collected data is then stored in the CPE device datastore .

According to one embodiment the CPE devices present the data for collection in a standard data model like a public tree data model as described in Broadband Forum s Technical Report TR 098 entitled Internet Gateway Device Data Model for TR 069. The tree data model provides flexibility in the data collection process in that data can be collected selectively by leaf branch or whole tree. Utilizing a standard data model also allows a small number of data collectors to collect data from a large network within a short time window saving on hardware and operation costs. From operation the routine ends.

The processing unit may be a standard central processor that performs arithmetic and logical operations a more specific purpose programmable logic controller PLC a programmable gate array or other type of processor known to those skilled in the art and suitable for controlling the operation of the computer. Processing units are well known in the art and therefore not described in further detail herein.

The memory communicates with the processing unit via the system bus . In one embodiment the memory is operatively connected to a memory controller not shown that enables communication with the processing unit via the system bus . The memory includes an operating system and one or more program modules according to exemplary embodiments. Examples of operating systems such as the operating system include but are not limited to WINDOWS WINDOWS CE and WINDOWS MOBILE from MICROSOFT CORPORATION LINUX SYMBIAN from SYMBIAN SOFTWARE LTD. BREW from QUALCOMM INCORPORATED MAC OS from APPLE INC. and FREEBSD operating system. An example of the program module includes the data collector described above in regard to . In one embodiment the program modules are embodied in computer readable media containing instructions that when executed by the processing unit perform the routine for collecting data from CPE devices on a remote LAN as described in greater detail above in regard to . According to further embodiments the program modules may be embodied in hardware software firmware or any combination thereof.

By way of example and not limitation computer readable media may comprise computer storage media and communication media. Computer storage media includes volatile and non volatile removable and non removable media implemented in any method or technology for storage of information such as computer readable instructions data structures program modules or other data. Computer storage media includes but is not limited to RAM ROM Erasable Programmable ROM EPROM Electrically Erasable Programmable ROM EEPROM flash memory or other solid state memory technology CD ROM digital versatile disks DVD or other optical storage magnetic cassettes magnetic tape magnetic disk storage or other magnetic storage devices or any other medium which can be used to store the desired information and which can be accessed by the computer system .

The user interface devices may include one or more devices with which a user accesses the computer system . The user interface devices may also include but are not limited to computers servers personal digital assistants cellular phones or any suitable computing devices. The I O devices enable a user to interface with the program modules . In one embodiment the I O devices are operatively connected to an I O controller not shown that enables communication with the processing unit via the system bus . The I O devices may include one or more input devices such as but not limited to a keyboard a mouse or an electronic stylus. Further the I O devices may include one or more output devices such as but not limited to a display screen or a printer.

The network interface controllers enable the computer system to communicate with other networks or remote systems via a network . Examples of the network interface controllers may include but are not limited to a modem a radio frequency RF or infrared IR transceiver a telephonic interface a bridge a router or a network card. The network may include a wireless network such as but not limited to a wireless local area network WLAN such as a Wi Fi network a wireless wide area network WWAN a wireless personal area network WPAN such as BLUETOOTH a wireless metropolitan area network WMAN such as a WiMAX network or a cellular network. Alternatively the network may be a wired network such as but not limited to a WAN such as the Internet a LAN such as an Ethernet network a wired personal area network PAN or a wired metropolitan area network MAN .

Although the subject matter presented herein has been described in conjunction with one or more particular embodiments and implementations it is to be understood that the embodiments defined in the appended claims are not necessarily limited to the specific structure configuration or functionality described herein. Rather the specific structure configuration and functionality are disclosed as example forms of implementing the claims.

The subject matter described above is provided by way of illustration only and should not be construed as limiting. Various modifications and changes may be made to the subject matter described herein without following the example embodiments and applications illustrated and described and without departing from the true spirit and scope of the embodiments which is set forth in the following claims.

