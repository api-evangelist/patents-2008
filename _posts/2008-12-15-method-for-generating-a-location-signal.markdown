---

title: Method for generating a location signal
abstract: A communication device uses its FGU to generate a location signal that can be used by a reference device to calibrate the communication device and to determine the distance of the communication device from the reference device. The communication device: receives, from a reference device, at least one location signal control parameter that defines pulse shape characteristics for a location signal; configures its FGU based on the at least one location signal control parameter; generates a linear first part of a phase-incoherent location signal having the defined pulse shape characteristics by progressively sweeping an output of the FGU over a range of frequencies from a first frequency to a second frequency within a first time period; and transmits at least one iteration of the first part of the location signal.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08063823&OS=08063823&RS=08063823
owner: Motorola Solutions, Inc.
number: 08063823
owner_city: Schaumburg
owner_country: US
publication_date: 20081215
---
The present application is related to the following U.S. application commonly owned together with this application by Motorola Inc. 

Ser. No. 12 335 156 filed Dec. 15 2008 titled Method and Device for Generating a Location Signal Gonzalez et al.

The technical field relates generally to location technology and more particularly to a method for generating a location signal in a communication device that can be used for ranging.

Communication devices such as portable two way radios vastly improve the effectiveness of police fire and military personnel in a public or military emergency situation. Often the first responders at an emergency site communicate with subsequent responders to direct them to respond effectively in the emergency situation where it is often critical to locate the responders and entities such as sensors portable communication devices and the like. A variety of solutions are available for determining the location of a responder and various entities which can be segmented into three basic groups outdoor indoor and indoor outdoor solutions. Outdoor location solutions typically provide two dimensional location information in outdoor areas such as streets parks stadiums markets and the like. Typically the outdoor solutions include Global Positioning System GPS based location determination solutions. Indoor solutions typically provide three dimensional location information in a more localized area such as in buildings warehouses and the like. Generally indoor solutions require dense installation of field deployable infrastructure and have stringent location accuracy requirements. Indoor outdoor solutions provide wide area location information for multi building campuses. Conventionally an indoor outdoor location solution requires a combination of outdoor tracking technologies and installation of indoor tracking support infrastructure.

There are several inherent shortcomings in the existing location determination technologies that inhibit their usage in an indoor outdoor solution for determining location. Generally a GPS based solution does not work reliably in dense urban areas. Further a GPS based solution cannot be used as an indoor solution for determining location. Network overlay solutions usually provide better outdoor coverage at the expense of accuracy. Dedicated systems usually provide both coverage depth and accuracy but at a high infrastructure cost.

Thus there exists a need for a method of generating a location signal in a communication device that can be used both for indoor and outdoor range determination for the communication device.

Skilled artisans will appreciate that elements in the figures are illustrated for simplicity and clarity and have not necessarily been drawn to scale. For example the dimensions of some of the elements in the figures may be exaggerated relative to other elements to help improve understanding of various embodiments. In addition the description and drawings do not necessarily require the order illustrated. It will be further appreciated that certain actions and or steps may be described or depicted in a particular order of occurrence while those skilled in the art will understand that such specificity with respect to sequence is not actually required. Apparatus and method components have been represented where appropriate by conventional symbols in the drawings showing only those specific details that are pertinent to understanding the various embodiments so as not to obscure the disclosure with details that will be readily apparent to those of ordinary skill in the art having the benefit of the description herein. Thus it will be appreciated that for simplicity and clarity of illustration common and well understood elements that are useful or necessary in a commercially feasible embodiment may not be depicted in order to facilitate a less obstructed view of these various embodiments.

Generally speaking pursuant to the various embodiments a communication device uses its frequency generation unit FGU to generate a location e.g. chirp signal that can be used by a reference device to calibrate the communication device and to determine the distance of the communication device from the reference device. The communication device receives from a reference device at least one location signal control parameter that defines pulse shape characteristics for a location signal configures its FGU based on the at least one location signal control parameter generates a linear first part of a phase incoherent location signal having the defined pulse shape characteristics by progressively sweeping an output of the FGU over a range of frequencies from a first frequency to a second frequency within a first time period and transmits at least one iteration of the first part of the location signal.

In one embodiment a phase locked loop FGU having a voltage controlled oscillator VCO an adjustable filter that incorporates at least one component having a reactive value that is predominately capacitive a synthesizer with an adjustable charge pump a radio controller and ramp timers is used to generate chirp location signals. In this embodiment the radio controller sends control signals to set the adjustable filter to wideband operation to set the gain and polarity of the adjustable charge pump and to initialize the ramp timers. A first gain and polarity of the charge pump generates a first constant current having a first magnitude that charges the filter capacitive element for a first time period set by a ramp timer which provides a control signal that steers the VCO output to generate the first part of the chirp signal. The slope of the first part of the chirp signal is a function of the magnitude of the first current the capacitance value and the first time period.

In another embodiment a delay locked loop FGU having a plurality of delay elements each providing a different delayed output relative to a reference clock signal is used to generate chirp location signals. In this embodiment the communication device selects a sequence of the delayed outputs to progressively steer the signal output over the range of frequencies to generate the location signal.

Those skilled in the art will recognize that the FGU apparatus used to generate the chirp location signal need not be limited to the preceding illustrative examples. Other FGU systems of varying complexity may also be adaptable to create chirp location signaling. Alternative FGU systems may include any one or more of the following components programmable high speed Digital to Analog Converters DAC with sufficient voltage range and resolution for steering a VCO any filter configuration active passive discrete or integrated being adjustable over a sufficiently wide bandwidth range any feedback strategy whereby the FGU output frequency is compared to a known reference for generating an error signal and appropriate control logic for controlling the FGU operation during standard narrowband operation and during chirp location signaling for a wideband channel. As such other alternate FGU implementations are contemplated and are within the scope of the various teachings described herein.

The chirp signals can be used to calibrate the communication device and based on calibrated or steady state internal processes of the communication device to accurately determine a distance to the communication device without the need for complex and expensive infrastructure. Basically a single reference device is able to accurately determine its distance from the communication device using knowledge of the calibrated state of the communication device and the chirp signals generated by the communication device that are received at the reference device. Those skilled in the art will realize that the above recognized advantages and other advantages described herein are merely illustrative and are not meant to be a complete rendering of all of the advantages of the various embodiments.

Referring now to the drawings and in particular a block diagram illustrates a system comprising a reference device communicating with a communication device to participate in a training process for the communication device and to determine the location of the communication device. The communication device generates location e.g. chirp signals using its frequency generation unit FGU in accordance with some embodiments and transmits the location signals to the reference device to use in the training process and the subsequent location determination.

In the described embodiments the reference device and the communication device operate in accordance with Project 25 P25 or APCO 25 standard protocols which are a suite of standards for digital radio communications that are produced through the joint efforts of the Association of Public Safety Communications Officials International APCO the National Association of State Telecommunications Directors NASTD selected Federal Agencies and the National Communications System NCS and standardized under the Telecommunications Industry Association TIA . However the teachings described herein are in no way limited to this system implementation. Those skilled in the art will recognize and appreciate that the specifics of this example are merely illustrative of some embodiments and that the teachings set forth herein are applicable in a variety of settings. As such other alternate implementations with the devices using different protocols are contemplated and are within the scope of the various teachings described herein. Also the reference device can be associated with more than one communication device to determine locations of a plurality of communication devices.

As used herein the term reference device includes but is not limited to equipment commonly referred to as access points access terminals base stations incident command stations and any other device capable of interfacing with a communication device in a wireless environment. In accordance with some embodiments the reference device can be portable such as in the case of the laptop computer shown in . As such the reference device can be installed in a vehicle such as a fire truck. As used herein the term communication device includes but is not limited to equipment commonly referred to as mobile devices access terminals two way radios portable radios and any other device capable of operating in a wireless environment. Typically the communication device is portable and it can be carried by a responder to an emergency situation.

As shown in the reference device comprises an interface an interface a processor a memory and antennas and and the communication device comprises an interface and interface a processor a memory antennas and and a frequency generation unit FGU that includes Chirp Generation Control circuitry CGC to generate a sequence of wideband chirp signals used as location pulses. The reference device and the communication device are also equipped with a transceiver i.e. transmitter and receiver apparatus not shown coupled to the interfaces and antenna which includes FGUs and is further equipped with other components such as one or more timers as needed for a commercial embodiment.

The transceiver memory and processors can have any suitable physical implementation and are topologically coupled depending on the particular device implementation. These components are further operatively coupled and can be adapted arranged configured and designed to perform methods in accordance with the teachings herein for instance as illustratively described by reference to through . For example memories and and processors and are each depicted as a single physical device but it is well understood that any of those elements can comprise multiple such elements. For instance the processing device can include one or more processors microprocessors etc. and the memory can comprise one or more storage units such as random access memory RAM read only memory ROM databases etc. for performing the intended functionality in accordance with the teachings herein.

In accordance with this illustrative embodiment the devices and include two interfaces and two antennas for communicating using two different channels wherein the channels are the physical communication resources over which information is sent between the devices and and can comprise wired links or wireless links as in the present case . For wireless channels the corresponding physical resource is an allocation of radio spectrum that is partitioned into radio frequency RF carriers that are modulated by a media e.g. audio video data etc. or a control e.g. requests from the reference device for location signals and the corresponding transmitted location signals etc. stream.

More particularly interface and antenna of the reference device communicate with the interface and antenna of the communication device on a narrowband channel which in this example is an APCO 25 data channel but can be any type of wireless channel having any suitable bandwidth. For the purposes of this application a narrowband channel is defined as any wireless channel having channel spacing equal to or less than 500 kHz. In accordance with the teachings herein the reference device uses the interface and antenna to transmit and receive control information related to an inbound location pulse sequence.

The interface and the antenna of the reference device communicate with the interface and antenna of communication device on a channel . In accordance with the teachings herein the reference device receives a sequence of location pulses from the communication device on the channel . In the described embodiments the channel is a wideband channel. For the purposes of this application a wideband band channel is defined as a wireless channel having a frequency span equal to or greater than 5 MHz. In one embodiment a location pulse signal from the communication device sweeps over a frequency range of 50 MHz when communicated on channel and is therefore said to have a bandwidth BW of 50 MHz.

Antennas and may be omni directional sectored MIMO Multiple In Multiple Out a technology that allows antennae to process numerous incoming and outgoing signals simultaneously or a smart antenna array. In accordance with one embodiment the antennas and are each an Omni directional antenna while the antenna is a narrow beam phase array or scanning antenna. However the reference device and communication device antenna structures need not be limited in this fashion. In accordance with alternate embodiments a single antenna may also be used for both communicating on the narrowband channel and receiving on the wideband channel. If a single antenna topology is employed an antenna switch may also be incorporated at the junction of the antenna and the two interfaces as is well known in the art.

As mentioned earlier the communication device further comprises FGU circuitry that generates the wideband location pulses sent to and used by the reference device during a training process and thereafter to determine its distance from the communication device . The type of FGU used is a matter of design preference based on a given device implementation and the manner in which the communication device generates wideband location signals in accordance with the teachings herein is based on the particular FGU topology.

By way of illustration methods performed by a communication device e.g. communication device of generating wideband location signals using a FGU comprising a multi accumulator synthesizer within a phase locked loop PLL e.g. as shown in or using a FGU comprising a delay locked loop DLL for direct digital synthesis e.g. as shown in are next described by reference to to . However the implementation of the teachings herein is not limited to these particular FGU topologies but can be applied to any suitable FGU topology. Moreover it will be appreciated that the methods described in accordance with the teachings herein include functionality that may be performed in hardware firmware software or a combination thereof.

Turning now to illustrated therein is a flow diagram of a method for generating a location signal in a FGU in accordance with some embodiments. During normal radio communications of the communication device the FGU also referred to in the art as a frequency synthesizer generates the appropriate frequency signals needed to transmit and receive narrowband signals on channel wherein the narrowband signals include voice or other media sent between at least two devices using a wireless interface. Some embodiments of a FGU like the FGU illustrated in include a Voltage Controlled Oscillator VCO a synthesizer loop filter a reference frequency oscillator and a synthesizer Integrated Circuit IC that includes at least one charge pump a phase detector and a frequency divider controlled by a microprocessor wherein the microprocessor can be integrated into the processor or implemented as a separate processing device. Other embodiments of the FGU like the FGU illustrated in include a PLL a frequency divider a phase detector a charge pump a delay line with multiple delay elements and a tap selection network controlled by a microprocessor.

Normal operation of the communication device using its FGU to communicate signals on the narrowband channel occurs until the communication device is prompted by internal or external commands to transmit location signals. In one embodiment the communication device receives a request from the reference device to generate one or more location signals and the communication device sends the location signals in response thereto which can be used by the reference device to train or calibrate the communication device or to calculate range distance information for a calibrated communication device. The request message may include one or more chirp control parameters for defining the inbound location signal pulse shape characteristics. In general a single location pulse is associated with at least one positive slope K linear frequency ramp or negative slope K linear frequency ramp. For the purposes of the teachings herein the term linear means a fixed frequency variation in time e.g. slope when generating a ramp response that is sweeping between two terminus frequencies fand f. Accordingly the chirp control parameters can include but are not limited to chirp slope counter values during which the slope is maintained and start and stop frequencies for the chirp response. In the case of the FGU implementation these parameters may be embodied as charge pump gain or magnitude and charge pump polarity and code plug values for generating specific terminus frequencies.

In an APCO 25 system implementation the reference device and the communication device both contain APCO 25 modems for communicating over the APCO 25 data channel . In accordance with one embodiment the APCO modem of the reference device transmits to the APCO modem of the communication device an APCO 25 data packet that can easily fit into a User Datagram Protocol UDP frame. Generally in an APCO 25 data mode 512 bytes of data with only 480 bytes of useable message or data space are transmitted. Table 1 illustrates some of the key commands control or data that may be needed to manage the training and sampling of the ranging location signal. Table consists of the chirp control parameters needed to define the slope K of the signal the reference device receiver expects to see. Table 1 also defines how many training pulses to use and the rate. The transmit TX time is sent if available course ranging along with pulse shaping information fine ranging . If the training bit is logic 0 then the reference device is requesting a sample.

It should be noted that the chirp control parameters need not be received in a location signal request from the reference device. The reference device may send the chirp control parameters at any time before calibrating the communication device wherein the communication device stores these parameters for future use. In addition the reference device can transmit the chirp control parameters either via a wired or wireless link and if using a wireless link any suitable wireless protocol can be used to transmit the message containing the chirp control parameters. Accordingly in an alternative embodiment the communication device periodically and not responsive to a request transmits the location signals to the reference device for range calculations. In this embodiment the communication device has stored in its memory the control parameters defining the location signal.

Upon the APCO modem of the communication device receiving the request for a location signal from the APCO modem of the reference device the APCO modem of the communication device sends acknowledgements ACK and permissions to an Application Programming Interface API in the communication device e.g. an API for a microprocessor radio controller which sends control signals to suspend non critical internal processes. Suspending some internal processes minimizes the time taken by the communication device to send the location signals and also stabilizes its internal processes to an optimized e.g. calibrated state so as to enable the reference device to make more consistent and accurate distance calculations relative to the communication device location.

In one illustrative example the communication device continues internal maintenance routines that keep the device functional e.g. keeps the device from locking up but suspends non critical voice and non voice processes. Suspending the non voice processes include for instance idling e.g. reducing and in some cases stopping input output and peripheral machine access controls MACs . Moreover the communication device can be configured to activate pre programmed and predictable timing functions and features such as emergency codes which may be associated with a calibrated processing state of the communication device to manage its internal processing delays wherein the internal processing delay is for instance a delay between the communication device receiving the request to generate location signals and the communication device responsively transmitting the first location pulse.

After suspending appropriate internal processes the communication device configures the FGU to generate the location signals and then transmits a location signal sequence that may have multiple location pulses to the reference device. The transmission of location signals that are substantially equivalent is achieved based on recursive sequencing from the reference device during a training process or based on a stored internal calibrated processing state that was previously associated with a calibrated internal time delay for the communication device during training. The communication device for example selects the initial slope for the first ramp of the signal initializes an up ramp and or down ramp counter locks to a start frequency wideband channel and sets the location signal iteration count. In addition for the FGU implementation the communication device changes a loop filter from a narrowband operation for normal operations to a wideband operation for generating the location signals and sets a charge pump gain corresponding to the initial slope for the location signal.

After the communication device transmits the required number of chirp pulses in the sequence the communication device reconfigures the FGU for normal operations on the narrowband channel and then resumes the normal narrowband radio operations.

In accordance with one embodiment the location signal is a chirp signal generated using the FGU of the communication device. Frequency selection or programming in a frequency synthesizer is accomplished via a control signal that can be either analog or digital depending on the particular FGU implementation. For example when the control signal such as a current or voltage source is applied to an oscillator e.g. a Voltage Controlled Oscillator VCO or a Current Controlled Oscillator CCO the oscillator moves from a first frequency to the programmed frequency for normal radio operations. However the frequency change is not immediate and in fact occurs over a short period of time creating what is commonly referred to as chirp . In this context slope characteristics of the chirp are not dynamically controlled based on one or more programmable parameters but are simply intrinsic to the hardware limitations which is different from the teachings herein. As a consequence known chirp signal frequency responses are non linear.

However as the term is used herein a chirp signal is defined as a controlled RF signal with a predefined based on one or more received programmable parameters wideband linear frequency swept response of relatively short time duration e.g. 22 micro seconds that is generated using the FGU. The FGU with CGC receives from a reference device at least one chirp control parameter defining pulse shape characteristics of the chirp signal and responsively programs or configures used herein interchangeably frequency synthesizer circuitry to sweep the output RF frequency over a wide range of frequencies e.g. 50 MHz from an initial frequency to a final frequency to generate a wideband chirp location signal that the communication device sends to the reference device over the wideband channel . This programmable chirp signal can include one or more chirp pulses with each chirp pulse comprising a frequency sweep of one or more continuous linear frequency ramps from an initial frequency to an end frequency.

The typical Frequency Modulated FM chirp signal is represented in equation 1.0 below where f is the carrier or IF frequency K is the chirp slope T is the chirp duration period in seconds and the function rect . represents the pulse shape of a chirp single ramp signal. Equation 1.0 is the complex representation of the transmitted signal.

A characteristic of the chirp signal generated in accordance with the teachings herein is that all portions of the chirp signal are phase incoherent unlike conventional radar technology . A signal being phase incoherent as the term is defined herein means that there exists no predetermined phase relationship between the reference device internal timing sources and the phase of the in bound location pulse signal e.g. the in bound location pulse signal does not contain coherent phase modulated information. However other methodologies besides phase modulation may be used to carry information in the chirp signal as relates to the communication device sending the chirp signal or a user of that communication device. For example data parameters such as communication device identification ID location e.g. coordinates of the communication device biometrics information emergency man down or other critical information etc. can be embedded in the chirp signal.

Example methodologies that can be used to embed the data parameters in the chirp signal include but are not limited to using a combination of different values of start e.g. f intermediate e.g. f and final frequencies within a given chirp pulse e.g. where the first intermediate and final frequencies are all different or the first and final frequencies could be the same variation in slope e.g. slope magnitude and or polarity number of chirp pulse iterations segmenting the chirp location signal into a plurality of contiguous segments with each segment exhibiting different slopes and timing durations instead of a single slope from the start frequency e.g. f to the intermediate frequency e.g. f in the first part of the chirp signal and a second fixed slope from the intermediate frequency e.g. f to the final frequency of the second part of the chirp signal etc.

With regard to a particular illustrative use of methodologies to communicate one or more data parameters in the chirp signal a plurality of communication devices could be calibrated with each device having a different slope magnitude or combination of slopes for the first and second portions of the chirp location signal. In this manner each slope or combination of slopes of a given chirp pulse is associated with a different communication device and thereby conveys communication device ID. The chirp pulse could also include changes in the linear slope for a given slope polarity i.e. multiple slope iterations in one part of a chirp pulse that can be calibrated to be associated with information such as biometrics or emergency information that can be for instance communicated in chirp pulses when a user of the device is unable to otherwise normally transmit on the communication device. The latter embodiment could be associated with an emergency button that a user can press to send chirp pulses that have the embedded emergency information wherein the pulse sequence can also be used to determine the distance of the communication device.

Regarding the circuitry used to generate the chirp signal in the FGU embodiment the CGC sequences a charge pump so as to steer the VCO to generate the chirp signal. In another embodiment the CGC controls a tap selection network to sequentially select taps from the delay line to generate the chirp signal. Correspondingly although not shown in the reference device includes counterpart circuitry in its receiver apparatus to properly receive the chirp signal. When the chirp signal has one part that slopes in one direction the reference device comprises an APCO modem and a chirp receiver incorporating an up ramp K or a down ramp K correlator filter matched to the location pulse characteristics e.g. the slope frequency response of the chirp signal . In the alternative embodiment where the chirp signal has two parts the chirp receiver of the reference device includes a splitter for splitting the received chirp signal up ramp K and down ramp K matched correlator filters and a microprocessor for controlling the up ramp and down ramp matched correlator filters.

Turning now to the detailed description of generating chirp location signals using the PLL FGU topology. illustrates a PLL FGU in accordance with some embodiments. PLL comprises a Programmable Synthesizer with chirp signal generation capability of either Integer or Fractional N design an Adjustable Loop Filter a Temperature Compensated Crystal Oscillator TCXO a Radio Controller with Memory a Voltage Controlled Oscillator VCO and a VCO Buffer . More particularly Synthesizer comprises optionally a modulation block and further comprises dividers accumulators an adjustable programmable charge pump CP having a variable gain a phase detector PD a reference frequency divider R and Chirp Generation Control circuitry CGC for controlling the Charge Pump the loop filter and various timers not shown that serve as a timing source to generate chirp signals in accordance with embodiments described herein.

The CGC comprises any control system that regulates the suspension of normal closed loop PLL operation for discrete frequency generation and manages the FGU during swept frequency chirp signal generation. For the present example illustrated in the CGC is a logic control system that once triggered reconfigures the FGU from normal closed loop operation sequences the VCO through a plurality of precision swept frequency responses and reconfigures the FGU back to nominal closed loop operation. The CGC may contain dividers logic counters signal multiplexers and mechanisms for storing timing CP gain settings and transition thresholds associated with the chirp location signal. However the CGC need not be limited in this fashion but may include specialized micro processor controllers Field Programmable Gate Arrays FPGA or other autonomous control mechanisms as may be required for proper chirp signal generation. Alternatively as will be discussed when reviewing the CGC may simply be different sequencing within a program code that controls the closed loop FGU operation in which case the CGC comprises the algorithm within the micro processor controlling the FGU.

During normal operations the PLL generates RF signals at the output of buffer of predetermined frequencies using a technique that includes coupling an output of the VCO to the frequency divider accumulators which can have modulation capability . The output of the frequency divider accumulators provides one input to the phase detector reflecting the current operating frequency of the VCO. Another input to the phase detector is a frequency which is derived by dividing down the TCXO signal by the Reference Frequency Divider . The TCXO is a specialized component that generates a reference frequency having high stability characteristics over a range of extreme operating conditions.

In essence during normal operations the Synthesizer operates in a closed loop fashion wherein the Phase Detector determines the difference in phase between its two inputs. The Phase Detector responsively generates a control signal proportional to the phase difference and directs the control signal to charge pump . In response to the PD control signal the charge pump generates an output signal comprising a series of contiguous current pulses each pulse polarity being either current sink or source pulses as determined by the PD error signal. These current pulses in output signal are filtered by the synthesizer loop filter which is configured for narrowband operations and applied to the VCO as a variable control voltage . The control voltage from the loop filter controls the VCO output frequency . As will be apparent to those skilled in the art the PD control signal effectively steers the control voltage to reduce the previously detected phase difference between the inputs of the phase detector.

The PLL synthesizer is programmed by the Radio controller over an SPI serial peripheral interface in order to generate fixed frequencies stored in memory within the operating range of the VCO . The Radio controller also programs the CGC to transform the PLL into a frequency sweeper or CHIRP generator CHIRP mode in accordance with the teachings herein as further illustrated by reference to .

In the CHIRP mode of operation upon receiving a command to generate the chirp signal the radio controller provides control signals over the SPI to the synthesizer that disables the Modulation component and the Dividers Accumulators component . The control signals also cause the CGC to 1 disconnect the Phase Detector from Charge Pump so that the synthesizer operates in an open loop fashion wherein the control of the Charge Pump is transferred to the CGC 2 adjust the loop filter for wideband operations using a loop filter adjust signal wherein the loop filter effectively operates as a capacitive element with a reactive value that sets a fixed integration time constant as may be necessary to transform the PLL synthesizer into a frequency sweeper or chirp generator based on the VCO gain and charge pump gain 3 initialize programmable counters or timers to control the duration of the charge pump sourcing or sinking and a CHIRP sequencer counter that defines frequency sweep repetitions and 4 restore the FGU to the normal operating mode once the frequency sweep repetitions are complete.

More particularly with respect to the CGC initializes the CHIRP sequencer. Included in the control signals from the radio controller to the CGC is a first chirp generation programming word that causes the CGC to tune the VCO output signal to an initial start frequency F set the charge pump to its initial polarity and magnitude to continuously source in this case a current at the given magnitude and trigger the first ramp timer that controls the duration of the continuous current . A constant charge pump current setting integrated by the loop filter capacitance for a set period of time will cause the VCO output frequency to sweep from the initial start frequency to a stop frequency at a rate set by the following formula 2 where C loop filter pole capacitance when configured for wide band operation I charge pump current set at constant source sink operation by CGC V VCO control voltage and dt time duration during which the charge pump current is held at a constant magnitude and polarity.

Referring for the moment to illustrated are three chirp up ramp pulses and sweeping from an initial frequency Fto a given stop frequency F. Ramp is generated by a sourcing current of magnitude Icharging the loop filter capacitive element for a time T. Ramp is generated by a sourcing current of magnitude 2Icharging the loop filter capacitive element for a time equal to half of time period Tor T 0.5T 2T. Ramp is generated by a sourcing current of magnitude 4Icharging the loop filter capacitive element for a time T 0.5 0.25T.

All three swept responses and are governed by the response equation 2 wherein charge pump current I is equal to 4I 2I and Ifor and respectively. When loop filter is configured for a fixed integration capacitance C during wide band operation the slope of the frequency response ramp time is determined by the magnitude of the charge pump current and the duration during which the charge pump is set to a fixed current and polarity also referred to as an integration period dt. As the charge pump output current increases the time it takes to arrive at a given stop frequency Fdecreases. More particularly shows that as the charge pump current is doubled the time it takes to sweep from Fto Fis halved.

The same principle applies whether the ramp being generated is a positive slope as shown in or a negative slope with the slope change being facilitated by switching the charge pump current polarity source to sink or sink to source . Therefore by setting the charge pump gain to a level that matches the known loop filter integration capacitance and waiting a length of time as necessary to generate the desire stop frequency a ramp up in this case response is generated corresponding to half of a chirp pulse in this illustrative implementation. Once the targeted stop frequency which is an intermediate frequency for a chirp pulse having two parts is reached the CGC uses a second chirp generation programming word from the radio controller to set the charge pump to the opposite polarity and to a desired magnitude to continuously sink a current at a given magnitude and trigger a second ramp timer that controls the duration of the CP current to form a ramp down response in this case . As noted for the previous ramp up response by setting charge pump current to a fixed level and knowing the loop filter capacitance defines a dynamically programmable period of time in which the VCO output frequency is swept from the intermediate frequency to a final frequency wherein the resulting chirp pulse is output from the buffer . As will be apparent to those skilled in the art for a given fixed capacitance value in loop filter a change in charge pump current for the second part of the chirp signal will result in a change in the slope compared to the first part of the chirp signal

The frequency sweeping or CHIRP generator mode is maintained and method of is repeated to generate additional chirp pulses until the number of chirp sequences is complete as defined by the CHIRP sequence counter . Once the CHIRP sequence ends the PLL is configured for nominal operation. The entire CHIRP sequence can last several hundred microseconds and can be managed by either internal synthesizer timers or directly by the Radio Controller or a combination of the two.

Similarly for chirp sequence beginning at time T 0 the first timer is triggered for duration t to set the VCO output frequency to an initial frequency f. After the first duration is complete at T a down ramp of first chirp pulse is generated by applying a charge pump sink current for a time period tto an integration capacitive element with loop filter . During time interval t the VCO frequency is swept from the initial frequency fto an intermediate frequency f. Note that fof chirp sequence does not have to equal fof chirp sequence . For illustrative purposes the start frequency ffor chirp sequence is higher than the intermediate frequency f. After time interval thas elapsed at time T the up ramp of the first chirp pulse is generated by applying a charge pump source current of higher magnitude than was used for down ramp for a time period t. During time interval t the VCO frequency is swept from the intermediate frequency to a final frequency which in this case is the starting frequency f. After time interval thas elapsed at time T additional chirp pulses N pulses are generated in the same manner until the chirp sequence is complete at time T. further shows that in operation there may be some brief e.g. less than 1 uSec time transition between the generation of the first and second halves of a chirp pulse and between consecutive pulses.

Turning back to when a chirp sequence is generated for location determination generally before generating the chirp sequence the communication device sets its internal processing to a calibrated state which generates a calibrated internal processing time delay within the communication device wherein the calibrated time delay comprises a steady state internal processing delay for the communication device. However when the chirp sequence is generated while the communication device is being calibrated by the reference device the communication device continues to adjust e.g. reduce internal processes as appropriate to generate a steady state chirp signal that corresponds to the calibrated internal processing delay for the communication device.

In accordance with this embodiment after each chirp pulse during the training process the reference device calculates an intermediate processing delay also referred to as an intermediate time delay for the communication device and may transmit the value of the intermediate time delay to the communication device to facilitate the optimization minimization of non critical internal processes. The training is continued until the calibrated internal processing delay is reached in the communication device. The communication device associates its calibrated processing state to the calibrated internal processing delay also referred to as the calibrated time delay that was determined during training and stores the process configuration associated with the calibrated time delay in memory of .

Once a steady state time delay is achieved and if the time delays are being measured during training a calibrated time delay is measured and associated with a known range measurement. More particularly the intermediate time delay is said to have reached steady state when the time difference between consecutive contiguous intermediate time delays is equal to or less than the desired resolution for locating the communication device. The calibrated time delay is identified as the final delay in curve . Although it can take several pulses to train the communication device at 5 thousand pulses per second pps the entire training process will be less than a few hundred milliseconds. The number of chirp pulse iterations needed to achieve steady state depends on the targeted accuracy for locating the communication device.

In another embodiment as briefly mentioned above there can be several slope transitions in a given portion of the chirp pulse. shows this embodiment. More particularly shows a ramp sequence with two chirp pulses and which has a plurality of slopes in an up ramp between frequencies Fand F and a plurality of slopes in a down ramp between frequencies Fand F. Each slope is generated similarly to how the slopes were generated with respect to . More particularly each slope of the multiple slopes in chirp pulses and comprises a linear frequency sweep or ramp between two terminus frequencies in accordance with the teachings herein. Such a signal with multiple slope transitions can be used to embed one or more data parameters as discussed earlier.

Turning now to this drawing depicts another example of a FGU with CGC that is implemented as a delay locked loop DLL and can be used to generate a chirp signal at a FGU output . The FGU includes a phased locked loop PLL optionally a divider a phase detector a charge pump a plurality of delay elements e.g. buffers N N that collectively form a delay line and a tap selection network . During operation the DLL generates a reference frequency F from PLL . The reference frequency may be divided down at divider wherein the divider output frequency CLK2kFd is a frequency that is at least 2 times k times the highest frequency to be available at output signal . The value of k is a number equal to or great than 1. For improved frequency resolution k may be scaled to the ratio of the highest and lowest terminus frequencies of the chirp location signal that is sourced at output e.g. F Fof . For example if F 100 MHz and F 300 MHz then k 3.

Each delay element through N induces an incremental time delay in its output signal relative to the input signal forming a plurality of signals at tap terminals through N. The operating frequency at taps O through N is equal to CLK2kFd however each signal is offset from the other in time by a fixed delay phase delay as determined by delay elements . Therefore there exists a plurality of high frequency signals at the tap inputs O through N each signal being offset from each other by an incremental time delay.

The time delay of each of the delay elements through N is controlled by a voltage control V signal that is tied to ground through a capacitive element . For example the phase detector receives both the clock signal and a delayed clock signal from the delay element N and produces a phase detection signal P that represents a phase difference between the clock signal and the delayed clock signal . The phase detection signal is communicated to the charge pump which produces the voltage control that is proportional to signal and that is communicated to each of the delay elements through N. Control voltage progressively adjusts the phase lock of the delay among the delay elements through N in tandem so that the phase difference between the input clock signal and the delayed clock signal is separated by one or more time periods of the reference clock signal . In one embodiment the phase detector phase locks reference clock signal to the delayed clock signal wherein the difference in absolute time is one period of reference signal i.e. signal and are phase locked together with signal lagging by exactly one period .

The number of delay elements through N is selected based on the phase e.g. time resolution desired in generating the transitions that are needed to create the chirp location signal at output . For example if an input signal is Clk2kFdf GHz 1 nano second period and if there are 1023 tap elements 2 1 taps then each delay element is 0.978 pico seconds 1 nS 1023 . This means that when generating a frequency at output the tap selection network picks the phase transition from the plurality of transitions within output signals at taps through N that is proximate within 0.978 pico seconds of the ideal frequency.

To generate a frequency the tap selection network is sequenced by a suitable program code . The program code identifies a particular order of specific delay output signals among the signals through N that when taken in sequence relative to the reference clock frequency generates the corresponding transitions for correct piece wise construction of the desired output signal . In one embodiment the program code is determined prior to frequency generation by the communication device host processor which functions as the CGC. Thus for the DLL configuring the FGU for chirp mode is accomplished by programming the tap selection network via the program code .

For generating a single fixed frequency as is needed during normal narrow band operation the tap selection sequence as programmed by program code is cyclical in nature forming a repeating sequence of tap inputs to be selected over time. The tap cycle is related to the periodicity of the frequency that is being generated. However when generating a chirp location signal the tap sequencing is set by the varying periodicity of the phase transitions that make up the swept frequency response of the chirp signal. Referring to of the 180 degree phase transitions occur with increasing frequency over time which means that the tap selection sequence is continuously varying to select the appropriate tap having an output signal that matches the same phase transition point as needed to create the swept frequency response.

In the foregoing specification specific embodiments have been described. However one of ordinary skill in the art appreciates that various modifications and changes can be made without departing from the scope of the invention as set forth in the claims below. Accordingly the specification and figures are to be regarded in an illustrative rather than a restrictive sense and all such modifications are intended to be included within the scope of present teachings. The benefits advantages solutions to problems and any element s that may cause any benefit advantage or solution to occur or become more pronounced are not to be construed as a critical required or essential features or elements of any or all the claims. The invention is defined solely by the appended claims including any amendments made during the pendency of this application and all equivalents of those claims as issued.

Moreover in this document relational terms such as first and second top and bottom and the like may be used solely to distinguish one entity or action from another entity or action without necessarily requiring or implying any actual such relationship or order between such entities or actions. The terms comprises comprising has having includes including contains containing or any other variation thereof are intended to cover a non exclusive inclusion such that a process method article or apparatus that comprises has includes contains a list of elements does not include only those elements but may include other elements not expressly listed or inherent to such process method article or apparatus. An element proceeded by comprises . . . a has . . . a includes . . . a contains . . . a does not without more constraints preclude the existence of additional identical elements in the process method article or apparatus that comprises has includes contains the element. The terms a and an are defined as one or more unless explicitly stated otherwise herein. The terms substantially essentially approximately about or any other version thereof are defined as being close to as understood by one of ordinary skill in the art and in one non limiting embodiment the term is defined to be within 10 in another embodiment within 5 in another embodiment within 1 and in another embodiment within 0.5 . The term coupled as used herein is defined as connected although not necessarily directly and not necessarily mechanically. A device or structure that is configured in a certain way is configured in at least that way but may also be configured in ways that are not listed.

It will be appreciated that some embodiments may be comprised of one or more generic or specialized processors or processing devices such as microprocessors digital signal processors customized processors and field programmable gate arrays FPGAs and unique stored program instructions including both software and firmware that control the one or more processors to implement in conjunction with certain non processor circuits some most or all of the functions of the method and apparatus for generating location signals described herein. The non processor circuits may include but are not limited to a radio receiver a radio transmitter signal drivers clock circuits power source circuits and user input devices. As such these functions may be interpreted as steps of a method to perform generating location signals described herein. Alternatively some or all functions could be implemented by a state machine that has no stored program instructions or in one or more application specific integrated circuits ASICs in which each function or some combinations of certain of the functions are implemented as custom logic. Of course a combination of the two approaches could be used. Both the state machine and ASIC are considered herein as a processing device for purposes of the foregoing discussion and claim language.

Moreover an embodiment can be implemented as a computer readable storage element or medium having computer readable code stored thereon for programming a computer e.g. comprising a processing device to perform a method as described and claimed herein. Examples of such computer readable storage elements include but are not limited to a hard disk a CD ROM an optical storage device a magnetic storage device a ROM Read Only Memory a PROM Programmable Read Only Memory an EPROM Erasable Programmable Read Only Memory an EEPROM Electrically Erasable Programmable Read Only Memory and a Flash memory. Further it is expected that one of ordinary skill notwithstanding possibly significant effort and many design choices motivated by for example available time current technology and economic considerations when guided by the concepts and principles disclosed herein will be readily capable of generating such software instructions and programs and ICs with minimal experimentation.

The Abstract of the Disclosure is provided to allow the reader to quickly ascertain the nature of the technical disclosure. It is submitted with the understanding that it will not be used to interpret or limit the scope or meaning of the claims. In addition in the foregoing Detailed Description it can be seen that various features are grouped together in various embodiments for the purpose of streamlining the disclosure. This method of disclosure is not to be interpreted as reflecting an intention that the claimed embodiments require more features than are expressly recited in each claim. Rather as the following claims reflect inventive subject matter lies in less than all features of a single disclosed embodiment. Thus the following claims are hereby incorporated into the Detailed Description with each claim standing on its own as a separately claimed subject matter.

