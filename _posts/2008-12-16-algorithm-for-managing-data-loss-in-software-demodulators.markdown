---

title: Algorithm for managing data loss in software demodulators
abstract: Embodiments of methods for receiving and processing multi-band signals in wideband and narrowband environments are described herein. Other embodiments may be described and claimed.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08059687&OS=08059687&RS=08059687
owner: Intel Corporation
number: 08059687
owner_city: Santa Clara
owner_country: US
publication_date: 20081216
---
The field of invention relates generally to a multi band wireless system and more specifically but not exclusively relates to methods for receiving and processing multi band signals in wideband and or narrowband environments.

Technological developments permit digitization of large amounts of voice video imaging and data information from a transmitting station to a receiving station. One emerging application is the deployment of digital television including handheld oriented broadcast services that can withstand mobility of the receiving stations. For example digital video broadcasting handheld DVB H and terrestrial digital multimedia broadcasting T DMB are deployed in mobile TV applications while digital video broadcasting terrestrial DVB T is already widely deployed for nomadic to portable reception conditions.

The need to transfer data between stations in wireless radio communication requires transfer of a reliable data stream between stations and internally within each station. Depending upon underlying transfer mechanisms certain data transfers may require the buffering and storage of data blocks. For example in a universal serial bus USB implementation isochronous data transfers may be utilized to transmit digital television data to a storage location before demodulation by a software demodulator. Incoming isochronous data flows when stored in a fixed buffer location can lead to buffer overruns and data loss if the data is not regularly transferred from the buffer to a processor leading to data synchronization issues.

In the following detailed description numerous specific details are set forth in order to provide a thorough understanding of the invention. However it will be understood by those skilled in the art that the present invention may be practiced without these specific details. In other instances well known methods procedures components and circuits have not been described in detail so as not to obscure the present invention.

Embodiments of methods and systems for managing data loss in a computing system are described herein. In the following description numerous specific details are set forth such as a description of a mechanism for reducing or eliminating data transfer synchronization errors in multi band wireless systems to provide a thorough understanding of embodiments of the invention. One skilled in the relevant art will recognize however that the invention can be practiced without one or more of the specific details or with other methods components materials etc. In other instances well known structures materials or operations are not shown or described in detail to avoid obscuring aspects of the invention.

It would be an advance in the art to provide a data synchronization mechanism for multi band wireless systems communicating over a plurality channels or spectrum bands to provide a non interrupted broadcast stream. As an example wireless stations may comprise a host processor a flash memory device a random access memory and a transceiver configured to communicate either sequentially or simultaneously over narrowband and wideband channels.

In one embodiment a method for maintaining synchronization of data packets may comprise partitioning the data packets into a plurality of blocks with headers. A continuity counter is added to the header of each block of the plurality of blocks and the plurality of blocks is stored in a buffer memory. An availability of a communication channel is monitored and one or more of the plurality of blocks is erased when the communication channel is not available. The continuity counters are monitored to determine if one or more blocks have been erased and pseudo noise samples are inserted to replace the one or more erased blocks.

Now turning to the figures illustrates various components of a networking environment which may be utilized to implement various embodiments discussed herein. The environment may include a network to enable communication between various devices such as a server a desktop computer such as for example a workstation or a desktop computer a laptop netbook or notebook computer a reproduction device such as for example a network printer copier facsimile scanner all in one device etc. a wireless access point which may comprise a cellular base station in various embodiments and a personal digital assistant smartphone or mobile device . The network may be any type of types of a computer network including an intranet the Internet and or combinations thereof.

The devices may communicate with the network through wired and or wireless connections. Hence the network may be a wired and or wireless network. For example as illustrated in the wireless access point may be coupled to the network to enable other wireless capable devices such as the device for example to communicate with the network . In various embodiments the wireless access point may include traffic management capabilities. Also data communicated between the devices may be encrypted or cryptographically secured to limit unauthorized access.

The network may utilize any communication protocol such as Ethernet Fast Ethernet Gigabit Ethernet wide area network WAN fiber distributed data interface FDDI Token Ring leased line analog modem digital subscriber line DSL and its varieties such as high bit rate DSL HDSL integrated services digital network DSL IDSL etc. asynchronous transfer mode ATM cable modem and or FireWire.

Wireless communication through the network may be in accordance with one or more of the following wireless local area network WLAN wireless wide area network WWAN code division multiple access CDMA cellular radiotelephone communication systems global system for mobile communications GSM cellular radiotelephone systems North American Digital Cellular NADC cellular radiotelephone systems time division multiple access TDMA systems extended TDMA E TDMA cellular radiotelephone systems third generation partnership project 3G systems such as wide band CDMA WCDMA etc. Moreover network communication may be established by internal network interface devices e.g. present within the same physical enclosure as a computing system such as a network interface card NIC or external network interface devices e.g. having a separate physical enclosure and or power supply than the computing system to which it is coupled .

Further digital television signals may be communicated along wideband and narrowband channels in the networking environment . Examples of wideband channel data in frequencies ranging from 5 to 8 megahertz MHz comprise digital video broadcasting terrestrial DVB T and or digital video broadcasting handheld DVB H applications. Examples of narrowband channel data in frequencies substantially at or near 1.5 MHz include terrestrial digital multimedia broadcasting T DMB digital audio broadcast DAB and single segment integrated services digital broadcasting terrestrial ISDB T applications. The narrowband and or wideband channel data is demodulated using hardware and or software means by one or more of the devices .

A continuity counter is provided in each header which in one example is a byte wide though the embodiment is not so limited. In another embodiment the header may be several blocks wide depending on the information provided in each header. The continuity counter in this example is a modulo counter that counts from 1 to 255 before rolling back to a zero 0 value. The continuity counter is incremented by one for every block that is to be transferred.

An availability of a communications channel such as a pathway provided by a universal serial bus USB is monitored for availability in element . The buffer continues to collect and store incoming data packets until the buffer space has reached a given capacity which may be equal to the total storage capacity of the buffer or some other portion of the total capacity. If the communications channel is busy at the time that the buffer has reached capacity according to element then one or more blocks are erased in element until the communications channel become available in element . If the buffer is at capacity but the communications channel is available then the plurality of blocks is transferred in element . The continuity counters in headers of the plurality of blocks are monitored in one embodiment by a host processor in element to determine if one or more blocks have been erased as indicated in element . The host processor determines a number of lost blocks through a relationship described in the continuity counter equation Blocks lost 1 1 mod 256

As another example if 256 blocks are lost the continuity counter equation would return a value of Blocks lost 0. At this point synchronization might be lost. This may be overcome by choosing a continuity counter that is greater than 1 byte or 8 bits in length. In another embodiment a synchronization byte is added to the header in addition to the continuity counter resulting in 130 byte samples. In this embodiment the host processor receives a sequence of bytes and will have to achieve byte synchronization at the start after locking onto several successive synch bytes that are 130 samples apart. The addition of a synch byte allows the software demodulator executed by the host processor to operate without loss of synchronization.

If it has been determined that blocks have been erased then pseudo noise samples are inserted to replace the erased blocks in element to provide a synchronized set of blocks. In one embodiment the pseudo noise samples are normally distributed zero mean pseudo noise samples with a same variance as the data blocks. The synchronized set of data blocks are processed by the host processor using the software demodulator in element to provide a demodulated transport stream. Examples of the demodulated stream may be one or more of a DAB T DMB or a ISDB T transport stream.

The processor may include one or more caches which may be private and or shared in various embodiments. Generally a cache stores data corresponding to original data stored elsewhere or computed earlier. To reduce memory access latency once data is stored in a cache future use may be made by accessing a cached copy rather than refetching or recomputing the original data. The cache may be any type of cache such a level 1 L1 cache a level 2 L2 cache a level 3 L 3 a mid level cache a last level cache LLC etc. to store electronic data e.g. including instructions that is utilized by one or more components of the computing system .

A chipset may additionally be coupled to the interconnection network . The chipset may include a memory control hub MCH . The MCH may include a memory controller that is coupled to a memory . The memory may store data e.g. including sequences of instructions that are executed by the processor or any other device in communication with components of the computing system . In various embodiments the memory may include one or more volatile storage or memory devices such as random access memory RAM dynamic RAM DRAM synchronous DRAM SDRAM static RAM SRAM etc. Nonvolatile memory may also be utilized such as a hard disk. Additional devices may be coupled to the interconnection network such as multiple processors and or multiple system memories.

The MCH may further include a graphics interface coupled to a display e.g. via a graphics accelerator. In various embodiments the graphics interface may be coupled to the display device via an accelerated graphics port AGP . In various embodiments the display device which for example may include a flat panel display or a cathode ray tube may be coupled to the graphics interface through for example a signal converter that translates a digital representation of an image stored in a storage device such as video memory or system memory into display signals that are interpreted and displayed by the display. The display signals produced by the display device may pass through various control devices before being interpreted by and subsequently displayed on the display device .

As shown in a hub interface may couple the MCH to an input output control hub ICH . The ICH may provide an interface to input output I O devices coupled to the computing system . The ICH may be coupled to a bus through a peripheral bridge or host controller such as a peripheral component interconnect PCI bridge a universal serial bus USB controller etc. The controller may provide a data path between the processor and peripheral devices. Other types of topologies may be utilized. Also multiple buses may be coupled to the ICH for example through multiple bridges or controllers. For example the bus may comply with the Universal Serial Bus Specification Revision 1.1 Sep. 23 1998 and or Universal Serial Bus Specification Revision 2.0 Apr. 27 2000 including subsequent amendments to either revision . Alternatively the bus may comprise other types and configurations of bus systems. Moreover other peripherals coupled to the ICH may include in various embodiments integrated drive electronics IDE or small computer system interface SCSI hard drive s USB port s a keyboard a mouse parallel port s serial port s floppy disk drive s digital output support e.g. digital video interface DVI etc.

The bus may be coupled to an audio device one or more disk drive s and a communication device which in various embodiments may be a network interface card NIC or a tuner card. Other devices may be coupled to the bus . Also various components such as the communication device may be coupled to the MCH in various embodiments. In addition the processor and the MCH may be combined to form a single chip.

Additionally the computing system may include volatile and or nonvolatile memory or storage. For example nonvolatile memory may include one or more of the following read only memory ROM programmable ROM PROM erasable PROM EPROM electrically EPROM EEPROM a disk drive e.g. a floppy disk a compact disk ROM CD ROM a digital versatile disk DVD flash memory a magneto optical disk or other types of nonvolatile machine readable media capable of storing electronic data including instructions.

The memory may include one or more of the following in various embodiments an operating system O S application device driver buffers function driver and or protocol driver . Programs and or data stored in the memory may be swapped into the disk drive as part of memory management operations. The processor s executes various commands and processes one or more packets with one or more computing devices coupled to the network such as the devices of . In various embodiments a packet may be a sequence of one or more symbols and or values that may be encoded by one or more electrical signals transmitted from at least one sender to at least one receiver e.g. over a network such as the network . For example each packet may have a header A that includes information that may be utilized in routing and or processing of the packet may comprise the continuity counter a sync byte source address a destination address packet type etc. Each packet may also have a payload B that includes the raw data or content the packet is transferring between various computing devices for example the devices of over a computer network such as the network .

In various embodiments the application may utilize the O S to communicate with various components of the computing system e.g. through the device driver and or function driver . For example the device driver and function driver may be used for different categories e.g. device driver may manage generic device class attributes whereas the function driver may manage device specific attributes such as USB specific commands . In various embodiments the device driver may allocate one or more buffers A through M to store packet data such as the packet payload B. One or more descriptors not shown may respectively point to the buffers . In various embodiments one or more of the buffers may be implemented as circular ring buffers. Also one or more of the buffers may correspond to contiguous memory pages in various embodiments. Furthermore a protocol driver may implement a protocol driver to process packets communicated over the network according to one or more protocols. In accordance with various embodiments as discussed herein forth reference to function driver may or may not refer to other types of drivers e.g. including device driver function driver and or protocol driver .

As illustrated in the communication device may include a network protocol layer for implementing the physical communication layer to send and receive network packets to and from remote devices over the network . The network may include any type of computer network such as those discussed with reference to . The communication device may further include a direct memory access DMA engine which may write packet data to buffers to transmit and or receive data over the network . Additionally the communication device may include a controller which may include logic such as a programmable processor for example to perform communication device related operations. In various embodiments the controller may be a MAC media access control component. The communication device may further include a memory such as any type of volatile nonvolatile memory e.g. including one or more cache s and or other memory types discussed with reference to memory .

In various embodiments the communication device may include a firmware storage device to store firmware or software that may be utilized in management of various functions performed by components of the communication device . The storage device may be any type of a storage device such as a non volatile storage device. For example the storage device may include one or more of the following ROM PROM EPROM EEPROM disk drive floppy disk CD ROM DVD flash memory a magneto optical disk or other types of nonvolatile machine readable media capable of storing electronic data including instructions.

In various embodiments communication device may include or comprise a USB tuner card configured to receive and process multimedia information. The tuner card may comprise a component that receives digital television signals for any of devices described in . In various embodiments the tuner card may also function as video capture card allowing the card to record multimedia information onto a hard disk. In various embodiments the tuner card may comprise a USB express card a USB mini card a USB half mini card or any other suitable USB form factor card. The tuner card may contain a receiver tuner hardware demodulator and an analog to digital converter in various embodiments.

In various embodiments the multimedia information comprises a digital television signal sent over network from a media source not shown to the communication device . The multimedia information may comprise a constant bit rate signal for a given modulation rate code rate and guard interval. The multimedia information may comprise generic coding of moving pictures and associated audio information. In various embodiments the multimedia information comprises a DAB T DMB ISDB T DVB T H or MPEG2 transport stream. The multimedia information may contain multiple digital television channels or logical streams in each physical channel received from the media source. For example the multimedia information may comprise various digital television channels such as BBC 1 BBC 2 BBC 3 and BBC 4 in a single physical channel.

In various embodiments the received multimedia information is converted from an analog signal to a digital signal using an analog to digital converter in the tuner card. In one embodiment demodulation of wideband signals may also occur in the tuner card using a hardware demodulator. Demodulation may occur within the tuner card and or part of the demodulation may occur outside the tuner card for example by the CPU . In various embodiments the filtered multimedia information is sent from the communication device to the chipset over bus . As a result of the processing performed in the communication device the multimedia information sent over bus to chipset comprises variable bit rate data even though the information received from the media source comprises constant bit rate data.

In various embodiments bus may comprise a USB bus. Isochronous mode is one of the four data flow types for USB devices the others being Control Interrupt and Bulk . Isochronous mode is commonly used for streaming multimedia data types such as video or audio sources. In isochronous mode a device can reserve bandwidth on the bus making isochronous mode desirable for multimedia applications. In various embodiments the data transfer described herein utilizes isochronous mode.

Device driver may comprise a component that handles interactions between memory and any of the elements of computing system for example. Device driver may be responsible for allocating and managing buffers A and B. In various embodiments device driver allocates USB buffers A to be as large as the USB processing stack will allow. Device driver may also allocate media buffers B the size of media buffers B selected to reduce or eliminate latency when the multimedia information is retrieved.

USB buffers A may comprise a permanent or temporary allocation of memory to store multimedia information. As shown in the multimedia information stored in USB buffers A may comprise contiguous or non contiguous data. If a system operating in isochronous mode attempts to retrieve the multimedia information stored in USB buffers A contiguous data is transferred in an orderly manner without loss of synchronization and non contiguous data may be transformed into contiguous data as provided by embodiments of the invention.

In various embodiments device driver controls the making of a copy of the multimedia information from USB buffers A to media buffers B. In a case of non contiguous data missing blocks of multimedia information may be replaced with pseudo noise samples as provided in element of to resolve potential synchronization errors when processed by the software demodulator at the processor . The pseudo noise samples may be noise samples saved in a memory and or the pseudo noise samples may be generated using an optional pseudo number generator not shown .

Media control engine may comprise a component that controls requests for multimedia information. An example of a media control engine is the Microsoft DirectShow application programming interface API by Microsoft Corporation of Redmond Wash. DirectShow is a media streaming architecture for the Microsoft Windows platform that allows applications to perform high quality video and audio playback or capture. In various embodiments media control engine may retrieve requested multimedia data from media buffers B to fulfill requests for specific multimedia information for example a specific television channel or program and provide the requested information to processor for further processing and playback.

The narrowband channel data is directed to decimation to reduce a number of samples to be provided for software demodulation. Decimation removes in a predictable and orderly manner the number of samples transferred to a hardware data collection module . In another embodiment not shown demodulation is eliminated or reduced as software and processor capabilities allow higher throughput of sampled data. The hardware data collection module HDCM is a memory module or buffer and operates as previously described in . The buffered data from the HDCM is transferred to the USB interface when a communications channel is available to the host processor to demodulate the narrowband data using a software demodulator.

A plurality of samples is received in a buffer in element such as the HDCM of . The plurality of samples collect in the buffer until the buffer reaches a capacity in element . If a communications channel such as the USB interface of is busy when the buffer reaches capacity then one or more samples are erased in element . Otherwise the samples are directed to a software demodulator to process a contiguous sample stream in element . The number of samples erased is determined in element and the unique header pattern is transferred to the processor in element to indicate a discontiguous data stream. A fixed length word is transmitted to the processor in element to indicate the number of samples erased. In one embodiment the fixed length word is two bytes in length. In other embodiments the fixed length word is one byte in length or greater than two bytes in length. Pseudo noise samples are inserted to replace the erased samples in element either through generation of pseudo noise samples by the processor or by replacing the erased samples with pseudo noise samples from a memory location to provide a contiguous sample stream. The contiguous sample stream is processed in element by the processor .

Embodiments of this invention may be used as or to support a software program executed upon some form of processing core such as a processor of a computer or otherwise implemented or realized upon or within a machine readable medium. A machine readable medium includes any mechanism for storing information in a form readable by a machine e.g. a computer . For example a machine readable medium can include such as a read only memory ROM a random access memory RAM a magnetic disk storage media an optical storage media and a flash memory device etc.

Reference throughout this specification to one embodiment or an embodiment means that a particular feature structure or characteristic described in connection with the embodiment is included in at least one embodiment of the present invention. Thus the appearances of the phrases in one embodiment or in an embodiment in various places throughout this specification are not necessarily all referring to the same embodiment. Furthermore the particular features structures or characteristics may be combined in any suitable manner in one or more embodiments.

Modifications may be made to the invention in light of the above detailed description. The terms used in the following claims should not be construed to limit the invention to the specific embodiments disclosed in the specification and the drawings. Rather the scope of the invention is to be determined entirely by the following claims which are to be construed in accordance with established doctrines of claim interpretation.

