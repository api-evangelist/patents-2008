---

title: Authentication with an untrusted root
abstract: Techniques and systems for authentication with an untrusted root between a client and a server are disclosed. In some aspects, a client may connect to a server. The server and client may initiate a secure connection by exchanging certificates. The server may accept a client certificate having an untrusted root that does not chain up to a root certificate verifiable to the server certificate authority. In further aspects, the server may enable the client to associate an untrusted certificate with an existing account associated with the server. The client certificate may be hardware based or generated in software, and may be issued to the client independent of interactions with the server.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08924714&OS=08924714&RS=08924714
owner: Microsoft Corporation
number: 08924714
owner_city: Redmond
owner_country: US
publication_date: 20080627
---
Important networked resources are being made accessible over computer networks in ever greater frequency. An increased effort to ensure secure connections follows as more data is exchanged via networks which are exposed to threats such as hacking schemes that comprise security. Access to less sensitive or valuable networked resources may be sufficiently controlled based on logon identities and passwords. However other networked resources may require enhanced protection provided by more complex authentication methods and systems.

Certificate initiated authentication is significantly more secure than a password initiated authentication. Typically a process of authenticating a client and a server requires a shared hierarchical structure that enables both the client and the server to verify the authenticity of one another s certificates. In some instances the client may have received a certificate directly from the server such as when a server host issues the client a smartcard that includes the certificate. Today if an entity wants to use a certificate initiated authentication such as public key infrastructure PKI identity for its customers the entity has to act as a certificate authority CA and issue a new identity for the customer.

The process of issuing the new identity and configuring the secure connection with the certificate does not scale well for either the entity or the customer. Certificates are expensive require hierarchy trust chain and take time and resources to configure.

This Summary is provided to introduce a selection of concepts in a simplified form that is further described below in the Detailed Description. This Summary is not intended to identify key features or essential features of the claimed subject matter nor is it intended to be used to limit the scope of the claimed subject matter.

Techniques and systems for authentication with an untrusted root between a client and a server are disclosed. In one or more aspects a client may connect to a server. The server and client may initiate a secure connection by exchanging certificates. The server may accept a client certificate that does not chain up to a root certificate verifiable to the server certificate authority.

In further aspects the server may enable the client to associate an untrusted certificate with an existing account associated with the server. The server may associate the certificate directly with the account during subsequent connections with the client.

The client certificate and private key may be stored as an algorithm and hardwired into an integrated circuit card e.g. on a smartcard etc. or the client certificate and private key may be stored in a computer readable media on the client machine or elsewhere. In some aspects the client may be directed to generate or cause to generate a certificate prior to or during a request for a certificate from the server.

Other embodiments will become more apparent from the following detailed description when taken in conjunction with the accompanying drawings.

This disclosure is directed to embodiments that facilitate authentication by a target server of a client having an untrusted root. In one or more embodiments of the disclosure the client is assumed to either 1 have a certificate available such as in a government issued identification card ID card an employer ID card a mobile phone having certificate etc. or 2 obtain a custom generated certificate such as by obtaining a smart card acquiring a software based certificate or obtaining a certificate from another third party source. The client may identify itself and establish a secure channel with the server without having the certificate chain up to a root that the server trusts. However the client has to configure the certificate to enable authentication with the server without relying on a traditional hierarchy or distribution of certificates issued from the target server. Various examples of authenticating a client with an untrusted root on a server are described below with reference to .

The target server may be in communication with one or more authentication servers . The authentication servers may be connected to the target server by a wired connection e.g. LAN WAN etc. or a wireless connection e.g. cellular WiFi Ultrawideband etc. . The authentication servers may have a root certificate . The authentication servers may be a certificate authority CA and issue a server certificate to the target server . In some embodiments the authentication servers may authenticate the server certificate for the target server during an authentication process between the target server and the client . For example the authentication servers may issue the server certificate to the target server which may then transmit the server certificate to the client during an authentication process such as a symmetric key encryption process.

In one or more embodiments the user may present an identity for authentication to the authentication server via the client by transmitting a client certificate to the target server . For example in some embodiments the client certificate and associated private key that is stored as an algorithm that is hardwired into an integrated circuit card ICC also known as a smart card. Hardware based certificates and private keys may also be hardwired in other hardware based devices such as universal serial bus USB memory devices and secure digital SD cards which may also include volatile or non volatile memory. In other embodiments the client certificate may be in the form of software data stored in a computer readable storage media such as a hard drive connected to the client a storage database associated with a web server a USB drive or another computer readable storage device accessible by the client .

Accordingly in instances where a hardware based authentication is implemented the user may authenticate the user s identity to the authentication server by presenting the client certificate . A certificate such as the client certificate may contain a public key which is associated with a private key stored in a location accessible to the client e.g. smart card file system registry etc . A smart card reader may relay signals from the smart card to the client via an interactive link. Nevertheless it will be appreciated that in alternative instances the identity certificates and or one or more cryptographic keys may be further stored in other computer readable media including flash drives radio frequency identification RFID tags as well as other portable data storage devices.

The user may authenticate the user s identity to the target server via a variety of authentication protocols. These authentication protocols may include without limitation a Transport Layer Security TLS protocol a Secure Sockets Layer SSL protocol a NT LAN Manager NTLM protocol a Kerberos protocol a Web Services WS security protocol and a Public Key Cryptography for Initial Authentication in Kerberos PKINIT protocol. Typically these forms of authentication protocols do not occur at the message layer using a user ID and password or tokens but occur during the connection handshake using certificates.

In one or more embodiments the user may have an issued certificate . For example the user may have been issued a national or government ID which includes a certificate e.g. a smartcard etc. . The issued certificate may not be associated with the target server the authentication servers or chain up to the hierarchical structure .

The user may receive a request from the target server to transmit the issued certificate to authenticate a connection between the client and the target server. The user may insert the issued certificate into storage media reader which may facilitate transmission of the issued certificate to target server via the client .

In other embodiments the user may not have an issued certificate . For example the user s government agencies may not issue certificates on smartcards. In such instances the user may obtain a generic certificate . The generic certificate may not be associated with the user . For example the user may purchase the generic certificate in a marketplace such as an electronics store a grocery store or a convenience store. The user may insert the generic certificate into the storage media reader when the target server requests a certificate from the user .

In further embodiments the user may generate a certificate which may be stored in a computer readable media. A generated certificate may be generated by software installed on the client or may be generated by a third party such as an online retailer. The generated certificate may be encrypted on computer readable media made accessible to the client . The user may transmit the generated certificate to the target server via the client to initiate a secure connection upon receiving a certificate request from the target server.

As shown in at the client may transmit a client hello message to the target server along with a client random value associated with the client and supported cipher suites. For example the user may connect to the target server through a website which may enable access to the user s financial information confidential information or information the user desires to protect from third party interception modification or exploitation. During a connection with the target server the client may transmit the client hello and package with the client random value. At the target server receives the client hello and package with the client random value.

At the target server may transmit a server hello and server random number to the client . The client may receive the server hello and the server random value at . In addition the target server may also send the server certificate to the client and request the client certificate from the client at . The server certificate may have been issued to the target server as an intermediate certificate authority which may be verified by the authentication servers that may be the root certificate or otherwise chain up from the target server. Thus the authenticity of the server certificate may be supported by the authentication servers to enable the user to trust the identity of the target server . At the client receives the server certificate and request for the client certificate .

In one or more embodiments the user may direct the client to obtain the client certificate having an untrusted root and transmit the client certificate to the target server at . For example the user may insert the issued certificate e.g. a national ID smart card into the storage media reader e.g. a smart card reader etc. which is connected to the client for transmission to the target server via the network . The user may also direct the client to retrieve the client certificate from a computer readable media such as the client s hard drive a flash USB device an SD card or other computer readable media in connection with the client. In some embodiments the client may provide a user interface that enables the user to select a certificate type and location such as by browsing client s folders to locate a certificate accessible to the client.

In accordance with embodiments the target server may receive the client certificate at . Typically when a server receives a certificate with an untrusted root an error is returned and the authentication process is terminated. However in one or more embodiments of the disclosure the target server may accept the client certificate at as a valid certificate but with an untrusted root. The target server may allow the authentication to complete such as a transport layer security TLS authentication and stores the client certificate as associated to a socket and or session. The security context of the authentication may be set to a level associated with the untrusted root such as a guest security context until further validation has occurred. For example the certificate may be matched to a user account by a server application running on the target server such as by matching the certificate to a known username and password. In some embodiments the target server s authentication protocol may be modified to add a guest security context to enable acceptance of the client certificate having an untrusted root. The target server may implement the modified protocol that allows for out of band identity verification rather than traditional chain building via a hierarchical structure on the client side. In embodiments the target server may effectively use the public key as a password replacement.

At the client may create a pre master secret encrypt it with the public key from the server certificate and transmit the encrypted pre master secret to the target server . The target server may receive the encrypted pre master secret at . At the target server generates a master secret and session keys based on the pre master secret. At the client may generate a master secret and session keys based on the pre master secret. At the client transmits a change cipher specification notification to the target server to indicate that the client will start using the new session keys for hashing and encrypting messages. The client may also send a client finished message to the target server at . At the target server receives the change cipher specification message from the client and switches the server s record layer security state to symmetric encryption using the session keys. At the target server also sends a server finished message to the client .

In accordance with one or more embodiments at the client and the target server may now exchange data over the secured channel the client and target server have established in the process . The data that is exchanged between the client and server is encrypted using the session key.

At the client may connect to the target server . The target server requests proof of the client identity at . For example the target server may cause the client to display a login and password user interface for manipulation by the user . At the client satisfies the request of proof of client identity from . For example the user may enter the username and the password associated with a user account.

At the target server may provide an option to enable the user via the client to associate the user account with the issued certificate encoded in hardware from . For example the target server may cause the client to display a user interface that enables the user to selectively associate the issued certificate to the user account. At the client may transmit the issued certificate to the target server . At the target server may associate the issued certificate to the user account. Additionally the target server may allow an authentication protocol such as a TLS protocol to complete despite the issued certificate having an untrusted root by the target server.

In one or more embodiments the process may accept the issued certificate before the user via the client proves the user s identity to the target server to associate the user account with the issued certificate. Alternatively or additionally the target server may associate the user account with the user and client and then request the client to provide an issued certificate for association with the user account. Further the user may use the issued certificate instead of the user login and password or other identification methods to gain access to the target server after the process is successfully completed. Thus the target server may map the user account to the issued certificate and associate a security token to that session enabling the user to access the user account without additional data entry or requests from the target server.

In accordance with one or more embodiments via the user the client may obtain a generic certificate e.g. the generic certificate of encoded in hardware at . For example the generic certificate may be acquired in a marketplace such as an electronics store an online retailer a grocery store or a convenience store. The user may insert the generic certificate into the storage media reader in communication with the client when the target server requests a certificate from the user . The generic certificate typically does not have a trusted root and is unrelated to the target server . Acceptance of the generic certificate by the target server may be advantageous to shift the cost of the certificate to the user to enable the user to use certificates for multiple servers that are unrelated on each other to enable quick replacement of lost or damaged certificates or for other reasons.

In accordance with one or more embodiments the user may obtain a generated certificate e.g. the generated certificate of at . The generated certificate may be generated by software installed on the client or may be generated by a third party such as an online retailer. In some embodiments the user may log into another server to obtain a software based generated certificate to transmit to the target server . The user may also download a software based certificate to the client and then transmit the certificate to the target server such as via an upload user interface on the client. In further embodiments a cloud service may enable a user to manage one or more certificates which could be downloaded to a user device such as the client or may be used by directing the target server to obtain the generated certificate from the cloud service or vice versa . The generated certificate may enable the user to log into the target server with an additional identity other than an identity established in a previous session or anonymously such as when the issued certificate is used to log into the target server.

Each server e.g. the target server may require different levels of proof of identity before associating the generated certificate or any other certificate to the user . For example the target server may require a user account association validation of an email address or other identify verification steps before associating the certificate having an untrusted root to the user .

Continuing with the client initiates transmission of the generated certificate to the target server at . At the target server may associate the generated certificate to the user account. Additionally the target server may allow an authentication protocol such as a TLS protocol to complete despite the generated certificate having an untrusted root by the target server.

In further embodiments the user may transmit the certificate to the target server by simply connecting with the user interface such as by directing the user s browser residing on the client to navigate to a uniform resource locator URL associated with the target server . The target server may recognize the client and search for the certificate in a predetermined location such as the last location used for the client. Additionally or alternatively the user may insert a certificate into a storage media reader when the client has navigated to the user interface which may then initiate a secure connection between the client and the target server without further action by the user .

The second portion of the user interface may enable the user to associate an existing account with a certificate. In one or more embodiments a login prompt may enable a user to enter information such as a username and password to gain access to a user account. At the user may also locate a certificate to associate the certificate with the user account related to the login prompt .

In a very basic configuration the computing device typically includes at least one processing unit and system memory . Depending on the exact configuration and type of computing device the system memory may be volatile such as RAM non volatile such as ROM flash memory etc. or some combination of the two. The system memory typically includes an operating system one or more program modules and may include program data . The operating system includes a component based framework that supports components including properties and events objects inheritance polymorphism reflection and provides an object oriented component based application programming interface API . The computing device is of a very basic configuration demarcated by a dashed line . Again a terminal may have fewer components but will interact with a computing device that may have such a basic configuration.

The computing device may have additional features or functionality. For example the computing device may also include additional data storage devices removable and or non removable such as for example magnetic disks optical disks or tape. Such additional storage is illustrated in by removable storage and non removable storage . Computer storage media may include volatile and nonvolatile removable and non removable media implemented in any method or technology for storage of information such as computer readable instructions data structures program modules or other data. The system memory the removable storage and the non removable storage are all examples of computer storage media. The computer storage media includes but is not limited to RAM ROM EEPROM flash memory or other memory technology CD ROM digital versatile disks DVD or other optical storage magnetic cassettes magnetic tape magnetic disk storage or other magnetic storage devices or any other medium which can be used to store the desired information and which can be accessed by the computing device . Any such computer storage media may be part of the computing device . The computing device may also have input device s such as keyboard mouse pen voice input device touch input device etc. Output device s such as a display speakers printer etc. may also be included. These devices are well know in the art and are not discussed at length here.

The computing device may also contain communication connections that allow the device to communicate with other computing devices such as over a network. These networks may include wired networks as well as wireless networks. The communication connections are one example of communication media. The communication media may typically be embodied by computer readable instructions data structures program modules etc.

It is appreciated that the illustrated computing device is only one example of a suitable device and is not intended to suggest any limitation as to the scope of use or functionality of the various embodiments described. Other well known computing devices systems environments and or configurations that may be suitable for use with the embodiments include but are not limited to personal computers server computers hand held or laptop devices multiprocessor systems microprocessor base systems set top boxes game consoles programmable consumer electronics network PCs minicomputers mainframe computers distributed computing environments that include any of the above systems or devices and or the like.

An implementation of authentication using an untrusted root may enable users to access a target server with a client using a more secure connection. This enhanced security may be especially important for the protection of high end valuable expensive or sensitive resources applications or data. Distribution of client certificates is simplified by allowing the user to use an issued certificate from another source a generic certificate or a generated certificate. Therefore the expense of the certificate is shifted to the user no hierarchy trust chain is necessary and configuration requires less time and resources.

In closing although the various embodiments have been described in language specific to structural features and or methodological acts it is to be understood that the subject matter defined in the appended representations is not necessarily limited to the specific features or acts described. Rather the specific features and acts are disclosed as exemplary forms of implementing the claimed subject matter.

