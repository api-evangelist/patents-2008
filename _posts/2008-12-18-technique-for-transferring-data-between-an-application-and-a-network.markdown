---

title: Technique for transferring data between an application and a network
abstract: A technique for transferring data between an application and at least two Radio Access Technology (RAT) modules selectively connectable to a network is described. A device embodiment of this technique comprises a storage adapted to hold data from the application, the data being intended to be transmitted via at least one of the RAT modules. Furthermore, the device comprises a first control mechanism adapted to initiate holding of the data in the storage when the RAT modules assume the same connection state. The connection state is selected from a connected state in which data transmission via the respective RAT is enabled and a disconnected state in which data transmission via the respective RAT is disabled. The device also comprises a second control mechanism adapted to initiate sending of the data held in the storage to the RAT module assuming the connected state when the RAT modules assumed different connection states again.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08873506&OS=08873506&RS=08873506
owner: Telefonaktiebolaget L M Ericsson (publ)
number: 08873506
owner_city: Stockholm
owner_country: SE
publication_date: 20081218
---
This application claims the benefit of U.S. Provisional Application No. 61 053 765 filed May 16 2008 and U.S. Provisional Application No. 61 053 776 filed May 16 2008 the disclosures of which are fully incorporated herein by reference.

The present disclosure generally relates to the provision of network access via a Radio Access Technology RAT . In particular the disclosure is directed to a technique for transferring data between an application and two or more RAT modules that are selectively connectable to a network.

As wireless Network Access Points NAPs are becoming ubiquitous it is only a logical consequence that many mobile devices support more than one RAT to offer an increased connectivity. In this regard US 2007 0173283 A1 describes an exemplary mobile device supporting two different RATs. Specifically the mobile device comprises a first module providing network access according to the Universal Mobile Telecommunications System UMTS specifications and a second module network providing access to a Wireless Local Area Network WLAN .

Such multi RAT devices are typically designed to permit a handover between the internal RATs IRAT handover . IRAT handovers may for example be performed in case coverage of one RAT is fading or another RAT with better Quality of Service QoS parameters becomes locally available. For the coordination of IRAT handovers in US 2007 0173283 A1 a mobility middleware function is proposed. The mobility middleware function comprises an IRAT handover functionality that performs seamless handover between the UMTS network and the WLAN with the purpose of providing service continuity to a user.

Multi RAT devices as those discussed in US 2007 0173283 A1 suffer from the drawbacks that a seamless handover typically requires a data connection between the RAT modules and an associated control mechanism for inter module data transfer. Such an inter module data connection is required for the following reason. When a handover from a first RAT supported by a first RAT module to a second RAT supported by a second RAT module is in progress the uplink data from a user application are during the handover phase still sent to the first RAT module. Has the handover to the second RAT been successful the first RAT module will thus typically still have user data in its local buffers that has not been transmitted. This user data will have to be transferred via the data connection to the second RAT module for transmission. Otherwise i.e. if the user data buffered by the first RAT module is simply discarded problems on the network side which may still be expecting the buffered user data and on the side of the mobile device e.g. an instability of the user application that is expecting response data from the network may occur.

Obviously the data transfer between the RAT modules in connection with a seamless handover requires additional data interfaces and additional control mechanisms to align the data stream towards the network. Such interfaces and control mechanisms lead to additional costs. Moreover it might be difficult to harmonize the inter module data transfer in case the involved RAT modules come from different manufactures with proprietary interfaces and proprietary control mechanisms.

Similar problems arise in case the first RAT module becomes temporarily disconnected from the network while the second RAT module is not or not yet connected. In such a case the user application may continue sending user data towards the buffers of the first RAT module while it is uncertain whether the first RAT module will become connected again or whether the second RAT module will become connected instead e.g. because first RAT coverage got lost .

There is a need for a technique for transferring data between an application and two or more RAT modules that avoids at least some of the drawbacks discussed in the foregoing.

According to a first aspect a device for transferring data between an application and at least two RAT modules selectively connectable to a network is provided. The device comprises a storage adapted to hold e.g. to buffer data from the application the data being intended to be transmitted via at least one of the RAT modules a first control mechanism adapted to initiate holding of the data in the storage when the RAT modules assume the same connection state wherein the connection state is a connected state in which data transmission via the respective RAT is enabled or a disconnected state in which data transmission via the respective RAT is disabled and a second control mechanism adapted to initiate sending of the data held in the storage to the RAT module assuming the connected state when the RAT modules assume different connection states again.

The holding of the data may comprise queuing the data in the storage e.g. in the order received from the application . Of course the data may be held in the storage also in a non queued manner. The storage may be configured as a buffer allowing a temporal data buffering.

The individual RAT modules also called mobile platform modules herein may be realized in various ways. In one implementation at least one of the RAT modules is realized in the form of a delimitated chip or chip set. The delimitated chip or chip set may comprise Radio Frequency RF components tailored to support the respective RAT and additionally or alternatively a digital baseband processor adapted to perform baseband processing operations for the respective RAT. In one variation at least one of the RAT modules may comprise or may be constituted by an Application Specific Integrated Circuit ASIC a Digital Signal Processor DSP or a Field Programmable Gate Array FPGA .

In accordance with the paradigm of modularity at least one of the RAT modules may be configured to be re useable either in a stand alone configuration or in a dual or triple etc. mode configuration. In a multi mode configuration two or more RAT modules may be co located within one and the same hardware device and may be provided with optional inter module data and or inter module control interfaces. It should be noted that the term RAT module as used herein also encompasses RAT modules e.g. chips or chip sets that are only intended for use in a non modular stand alone configuration.

In one implementation the device further comprises a timer configured to be started upon initiating the holding of the data. Various measures can be triggered by expiry of the timer. For example the data in the storage may be discarded in case the RAT modules have not assumed different connection states upon expiry of the timer. Additionally or in the alternative a notification may be sent to at least one of the RAT modules and the application upon expiry of the timer. The one or more RAT modules may forward the notification to the network. The notification may notify the receiving entity that the data held in the storage has been discarded. In one scenario the timing and optional discarding operations are only performed in context with the RAT modules all assuming the disconnected state.

The device may further comprise a data route bypassing the storage. The data route may be adapted to forward data coming from at least one of the RAT modules directly to the application. The forwarding of the data to the application may be performed as long as at least one of the RAT modules assumes the connected state and in particular during an IRAT handover phase in which two or more of the RAT modules assume the connected state . In one possible IRAT handover scenario with two or more connected RAT modules the uplink data from the application may be fed to the storage while at the same time the downlink data from one or more RAT modules may be directly forwarded to the application without any holding latency.

The device may comprise one more or all of the RAT modules itself. Additionally or as an alternative the device may have access to one more or all RAT modules via an external interface. In such a case at least one of the RAT modules may be installed on an external apparatus and can be coupled to the device via its external interface.

The device may be configured as a PC as a laptop as a mobile telephone as a network card as a chip or chip set or as a similar stationary or mobile device. The device may be configured to be removably connected to the external apparatus via a cable e.g. via a USB cable or directly via suitable connectors. The external apparatus hosting one or more of the RAT modules may have a similar or different configuration than the device. In one variant the external apparatus is configured as a mobile telephone or as a network card.

In one implementation the device is coupled via the external interface to at least two RAT modules installed on the external apparatus. In such a scenario the device may further comprise a logical interface for each RAT module of the external apparatus as well as an interface driver for presenting the two logical interfaces as a single network interface to the application.

According to a further aspect a method of transferring data between an application and at least two RAT modules selectively connectable to a network is provided. The method comprises receiving data from the application the data being intended to be transmitted via at least one of the RAT modules holding the data in a storage when the RAT modules assume the same connection state wherein the connection state is a connected state in which data transmission via the respective RAT module is enabled or a disconnected state in which data transmission via the respective RAT module is disabled and sending the data held in the storage to the RAT module assuming the connected state when the RAT modules assume different connection states again.

The method may further comprise starting a timer upon initiating the holding of the data in the storage. The data held in the storage may be discarded if the RAT modules have not assumed different connection states e.g. remain in the disconnected state upon expiry of the timer.

Holding of the data in the storage may be initiated during a disconnecting phase in which at least one connected first RAT module enters the disconnected state and at least one disconnected second RAT module remains in the disconnected state. Additionally or in the alternative holding of the data in the storage may be initiated during an IRAT handover phase in which at least one disconnected first RAT module enters the connected state and at least one connected second RAT module remains in the connected state.

In one implementation the method further comprises forwarding data coming from at least one of the RAT modules directly to the application. This forwarding of the data to the application may be performed concurrently with holding the data coming from the application in the storage. Especially during an IRAT handover phase in which at least two of the RAT modules are connected the downlink data from one or more of the connected RAT modules may thus be transferred to the application without any holding latency while the uplink data from the application may be held in the storage until the IRAT handover phase has been successfully or unsuccessfully concluded.

The method may further comprise receiving connection information from at least one of the RAT modules. The connection information for a specific RAT module may be indicative of whether the RAT module is connected to or disconnected from the network. The connection information may thus have at least a binary information content. In the case connection information is received the method may further comprise controlling at least one of the holding of the data in the storage and the sending of the held data from the storage based on the connection information.

The connection information received from one of the RAT modules may be indicative of the connected state if the respective RAT module gets connected to its access network or establishes a first packet domain connection to its access network. On the other hand the connection information may indicate the disconnected state if the respective RAT module gets disconnected from its access network or upon release of the last packet domain connection to its access network.

The connection information may also be used to signal a handover state by the RAT modules. For example the connection information received from one of the RAT modules may indicate the connected state if the respective RAT module receives e.g. from the network an external terminal device or another RAT module a handover command to take over. On the other hand the connection information may indicate the disconnected state if the respective RAT module receives a handover complete message regarding the take over by another RAT module. While the signalling of handover messages using connection information is advantageous from certain points of view the handover signalling could also be performed using dedicated messages containing this handover information.

The method may further comprise receiving one or more control commands. The control commands may be directed to various control tasks. For example the control commands may be directed to at least one of an IRAT handover control a validity of control commands received from at least one other of the RAT modules a connection control towards the application and a connection control towards one or more of the RAT modules. The control commands may be received from at least one of the RAT modules e.g. from each RAT module . The control commands received from the one or more RAT modules may have been generated by the RAT modules themselves or by a remote network component attached via the RAT to the respective RAT module. The control commands may also be received from the application.

The control commands may be encoded in the connection information. For example a particular sequence of e.g. binary connection information may represent or be indicative of a specific control command.

In a further implementation the method may comprise establishing a control link between at least two of the RAT modules. The control link can stretch between respective inter module interfaces and may be used for various inter module signaling purposes. Such inter module signaling purposes may include the exchange of IRAT handover related messages via the control link.

The techniques presented herein may be realised in the form of software in the form of hardware or using a combined software hardware approach. A software aspect may provide a computer program product comprising program code portions for performing the steps presented herein when the computer program product is run on one or more processors. The computer program product may be stored on a computer readable recording medium such as a memory chip a CD ROM a harddisk to and so on.

In the following description of preferred embodiments for purposes of explanation and not limitation specific details are set forth such as particular interfaces network access technologies and sequences of steps in order to provide a thorough understanding of the technique presented herein. It will be apparent to one skilled in the art that the technique presented herein may be practiced in other embodiments that depart from these specific details. For example while the embodiments will primarily be described in context with third and fourth generation mobile communications standards such as the UMTS and Long Term Evolution LTE standards respectively it will be evident that the technique can also be practiced in combination with a second generation mobile communications technology according to for example the Global System for Mobile communications GSM standard or in combination with a short range wireless communication technology such as Bluetooth or any WLAN standard e.g. from the IEEE 802.11 suite .

Moreover those skilled in the art will appreciate that the services functions and steps explained herein may be implemented using software functioning in conjunction with a programmed micro processor an ASIC a DSP an FPGA or a general purpose computer. It will also be appreciated that while the following embodiments will primarily be described in context with methods and devices the technique presented herein may also be embodied in a computer program product as well as in a system comprising a computer processor and a memory coupled to the processor wherein the memory is encoded with one or more programs that may perform the services functions and steps disclosed herein.

The modem device comprises two mobile platform modules RAT modules each supporting one or more RATs and each realized in the form of a separate chip or chip set. In the present embodiment support for a specific RAT includes the provision of at least one dedicated baseband processor for this RAT on the respective module . Although not shown in each RAT module may further comprise dedicated RF components such as RF filters and RF amplifiers or such RF components may be jointly used by the two RAT modules .

The RAT module may be provided in the form of a platform main chip supporting one or more existing or legacy RATS such as EDGE Wideband Code Division Multiple Access WCDMA GSM or High Speed Packet Access HSPA radio technologies. The other RAT module may be provided in the form of a platform co chip supporting one or more novel RATs such as LTE or evolved HSPA eHSPA .

The RAT modules comprise a plurality of interfaces. First of all each RAT module comprises a data interface towards the terminal device . The data interfaces are configured to be used by the terminal device to obtain network access via the one or more RATs supported by each RAT module . In one implementation the data interfaces are realized in accordance with the USB standard. Specifically the data interfaces may be configured in accordance with a USB device class presenting the RAT modules as Ethernet network cards towards the terminal device . Suitable USB device classes providing Ethernet via USB include for example USB CDC ECM USB CDC EEM USB CDC ENCM and USB NCM.

In the embodiment shown in the two data interfaces are connected to an USB hub presenting the two data interfaces in the form of a single physical data port towards the external device . Accordingly while there exist two logical USB Ethernet devices on the two RAT modules only a single physical USB port will be presented towards the external device . It should be noted that the data interfaces towards the external device need not necessarily be configured in accordance with the USB standard. Other possible interface standards include the Universal Asynchronous Receiver Transmitter UART standard or any proprietary standard.

As shown in the RAT modules additionally include optional inter platform data interfaces . These inter platform data interfaces allow for a user data transfer between the two mobile platform modules . Such a user data transfer may for example be required if an application not shown in residing within or on top of RAT module wishes to obtain network access via the RAT provided by RAT module and vice versa. In a data card configuration without any local application requiring network access the inter platform data interfaces may be omitted.

The inter platform data interfaces may be configured as USB interfaces and in such a case the interface on one RAT module implements the UBS host role while the interface on the other RAT module implements the USB device role. Of course other interface standards including UART and proprietary standards can be used also.

In addition to the data interfaces towards the external device and the inter platform data interfaces the RAT modules comprise optional inter platform control interfaces . The inter platform control interfaces will be utilized for the exchange of control signaling between the two RAT modules . Such control signaling may include IRAT synchronization signaling IRAT handover signaling SIM access signaling from one RAT module to the other RAT module in such a case only a single one of the two RAT modules needs to provide SIM access functionalities and system control signaling including RAT module wake up functionalities. The control interfaces can be configured in accordance with the UART standard the USB standard the General Purpose Input Output GPIO standard any other public interface standard e.g. SDIO HIS UniPro SPI etc. or any proprietary standard. If supporting a high enough data rate the control interfaces may at the same time be utilized for user data transfer and in such a case the two inter platform data interfaces may be omitted.

The modem device communicates with the terminal device via a data connection on the one hand and a control connection on the other. The data connection stretches from the physical port of the USB hub to a physical USB port of the terminal device . The control connection on the other hand stretches between a control interface of the modem device and a corresponding control interface of the terminal device . The control interfaces may be configured in accordance with the UART standard or any proprietary standard. Alternatively the control interfaces could be omitted and control signaling be exchanged via the link between the port provided by the USB hub on the one side and the USB port of the terminal device on the other side.

As shown in the terminal device comprises a first data interface and a second data interface which are adapted to be coupled to the modem device to obtain network access via the RATs supported by the modem device . Specifically the first data interface is a logical USB interface adapted to be coupled to the corresponding USB interface of the RAT module to obtain network access via the one or more RATs provided by the RAT module and the second data interface is a logical USB interface adapted to be coupled to the corresponding USB interface of the RAT module to obtain network access via the one or more RATs provided by the RAT module .

The terminal device further comprises an interface and handover driver adapted inter alia to bind the first data interface and the second data interface of the terminal device into one logical network interface. As a consequence an application of the terminal device requiring network access will not see the two separate data interfaces of the modem device but will only see the single logical network interface provided by the driver .

The driver is coupled to the control interface to receive connection information indicative of the availability i.e. of the connection state of the RATs supported by the RAT modules . The driver may thus selectively switch either to the first data interface or to the second data interface depending on the control information received via the control interface .

The driver additionally comprises two control mechanisms and a timer . The control mechanisms are coupled to the control interface of the terminal device see to receive connection information in relation to the two RAT modules . In their combination the two control mechanisms and the timer control the holding of data in the storage as well as the sending or discarding of data held in the storage as will now be described in more detail with reference to the schematic flow diagram shown in .

In a first step the driver receives data from the application that is intended to be transmitted via at least one of the RAT modules . The data may be any application data typically generated by a user application such as a web browser Voice over Internet Protocol VoIP application or any other application. In step one of the RAT modules is connected to the respective access network while the other RAT module is disconnected from the respective access network.

In a next step the control mechanism determines from the connection information received from the RAT modules that both RAT modules have assumed the same connection state. This connection state is either a connected state in which data transmission via the respective RAT module is enabled or a disconnected state in which data transmission via the respective RAT module is disabled.

In response to detecting that the RAT modules are currently both in the connected state or both in the disconnected state the control mechanism initiates holding of the data from the application in the storage . The storage thus intercepts the uplink data path for temporarily buffering e.g. queuing the uplink data until either a data sending command or a data discarding command is received.

As soon as holding of the data in the storage is initiated by the control mechanism the uplink data path to the RAT modules is blocked so that the RAT modules will no longer be fed by the terminal device with data from the application . The downlink data path on the other hand bypasses the storage so that data from any of the RAT modules that is still in the connected state is still fed to the application . Such an asymmetric data transmission scenario may for example occur during an IRAT handover phase in which both RAT modules are temporarily in the connected state. It will be appreciated that during a disconnecting phase in which one of the two RAT modules remains in the disconnected state while the other RAT module just enters the disconnected state no data will be transmitted in the downlink data path while the application may still send data on the uplink data path that is then held at least temporarily in the storage .

In a third step the second control mechanism initiates sending of the data held in the storage . Initiating sending of the data held in the storage by the second control mechanism is dependent on the connection information as received via the control interface see . As soon as the second control mechanism detects that the RAT modules have assumed different connection states again the control mechanism initiates sending of the data held in the storage to this RAT module that assumes the connected state. The RAT modules will for example assume different connection state after the IRAT handover phase has been completed and the originally connected RAT module assumes the disconnected state again while the other RAT module has become connected. In another connection scenario in which one of the RAT modules remains disconnected and the other suffers from only a brief connection failure sending of the data held in the storage is initiated as soon as the other RAT module becomes connected again.

Upon initiating the holding of the data in the storage by the first control mechanism in step the control mechanism also starts a timer as illustrated in step . The timer thus runs in parallel to detecting by the second control mechanism when the RAT modules assume different connection states again. The timer is provided to prevent a storage overflow of the storage in case the RAT modules do not assume different connection states again. Specifically the control mechanism initiates a discarding of the data held in the storage if the RAT modules have not assumed different connection states upon expiry of the timer. At the same time the control mechanism may notify the application or any other component of the terminal device of this fact as illustrated by the corresponding arrow in .

In the embodiment shown in the modem device is again a dual mode device comprising a first RAT module supporting LTE network access and a second RAT module supporting UMTS network access.

As can be gathered from each RAT module further comprises a network signaling module that constitutes an interface towards the associated access network. The network signaling modules are in charge of the signaling required to establish and maintain a network connection e.g. a connection to the Internet or the core network of an operator via the associated RAT.

Each RAT module may additionally comprise a network address management component not shown in in the form of an IP module with IP layer functionalities. The network address management components are configured to communicate with each other via the control interfaces shown in omitted in . This inter platform communication between the two network address management components aims at synchronizing the IP stacks maintained by each network address signaling component. Such a synchronization includes the transfer of an IP address that has been allocated by the network between the respective IP stacks. After the IP stack synchronization the two RAT modules will act towards the outside world i.e. towards the network and towards the terminal device as if the modem device had only a single IP stack.

Each of the RAT modules provides an external USB device data interface respectively and presents itself as Ethernet network card towards the terminal device . The UMTS platform module is therefore configured to present itself as USB Ethernet Network Access Point NAP device to the terminal device giving the USB host network access using UMTS RAT via USB Ethernet. In a similar manner the LTE platform module is configured to present itself via the USB device interface as USB Ethernet NAP device to the terminal device thus giving the USB host network access using LTE RAT via USB Ethernet.

On the side of the terminal device in addition to a general USB bus driver and possible drivers for other USB classes there exists for each RAT module a PC USB device class driver which provides Ethernet via USB e.g. according to USB CDC ECN USB CDC EEN USB CDC ENCN or USB NCN . Each USB Ethernet connection to the modem device includes a mechanism based on NotifyConnect and NotifyDisconnect messages according to which the USB device stack of the corresponding USB interface indicates to the associated USB Ethernet class driver connection information indicative of whether or not there exists an active network connection.

The interface and handover driver is configured to communicate in accordance with the Network Driver Interfaces Specification NDIS towards the operating system of the terminal device and the application . To this end an NDIS module is located between the driver and the IP stack . NDIS is an Application Programming Interface API for Network Interface Cards NICs .

As mentioned above the driver combines the two Ethernet devices represented by the two data interfaces and presents both as a single NIC to the NDIS module IP stack and the application . In this regard the driver may simply indicate whether there is an NIC connected to the network e.g. the Internet or not. However the signaling of the driver towards the application does not distinguish between which of the two USB Ethernet devices is connected. From the connection state of the LTE USB Ethernet device data interface and the connection state of the UMTS USB Ethernet device data interface the driver may determine the connection state of the NIC.

Certain communication scenarios may require an IRAT handover during an ongoing data session. Such a handover may occur from the LTE RAT to the UMTS RAT or vice versa depending on considerations such as RAT signal strengths network access costs quality of service and the like. In the case of an IRAT handover the switching from one RAT to the other is in one scenario not done inside the modem device but inside the terminal device by the driver for example by switching from the USB Ethernet connection provided by the UMTS module to the USB Ethernet connection provided by the LTE module or vice versa . This switching is done such that there will be no service disconnection when changing from one RAT to the other RAT.

Since the switching is controlled by the driver there has to be a mechanism that indicates to the USB host driver which USB Ethernet connection is currently the one with the active RAT. Such a mechanism can optionally be based on the control connection discussed above in context with . The generation of the corresponding switching control command can alternatively be controlled by the modem device .

According to a very simple switching strategy the user data will always be routed to the fastest available USB Ethernet device which will be presented by the LTE module in the present embodiment and which will only be available if the LTE RAT is active . The decision strategy underlying the generation of the switching control command could also be more advanced. For example the LTE module may direct the USB host driver via the control connection see by notifications from an LTE USB Ethernet notification pipe to prepare and execute a handover between the USB Ethernet devices presented by the data interfaces . It is possible that either the LTE module or the UMTS module controls the generation of the switching control command for the driver . However it is also conceivable that the LTE module sends the connection state of the LTE RAT and the UMTS module the connection state of the UMTS RAT via separate notifications to the driver to enable an autonomous decision within the terminal device .

An USB host driver not shown installed on the terminal device is adapted to bind the two USB Ethernet devices presented by the two data interfaces into one logical network interface with the same IP address. Accordingly an operating system with the associated IP stack and the application running on the operating system only see a single network device instead of two dedicated RAT modules . As already mentioned above in context with the two logical USB Ethernet devices presented by the two data interfaces can optionally be merged by a USB hub so that only a single physical USB port or interface is presented towards the terminal device .

As has been explained above the USB Ethernet connections between the RAT modules on the one side and the terminal device on the other side comprises a mechanism to indicate whether there is an active network connection or not. This mechanism is based on the transmission of NotifyConnect and NotifyDisconnect messages from the RAT modules to the terminal device . In one implementation the RAT modules are configured such that the establishment of a network connection network attach or the loss of a network connection network detach or network disconnect function as trigger for sending the NotifyConnect and NotifyDisconnect messages to the terminal device .

Specifically the LTE module is configured to send such messages to the terminal device in the case of the following events 

The UMTS module is configured to send NotifyConnect and NotifyDisconnect messages to the terminal in the case of the following events 

In the above example network attach and network detach processes have been used as trigger for sending NotifyConnect and NotifyDisconnect messages from the modem device to the terminal device . As an alternative connection state indication and alternative trigger for sending these messages the establishment of the first packet domain connection and the release of the last packet domain connection by the RAT modules may be used as will now be explained.

The LTE module may thus send a NotifyConnect message to the terminal device upon establishment of the first packet domain connection to the LTE network for the USB Ethernet link as well as upon reception of a handover command to handover from UMTS to LTE this command is received via the UMTS network . On the other hand the LTE platform will sent a NotifyDisconnect message upon release of the last packet domain connection to the LTE network for the USB Ethernet link i.e. afterwards there will be no more packet domain connection to the LTE network for the USB Ethernet link as well as upon reception of a handover complete message from the UMTS module for handover from LTE to UMTS.

In a similar manner the UMTS module will send a NotifyConnect message upon establishment of the first packet domain connection to the UMTS network for the USB Ethernet link as well as upon reception of a handover command to handover from LTE to UMTS this command will be received via the LTE network . A NotifyDisconnect message will be sent from the UMTS module to the terminal device upon release of the last packet domain connection to the LTE network for the USB Ethernet link i.e. afterwards there will be no more packet domain connection to the LTE network for the USB Ethernet links or upon reception of a handover complete message from the LTE module for a handover from UMTS to LTE.

Out of the connection status of the LTE USB Ethernet interface LTE module and the connection status of the UMTS USB Ethernet interface UMTS module the driver determines the connection status of the NIC i.e. of the modem device . The various connection scenarios are illustrated in the exemplary state diagram of . It should be noted that for an USB connection OUT denotes the direction from the USB host terminal device to the USB device modem device while IN denotes the inverse direction.

The state diagram illustrates four possible connection states and the associated operational modes of the driver . A first connection state indicates that neither an LTE connection nor an UMTS connection is available. Connection state indicates the availability of an LTE connection only and connection state indicates the availability of an UMTS connection only. The availability of both connections typically during an IRAT handover phase is represented by connection state .

In LTE UMTS up denotes the reception of a NotifyConnect message from the LTE UMTS module with the prerequisite that the LTE UMTS USB device including the USB Ethernet class is enumerated . On the other hand LTE UMTS down denotes the reception of a NotifyDisconnect message from the LTE UMTS module or a deregistration of the USB Ethernet device by the LTE UMTS module .

The state diagram of is to a large extent self explanatory and for this reason only the crucial connection state in which both the LTE module and the UMTS module are connected to the access network will be described in more detail. Connection state corresponds to an exemplary IRAT handover phase in which in addition to an existing UMTS connection an LTE connection becomes available. In this exemplary IRAT handover scenario the connection state Both Connected is thus reached from the connection state UMTS Connected .

As soon as the control mechanism illustrated in detects that both the LTE module and the UMTS module have a network connection i.e. assume the same connection state it initiates holding of the application data on the uplink data path in the storage so that no further uplink data is sent to the LTE and UMTS modules . On the downlink data path on the other hand one or even both of the LTE and UMTS modules can be used for transferring data from the network side to the application . In other words the downlink data are directly forwarded to the application while the uplink data from the application are queued in the storage .

When the IRAT handover phase has successfully been concluded and the UMTS connection goes down the connection state LTE Connected as illustrated in the state diagram of is assumed. The control mechanism of detects the loss of the UMTS connection and in response to this detection initiates the sending of the application data queued in the storage to the single RAT module still active namely the LTE module . During the sending of the data held in the storage to the LTE module the further data received from the application may also be buffered in the storage until the storage is empty assuming a higher data rate from the storage to the LTE module than from the application to the storage . Alternatively data may be transmitted to the LTE module in parallel from the storage and from the application .

While has been explained for the exemplary case of an IRAT handover from UMTS to LTE it will be appreciated that a similar procedure as discussed above will be performed in the case of an IRAT handover from LTE to UMTS. Accordingly a discussion of the handover to UMTS is omitted here.

In the following two alternative state diagrams and the associated operation of the driver illustrated in will be discussed with reference to .

Starting with the state diagram of connection states and essentially correspond to connection states and as discussed above and will thus not be described in more detail. Connection state corresponds to connection state Both Connected but has been modified such that the LTE connection is always used for data transfer towards the access network in case both RAT modules are connected. In the opposite direction from the network to the application both RAT modules are used for data transfer. It should be noted that connection state may require an inter module data transfer in certain handover scenarios.

As becomes apparent from there is no direct transition from any connected state to the connection state representative of a lacking connection. Rather a disconnecting state and an associated timing procedure always intercepts a transition from any of the connection states to the disconnected state . If both the LTE RAT and the UMTS RAT go down i.e. become disconnected this will again be detected by the control mechanism of and the disconnecting state will be temporarily assumed. At the same time the control mechanism initiates holding of the application data in the storage and starts the timer .

Only if neither one of the two RATs has gone up again before expiry of the timer the disconnected state will be assumed. At the same time the data held in the storage will be discarded in response to the time out. If on the other hand one of the two RATs goes up again this will be detected by the control mechanism so that the data held in the storage can be sent out to the corresponding RAT module that has become connected. This corresponds to a transition from the disconnecting state to one of the connected states and .

The provision of the disconnected state provides the advantage of a more stable system operation in case of only brief network access failures without any loss of application data.

It should be noted that the storage concept described above is not limited to the system configuration of in which two external RAT modules are connected to the terminal device via two logical interfaces. For this reason three exemplary alternative system configurations will now be described with reference to . While the following embodiments will be described with reference to LTE UMTS and WLAN it will be apparent that other RATs may of course also be used.

Turning first to the alternative system configuration of a terminal device with a built in wireless module and with an external interface to an LTE module is shown. Components identical or similar to components of the previous embodiments will again be denoted by the same reference numerals and only the configurational differences will be discussed in more detail.

In the scenario of both the LTE module which may for example be part of a modem device such as a network card or mobile telephone and the built in WLAN module present themselves as Ethernet network cards towards the driver and NDIS module . While the LTE module is physically connected to the terminal device via an external USB connection the built in WLAN module is integrated on a motherboard not shown of the terminal device . The physical connection between the WLAN module and the motherboard may be based on Peripheral Component Interconnect Express PCI Express standard.

Again each connection between the RAT modules and the driver includes a mechanism that allows the RAT module to indicate whether there is an active network connection or not. A separate control link between the LTE module and the WLAN module is used to exchange control messages such as handover related control messages.

The scheme for the connection and disconnection notifications sent by the LTE module and the WLAN module to the driver could be as follows. The LTE module may be configured to send a NotifyConnect message to the terminal device upon establishment of the first packet domain connection to the LTE network for the USB Ethernet link as well as upon receipt of a handover command to perform a handover from WLAN to LTE this command may be received via the WLAN network . A NotifyDisconnect message is sent by the LTE module upon release of the last packet domain connection to the LTE network for the USB Ethernet link i.e. afterwards there will be no more packet domain connection to the LTE network for the USB Ethernet link and upon receipt of a handover complete message from the WLAN module for handover from LTE to WLAN.

The WLAN module on the other hand shall send connection information such as NotifyConnect and NotifyDisconnect messages which are seen here from a functional point of view while the real implementation and thus the naming could be different in the case of the following events. Specifically a connect message may be sent upon establishment of the first packet domain connection via WLAN to the network e.g. the Internet and upon reception of a handover command to handover from LTE to WLAN this command is received via the LTE network . On the other hand a disconnect message may be sent from the WLAN module upon release of the last packet domain connection via WLAN to the network i.e. afterwards there will be no more packet domain connection via WLAN to the network and upon receipt of a handover complete message from the LTE module for handover from WLAN to LTE.

The modem device with its LTE module and WLAN module is connected via a single physical interface such as an USB Ethernet interface to the terminal device . In this case the IRAT handover of the user data path is handled on the side of the modem device and not on the side of the terminal device . Accordingly the handover driver is located on the modem device i.e. on the multi RAT platform instead of on the terminal device . The driver may again be configured as shown in .

The LTE stack and the WLAN stack the latter being part of the WLAN module of the modem device are internally connected to the driver and each interface between the driver and the modules includes a mechanism that allows the wireless stacks to indicate to the driver whether there is an active network connection or not. It should be noted that the WLAN stack could alternatively also be located on the LTE module . A separate control link between the LTE stack and the WLAN stack is provided to exchange control messages such as handover related messages .

The scheme for the connection and disconnection notifications sent by the LTE stack and the WLAN stack to the driver could be as follows. The LTE stack may be configured to send a connect disconnect notification e.g. a NotifyConnect NotifyDisconnect message to the driver for the following events. A NotifyConnect message is sent upon establishment of the first packet domain connection to the LTE network as well as upon receipt of a handover command to handover from WLAN to LTE this message will be received via the WLAN network . On the other hand a NotifyDisconnect message will be sent upon release of the last packet domain connection to the LTE network i.e. afterwards there will be no more packet domain connection to the LTE network as well as upon receipt of a handover complete message from the WLAN module for handover from LTE to WLAN.

The WLAN module is configured to send a connect disconnect notification to the driver in the case of the following events. Upon establishment of the first packet domain connection via WLAN to the network as well as upon receipt of a handover command to handover from LTE to WLAN via the LTE network the LTE module sends a NotifyConnect message. On the other hand a NotifyDisconnect message is sent upon release of the last packet domain connection via WLAN to the network i.e. the Internet and upon receipt of a handover complete message from the LTE module for handover from WLAN to LTE.

Turning now to the system configuration of a multi RAT mobile device such as a mobile telephone using the driver mechanism discussed in combination with the previous embodiments will be described. Again the same reference numerals will be used to designate the same or similar components.

The multi RAT device comprises an LTE module as well as an UMTS module . In such a device configuration the concept described in the previous embodiments for the terminal device can be used to perform the IRAT handover within the device using the data holding approach discussed above in context with . Accordingly the handover driver is added to the device for coordinating the IRAT handover between UMTS and LTE.

The LTE stack and the UMTS stack are internally connected to the driver . Moreover a mechanism is provided that allows each wireless stack to indicate to the driver whether there is an active network connection or not. It should be noted that the LTE and UMTS functionalities could physically be integrated in one single chip or chip set. In such a case the LTE module and the UMTS module would constitute separate logical entities. Although not shown in there may exist a separate control link between the LTE stack and the UMTS stack to exchange control messages such as handover related control message .

The scheme for signaling connection and disconnection notifications from the LTE stack and the UMTS stack to the driver could be as follows. The LTE stack may send a NotifyConnect or similar message to the driver upon establishment of the first packet domain connection to the LTE network and upon receipt of a handover command to handover from UMTS to LTE as received via the UMTS network . A NotifyDisconnect message could be sent by the LTE stack upon release of the last packet domain connection to the LTE network i.e. afterwards there will be no more packet domain connections with the LTE network and upon receipt of a handover complete message from the UMTS module for handover from LTE to UMTS.

The UMTS stack on the other hand shall sent a NotifyConnect or similar message upon establishment of the first packet domain connection via UMTS to the network e.g. to the Internet as well as upon receipt of a handover command to handover from LTE to UMTS this message may again be received via the LTE network . The UMTS stack sends a NotifyDisconnect or similar message upon release of the last packet domain connection via UMTS to the network i.e. afterwards there will be no more packet domain connection via UMTS to the network and upon receipt of a handover complete message from the LTE module for handover from UMTS to LTE.

As has become apparent from the above the buffering technique suggested herein provides a plurality of advantages. Such advantages include the fact that in certain situations inter module data interfaces can be avoided or at least relieved from data transfer. Additionally inter module data transfer control mechanisms can be avoided or at least configured less complex. These advantages are mainly the result of the fact that in certain connection scenarios uplink data are buffered instead of being transferred to the RAT modules.

Since data or logical interfaces and data transfer mechanisms between different modules can be avoided it is easier to realize a multi RAT solution with RAT modules from different manufacturers. In other words in many cases no knowledge of proprietory interface and control specifications is required.

Additionally external interfaces between modem and user devices can be based on common interface standards such as the USB Ethernet interface mechanism. USB Ethernet class drivers are not affected by the implementation of the handover logic in the terminal device as the handover logic may completely be encapsulated in a driver component. As a further result the handover can be fully controlled by the terminal device if required. An additional advantage is the fact that the handover driver suggested herein allows an IRAT handover between built in RAT modules and externally connected RAT modules.

In the following various embodiments will be discussed for coordinating the connection signaling between the RAT modules and the handover driver . These embodiments may in principle be practiced independently from the holding and buffering concept discussed in connection with the above embodiments.

It has been recognized that the connection signaling mechanisms may be incompatible with the above suggestions in case the RAT modules are provided from different manufacturers. In particular a third party RAT module may signal connection information that is not compatible with the control strategies described above. For example the third party RAT module may send a NotifyConnect message to the terminal device already when the start up sequence is completed even though no network connection has yet been established. In case the other RAT module is already connected the terminal device would thus see a handover in progress all the time.

One solution to this problem is of course to adapt the third party RAT module to behave as expected concerning the transmission of NotifyConnect and NotifyDisconnect messages. Nonetheless a solution which is more independent from the behaviour of the connection signaling of the third party RAT platform would be preferable and is described hereinafter.

It has been found that a graceful handover which is independent from the implementation details the NotifyConnect NotifyDisconnect mechanism in the third party RAT platform requires an additional protocol for controlling the driver from one single RAT module the controlling RAT module . In order to support an additional protocol for controlling the driver with minimum impact on the software of the terminal device and without adding additional proprietory control messages for the USB Ethernet class a mechanism is proposed which is based on the idea of encoding control commands in connection information. Specifically a sequence of NotifyConnect and NotifyDisconnect messages which are issued by the controlling RAT module and which are part of the standard USB Ethernet protocol is used to encode different handover requests.

According to the encoding approach proposed herein a NotifyConnect or similar message is interpreted as a logical 1 and a NotifyDisconnect or similar message is interpreted as a logical 0 . One control command from the controlling RAT module consists of a stream of NotifyConnect and NotifyDisconnect messages which is interpreted by the driver as a logical sequence of bits.

The data bits are used to encode the control commands from the controlling RAT module to the driver . When exemplarily using 4 data bits and implementing a coding scheme without adding redundancy this means that 16 different control commands e.g. handover related control commands can be signalled as exemplarily shown in the table of .

The processing of NotifyConnect and NotifyDisconnect messages is controlled via a timer which may be provided in addition to the timer shown in of the driver . If timeout occurs during reception of a control command i.e. of a sequence of NotifyConnect and NotifyDisconnect messages the sequence is invalidated and the driver returns to its previous state.

The driver may comprise registry settings for command mode enabled disabled and for a timeout value for the command sequence. If the command mode is disabled the NotifyConnect and NotifyDisconnect messages are interpreted in accordance with their original meaning. It should be noted that the USB stack of the non controlling RAT module may be used without any modifications during the handover scenario.

In the following one specific command scenario will be described with reference to the table of . It is assumed that a third party RAT module with its USB stack connects to the terminal device of during normal start up. In such a case the controlling RAT module could send a command sequence instructing the driver to ignore this connect request from the non controlling RAT module because it is not part of a handover scenario at this time bit sequence . If a handover has to be executed the controlling RAT module could send a command not shown in table to the driver to take care of connect and disconnect requests from the non controlling RAT module.

It should be noted that the signaling context described above is not limited to the handover case. It can also be used for other remote control mechanisms between an USB Ethernet device and an external USB host. Moreover it should be noted that the connection state of a RAT module is still indicated by a single NotifyConnect or NotifyDisconnect message.

As has become apparent from the above description of the concept of a controlling RAT module and at least one non controlling RAT module allows to implement a handover solution which is independent of the NotifyConnect and NotifyDisconnect signaling behaviour of a third party RAT module. In other words the third party RAT module need not be adapted regarding the NotifyConnect and NotifyDisconnect signaling to support a graceful handover as described herein. Also the solution has minimum impact on the USB host side to support graceful handover as already existing USB mechanisms may be used to add an additional protocol for controlling the driver by an RAT module. In particular the USB bus and class drivers on the USB host side are not affected and the interface towards the terminal device can be based on the standard USB Ethernet interface mechanisms.

It is believed that many advantages of the technique presented herein will be fully understood from the forgoing description and it will be apparent that various changes may be made in the form construction and arrangement of the exemplary aspects thereof without departing from the scope of the invention or without sacrificing all of its advantages. Because the invention can be varied in many ways it will be recognized that the technique presented herein should be limited only by the scope of the following claims.

