---

title: Roaming personal information items across multiple computing devices using an IMAP server
abstract: Technologies for roaming personal information items across multiple computing devices using an IMAP server are provided. When a change is detected to a personal information item maintained by a PIM program one computing device, the data representing the personal information item is uploaded from the computing device to an IMAP server, where it is stored as a message in a user mailbox designated to hold personal information items. A second computing device then downloads the message storing the data representing the personal information item from the IMAP server and makes it available to a PIM program executing on the second computing device.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08161107&OS=08161107&RS=08161107
owner: Microsoft Corporation
number: 08161107
owner_city: Redmond
owner_country: US
publication_date: 20081229
---
A user may utilize multiple computing devices to view and maintain e mail and personal information items such as contacts calendar items tasks notes and journal entries. Such devices include personal computers PC digital cellular phones personal digital assistants PDA game consoles set top boxes etc. Each of these devices may have a different software program known as a personal information manager PIM for the management of e mail and personal information items.

Many of the PIM programs on the user s devices may support the roaming of e mail across multiple devices. In other words the user s e mail may be stored in a standard format in a central location and replicated to the PIM on multiple of the user s devices. In this way changes made to the e mail on one device such as deleting a message or marking a message as read may be replicated to the user s other devices. Traditionally however a PIM maintains other personal information items for the user in a local storage often using native formats specific to the individual PIM program. Changes made to a personal information item such as a contact or task on one device may be isolated to that device and unavailable to the user s other devices. While some server programs may exist that allow roaming of personal information items across devices these servers often use proprietary protocols and may be limited to access by a specific client application.

Technologies are described herein for roaming personal information items across multiple computing devices using an Internet message access protocol IMAP server. According to this description when a change is detected to a personal information item maintained by a PIM program executing on one computing device the data representing the personal information item is uploaded to an IMAP server where it is stored as a message in a user mailbox designated to hold personal information items. A second computing device then downloads the message storing the data representing the personal information item from the IMAP server and makes it available to a PIM program executing on the second computing device.

It should be appreciated that the above described subject matter may be implemented as a computer controlled apparatus a computer process a computing system or as an article of manufacture such as a computer readable medium. These and various other features will be apparent from a reading of the following Detailed Description and a review of the associated drawings.

This Summary is provided to introduce a selection of concepts in a simplified form that are further described below in the Detailed Description. This Summary is not intended to identify key features or essential features of the claimed subject matter nor is it intended that this Summary be used to limit the scope of the claimed subject matter. Furthermore the claimed subject matter is not limited to implementations that solve any or all disadvantages noted in any part of this disclosure.

The following detailed description is directed to technologies for roaming personal information items for a user across multiple PIM programs on multiple computing devices utilizing an IMAP server. Utilizing the technologies described herein a PIM executing on one of a user s devices can add or change a personal information item maintained in the local storage of the device and replicate those changes to any centralized mail server on the Internet supporting IMAP. The PIMs on the user s other devices can then periodically synchronize their local storage of personal information items with that of the centralized mail server thus making the changes made to personal information items on one device available to the other devices of the user.

While the subject matter described herein is presented in the general context of program modules that execute in conjunction with the execution of an operating system and application programs on a computer system those skilled in the art will recognize that other implementations may be performed in combination with other types of program modules. Generally program modules include routines programs components data structures and other types of structures that perform particular tasks or implement particular abstract data types. Moreover those skilled in the art will appreciate that the subject matter described herein may be practiced with other computer system configurations including hand held devices multiprocessor systems microprocessor based or programmable consumer electronics minicomputers mainframe computers and the like.

In the following detailed description references are made to the accompanying drawings that form a part hereof and that show by way of illustration specific embodiments or examples. In the accompanying drawings like numerals represent like elements through the several figures.

The computing device executes a PIM program . The PIM program may be an application program that allows the user to maintain the user s e mail and personal information items such as contacts tasks calendar items notes and journal entries through a single unified interface. Examples of the PIM program may include but are not limited to the MICROSOFT OUTLOOK messaging and collaboration client from Microsoft Corporation of Redmond Wash. or the IBM LOTUS NOTES client program from IBM Corporation of Armonk N.Y. The PIM program may also be a special purpose program that allows the user to maintain a subset of the user s personal information items such as the Contacts or Calendar applications on the APPLE IPHONE mobile digital device from Apple Inc. of Cupertino Calif. Further the PIM program may be a Web based application executing on a Web server that provides a user access to one or more of the user s personal information items such as the GOOGLE CALENDAR calendaring service from Google Inc. of Mountain View Calif.

The PIM program may maintain a copy of the user s personal information items in a local information cache located on the computing device or on an external file system connected to the computing device. The format of the personal information items stored in the local information cache may be native to the specific PIM program executing on the computing device .

According to embodiments described herein the PIM program uses an IMAP client extension to roam personal information items across multiple of the user s computing devices. In other words through the IMAP client extension additions deletions and modifications made to personal information items made on one of the user s computing devices A may be reflected on the user s other devices B D. The IMAP client extension may be a module contained in the PIM program or it may be an external component located on the computing device that provides services to the PIM program through an application programming interface API . The IMAP client extension communicates over an IP network to an IMAP server executing on a mail server computer or other server computer network appliance or special purpose computing device connected to the IP network. The IP network may be the Internet a local area network LAN or a wide area network WAN .

As will be appreciated by one skilled in the art the IMAP server allows computing devices A D to access messages across the IP network through the Internet message access protocol version 4 IMAPv4 . IMAPv4 is an open standard for the manipulation of e mail messages on a remote server over the Internet. IMAPv4 is supported by the majority of mail server programs on the Internet and is defined in Internet Engineering Task Force IETF RFC 3501 entitled Internet Message Access Protocol Version 4rev1 which is incorporated herein by reference in its entirety. Examples of mail server programs that support IMAPv4 include the MICROSOFT EXCHANGE SERVER 2007 server program from Microsoft Corporation IBM LOTUS DOMINO server from IBM Corporation or EUDORA WORLDMAIL 4 server from QUALCOMM Incorporated of San Diego Calif.

The IMAP server may maintain the messages for the user in a server mailbox store located on the mail server computer or some other file system or storage mechanism connected to the mail server computer. As shown in the information in the server mailbox store as defined by the IMAPv4 protocol is divided into individual user mailboxes . IMAP client programs such as the IMAP client extension may utilize commands defined by the IMAPv4 protocol to create delete and enumerate the user mailboxes on the IMAP server for an individual user.

Any number of user mailboxes may be created each with a unique mailbox name . Some mailbox names may be reserved by the IMAPv4 protocol specifically for e mail messages such as the mailbox name INBOX. According to embodiments herein the IMAP client extension executing in conjunction with a PIM program on one of the user s computing devices A may create an individual user mailbox in the server mailbox store of the IMAP server for each type of personal information item that the PIM program maintains as will be discussed in more detail below with respect to .

The user mailboxes in the server mailbox store may contain one or more messages . The messages may contain e mail messages received for the user by the mail server computer or the messages may contain personal information items associated with the user mailbox that are created or modified by the PIM program and replicated to the IMAP server by the IMAP client extension as will be further discussed below with respect to . According to the IMAPv4 protocol an individual message in a user mailbox has a unique identifier . The unique identifier is unique across the specific user mailbox and serves to uniquely identify the individual message to IMAP client programs such as the IMAP client extension accessing the IMAP server .

A message also contains one or more attributes . The attributes define properties of the message that are utilized by the IMAP server and IMAP client programs to manage the messages contained in the user mailboxes . Attributes may include the date and time that the message was received a set of flags that indicate whether the message is new has been read or is marked for deletion the size of the message and other message properties as defined in the IMAPv4 protocol.

The contents of a message are stored in a message text field. The message text may include any text content for the message although the IMAPv4 protocol recommends that the message text be consistent with IETF RFC 2822 entitled Internet Message Format. Messages in the Internet message format may include a message header a body and one or more file attachments. According to one embodiment the IMAP client extension replicates personal information items maintained in the PIM program to the IMAP server as IMAP messages with an RFC 2822 compliant message text . The message text of the message contains the data representing the personal information item serialized into the body of the message or attached as a file attachment as will be discussed in more detail below with respect to .

Referring now to additional details will be provided regarding the embodiments presented herein. It should be appreciated that the logical operations described with respect to are implemented 1 as a sequence of computer implemented acts or program modules running on a computing system and or 2 as interconnected machine logic circuits or circuit modules within the computing system. The implementation is a matter of choice dependent on the performance and other requirements of the computing system. Accordingly the logical operations described herein are referred to variously as operations structural devices acts or modules. These operations structural devices acts and modules may be implemented in software in firmware in special purpose digital logic and any combination thereof. It should also be appreciated that more or fewer operations may be performed than shown in the figures and described herein. The operations may also be performed in a different order than described.

Upon detecting a change to a personal information item the routine proceeds from operation to operation where the IMAP client extension establishes a connection with the IMAP server over the IP network . In one embodiment the IMAP client extension may maintain an active connection to the IMAP server during the execution of the PIM program . This is often referred to as connected mode or working online. In another embodiment the IMAP client extension may establish a connection to the IMAP server when a personal information item has been modified in the local information cache and is to be replicated to the IMAP server . In a further embodiment the IMAP client extension may establish a connection to the IMAP server on a periodic basis such as upon initial execution and termination of the PIM program at regularly established intervals or in response to a user action such as the click of a Refresh button. This may be referred to as offline mode. When working in this mode modified personal information items may be marked as modified and replicated to the IMAP sever when the connection is established.

From operation the routine proceeds to operation where the IMAP client extension selects the user mailbox on the IMAP server corresponding to the type of the personal information item to be replicated to the server. According to one embodiment the IMAP client extension may create and maintain an individual user mailbox on the IMAP server corresponding to the different personal information types maintained by the PIM program . The user mailbox may have a specific mailbox name associated with the type of personal information item. For example calendar items may be maintained in a user mailbox with a mailbox name of x calendar while contacts may be maintained in a user mailbox with a mailbox name of x contacts. The specific mailbox names used for the user mailboxes may be implementation specific or based on a standard established such that PIM programs from different vendors incorporating the IMAP client extension functionality described herein can share personal information items through the IMAP server .

In another embodiment the type of personal information items stored in the user mailbox may be contained in a type identifying message within each user mailbox maintained by the IMAP client extension . The type identifying message may be established in such a way that it is readily accessible to the IMAP client extension such as positioned so that it is generally returned as the message with a sequence number of 1 in a list of messages in the user mailbox . The type of personal information item may be encoded into the message text of the type identifying message along with other information such as the format in which data representing the personal information item is encoded and other application specific settings. PIM programs incorporating the IMAP client extension functionality described herein may enumerate the user mailboxes on the IMAP server and access the type identifying message at sequence number 1 to discover the type of personal information item contained in each user mailbox.

It will be appreciated that any number of methods may be employed by the IMAP client extension to identify the user mailbox that is associated with a particular type of personal information item including configuring user definable settings in the PIM program using namespaces on the IMAP server creating an additional user mailbox on the IMAP server containing application settings for the IMAP client extension and or PIM program or the like. It is intended that this application include all such methods for identifying the user mailbox associated with a particular type of personal information item.

In one embodiment the IMAP client extension selects the user mailbox associated with the type of personal information item to be replicated using the IMAPv4 SELECT command. If the user mailbox does not yet exist on the IMAP server as determined in operation then the routine moves to operation where the IMAP client extension creates the user mailbox on the IMAP server. The IMAP client extension may create the user mailbox using the IMAPv4 CREATE command. The IMAP client extension may then associate the created user mailbox with the type of personal information items to be stored therein by setting the mailbox name of the user mailbox and or creating the type identifying message in the user mailbox depending on the specific implementation chosen as discussed in regard to operation . According to one embodiment the IMAP client extension may create the user mailboxes on the IMAP server for the different types of personal information item maintained by the PIM program upon the initial connection to the IMAP server during configuration of the IMAP client extension for example.

Next the routine moves to operation where the IMAP client extension converts the data representing the personal information item from the native format of the PIM program to the format that will be used to store the type of personal information items in the associated user mailbox . As described briefly above the IMAP client extension may store individual personal information items as messages in the user mailbox associated with the type of the personal information item. The data representing the personal information item may be serialized into the body of the message text of the message or it may be encoded as a file attachment to the message based on a specific format or MIME content type. The choice of method for converting the data representing the personal information item may vary with the individual PIM program s implementation of the IMAP client extension functionality.

According to one embodiment the IMAP client extension may use a different method of converting the data representing the personal information item depending on the type of the personal information item. For example calendar items tasks and journal entries may be stored as file attachments encoded in an iCalendar format as defined by IETF RFC 2445 entitled Internet Calendaring and Scheduling Core Object Specification iCalendar . Calendar items may be encoded using the iCalendar VEVENT format tasks may be encoded using the iCalendar VTODO format and journal entries may be encoded using the iCalendar VJOURNAL format. Contacts may be stored as file attachments encoded in the widely supported vCard format while notes may be serialized as text XML or HTML into the body of the message .

In another embodiment in addition to the file attachment containing the data representing the personal information item additional information regarding the personal information item may be encoded into the body of the message to enable PIM programs not incorporating the IMAP client extension functionality described herein to display some information regarding the personal information item. For example for a contact the contact s name phone numbers and e mail addresses may be encoded into the body of the message that also contains the vCard format file attachment.

From operation the routine proceeds to operation where the IMAP client extension creates a new message in the user mailbox associated with the type of the personal information item to be replicated. The IMAP client extension may create the new message in the user mailbox using the IMAPv4 APPEND command according to one embodiment. The message text of the new message may contain the converted data representing the personal information item as described above in regard to operation . For example the message text may contain an RFC 2822 compliant message with the body information and or file attachments encoded with the format corresponding to the type of personal information item as described above.

The routine then proceeds from operation to operation where the IMAP client extension determines if the personal information item was previously stored on the IMAP server . This may be the case when an existing personal information item has been modified by PIM program in the local information cache . The PIM program may maintain this information by storing the unique identifier for the message on the IMAP server corresponding to the replicated personal information items in the local information cache . If the personal information item was previously stored on the IMAP server the routine proceeds to operation where the IMAP client extension marks the previously stored message for deletion. This may be done by setting an attribute on the message for example. From operation the routine ends.

In another embodiment the IMAP client extension may implement a more robust change detection strategy in which the IMAP client extension checks for conflicting or overlapping changes to a personal information item before the item is replicated to the IMAP server . This may allow the IMAP client extension to account for a situation where the same personal information item is changed by two different user computing devices before the changed item from the first device has been synchronized to the second device. In this case the IMAP client extension on the second device may detect the changed personal information item from the first device on the IMAP server and attempt to merge the two sets of changes before replicating the changed item back to the IMAP server.

Upon connecting to the IMAP server the routine proceeds from operation to operation where the IMAP client extension enumerates the user mailboxes on the IMAP server that contain personal information items maintained by the PIM program . In one embodiment the IMAP client extension may use the IMAPv4 LIST command to list the user mailboxes for the user on the IMAP server and discover the type of personal information items contained in the mailboxes. For example the IMAP client extension may reference the type identifying messages contained in the different user mailboxes as discussed above in regard to operation . In another embodiment the IMAP client extension may iterate through the known mailbox names of the user mailboxes containing personal information items.

Next at operation the IMAP client extension determines if all user mailboxes on the IMAP server enumerated in operation have been synchronized in other words whether all the changed messages in the user mailboxes containing personal information items maintained by the PIM program have been updated in the local information cache . If not all of the user mailboxes enumerated in operation have been synchronized then the routine proceeds from operation to operation where the IMAP client extension selects the next user mailbox on the IMAP server . According to one embodiment the IMAP client extension may select the user mailbox using the IMAPv4 SELECT command

Once the mailbox is selected the routine proceeds from operation to operation where the IMAP client extension determines whether any messages containing personal information items have been deleted from the user mailbox . This may be done by enumerating the unique identifiers of the messages stored in the user mailbox and comparing them with the unique identifiers maintained with the personal information items in the local information cache . If a message in the user mailbox corresponding to a personal information item in the local information cache is marked for deletion or if a message corresponding to a personal information item no longer exists in the user mailbox the routine proceeds from operation to operation . In operation the IMAP client extension removes the corresponding personal information item from the local information cache.

From operation the routine returns to operation where the IMAP client extension determines if any additional messages containing personal information items have been deleted from the user mailbox . If no more messages containing personal information items have been deleted the routine proceeds from operation to operation where the IMAP client extension determines if any messages containing personal information items have been added to the user mailbox . As in operation this may be accomplished by enumerating the unique identifiers of the messages stored in the user mailbox and comparing them with the unique identifiers maintained with the personal information items in the local information cache . If a new message exists in the user mailbox containing a personal information item the routine proceeds from operation to operation where the IMAP client extension retrieves the new message containing the personal information item from the IMAP server .

From operation the routine proceeds to operation where the IMAP client extension converts the data representing the personal information item from the format stored in the IMAP message to the native format of the PIM program . As discussed above in regard to operation the data for the personal information item may be serialized into the body of the message text of the new message or it may be encoded as a file attachment to the message based on a specific format or MIME content type. The IMAP client extension may extract the data from the message text of the message accordingly and convert it to the native format of the PIM program for storage in the local information cache .

The routine then proceeds from operation to operation where the IMAP client extension stores the personal information item from the new message in the local information cache in the format native to the PIM program . Next the routine returns to operation where the IMAP client extension determines if any additional messages containing personal information items have been added to the user mailbox . If no more new messages exist in the user mailbox the routine returns to operation where the IMAP client extension determines if all user mailboxes on the IMAP server enumerated in operation have been synchronized. Once all the user mailboxes containing personal information items on the IMAP server have been synchronized the routine ends.

According to another embodiment the IMAP server may notify the IMAP client extension of deleted or added messages in a user mailbox containing personal information items maintained by the PIM program . This may be accomplished by the IMAP client extension receiving from the IMAP server IDLE responses that contain status information of the currently selected user mailbox as defined by the IMAPv4 protocol. Because the IMAP server typically provides notifications with status information only regarding the currently selected user mailbox the IMAP client extension may establish a separate connection with the IMAP server for the different user mailboxes containing personal information items. The IMAP client extension may then select the corresponding user mailbox in the IMAP session for each connection in order to receive change notifications for messages contained in that user mailbox.

When the IMAP client extension receives a notification of a deleted message in a user mailbox containing personal information items maintained by the PIM program the IMAP client extension may then remove the corresponding personal information item from the local information cache as described above in regard to operation . Similarly when the IMAP client extension receives a notification of a new message added to a user mailbox containing personal information items the IMAP client extension may retrieve the new message convert the data for the personal information item to the native format of the PIM program and store the personal information item from the new message in the local information cache as described above in regard to operations and .

It will be appreciated by one skilled in the art that methods for replicating new or modified personal information items from the local information cache to the IMAP server and updating the local information cache with changes to personal information items from the IMAP server may be utilized other than those described above in regard to . These other methods may further utilize different commands facilities interfaces or capabilities of the IMAPv4 protocol than those described herein. It is intended that all such methods be included in this application.

The computer architecture shown in includes a central processing unit CPU a system memory including a random access memory RAM and a read only memory ROM and a system bus that couples the memory to the CPU . A basic input output system containing the basic routines that help to transfer information between elements within the computer such as during startup is stored in the ROM . The computer also includes a mass storage device for storing an operating system application programs and other program modules which are described in greater detail herein.

The mass storage device is connected to the CPU through a mass storage controller not shown connected to the bus . The mass storage device and its associated computer readable media provide non volatile storage for the computer . Although the description of computer readable media contained herein refers to a mass storage device such as a hard disk or CD ROM drive it should be appreciated by those skilled in the art that computer readable media can be any available computer storage media that can be accessed by the computer .

By way of example and not limitation computer readable media may include volatile and non volatile removable and non removable media implemented in any method or technology for storage of information such as computer readable instructions data structures program modules or other data. For example computer readable media includes but is not limited to RAM ROM EPROM EEPROM flash memory or other solid state memory technology CD ROM digital versatile disks DVD HD DVD BLU RAY or other optical storage magnetic cassettes magnetic tape magnetic disk storage or other magnetic storage devices or any other medium that can be used to store the desired information and that can be accessed by the computer .

According to various embodiments the computer may operate in a networked environment using logical connections to remote computers through a network such as the IP network . The computer may connect to the IP network through a network interface unit connected to the bus . It should be appreciated that the network interface unit may also be utilized to connect to other types of networks and remote computer systems. The computer may also include an input output controller for receiving and processing input from a number of other devices including a keyboard a mouse or an electronic stylus not shown in . Similarly the input output controller may provide output to a display a printer or other type of output device also not shown in .

As mentioned briefly above a number of program modules and data files may be stored in the mass storage device and RAM of the computer including an operating system suitable for controlling the operation of a computer. The mass storage device and RAM may also store one or more program modules. In particular the mass storage device and the RAM may store the PIM program the IMAP client extension or the IMAP server each of which was described in detail above in regard to . The mass storage device and the RAM may also store other types of program modules or data.

Based on the foregoing it should be appreciated that technologies for roaming personal information items across multiple computing devices utilizing an IMAP server are provided herein. Although the subject matter presented herein has been described in language specific to computer structural features methodological acts and computer readable media it is to be understood that the invention defined in the appended claims is not necessarily limited to the specific features acts or media described herein. Rather the specific features acts and mediums are disclosed as example forms of implementing the claims.

The subject matter described above is provided by way of illustration only and should not be construed as limiting. Various modifications and changes may be made to the subject matter described herein without following the example embodiments and applications illustrated and described and without departing from the true spirit and scope of the present invention which is set forth in the following claims.

