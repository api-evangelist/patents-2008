---

title: Method for secure system shutdown
abstract: In one embodiment, a key list entry corresponding to a user's private key is securely deleted from a key list of a user device on shutdown of the user device. Subsequently, input of the user's private key will not allow decryption of an encrypted partition storing encrypted data on the user device. In another embodiment, a key list entry corresponding to a user's private key is automatically and securely re-provisioned on boot up of the user device. Subsequently, input of the user's private key will allow decryption of the encrypted partition on the user device.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08181028&OS=08181028&RS=08181028
owner: Symantec Corporation
number: 08181028
owner_city: Mountian View
owner_country: US
publication_date: 20080617
---
The present invention relates to computer systems. More particularly the present invention relates to the protection of encrypted data.

Users of laptop computer systems and similar devices are frequently mobile with the computer systems. A laptop computer system is easily lost stolen or illicitly accessed. This creates risk not only due to loss of the data stored on the laptop computer system but also due to potential parent system compromise such as compromise of a larger corporate network or corporate database.

Some current solutions advocate that the user utilize whole disk encryption to protect the data on the laptop computer system from compromise. In a simple loss scenario whole disk encryption protects against these risks however whole disk encryption is insufficient protection in the face of threats which involve coercing access from the user.

For example consider a user transiting a high risk area with a laptop computer system containing encrypted data. During transit the user can be stopped and asked to provide access to the laptop computer system. While the data on the laptop computer system is encrypted the user can be coerced to provide the password or other information to access the encrypted data. In some cases regional laws may even compel a user to provide this access information. Once the access information is divulged the coercer has access to the laptop computer system the data and potentially the parent system. Even if the laptop computer system is returned the laptop computer system is potentially compromised and the data at risk.

In one embodiment a computer implemented method for secure shutdown of a user device includes detecting a shutdown of a user device the user device including a key list having a first key list entry corresponding to a user private key for use in decrypting an encrypted partition storing encrypted data on the user device determining whether or not to securely shutdown the user device and upon a determination to securely shutdown the user device deleting the first key list entry from the key list and permitting the shutdown of the user device to proceed. Subsequently input of the user s private key will not allow decryption of encrypted partition on the user device as the corresponding key list entry is no longer present in the key list of the user device.

In another embodiment a computer implemented method for automated secure key re provisioning includes detecting a boot up of a user device the user device including a key list having one or more key list entries for use in decrypting an encrypted partition storing encrypted data on the user device querying a user for input of at least one user credential receiving the input of the at least one user credential obfuscating the at least one user credential the obfuscating generating at least one obfuscated user credential generating a key re provisioning request the key re provisioning request requesting a key re provisioning and including the at least one obfuscated user credential sending the key re provisioning request to a key management system device receiving a key re provisioning response from the key management system device the key re provisioning response including at least a key re provisioning password locating a key list entry in the key list corresponding to the key re provisioning password the key list entry including an encrypted session key decrypting the session key utilizing at least the key re provisioning password querying a user for input of at least one user password receiving the input of the at least one user password encrypting the session key utilizing the at least one user password generating a new key list entry corresponding to the user private key in the key list and allowing the boot up of the user device to proceed. In some embodiments the computer implemented method further includes decrypting the encrypted partition.

Embodiments in accordance with the invention are best understood by reference to the following detailed description when read in conjunction with the accompanying drawings.

Common reference numerals are used throughout the drawings and detailed description to indicate like elements.

User device typically includes a central processing unit CPU hereinafter processor an input output I O interface a memory and an operating system . In one embodiment memory includes storage media not shown for permanent storage of files sometimes called physical storage memory non volatile memory non temporary storage memory non temporary storage media or permanent storage memory. For example in one embodiment the storage media is a hard drive e.g. a magnetic hard drive a floppy disk a CD ROM and or a DVD. Generally files stored in permanent storage memory e.g. a magnetic hard disk a floppy disk a CD ROM a DVD are unaffected and maintained i.e. are not lost upon powering down turning off of user device .

In various embodiments memory further includes volatile memory for non permanent storage of files sometimes called temporary storage memory non temporary storage media or non permanent storage memory. Generally files stored in non permanent storage memory are lost upon powering down turning off of user device .

In one embodiment memory of user device further includes secure system shutdown application an encryption boot loader and automated secure key provisioning application . In various embodiments secure system shutdown application is loaded as an operating system OS extension a stand alone program or a hypervisor in a virtualization environment. In one embodiment automated secure key re provisioning application is loaded as part of encryption boot loader however in other embodiments automated secure key re provisioning application is loaded as a stand alone application that is accessible by encryption boot loader .

In one embodiment operating system utilizes an encryption technology such as a whole disk encryption technology in which at least one area of a storage medium such as a storage disk partition is encrypted i.e. stores encrypted data e.g. encrypted data .

A typical whole disk encryption configuration on disk includes an encrypted partition not shown storing encrypted data key list and encryption bootloader which manages the decryption of encrypted data . The encrypted partition can be viewed as E P K session where P is the partition K session is an arbitrary generated session key and E is a symmetric algorithm such as AES. Thus the partition is encrypted via AES with K session the session key.

Key list is a list where each entry N is E K session K pub N where E is a public key algorithm such as RSA K pub N is the public key of a key pair for which there is a corresponding K pri N. At boot time a user provides a K pri N herein termed the user private key for one of the key list entries in key list . This allows encryption boot loader to decrypt the partition as D P D entry N K pri N . Typically the user has one of the K pri N e.g. a user private key and an information technology IT department has the other keys which are kept for IT management or lost key recovery purposes.

In the present embodiment key list is a list of entries e.g. key list entries A N in which each entry N includes an encrypted session key that corresponds to a user s private key K pri N. Each entry in key list retains a public key K pub N of a public private key pair K pub N K pri N that is used to decrypt the session key K session. The session key is then used to decrypt the partition allowing access to encrypted data . Thus a key list entry A N in key list is of the form E K session K pub N where E is a public key algorithm such as RSA K pub N is the pubic key of a key pair for which there is a corresponding user private key K pri N and K session is an encrypted session key.

The correspondence completes the public private key sequence e.g. completes the key pair K pub N K pri N and decrypts the encrypted session key K session in the key list entry. The decrypted session key is then used to decrypt a disk access key of the encrypted partition and thus decrypts encrypted data . Disk encryption mechanisms such as whole disk encryption mechanisms are well known to those of skill in the art and are not further described herein to avoid detracting from the description.

User device may further include standard devices like a keyboard a mouse a printer and a display device as well as one or more standard input output I O devices such as a compact disk CD or DVD drive floppy disk drive or other digital or waveform port for inputting data to and outputting data from user device . In one embodiment secure system shutdown application and or automated secure key re provisioning application are loaded onto user device via I O device such as from a CD DVD floppy disk or other storage device containing secure system shutdown application and or automated secure key re provisioning application .

In one embodiment user device is coupled to a key management system device of system by a network . Key management system device typically includes an operating system a processor a memory and a network interface . In one embodiment key management system device utilizes a key management system such as Dynamic Host Configuration Protocol DHCP and further includes a master key list .

In one embodiment master key list is a list in which each master key list entry A N is a copy of a private key for a key list entry in a key list on a user s device. Each master key list entry A N in master key list retains a private key K pri N associated with a user and a public portion K pub N of a public private key pair K pub N K pri N . Thus a master key list entry in master key list is of the form E K pub N K pri N where E is an encryption algorithm such as AES K pub N is a public key and K pri N is a private key associated with a user.

Key management system device may further include standard devices such as a keyboard a mouse a printer a display device and an I O device s . The various hardware components of server computer system are not illustrated to avoid detracting from the description.

Network can be any network or network system that is of interest to a user. In various embodiments network interface and I O interface include analog modems digital modems or a network interface card. The particular type and configuration of user device and key management system device are not essential to the present embodiment.

In some embodiments user of user device can communicate with a user of key management system device over a trusted communication channel . For example user and user can establish a secure telephone connection e.g. a trusted communication channel such that authentication and verification procedures as well as key management passwords e.g. key re provisioning information are communicated between user and user over trusted communication channel . In some embodiments user device and or key management system device include stored system policy information not shown such as secure shutdown policy information accessible by user device and or key management system device .

As further described herein with reference to in one embodiment a secure shutdown process is implemented by secure system shutdown application which removes a user s key list entry which corresponds to the user s private key K pri N from key list . Consequently the user is unable to access encrypted data on user device .

As further described herein with reference to in a further embodiment an automated secure key re provisioning process is implemented to automatically and securely restore a user s access to the encrypted data on user device . In one embodiment a user key list entry corresponding to the user s private key is automatically generated and added to key list . Consequently the user is able to access encrypted data on user device .

In DETECT SHUTDOWN operation secure system shutdown application detects a shutdown event on user device . For example secure system shutdown application detects a user input entered on user device such as key input or graphical user interface GUI selection input to shutdown user device . In one embodiment detection of the shutdown event results in secure system shutdown application interrupting the shutdown process of user device to allow the operations of method to be performed. From DETECT SHUTDOWN processing transitions to a SECURE SHUTDOWN check operation .

In SECURE SHUTDOWN check operation secure system shutdown application determines whether a secure shutdown has been selected. In one embodiment the user input indicates whether or not a secure system shutdown is selected. In another embodiment where a secure system shutdown is not indicated secure system shutdown application generates and sends a query to the user whether or not a secure system shutdown is to be initiated. The user response to the query is received by secure system shutdown application and a determination is made whether secure shutdown has been selected.

In one embodiment when a secure shutdown is selected YES from SECURE SHUTDOWN check operation processing transitions to a DELETE USER KEY LIST ENTRY operation further described later herein. Alternatively when a secure shutdown is not selected NO in one embodiment from SECURE SHUTDOWN check operation processing transitions to a PERFORM POLICY CHECK operation .

In PERFORM POLICY CHECK operation secure shutdown application accesses or queries a system shutdown policy such as a stored security policy associated with user device and obtains shutdown policy information that indicates whether or not a secure system shutdown is to be performed on shutdown of user device . From PERFORM POLICY CHECK operation processing transitions to an IMPOSE SECURE SHUTDOWN check operation .

In IMPOSE SECURE SHUTDOWN check operation a determination is made whether or not to impose a secure shutdown of user device . In one embodiment secure shutdown application makes the determination based on the shutdown policy information obtained in operation .

In one embodiment when the shutdown policy information indicates a secure shutdown is not required to be performed NO from IMPOSE SECURE SHUTDOWN check operation processing transitions to a SHUTDOWN USER DEVICE operation further described later herein. Alternatively when the shutdown policy information indicates a secure shutdown is required to be performed YES from IMPOSE SECURE SHUTDOWN check operation processing transitions to DELETE USER KEY LIST ENTRY operation .

In DELETE USER KEY LIST ENTRY operation the user key list entry associated with the user s private key K pri N is deleted from key list . In one embodiment the user s private key is securely deleted from key list . Secure deletion of data from storage areas such as from disks is well known to those of skill in art and not further described herein to avoid detraction from the description. Deletion of the user key list entry e.g. Key list entry A from key list prevents the user from utilizing the current user private key to decrypt the session key and consequently prevents the user from accessing encrypted data .

In SHUTDOWN USER DEVICE operation user device is shutdown. More particularly following deletion of user key list entry A secure shutdown application permits user device to continue shutdown operations e.g. shutdown of user device is resumed. Standard shutdown operations are well known to those of skill in the art and are not further described herein to avoid detracting from the description. From SHUTDOWN USER DEVICE operation processing transitions to an EXIT operation with processing exiting method .

Thus in one embodiment user device is now securely shutdown such that even if user is coerced into providing the user private key the user private key will not have a corresponding key list entry in key list and consequently the user s private key cannot be used to decrypt encrypted data on user device .

In some embodiments secure system shutdown application includes further methods to mitigate adverse effects upon the user such as when the user is in hostile or other coercive environments and or to allow the user to remotely restart and obtain a user private key when in a trusted environment.

Referring now to A B and together in one embodiment execution of secure system shutdown application by processor results in the operations of method as described below. In one embodiment method is entered at an ENTER operation and processing transitions to a DETECT RESTART operation .

In DETECT BOOT UP operation secure system shutdown application detects boot up e.g. restart of user device . For example secure system shutdown application detects a power up event or a boot execute event on user device . In one embodiment detection of the boot up results in secure system shutdown application interrupting the boot process of user device to allow the operations of method to be performed. From DETECT BOOT UP operation processing transitions to a QUERY USER CREDENTIAL S operation .

In QUERY USER CREDENTIAL S operation secure system shutdown application generates and sends a user credential query that is displayed on user device such as on display device . In one embodiment the query is displayed to user as a GUI which allows user to enter one or more user credentials such as a name and password and or user private key K pri N for restart of user device . From QUERY USER CREDENTIAL S operation processing waits and transitions to a RECEIVE USER CREDENTIAL S operation on receipt of input user credential s .

In RECEIVE USER CREDENTIAL S operation secure system shutdown application receives the user credential s input by user in response to the query of operation . From RECEIVE USER CREDENTIAL S operation processing transitions to a USER ENTRY check operation .

In USER ENTRY check operation secure system shutdown application determines whether or not the user credential s received in operation correspond to a key list entry in key list . In one embodiment if the user credential s correspond to a key list entry in key list YES from USER ENTRY check operation processing transitions to a BOOT SYSTEM operation .

In BOOT SYSTEM operation user device is permitted to proceed with boot operations and restart user device . Standard boot operations of a user device are well known to those of skill in art and not further described herein to avoid detracting from the description. From BOOT SYSTEM operation processing transitions to a DECRYPT ENCRYPTED PARTITION DATA operation .

In DECRYPT ENCRYPTED PARTITION DATA operation the user credential s received in operation are used to complete the public key in the corresponding key list entry in key list and decrypt the session key which in turn is used to decrypt the encrypted partition and access encrypted data . From DECRYPT ENCRYPTED PARTITION DATA operation processing transitions to an EXIT operation with processing exiting method .

Referring now back again to USER ENTRY check operation alternatively in one embodiment if the user credentials do not correspond to a key list entry in key list NO from USER ENTRY check operation processing transitions to a TAKE PROTECTIVE ACTION S operation .

In TAKE PROTECTIVE ACTION S one or more protective actions are taken. For example when the input user credential s do not correspond to at least one key list entry in key list it is assumed that protective action is needed e.g. the restart is under duress. In one embodiment the user is queried again for user credential s . In some embodiments a security alert is generated and sent such as to key management system device and or to an alert system. In some embodiments the user is automatically redirected to dummy information or a non encrypted area of data. In still other embodiments the user is sent a default error message the system is shutdown or encrypted data is securely deleted. In various embodiments the protective actions can be modified to address specific environments user may encounter such as while traveling with user device . From TAKE PROTECTIVE ACTION S operation processing transitions to EXIT operation with processing exiting method .

In some embodiments secure system shutdown application includes further operations to allow remote start up of user device when user is in a trusted environment. illustrate a process flow diagram of a method for remote restart of user device in a trusted environment in accordance with another embodiment. More particularly user separately obtains a recovery password over a trusted communication channel such as from user via trusted communication channel to input to remote restart method .

Referring now to A B C and A B together in one embodiment execution of secure system shutdown application by processor results in the operations of method as described below. In one embodiment as shown in method is entered at an ENTER operation and from ENTER operation processing transitions to a DETECT RESTART operation .

In DETECT BOOT UP operation secure system shutdown application detects a boot up e.g. a restart of user device . For example secure system shutdown application detects a power up event or a boot execute event on user device . In one embodiment detection of the boot up results in secure system shutdown application interrupting the boot process of user device to allow the operations of method to be performed. From DETECT BOOT UP operation processing transitions to a QUERY RECOVERY PASSWORD operation .

In QUERY RECOVERY PASSWORD operation secure system shutdown application generates and sends a recovery password query that is displayed on user device such as on display device to user . In one embodiment the query is displayed to user as a GUI which allows user to enter at least one recovery password for restart of user device . In the present embodiment user separately obtains a recovery password over a trusted communication channel such as from user via trusted communication channel to input to remote restart method . From QUERY RECOVERY PASSWORD operation processing waits and transitions to a RECEIVE RECOVERY PASSWORD operation on receipt of at least one recovery password.

In RECEIVE RECOVERY PASSWORD operation secure system shutdown application receives the recovery password input by user in response to the query of operation . From RECEIVE RECOVERY PASSWORD operation processing transitions to a QUERY INITIATE RECOVERY operation .

In QUERY INITIATE RECOVERY operation secure system shutdown application generates and sends an initiate recovery query that is displayed on user device such as on display device to user . In one embodiment the query is displayed to user as a GUI which allows the user to enter at least one recovery password for restart of user device . From QUERY INITIATE RECOVERY operation processing waits and transitions to a RECEIVE INITIATE RECOVERY RESPONSE operation on receipt of a response to the initiate recovery query.

In RECEIVE INITIATE RECOVERY RESPONSE operation secure system shutdown application receives the response input by user in response to the initiate recovery query of operation for example an input of a YES or a NO . From RECEIVE INITIATE RECOVERY RESPONSE operation processing transitions to an INITIATE RECOVERY check operation .

In INITIATE RECOVERY check operation a determination is made whether or not to initiate recovery of the key list entry based on the initiate recovery response received in operation . In one embodiment if user inputs a selection not to initiate recovery NO from INITIATE RECOVERY check operation processing transitions to an EXIT operation with processing exiting method . Alternatively if user inputs a selection to initiate recovery YES from INITIATE RECOVERY check operation processing transitions to a LOCATE CORRESPONDING KEY LIST ENTRY operation .

Referring now to in LOCATE CORRESPONDING KEY LIST ENTRY operation secure system shutdown application locates the corresponding key list entry in key list e.g. the key list entry in key list which corresponds to the recovery password provided to the user and input to user device . For example referring again to the key list entry corresponding to the recovery password can be key list entry B. From LOCATE CORRESPONDING KEY LIST ENTRY operation processing transitions to a DECRYPT SESSION KEY operation .

In DECRYPT SESSION KEY operation the recovery password is utilized to decrypt the session key in the corresponding key list entry. For example the recovery password completes the public private key pair of key list entry B and decrypts the session key K session of key list entry B. From DECRYPT SESSION KEY operation processing transitions to a QUERY USER PASSWORD operation .

In QUERY USER PASSWORD operation the user is queried for a user password. In one embodiment secure system shutdown application generates and sends a user password query that is displayed on user device such as on display device to user . In one embodiment the query is displayed to user as a GUI which allows the user to enter at least one user password. In one embodiment the user password is the initial user private key that originally corresponded to the deleted key list entry e.g. the user private key to key list entry A. From QUERY USER PASSWORD operation processing transitions to a RECEIVE USER PASSWORD operation on receipt of at least one user password.

In RECEIVE USER PASSWORD operation secure system shutdown application receives the user password input by user in response to the query of operation . From RECEIVE USER PASSWORD operation processing transitions to an ENCRYPT SESSION KEY operation .

In ENCRYPT SESSION KEY operation the session key decrypted in operation is encrypted utilizing the user password received in operation e.g. the user s private key that corresponded to deleted key list entry A. From ENCRYPT SESSION KEY operation processing transitions to a GENERATE NEW KEY LIST ENTRY operation .

In GENERATE NEW KEY LIST ENTRY operation a new key list entry is generated in key list . More particularly in one embodiment the session key encrypted in operation is now stored in as a new key list entry in key list . In this way the user s password e.g. the user s private key can again be utilized to decrypt encrypted data . For example in new key list entry C is added to key list C. In the present embodiment key list entry C includes the session key encrypted with the user s private key half of the public private key pair. From GENERATE NEW KEY LIST ENTRY operation processing transitions to a BOOT SYSTEM operation .

In BOOT SYSTEM operation user device is permitted to continue boot loading and restart. From BOOT SYSTEM operation processing transitions to a DECRYPT ENCRYPTED PARTITION DATA operation .

In DECRYPT ENCRYPTED PARTITION DATA operation the user credential s received in operation are used to complete the public key in the new key list entry in key list e.g. key list entry C which in turn is used to decrypt the encrypted partition and encrypted data . From DECRYPT ENCRYPTED PARTITION DATA operation processing transitions to EXIT operation with processing exiting method .

In DECRYPT ENCRYPTED PARTITION DATA operation the user credential s received in operation are used to complete the public key in the corresponding key list entry in key list and decrypt the session key which in turn is used to decrypt the encrypted partition and access encrypted data . From DECRYPT ENCRYPTED PARTITION DATA operation 

In one embodiment user device further includes automated secure key re provisioning application which implements an automated secure key re provisioning process. More particularly the user does not have to establish a separate trusted communication channel with a user of key management system device but rather can automatically and securely re provision a private key over a network such as network .

In DETECT BOOT UP operation automated secure key re provisioning application detects boot up e.g. a boot event on user device . For example automated secure key re provisioning application detects a boot execute event on user device . In one embodiment detection of the boot event results in automated secure key re provisioning application interrupting the boot process of user device to allow the operations of method to be performed. From DETECT BOOT UP operation processing transitions to a QUERY USER CREDENTIAL S operation .

In QUERY USER CREDENTIAL S operation automated secure key re provisioning application generates and sends a user credential query that is displayed on user device such as on display device . In one embodiment the query is displayed as a GUI which allows a user e.g. user to enter one or more user credentials such as a name and or password for restart of user device . For example in one embodiment the query requests a username a user password and or other user authentication token s . From QUERY USER CREDENTIAL S operation processing transitions to a RECEIVE USER CREDENTIAL S operation on receipt of input user credential s .

In RECEIVE USER CREDENTIAL S operation automated secure key re provisioning application receives the user credential s input by user in response to the query of operation . For example automated secure key re provisioning application receives a user name and a user password or other user authentication token. From RECEIVE USER CREDENTIAL S operation processing transitions to an OBFUSCATE USER CREDENTIAL S operation .

In OBFUSCATE USER CREDENTIAL S operation the user credential s received in operation are obfuscated. For example in one embodiment automated secure key re provisioning application encrypts hashes or otherwise obfuscates the user credential s . From OBFUSCATE USER CREDENTIAL S operation processing transitions to a GENERATE RE PROVISIONING REQUEST operation .

In GENERATE RE PROVISIONING REQUEST operation a re provisioning request is automatically generated and sent to key management system device . In one embodiment automated secure key re provisioning application generates and sends a re provisioning request requesting regeneration of a user private key for the user on user device . More particularly in one embodiment the re provisioning request includes an identifier for the device for which the user private key is being re provisioned e.g. an identifier for user device and the obfuscated user credential s . In this way the user s private key information is automatically and securely sent from user device to key management system device .

In one embodiment key management system device receives the re provisioning request and verifies the user s credential s for example via the encryption hash or other obfuscation method. In some embodiments key management system device also validates the user device identified in the request e.g. user device is a member of the network managed by key management system device . Key management system device automatically generates and sends a response containing some K pri M from a master key list entry A N and the user s original public key K pub N. Thus for example referring to key management system device returns a response including for example master key list entry A. In some embodiments the master key list entry is obfuscated in the re provisioning response. An example of a method for generating a response to a secure key re provisioning request by key management system device is further described herein with reference to .

In RECEIVE RE PROVISIONING REQUEST operation the re provisioning request generated and sent in operation is received by key management system of key management system device . From RECEIVE RE PROVISIONING REQUEST operation processing transitions to a DE OBFUSCATE USER CREDENTIAL S operation .

In DE OBFUSCATE USER CREDENTIAL S operation the obfuscated user credential s received in the re provisioning request are de obfuscated such as in accordance with the encryption hash or other obfuscation method used to obfuscate the user credential s . Thus key management system has the user s private key. From DE OBFUSCATE USER CREDENTIAL S operation processing transitions to a VERIFY RE PROVISIONING REQUEST operation .

In VERIFY RE PROVISIONING REQUEST operation the user s credentials and or the user device identifier received in the re provisioning request are evaluated to determine whether or not the re provisioning request is verified i.e. is valid for key re provisioning. Any of a number of verification procedures can be used. Verification techniques are well known to those of skill in the art and are not further described herein to avoid detracting from the description. From VERIFY RE PROVISIONING REQUEST operation processing transitions to a VERIFIED check operation .

In VERIFIED check operation a determination is made whether or not the re provisioning request is verified based on the verification procedures performed in operation . In one embodiment if the re provisioning request is not verified NO from VERIFIED check operation processing transitions to a RETURN DENIAL operation .

In RETURN DENIAL operation a denial of the re provisioning request is generated and returned to automated secure key re provisioning application . In some embodiments further information is provided in the denial such as an IT contact point. From RETURN DENIAL operation processing transitions to an EXIT operation with processing exiting method .

Referring again to VERIFIED check operation alternatively in one embodiment if the re provisioning request is verified YES from VERIFIED check operation processing transitions to a SELECT MASTER KEY LIST ENTRY operation .

In SELECT MASTER KEY LIST ENTRY operation a master key list entry A N corresponding to the user s private key is selected for example master key list entry A. From SELECT MASTER KEY LIST ENTRY operation processing transitions to a GENERATE RE PROVISIONING RESPONSE operation .

In GENERATE RE PROVISIONING RESPONSE operation a re provisioning response is generated and sent to automated secure key re provisioning application . In one embodiment the re provisioning response includes the private key and public key of the master key list entry selected in operation e.g. master key list entry A. In some embodiments the re provisioning response is obfuscated to protect the key data or sent with authentication tokens. In one embodiment the re provisioning response is sent to automated secure key re provisioning application for example via network . From GENERATE RE PROVISIONING RESPONSE operation processing transitions to EXIT operation with processing exiting method or optionally returning to operation on receipt of a next re provisioning request. Referring now back to from GENERATE RE PROVISIONING REQUEST operation processing transitions to a RECEIVE RE PROVISIONING RESPONSE operation on receipt of a response to the re provisioning request.

In RECEIVE RE PROVISIONING RESPONSE operation the response to the re provisioning request to operation is received. More particularly automated secure key re provisioning application receives the re provisioning response from key management system device . In one embodiment as earlier described the re provisioning response includes the user s original public key K pub N and a K pri M from master key list needed to regenerate a user key list entry in key list . In some embodiments the re provisioning response is obfuscated and de obfuscated on receipt by user device . From RECEIVE RE PROVISIONING RESPONSE operation processing transitions to a LOCATE CORRESPONDING KEY LIST ENTRY operation .

Referring now to in LOCATE CORRESPONDING KEY LIST ENTRY operation secure system shutdown application locates the corresponding key list entry in key list e.g. the key list entry in key list which corresponds to the re provisioning private key K pri M received in operation . For example referring again to the key list entry corresponding to the re provisioning password can be key list entry B. From LOCATE CORRESPONDING KEY LIST ENTRY operation processing transitions to a DECRYPT SESSION KEY operation .

In DECRYPT SESSION KEY operation the re provisioning private key is utilized to decrypt the session key in the corresponding key list entry. For example encryption bootloader uses the private key K pri M to decrypt the session key e.g. in key list entry B formally D entryM K pri M K session. As bootloader knows K pub N it recreates the user s entryN E. In some embodiments the entry M can be deleted to prevent reuse of the token. From DECRYPT SESSION KEY operation processing transitions to a QUERY USER PASSWORD operation .

In QUERY USER PASSWORD operation the user is queried for a user password. In one embodiment secure system shutdown application generates and sends a user password query that is displayed on user device such as on display device to user . In one embodiment the query is displayed to user as a GUI which allows the user to enter at least one user password. In one embodiment the user password is the initial user private key that originally corresponded to the deleted key list entry e.g. the user private key to key list entry A. From QUERY USER PASSWORD operation processing transitions to a RECEIVE USER PASSWORD operation on receipt of at least one user password.

In RECEIVE USER PASSWORD operation secure system shutdown application receives the user password input by user in response to the query of operation . From RECEIVE USER PASSWORD operation processing transitions to an ENCRYPT SESSION KEY operation .

In ENCRYPT SESSION KEY operation the session key decrypted in operation is encrypted utilizing the user password received in operation e.g. the user s private key that corresponded to deleted key list entry A. From ENCRYPT SESSION KEY operation processing transitions to a GENERATE NEW KEY LIST ENTRY operation .

In GENERATE NEW KEY LIST ENTRY operation a new key list entry is generated in key list . More particularly in one embodiment the session key encrypted in operation is now stored in as a new key list entry in key list . In this way the user s password e.g. the user s private key can again be utilized to decrypt encrypted data . For example in new key list entry C is added to key list C. In the present embodiment key list entry C includes the session key encrypted with the user s private key half of the public private key pair. Referring back to from GENERATE NEW KEY LIST ENTRY operation processing transitions to a BOOT SYSTEM operation .

In BOOT SYSTEM operation user device is permitted to continue boot loading and start up of user device . From BOOT SYSTEM operation processing transitions to a DECRYPT ENCRYPTED PARTITION DATA operation .

In DECRYPT ENCRYPTED PARTITION DATA operation the user credential s received in operation are used to decrypt the session key in the new key list entry e.g. key list entry C which in turn is used to decrypt the encrypted partition and encrypted data . From DECRYPT ENCRYPTED PARTITION DATA operation processing transitions to EXIT operation with processing exiting method .

In one embodiment secure system shutdown method and automated secure key re provisioning application are in memory . As used herein a computer memory refers to a volatile memory a non volatile memory or a combination of the two. Although secure system shutdown method and automated secure key re provisioning application are referred to as applications this is illustrative only. Secure system shutdown method and automated secure key re provisioning application should be capable of being called from an application or the operating system. In one embodiment an application is generally defined to be any executable code. Moreover those of skill in the art will understand that when it is said that an application or an operation takes some action the action is the result of executing one or more instructions by a processor.

Various embodiments may be carried out using any suitable hardware configuration or means involving a personal computer a workstation a portable device or a network of computer devices. Other network configurations other than client server configurations e.g. peer to peer web based intranet internet network configurations are used in other embodiments.

Herein a computer program product comprises a medium configured to store or transport computer readable code in accordance with an embodiment. Some examples of computer program products are CD ROM disks DVDs ROM cards floppy disks magnetic tapes computer hard drives and servers on a network. In another embodiment a computer program product comprises a tangible storage medium configured to store computer readable code including CD ROM disks DVDs ROM cards floppy disks magnetic tapes computer hard drives and servers on a network.

As illustrated in this medium may belong to the computer system itself. However the medium also may be removed from the computer system. For example secure system shutdown method and automated secure key re provisioning application are may be stored in memory not shown that is physically located in a location different from processor . Processor should be coupled to the memory. This could be accomplished in a client server system or alternatively via a connection to another computer via modems and analog lines or digital interfaces and a digital carrier line.

More specifically in one embodiment user device and or server computer system is a portable computer a workstation a two way pager a cellular telephone a digital wireless telephone a personal digital assistant a server computer an Internet appliance or any other device that includes components that can execute the functionality of secure system shutdown method and or automated secure key re provisioning application in accordance with at least one of the embodiments as described herein. Similarly in another embodiment user device and or server computer system is comprised of multiple different computers wireless devices cellular telephones digital telephones two way pagers or personal digital assistants server computers or any desired combination of these devices that are interconnected to perform the methods as described herein.

In view of this disclosure the functionality of secure system shutdown method and automated secure key re provisioning application in accordance with one embodiment can be implemented in a wide variety of computer system configurations. In addition the functionality of secure system shutdown method and automated secure key re provisioning application could be stored as different modules in memories of different devices.

For example secure system shutdown method could initially be stored on a server computer system and then as necessary a portion of secure system shutdown method could be transferred to user device and executed on user device . Consequently part of the functionality of secure system shutdown method would be executed on a processor of the server computer system and another part would be executed on processor of user device . In view of this disclosure those of skill in the art can implement various embodiments in a wide variety of physical hardware configurations using an operating system and computer programming language of interest to the user.

This disclosure provides exemplary embodiments. The scope of the invention is not limited by these exemplary embodiments. Numerous variations whether explicitly provided for by the specification or implied by the specification or not may be implemented by one of skill in the art in view of this disclosure.

