---

title: Wireless location routing applications and architecture therefor
abstract: A system for wirelessly locating mobile station/units (MS) and using resulting location determinations for providing a product or service is disclosed. The system is useful for routing an MS user to a plurality of desired locations, alerting an MS user to a nearby desired product or service based on satisfaction of user criteria, and providing enhanced security and 911 response. In one embodiment, the system responds to MS location requests via, e.g., Internet communication between a distributed network of location processing sites. A plurality of locating technologies including those based on: () TDOA; () pattern recognition; () timing advance; () GPS and network assisted GPS, () angle of arrival, () super resolution enhancements, and () supplemental information from low cost base stations can be activated, in various combinations, by system embodiments. MS location difficulties resulting from poor location accuracy/reliability and/or poor coverage are alleviated via such technologies in combination with automatically adapting and calibrating system performance according to environmental and geographical changes so that the system becomes progressively more comprehensive and accurate. Further, the system can be modularly configured for use in location signaling environments ranging from urban, dense urban, suburban, rural, mountain to low traffic or isolated roadways. Accordingly, the system is useful for 911 emergency calls, tracking, routing, people and animal location including applications for confinement to and exclusion from certain areas.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08082096&OS=08082096&RS=08082096
owner: TracBeam LLC
number: 08082096
owner_city: Golden
owner_country: US
publication_date: 20080128
---
The present application is a continuation of U.S. patent application Ser. No. 10 297 449 filed Dec. 6 2002 which is the U.S. National Stage filing of International Application No. PCT US01 17957 filed Jun. 4 2001 which claims the benefit of U.S. Provisional Application No. 60 293 094 filed May 22 2001 these applications being fully incorporated herein by reference.

The present invention is directed generally to a system and method for locating people services or objects and in particular to a system and method for locating a wireless mobile station unit using various mobile station location estimators wherein e.g. a resulting location determination s is used for assisting in accessing a product or service. The present invention is additionally directed to a computational system and method for calibrating the relative performance of multiple location models wherein each such model is capable of being activated for generating hypotheses e.g. estimates and or predictions of an unknown condition such as the location of wireless mobile station.

There is great interest in providing existing infrastructures for wireless communication systems with the capability for locating people and or objects in a cost effective manner. Such a capability would be invaluable in a variety of situations especially in emergency crime situations and mobile commerce. There are numerous competing wireless location technologies that purport to effectively locate wireless mobile stations as used herein this term includes e.g. mobile phones short message devices SMS electronic container tracking tags micro transceivers for personal location and or emergency . These technologies can be generally classified as 

The wide variety of wireless location techniques can provide under appropriate circumstances the following advantages 

However the variety of wireless location techniques available is also problematic for at least the following reasons 

Accordingly it would be desirable to integrate into a single wireless location broker or wireless location gateway as many location techniques as possible so that location requests can be fulfilled without the requester needing to know what location technique is used. It would be further desirable for roaming MSs to be able to be located in coverage areas where a wireless location technique is different from the one or more techniques supported in the primary subscription area for the MS. Additionally it would be desirable to provide new applications for which MS location information can be applied via e.g. a wireless location gateway.

It is an objective of the present invention to provide a system and method for accurately locating people and or objects in a cost effective manner wherein a location requester can obtain an MS location without needing to provide location technique specific information with the request.

It is a further object the present invention to provide wireless location without the requester knowing the particulars of communication network with which the MS may be in contact e.g. the commercial radio service provider CMRS the wireless communications protocol etc.

Yet another objective is to provide a low cost location system and method adaptable to wireless telephony Internet systems for using a plurality of location techniques for increasing MS location accuracy and consistency. In particular the plurality of location techniques embodied in location estimators also denoted first order models or FOMs herein may be activated according to any one or more of a number of activation strategies such as concurrent activation e.g. for obtaining two location estimates of an MS location data driven activation e.g. activated when appropriate input data is available priority activation e.g. an attempt to activate a preferred FOM is first performed and if unsuccessful or a result unsatisfactory then an attempt at activating a second FOM is performed .

Yet another object is to or be able to integrate into a wireless location gateway a large number of MS location techniques such as 

A related object is to integrate handset centric network centric and hybrid systems so that the problems identified hereinabove are mitigated.

Note that it is an objective of the present invention to provide a plug and play capability for new wireless location estimators wherein new location estimators can be easily incorporated into an embodiment of the present invention. That is provide an interface that allows substantially automatic integration of new FOMs.

Yet another object is to provide novel applications for wireless location that benefits from an integration of different location techniques.

The following definitions are provided for convenience. In general the definitions here are also defined elsewhere in this document as well.

The present invention relates to a method and system for performing wireless mobile station location. In particular the present invention is a wireless mobile station location computing method and system that utilizes multiple wireless location computational estimators these estimators also denoted herein as MS location hypothesizing computational models first order models FOMs and or location estimating models for providing location estimates of a target mobile station MS wherein ambiguities and or conflicts between the location estimates may be effectively and straightforwardly resolved. More particularly the present invention provides a technique for calibrating the performance of each of the location estimators so that a confidence value e.g. a probability can be assigned to each generated location estimate. Additionally the present invention provides a straightforward technique for using the confidence values probabilities for deriving a resulting most likely location estimate of a target wireless mobile station.

More generally the present invention relates to a novel computational method and architecture for synergistically combining the results of a plurality of computational models in a straightforward way that allows the models to be calibrated relative to one another so that differences in results generated by the models can be readily resolved. Accordingly the computational method and architecture of the present invention may be applied to wide range applications where synergies between multiple models is expected to be enhance performance.

For a particular application having a plurality of computational models each generating a hypothetical estimate of a desired result s in a space of hypothesis results the present invention may be described at a high level as any method or system that performs the following steps 

For example for a wireless location system utilizing the present invention each location hypothesis H identifies an area for a target MS and H can used to identify additional related locations included in archived hypotheses generated by the same FOM as generated H. For instance such related locations may be the area centroids of the archived hypotheses wherein these centroids reside within the area hypothesized by H. Accordingly such centroids may be used to retrieve the corresponding actual verified MS locations i.e. the corresponding desired results and these retrieved verified locations may be used to generate a new adjusted area that is likely to be more accurate than H. In particular a convex hull of the verified locations may be used as a basis for determining a new location hypothesis of the target MS. Moreover this aspect of the invention may include the preprocessing of such adjustments throughout a wireless coverage area to produce a geolocation vector gradient field wherein for each archived hypotheses H having Las an MS location estimate for a designated FOM throughout the coverage area a corresponding verified location version VLis determined. Subsequently the adjustment vector AV VL L is determined as one of the adjustment vectors of the vector gradient field. Thus Land AVare associated in the data archive as a record of the vector gradient field. Accordingly when a location hypothesis H for a target MS at an unknown location is generated the hypothesis H having L as the target MS location estimate records within the vector gradient field having their corresponding location L near L e.g. within area of a predetermined distance about L or a neighborhood of L can be retrieved. Accordingly an adjustment to L can be determined as a function of the Land AVvalues of the retrieved records. Note that an adjustment to L may be simply an average of these AVvectors for the retrieved records. Alternatively the AVvalues may be weighted such that the AVhaving Lcloser to L are more influential in the resulting derived location for the target MS. More generally the adjustment technique includes a method for interpolating an adjustment at L from the verified adjustments at locations about L. Enhancements on such adjustment interpolation techniques are also within the scope of the present invention. For example the weightings or other terms of an such an interpolation technique may be combined with other known wireless signal characteristics of the area such as an identification of a a known sharp change in the geolocation gradient vector field and or b a subarea having reduced wireless transmission capabilities and or c a subarea wherein the retrieved records for the subarea have their estimates Lwidely spaced apart and or d a subarea wherein there is an insufficient number of retrieved records.

Referring to 4.1.3 there may be hypotheses for estimating not only desired result s but also hypotheses may be generated that indicate where the desired result s is not. Thus if the confidence values are probabilities an hypothesis may be generated that has a very low near zero probability of having the desired result. As an aside note that in general for each generated hypothesis H having a probability P there is a dual hypothesis Hthat may be generated wherein the Hrepresents the complementary hypothesis that the desired result is in the space of hypothesized results outside of H. Thus the probability that the desired result s is outside of the result hypothesized by H is 1 P. Accordingly with each location hypothesis having a probability favorably indicating where a desired result may be i.e. P 0.5 there is a corresponding probability for the complement hypothesis that indicates where the desired result s is unlikely to be. Thus applying this reasoning to a wireless location application utilizing the present invention then for an hypothesis H indicating that the target MS is in a geographical area A there is a dual location estimate Hthat may be generated wherein the Hrepresents the area outside of A and the probability that the target MS is outside of A is 1 P. Thus with each location hypothesis having a probability favorably indicating where a target MS may be i.e. P 0.5 there is a corresponding probability for the complement area not represented by the location hypothesis that does not favor the target MS being in this complement area. Further note that similar dual hypotheses can be used in other applications using the multiple model architecture of the present invention when probabilities are assigned to hypotheses generated by the models of the application.

Referring to 4.1.3 as it relates to a wireless location system provided by the present invention note that it is an aspect of the present invention to provide location hypothesis enhancing and evaluation techniques that can adjust target MS location estimates according to historical MS location data and or adjust the confidence values of location hypotheses according to how consistent the corresponding target MS location estimate is a with historical MS signal characteristic values b with various physical constraints and c with various heuristics. In particular the following capabilities are provided by the present invention 

As also mentioned above in 2.3 the present invention may utilize adaptive signal processing techniques. One particularly important utilization of such techniques includes the automatic tuning of the present invention so that e.g. such tuning can be applied to adjusting the values of location processing system parameters that affect the processing performed by the present invention. For example such system parameters as those used for determining the size of a geographical area to be specified when retrieving location signal data of known MS locations from the historical location signature data base can substantially affect the location processing. In particular a system parameter specifying a minimum size for such a geographical area may if too large cause unnecessary inaccuracies in locating an MS. Accordingly to accomplish a tuning of such system parameters an adaptation engine is included in the present invention for automatically adjusting or tuning parameters used by the present invention. Note that in one embodiment the adaptation engine is based on genetic algorithm techniques.

The present invention may include one or more FOMs that may be generally denoted as classification models wherein such FOMs are trained or calibrated to associate particular composite wireless signal characteristic values with a geographical location where a target MS could likely generate the wireless signal samples from which the composite wireless signal characteristic values are derived. Further the present invention may include the capability for training and retraining such classification FOMs to automatically maintain the accuracy of these models even though substantial changes to the radio coverage area may occur such as the construction of a new high rise building or seasonal variations due to for example foliage variations . As used herein training refers to iteratively presenting training data to a computational module for changing the behavior of the module so that the module may perform progressively better as it learns appropriate behavioral responses to the training data. Accordingly training may include for example the repeated input of training data to an artificial neural network or repeated statistical regression analyses on different and or enhanced training data e.g. statistical sample data sets . Note that other embodiments of a trained pattern matching FOMs for wireless location are disclosed in U.S. Pat. No. 6 026 304 titled Radio Transmitter Location Finding for Wireless Communication Network Services and Management filed Jan. 8 1997 and issued Feb. 15 2000 having Hilsenrath and Wax as inventors this patent being incorporated herein fully by reference.

It is well known in the wireless telephony art that the phenomenon of signal multipath and shadow fading renders most analytical location computational techniques such as time of arrival TOA or time difference of arrival TDOA substantially error prone in urban areas and particularly in dense urban areas without further statistical correlation processing such as such super resolution as disclosed in U.S. Pat. No. 5 890 068 by Fattouche et. al. issued on Mar. 30 1999 and incorporated fully herein by reference. Moreover it may be the case that even though such additional processing is performed the multipath phenomenon may still be problematic. However this same multipath phenomenon also may produce substantially distinct or peculiar signal measurement patterns wherein such a pattern coincides with a relatively small geographical area. Thus the present invention may include a FOM s utilize multipath as an advantage for increasing accuracy. Moreover it is worthwhile to note that the utilization of classification FOMs in high multipath environments is especially advantageous in that high multipath environments are typically densely populated. Thus since such environments are also capable of yielding a greater density of MS location signal data from MSs whose actual locations can be obtained there can be a substantial amount of training or calibration data captured by the present invention for training or calibrating such classification FOMs and for progressively improving the MS location accuracy of such models.

It is also an aspect of the present invention that classification FOMs may be utilized that determine target MS locations by correlating and or associating network anomalous behavior with geographic locations where such behavior occurs. That is network behaviors that are problematic for voice and or data communication may be used advantageously for locating a target MS. For example it is well known that wireless networks typically have within their coverage areas persistent subareas where voice quality is problematic due to e.g. measurements related to high total errors a high error rate or change in error rate. In particular such measurements may be related to frame error rates redundancy errors co channel interference excessive handoffs between base stations and or other call quality measurements. Additionally measurements may be used that are related to subareas where wireless communication between the network and a target MS is not sufficient to maintain a call i.e. deadzones . Thus information about such so called problematic behaviors may used by e.g. a location estimator FOM to generate a more accurate estimate of a target MS. For example such network behavioral measurements may be provided for training an artificial neural network and or for providing to a statistical regression analysis technique and or statistical prediction models e.g. using principle decomposition partial least squares or other regression techniques for associating or correlating such measurements with the geographic area for which they likely derive. Moreover note that such network behavioral measurements can also be used to reduce the likelihood of a target MS being in an area if such measurements are not what would be expected for the area.

It is also an aspect of the present invention that FOMs themselves may be hybrid combinations of MS location techniques. For example an embodiment of the present invention may include a FOM that uses a combination of Time Difference of Arrival TDOA and Timing Advance TA location measurement techniques for locating the target MS wherein such a technique may require only minor modifications to the wireless infrastructure. In particular such a FOM may provide reduced MS location errors and reduced resolution of ambiguities than are present when these techniques are used separately. One embodiment of such a FOM also denoted the Yost Model or FOM herein is disclosed in U.S. Pat. No. 5 987 329 filed Jul. 30 1997 and issued Nov. 16 1999 having Yost and Panchapakesan as inventors this patent being fully incorporated herein by reference.

Additionally note that FOMs related to the Yost Model may also be incorporated into embodiments of the present invention wherein an elliptical search restriction location technique may also be utilized. In particular such a technique is disclosed in U.S. patent application having U.S. Ser. No. 08 903 551 and entitled System and Method Using Elliptical Search Area Coverage in Determining the Location of a Mobile Terminal filed Jul. 30 1997 which is also incorporated by reference herein.

It is also a related aspect of the present invention to include a plurality of stationary low cost low power location detection base stations LBS each such LBS having both restricted range MS detection capabilities and a built in MS. Accordingly a grid of such LBSs can be utilized for providing wireless signaling characteristic data from their built in MSs for a re training such classification FOMs and b calibrating the FOMs so that each generated location hypothesis has a reliable confidence value probability indicative of the likeliness of the target MS being in an area represented by the location hypothesis.

It is a further aspect of the present invention that the personal communication system PCS infrastructures currently being developed by telecommunication providers offer an appropriate localized infrastructure base upon which to build various personal location systems PLS employing the present invention and or utilizing the techniques disclosed herein. In particular the present invention is especially suitable for the location of people and or objects using code division multiple access CDMA wireless infrastructures although other wireless infrastructures such as time division multiple access TDMA infrastructures and GSM are also contemplated. CDMA general principles are described for example in U.S. Pat. No. 5 109 390 to Gilhausen et al which is also incorporated herein by reference.

As mentioned in 1.7 and in the discussion of classification FOMs above embodiments of the present invention may include components e.g. FOMs that can substantially automatically retrain themselves to compensate for variations in wireless signal characteristics e.g. multipath due to environmental and or topographic changes to a geographic area serviced by the present invention. For example in one embodiment the present invention optionally includes low cost low power base stations denoted location base stations LBS above providing for example CDMA pilot channels to a very limited area about each such LBS. The location base stations may provide limited voice traffic capabilities but each is capable of gathering sufficient wireless signal characteristics from an MS within the location base station s range to facilitate locating the MS. Thus by positioning the location base stations at known locations in a geographic region such as for instance on street lamp poles and road signs additional MS location accuracy can be obtained. That is due to the low power signal output by such location base stations for there to be signaling control communication e.g. pilot signaling and other control signals between a location base station and a target MS the MS must be relatively near the location base station. Additionally for each location base station not in communication with the target MS it is likely that the MS is not near to this location base station. Thus by utilizing information received from both location base stations in communication with the target MS and those that are not in communication with the target MS the present invention may substantially narrow the possible geographic areas within which the target MS is likely to be. Further by providing each location base station LBS with a co located stationary wireless transceiver denoted a built in MS above having similar functionality to an MS the following advantages are provided 

 ii adjusting the confidence value initially assigned to a location hypothesis according to how accurate the generating FOM is in estimating the location of the stationary transceiver using data obtained from wireless signal characteristics of signals between the stationary transceiver and base stations with which the stationary transceiver is capable of communicating 

 iii automatically updating the previously mentioned historical data base i.e. the location signature data base wherein the stored signal characteristic data for each stationary transceiver can be used for detecting environmental and or topographical changes e.g. a newly built high rise or other structures capable of altering the multipath characteristics of a given geographical area and

 iv tuning of the location system parameters wherein the steps of a modifying various system parameters and b testing the performance of the modified location system on verified mobile station location data including the stationary transceiver signal characteristic data these steps being interleaved and repeatedly performed for obtaining better system location accuracy within useful time constraints.

One embodiment of the present invention utilizes a mobile location base station MBS that can be for example incorporated into a vehicle such as an ambulance police car or taxi. Such a vehicle can travel to sites having a transmitting target MS wherein such sites may be randomly located and the signal characteristic data from the transmitting target MS at such a location can consequently be archived with a verified location measurement performed at the site by the mobile location base station. Moreover it is important to note that such a mobile location base station as its name implies also includes base station electronics for communicating with mobile stations though not necessarily in the manner of a conventional infrastructure base station. In particular a mobile location base station may in one embodiment only monitor signal characteristics such as MS signal strength from a target MS without transmitting signals to the target MS. Alternatively a mobile location base station can periodically be in bi directional communication with a target MS for determining a signal time of arrival or time difference of arrival measurement between the mobile location base station and the target MS. Additionally each such mobile location base station includes components for estimating the location of the mobile location base station such mobile location base station location estimates being important when the mobile location base station is used for locating a target MS via for example time of arrival or time difference of arrival measurements as one skilled in the art will appreciate. In particular a mobile location base station can include 

Furthermore a mobile location base station includes modules for integrating or reconciling distinct mobile location base station location estimates that for example can be obtained using the components and devices of 7.1 through 7.4 above. That is location estimates for the mobile location base station may be obtained from GPS satellite data mobile location base station data provided by the location processing center dead reckoning data obtained from the mobile location base station vehicle dead reckoning devices and location data manually input by an operator of the mobile location base station.

The location estimating system of the present invention offers many advantages over existing location systems. The present invention employs a number of distinctly different location estimators which provide a greater degree of accuracy and or reliability than is possible with existing wireless location systems. For instance the location models provided may include not only the radius radius TOA and TDOA techniques but also adaptive techniques such as artificial neural net techniques and the techniques disclosed in the U.S. Pat. No. 6 026 304 by Hilsenrath et. al. incorporated by reference herein and angle or direction of arrival techniques as well as substantially any other wireless location technique wherein appropriate input data can be obtained.

It is also an aspect of the present invention that various embodiments may provide various strategies for activating within a single MS location instance one or more location estimators FOMs wherein each such activated location estimator is provided with sufficient wireless signal data input for the activation. In one embodiment one such strategy may be called greedy in that substantially as many location estimators may be activated as there is sufficient input additionally time and resources as well for activation. Note that some wireless location techniques are dependent on specialized location related devices being operational such as fixed or network based receivers antennas transceivers and or signal processing equipment. Additionally note that some location techniques also require particular functionality to be operable in the MS e.g. functionality for detecting one or more location related signals from satellites more generally non terrestrial transmitting stations . For example the signals may be GPS signals. Accordingly certain wireless location techniques may have their activations dependent upon whether such location related devices and or MS functionality are available and operable for each instance of determining an MS location. Thus for each MS wireless location instance location estimators may be activated according to the operable features present during an MS location instance for providing input activation data.

The present invention may be able to adapt to environmental changes substantially as frequently as desired. Thus the present invention may be able to take into account changes in the location topography over time without extensive manual data manipulation. Moreover the present invention can be utilized with varying amounts of signal measurement inputs. Thus if a location estimate is desired in a very short time interval e.g. less than approximately one to two seconds then the present invention can be used with only as much signal measurement data as is possible to acquire during an initial portion of this time interval. Subsequently after a greater amount of signal measurement data has been acquired additional more accurate location estimates may be obtained. Note that this capability can be useful in the context of 911 emergency response in that a first quick coarse wireless mobile station location estimate can be used to route a 911 call from the mobile station to a 911 emergency response center that has responsibility for the area containing the mobile station and the 911 caller. Subsequently once the 911 call has been routed according to this first quick location estimate by continuing to receive additional wireless signal measurements more reliable and accurate location estimates of the mobile station can be obtained.

Moreover there are numerous additional advantages of the system of the present invention when applied in communication systems using e.g. CDMA. The location system of the present invention readily benefits from the distinct advantages of the CDMA spread spectrum scheme. Namely these advantages include the exploitation of radio frequency spectral efficiency and isolation by a monitoring voice activity b management of two way power control c provisioning of advanced variable rate modems and error correcting signal encoding d inherent resistance to fading e enhanced privacy and f multiple rake digital data receivers and searcher receivers for correlation of signal multipaths.

At a more general level it is an aspect of the present invention to demonstrate the utilization of various novel computational paradigms such as 

The multiple FOM architecture provided herein is useful in implementing solutions in a wide range of applications. In fact most of the Detailed Description hereinbelow can be immediately translated into other application areas as one skilled in the art of computer application architectures will come to appreciate. For example the following additional applications are within the scope of the present invention 

In an alternative embodiment of the present invention the processing following the generation of location hypotheses each having an initial location estimate by the first order models may be such that this processing can be provided on Internet user nodes and the first order models may reside at Internet server sites. In this configuration an Internet user may request hypotheses from such remote first order models and perform the remaining processing at his her node.

Additionally note that it is within the scope of the present invention to provide one or more central location development sites that may be networked to for example geographically dispersed location centers providing location services according to the present invention wherein the FOMs may be accessed substituted enhanced or removed dynamically via network connections via e.g. the Internet with a central location development site. Thus a small but rapidly growing municipality in substantially flat low density area might initially be provided with access to for example two or three FOMs for generating location hypotheses in the municipality s relatively uncluttered radio signaling environment. However as the population density increases and the radio signaling environment becomes cluttered by for example thermal noise and multipath additional or alternative FOMs may be transferred via the network to the location center for the municipality.

Note that in some embodiments of the present invention since there is a lack of sequencing between the FOMs and subsequent processing of hypotheses e.g. location hypotheses or other application specific hypotheses the FOMs can be incorporated into an expert system if desired. For example each FOM may be activated from an antecedent of an expert system rule. Thus the antecedent for such a rule can evaluate to TRUE if the FOM outputs a location hypothesis and the consequent portion of such a rule may put the output location hypothesis on a list of location hypotheses occurring in a particular time window for subsequent processing by the location center. Alternatively activation of the FOMs may be in the consequents of such expert system rules. That is the antecedent of such an expert system rule may determine if the conditions are appropriate for invoking the FOM s in the rule s consequent.

The present invention may also be configured as a blackboard system with intelligent agents FOMs . In this embodiment each of the intelligent agents is calibrated using archived data so that for each of the input data sets provided either directly to the intelligent agents or to the blackboard each hypothesis generated and placed on the blackboard by the intelligent agents has a corresponding confidence value indicative of an expected validity of the hypothesis.

Of course other software architectures may also to used in implementing the processing of the location center without departing from scope of the present invention. In particular object oriented architectures are also within the scope of the present invention. For example the FOMs may be object methods on an MS location estimator object wherein the estimator object receives substantially all target MS location signal data output by the signal filtering subsystem. Alternatively software bus architectures are contemplated by the present invention as one skilled in the art will understand wherein the software architecture may be modular and facilitate parallel processing.

Further features and advantages of the present invention are provided by the figures and detailed description accompanying this invention summary. Note that the terms invention and present invention as used herein are to be considered generic terms for generally identifying novel aspects disclosed herein. The claims as provided hereinbelow define the scope of the invention for which patent protection has been granted.

When performing wireless location as described herein substantial improvements in radio location can be achieved since CDMA and other advanced radio communication infrastructures can be used for enhancing radio location. For example the capabilities of IS 41 and advanced intelligent network AIN already provide a coarse granularity of wireless location as is necessary to for example properly direct a terminating call to an MS. Such information originally intended for call processing usage can be re used in conjunction with the wireless location processing described herein to provide wireless location in the large i.e. to determine which country state and city a particular MS is located and wireless location in the small i.e. which location plus or minus a few hundred feet a given MS is located .

In addition the present invention provides one or more location centers gateways . Such gateways may be described at a high level as follows.

A location center gateway also be referred to as a location center gateway or simply gateway in response to a location request received at the location center can request activation of one or more of a plurality of wireless location techniques in order to locate an MS .

Various embodiments are provided herein of the location center gateway . In particular is block diagram illustrating another embodiment of the location center gateway of the present invention. Note that the wireless location gateway activation requests may be dependent upon e.g. 

Moreover regarding the plurality of wireless location techniques embodiments thereof also denoted herein as location estimators for which activation may be requested by the gateway these techniques may be co located with the gateway accessible via a network including i local area networks and ii wide area networks such as a telephony wired or wireless network the Internet or a cable network. The gateway may supply to one or more of the location estimators measurements of communications between the MS and one or more networks for determining a location of the MS . Alternatively instead of supplying such measurements locally or remotely and via a network or otherwise the gateway may provide with the location activation request an identification of where the measurements may be obtained e.g. one or more network addresses . In yet another alternative such a gateway may also send request s to the network s having such MS communication measurements to forward them to particular location estimators. Note that in performing these tasks the gateway may receive with a location request or may retrieve in response thereto information regarding the functionality of the target MS e.g. as discussed above. Accordingly such information may be used in selecting the location estimator to which an activation request is provided. Thus the gateway may be the intermediary between location requesting applications and the location estimators thereby providing a simple uniform application programming interface API for such applications substantially independently of the location estimators that are activated to fulfill such location requests. Moreover the gateway or embodiments thereof can substantially ease the burden on geolocation service providers by providing a substantially uniform method for obtaining target MS network signal data for use in locating the target MS. Thus by interfacing to the gateway a location service provider may substantially reduce the number and complexity of its data exchange interfaces with the wireless networks for obtaining target MS network signal data. Similarly the networks capturing such signal data may also reduce the complexity and number of their interfaces for providing such signal data to location service providers. Additionally note that the gateway may also fulfill location requests wherein the location is for a stationary and or wireline handset instead of a mobile station . Accordingly the gateway may request access to e.g. phone location information stored in a carrier s database of premise provisioning equipment as one skilled in the art will understand.

In some embodiments of the gateway it may also facilitate in the providing of certain location related services in addition to providing e.g. MS locations. In particular one or more of the following location related services may be facilitated by the gateway or may be made operative via the wireless location capabilities of the gateway . However note that the following location related services can in general be provided without use of a gateway albeit e.g. in a likely more restricted context wherein not all available wireless location estimating techniques are utilized and or by multiplying the number of interfaces to geolocation service providers e.g. distinct wireless location interfaces provided directly to each wireless location service provider utilized . Further note that some of these applications are described in greater detail in later sections herein 

Further note that various architectures for the location center location gateway are within the scope of the invention including a distributed architecture wherein in addition to the FOMs being possibly remotely accessed e.g. via a communications network such as the Internet the gateway itself may be distributed throughout one or more communication networks. Thus a location request received at a first location gateway portion may be routed to a second location gateway portion e.g. via the Internet . Such a distributed gateway may be considered a meta gateway and in fact such gateway portions may be fully functioning gateways in their own right. Thus such routing therebetween may be due to contractual arrangements between the two gateways each fulfilling location requests for a different network wireless carrier and or geographical region . For example for locating a stolen vehicle it is not uncommon for the stolen vehicle to be transported rapidly beyond the coverage area of a local or regional wireless vehicle locating service. Moreover a given location gateway may provide location information for only certain areas corresponding e.g. to contractual arrangements with the wireless carriers with which the location gateway is affiliated. Thus a first location gateway may provide vehicle locations for a first collection of one or more wireless networks and a second location gateway may provide vehicle locations for a second collection of one or more wireless networks. Accordingly for an MS built into a vehicle which can be detected by one or more wireless networks or portions thereof in each of the first and second collections then if the vehicle is stolen the first gateway may be initially contacted for determining whether the vehicle can be located via communications with the first collection of one or more wireless networks and if the vehicle can not be located the first gateway may provide a location request to the second gateway for thereby locating the stolen vehicle via wireless communications with one or more wireless networks of the second collection. Furthermore the first gateway may provide location requests for the stolen vehicle to other location gateways.

Since location base stations can be located on e.g. each floor of a multi story building the wireless location technology described herein can be used to perform location in terms of height as well as by latitude and longitude.

In operation an MS may utilize one or more of the wireless technologies CDMA TDMA AMPS NAMPS or GSM for wireless communication with a one or more infrastructure base stations b mobile base station s or c an LBS . Additionally note that in some embodiments of the invention there may be MS to MS communication.

Referring to again additional detail is provided of typical base station coverage areas sectorization and high level components within a radio coverage area including the MSC . Three exemplary base stations BSs are A B and C each of which radiate referencing signals within their area of coverage to facilitate mobile station MS radio frequency connectivity and various timing and synchronization functions. Note that some base stations may contain no sectors e.g. E thus radiating and receiving signals in a 360 degree omnidirectional coverage area pattern or the base station may contain smart antennas which have specialized coverage area patterns. However the generally most frequent base stations have three sector coverage area patterns. For example base station A includes sectors additionally labeled a b and c. Accordingly each of the sectors radiate and receive signals in an approximate 120 degree arc from an overhead view. As one skilled in the art will understand actual base station coverage areas stylistically represented by hexagons about the base stations generally are designed to overlap to some extent thus ensuring seamless coverage in a geographical area. Control electronics within each base station are used to communicate with a mobile stations . Information regarding the coverage area for each sector such as its range area and holes or areas of no coverage within the radio coverage area may be known and used by the location center to facilitate location determination. Further during communication with a mobile station the identification of each base station communicating with the MS as well as any sector identification information may be known and provided to the location center .

In the case of the base station types and communicating location information a base station or mobility controller BSC controls processes and provides an interface between originating and terminating telephone calls from to mobile station MS and the mobile switch center MSC . The MSC on the other hand performs various administration functions such as mobile station registration authentication and the relaying of various system parameters as one skilled in the art will understand.

The base stations may be coupled by various transport facilities such as leased lines frame relay T Carrier links optical fiber links or by microwave communication links.

When an MS is powered on and in the idle state it constantly monitors the pilot signal transmissions from each of the base stations located at nearby cell sites. Since base station sector coverage areas may often overlap such overlapping enables an MS to detect and in the case of certain wireless technologies communicate simultaneously along both the forward and reverse paths with multiple base stations and or sectors . In the constantly radiating pilot signals from base station sectors such as sectors a b and c of BS A are detectable by MSs within the coverage area for BS A. That is the mobile stations scan for pilot channels corresponding to a given base station sector identifiers IDs for determining in which coverage area i.e. cell it is contained. This is performed by comparing signal strengths of pilot signals transmitted from these particular cell sites.

The mobile station then initiates a registration request with the MSC via the base station controller . The MSC determines whether or not the mobile station is allowed to proceed with the registration process except e.g. in the case of a 911 call wherein no registration process is required . Once any required registration is complete calls may be originated from the mobile station or calls or short message service messages can be received from the network. Note that the MSC communicates as appropriate with a class 4 5 wireline telephony circuit switch or other central offices connected to the PSTN network. Such central offices connect to wireline terminals such as telephones or any communication device compatible with a wireline. The PSTN may also provide connections to long distance networks and other networks.

The MSC may also utilize IS 41 data circuits or trunks connecting to signal transfer point which in turn connects to a service control point via Signaling System 7 SS7 signaling links e.g. trunks for intelligent call processing as one skilled in the art will understand. In the case of wireless AIN services such links are used for call routing instructions of calls interacting with the MSC or any switch capable of providing service switching point functions and the public switched telephone network PSTN with possible termination back to the wireless network.

Referring still to the location center gateway LC interfaces with the MSC either via dedicated transport facilities using e.g. any number of LAN WAN technologies such as Ethernet fast Ethernet frame relay virtual private networks etc. or via the PSTN . The gateway may receive autonomous e.g. unsolicited command response messages regarding for example a the state of the wireless network of each commercial radio service provider utilizing the LC for wireless location services b MS and BS radio frequency RF measurements c communications with any MBSs and d location applications requesting MS locations using the location center gateway . Conversely the LC may provide data and control information to each of the above components in a d . Additionally the LC may provide location information to an MS via a BS . Moreover in the case of the use of a mobile base station MBS several communications paths may exist with the LC .

The MBS may act as a low cost partially functional moving base station and is in one embodiment situated in a vehicle e.g. land water or aircraft where an operator may engage in MS searching and tracking activities. In providing these activities using CDMA the MBS provides a forward link pilot channel for a target MS and subsequently receives unique BS pilot strength measurements from the MS . The MBS also includes a mobile station for data communication with the gateway via a BS . In particular such data communication includes telemetering at least the geographic position or estimates thereof of the MBS various RF measurements related to signals received from the target MS and in some embodiments MBS estimates of the location of the target MS . In some embodiments the MBS may utilize multiple beam fixed antenna array elements and or a moveable narrow beam antenna such as a microwave dish . The antennas for such embodiments may have a known orientation in order to further deduce a radio location of the target MS with respect to an estimated current location of the MBS . As will be described in more detail herein below the MBS may further contain a satellite e.g. global positioning system GPS receiver or other receiver for non terrestrial wireless signals for determining the location of the MBS and or providing wireless location assistance a target MS e.g. providing GPS information to the MS to assist the MS in determining its location. Additionally the MBS may include distance sensors dead reckoning electronics as well as an on board computing system and display devices for locating both the MBS itself as well as tracking and locating the target MS . The computing and display provides a means for communicating the position of the target MS on a map display to an operator of the MBS . It is important to note that in one embodiment an MBS may determine its location substantially independent of the communications network s with which the MBS communicates.

Each location base station LBS is a low cost location device. In some embodiments to provide such LBS s cost effectively each LBS only partially or minimally supports the air interface standards of the one or more wireless technologies used in communicating with both the BSs and the MSs . Each LBS when put in service is placed at a fixed location such as at a traffic signal lamp post etc. wherein the location of the LBS may be determined as accurately as for example the accuracy of the locations of the infrastructure BSs . Assuming the wireless technology CDMA is used each BS uses a time offset of the pilot PN sequence to identify a forward CDMA pilot channel. In one embodiment each LBS emits a unique time offset pilot PN sequence channel in accordance with the CDMA standard in the RF spectrum designated for BSs such that the channel does not interfere with neighboring BSs cell site channels and does not interfere with neighboring LBSs . Each LBS may also contain multiple wireless receivers in order to monitor transmissions from a target MS . Additionally each LBS contains mobile station electronics thereby allowing the LBS to both be controlled by e.g. the gateway or the wireless carrier s for the LBS and to transmit information to e.g. the gateway via e.g. at least one neighboring BS or to another wireless location service provider such as one providing one or more FOMs.

As mentioned above when the location of a particular target MS is desired the gateway may request location information about the target MS from for instance one or more activated LBSs in a geographical area of interest. Accordingly whenever the target MS is in an LBS coverage area or is suspected of being in the coverage area either upon command from the gateway or other location service provider or in a substantially continuous or periodic fashion the LBS s pilot channel appears to the target MS as a potential neighboring base station channel and consequently is placed for example in the CDMA neighboring set or the CDMA remaining set of the target MS as one familiar with the CDMA standards will understand .

During the normal CDMA pilot search sequence of the mobile station initialization state in the target MS the target MS will if within range of such an activated LBS detect the LBS pilot presence during the CDMA pilot channel acquisition substate. Consequently the target MS performs RF measurements on the signal from each detected LBS . Similarly an activated LBS can perform RF measurements on the wireless signals from the target MS . Accordingly each LBS detecting the target MS may subsequently telemeter back to the LC measurement results related to signals from to the target MS . Moreover upon command the target MS may telemeter back to the gateway its own measurements of the detected LBSs and consequently this new location information in conjunction with location related information received from the BSs can be used to locate the target MS .

It should be noted that an LBS will normally deny hand off requests since typically the LBS does not require the added complexity of handling voice or traffic bearer channels although economics and peak traffic load conditions may dictate preference here. Note that GPS timing information needed by any CDMA base station is either achieved via a the inclusion of a local GPS receiver or via a telemetry process from a neighboring conventional BS which contains a GPS receiver and timing information. Since energy requirements are minimal in such an LBS rechargeable batteries or solar cells may be used to power the LBSs. Further no expensive terrestrial transport link is typically required since two way communication is provided by an included MS or an electronic variation thereof within each LBS. Thus LBSs may be placed in numerous locations such as 

A location application programming interface denoted L API is may be provided between the location center gateway LC and the mobile switch center MSC network element type in order to send and receive various control signals and data messages. The L API may be implemented using a preferably high capacity physical layer communications interface such as IEEE standard 802.3 10 base T Ethernet although other physical layer interfaces could be used such as fiber optic ATM frame relay etc. At least two forms of L API implementation are possible. In a first case the signal control and data messages are provided using the MSC vendor s native operations messages inherent in the product offering without any special modifications. In a second case the L API includes a full suite of commands and messaging content specifically optimized for wireless location purposes which may require some although minor development on the part of an MSC vendor.

Referring to a signal processing subsystem labeled in other figures may be provided or accessed by the gateway . Such a signal processing subsystem may a receive control messages and signal measurements from one or more wireless service provider networks and b transmit appropriate control messages to such wireless networks via the location applications programming interface referenced earlier for wireless location purposes. The signal processing subsystem additionally provides various signal identification conditioning and pre processing functions including buffering signal type classification signal filtering message control and routing functions to the location estimating modules or FOMs.

There can be several combinations of Delay Spread Signal Strength sets of measurements made available to the signal processing subsystem . In some cases a mobile station may be able to detect up to three or four pilot channels representing three to four base stations or as few as one pilot channel depending upon the environment and wireless network configuration. Similarly possibly more than one BS can detect a mobile station transmitter signal and the fact that multiple CMRS base station equipment commonly will overlap coverage areas.

For each mobile station or BS transmitted signal that is detected by a receiver group at a base or mobile station respectively multiple delayed signals or fingers may be detected e.g. in CDMA and tracked resulting from multipath radio propagation conditions from a given transmitter. In typical spread spectrum diversity CDMA receiver design the first finger represents the most direct or least delayed multipath signal. Second or possibly third or fourth fingers may also be detected and tracked assuming the detecting base station and or mobile station contains a sufficient number of data receivers for doing so. The signal processing subsystem may utilize various wireless signal measurements of transmissions between a target mobile station and a network of base stations and or . Such measurements can be important in effectively estimating the location of mobile stations in that it is well known that measurements of wireless signal propagation characteristics such as signal strength e.g. RSSI time delay angle of arrival and any number other measurements can individually lead to gross errors in MS location estimates.

Accordingly one aspect of the present invention is directed to utilizing a larger number of wireless signal measurements and utilizing a plurality of MS estimation techniques to compensate for location estimation errors generated by some such techniques. For example due to the large capital outlay costs associated with providing three or more overlapping base station coverage signals in every possible location most practical digital PCS deployments result in fewer than three base station pilot channels being reportable in the majority of location areas thus resulting in a larger more amorphous location estimates by terrestrial triangulation systems. Thus by utilizing wireless signal measurements from a variety of sources substantially simultaneously and or greedily i.e. use whatever signal measurements can be obtained from any of the signal sources as they are obtained additional location enhancements can be obtained. For example by enhancing a mobile station with electronics for detecting satellite transmissions as done with mobile base stations and which also can be viewed as such an enhanced mobile station additional location related signals maybe obtained from 

Moreover the transmissions from the MS used for determining the MS s location need not be transmitted to terrestrial base stations e.g. . It is within the scope of the present invention that a target MS may transmit location related information to satellites as well. For example if a target MS detects two GPS satellite transmissions and is able to subsequently transmit the GPS signal measurements e.g. timing measurements to an additional satellite capable of determining additional MS location measurements according to the signals received then by performing a triangulation process at the location center gateway which may be co located with the additional satellite or at a remote terrestrial site a potentially reliable and accurate MS location can be obtained. Accordingly the present invention is capable of resolving wireless location ambiguities due to a lack of location related information of one type by utilizing supplemental location related information of a different type. Note that by type as used here it is intended to be interpreted broadly as e.g. 

Moreover it can be that different FOMs are provided for at least some wireless location computational models utilizing different types of location related information. For example in certain contexts wireless networks based on different wireless signaling technologies may be used to locate an MS during the time period of a single emergency call such as E911. Moreover in other contexts it may be possible for the target MS to use one or more of a plurality of wireless communication networks possibly based on different wireless communication technologies depending on availability the of technology in the coverage area. In particular since so called dual mode or tri mode mobile stations are available wherein such mobile stations are capable of wireless communication in a plurality of wireless communication technologies such as digital e.g. CDMA and or TDMA as well as analog or AMP NAMPS such mobile stations may utilize a first likely a default wireless communication technology whenever possible but switch to another wireless communication technology when e.g. coverage of the first wireless technology becomes poor. Moreover such different technologies are typically provided by different wireless networks wherein the term network is understood to include a network of communication supporting nodes geographically spaced apart that provide a communications infrastructure having access to information regarding subscribers to the network prior to a request to access the network by the subscribers . Accordingly the present invention may include or access FOMs for providing mobile station location estimates wherein the target MS communicates with various networks using different wireless communication technologies. Moreover such FOMs may be activated according to the wireless signal measurements received from various wireless networks and or wireless technologies supported by a target MS and to which there is a capability of communicating measurements of such varied wireless signals to the FOM s . Thus in one embodiment of the present invention there may be a triangulation or trilateration based FOM for each of CDMA TDMA and AMP NAMPS which may be singly serially or concurrently used for obtaining a particular location of an MS at a particular time e.g. for an E911 call . Thus when locating a target MS the MS may if there is overlapping coverage of two wireless communication technologies and the MS supports communications with both repeatedly switch back and forth between the two thereby providing additional wireless signal measurements for use in locating the target MS .

In one embodiment of the present invention wherein multiple FOMs may be activated substantially simultaneously or alternatively wherever appropriate input is received that allow particular FOMs to be activated . Note that at least some of the FOMs may provide inverse estimates of where a target MS is not instead of where it is. Such inverse analysis can be very useful in combination with location estimates indicating where the target MS is in that the accuracy of a resulting MS location estimate may be substantially decreased in size when such inverse estimates are utilized to rule out areas that otherwise appear to be likely possibilities for containing the target MS . Note that one embodiment of a FOM that can provide such reverse analysis is a location computational model that generates target MS location estimates based on archived knowledge of base station coverage areas such an archive being the result of e.g. the compilation a RF coverage database either via RF coverage area simulations or field tests . In particular such a model may provide target MS location inverse estimates having a high confidence or likelihood that that the target MS is not in an area since either a base station or can not detect the target MS or the target MS can not detect a particular base station. Accordingly the confidences or likelihoods on such estimates may be used by diminishing a likelihood that the target MS is in an area for the estimate or alternatively the confidence or likelihood of all areas of interest outside of the estimate can increased.

Note that in some embodiments of the present invention both measurements of forward wireless signals to a target MS and measurements of reverse wireless signals transmitted from the target MS to a base station can be utilized by various FOMs. In some embodiments the received relative signal strength RRSS of detected nearby base station transmitter signals along the forward link to the target mobile station can be more readily used by the location estimate modules FOMs since the transmission power of the base stations typically changes little during a communication with a mobile station. However the relative signal strength RRSS of target mobile station transmissions received by the base stations on the reverse link may require more adjustment prior to location estimate model use since the mobile station transmitter power level changes nearly continuously.

At a very high level the location center gateway computes or requests computation of location estimates for a wireless mobile station by performing at least some of the following steps 

 a optionally adjusting the target MS location estimates of the generated location hypotheses and or adjusting confidence values of the location hypotheses wherein for each location hypothesis its confidence value indicates the confidence or likelihood that the target MS is located in the location estimate of the location hypothesis. Moreover note that such adjusting uses archival information related to the accuracy and or reliability of previously generated location hypotheses 

 b optionally evaluating the location hypotheses according to various heuristics related to for example the radio coverage area terrain the laws of physics characteristics of likely movement of the target MS and

 c necessarily determining a most likely location area for the target MS wherein the measurement of confidence associated with each input MS location area estimate may be used for determining a most likely location area and

In order to describe how the steps 23.1 through 23.5 are performed in the sections below some introductory remarks related to the data denoted above as location hypotheses will be helpful. Additionally it will also be helpful to provide introductory remarks related to historical location data and the data base management programs associated therewith.

For each target MS location estimate generated and utilized by the present invention the location estimate is provided in a data structure or object class denoted as a location hypothesis illustrated in Table LH 1 . Brief descriptions of the data fields for a location hypothesis is provided in the Table LH 1.

As can be seen in the Table LH 1 each location hypothesis data structure includes at least one measurement denoted hereinafter as a confidence value or simply confidence that is a measurement of the perceived likelihood that an MS location estimate in the location hypothesis is an accurate location estimate of the target MS . Since in some embodiments of the invention such confidence values are an important aspect much of the description and use of such confidence values are described below however a brief description is provided here.

In one embodiment each confidence value is a probability indicative of a likeliness that the target MS resides within an geographic area represented by the hypothesis to which the confidence value applies. Accordingly each such confidence value is in the range 0 1 . Moreover for clarity of discussion it is assumed that unless stated otherwise that the probabilistic definition provided here is to be used when confidence values are discussed.

Note however other definitions of confidence values are within the scope of the present invention that may be more general than probabilities and or that have different ranges other than 0 1 . For example one such alternative is that each such confidence value is in the range 1.0 to 1.0 wherein the larger the value the greater the perceived likelihood that the target MS is in or at a corresponding MS location estimate of the location hypothesis to which the confidence value applies. As an aside note that a location hypothesis may have more than one MS location estimate as will be discussed in detail below and the confidence value will typically only correspond or apply to one of the MS location estimates in the location hypothesis. Further values for the confidence value field may be interpreted as a 1.0 means that the target MS is NOT in such a corresponding MS area estimate of the location hypothesis area b 0 means that it is unknown as to the likelihood of whether the MS in the corresponding MS area estimate and c 1.0 means that the MS is perceived to positively be in the corresponding MS area estimate.

Additionally in utilizing location hypotheses in for example the location evaluator as in 23.4 above it is important to keep in mind that for confidences cfand cf if cf

The notion of area type as related to wireless signal transmission characteristics has been used in many investigations of radio signal transmission characteristics. Some investigators when investigating such signal characteristics of areas have used somewhat naive area classifications such as urban suburban rural etc. However it is desirable for the purposes of the present invention to have a more operational definition of area types that is more closely associated with wireless signal transmission behaviors.

To describe embodiments of the an area type scheme that may be used in the present invention some introductory remarks are first provided. Note that the wireless signal transmission behavior for an area depends on at least the following criteria 

Accordingly a description of wireless signal characteristics for determining area types could potentially include a characterization of wireless signaling attributes as they relate to each of the above criteria. Thus an area type might be hilly treed suburban having no buildings above 50 feet with base stations spaced apart by two miles. However a categorization of area types is desired that is both more closely tied to the wireless signaling characteristics of the area and is capable of being computed substantially automatically and repeatedly over time. Moreover for a wireless location system the primary wireless signaling characteristics for categorizing areas into at least minimally similar area types are thermal noise and more importantly multipath characteristics e.g. multipath fade and time delay .

Focusing for the moment on the multipath characteristics it is believed that 23.8.1 and 23.8.3 immediately above are in general more important criteria for accurately locating an MS than 23.8.2 . That is regarding 23.8.1 multipath tends to increase as the density of nearby vertical area changes increases. For example multipath is particularly problematic where there is a high density of high rise buildings and or where there are closely spaced geographic undulations. In both cases the amount of change in vertical area per unit of area in a horizontal plane for some horizontal reference plane may be high. Regarding 23.8.3 the greater the density of base stations the less problematic multipath may become in locating an MS . Moreover the arrangement of the base stations in the radio coverage area in may affect the amount and severity of multipath.

Accordingly it would be desirable to have a method and system for straightforwardly determining area type classifications related to multipath and in particular multipath due to 23.8.1 and 23.8.3 . The present invention provides such a determination by utilizing a novel notion of area type hereinafter denoted transmission area type or area type when both a generic area type classification scheme and the transmission area type discussed hereinafter are intended for classifying similar areas wherein each transmission area type class or category is intended to describe an area having at least minimally similar wireless signal transmission characteristics. That is the novel transmission area type scheme of the present invention is based on a the terrain area classifications e.g. the terrain of an area surrounding a target MS b the configuration of base stations in the radio coverage area and c characterizations of the wireless signal transmission paths between a target MS location and the base stations .

In one embodiment of a method and system for determining such transmission area type approximations a partition denoted hereinafter as P is imposed upon the radio coverage area for partitioning for radio coverage area into subareas wherein each subarea is an estimate of an area having included MS locations that are likely to have is at least a minimal amount of similarity in their wireless signaling characteristics. To obtain the partition Pof the radio coverage area the following steps are performed 

Now assuming Phas been obtained the subareas of Pare provided with a first classification or categorization as follows 

Note that other transmission signal characteristics may be incorporated into the transmission area types. For example thermal noise characteristics may be included by providing a third radio coverage area partition P in addition to the partitions of Pand Pgenerated in 23.8.4.1 and 23.8.4.2 respectively. Moreover the time varying characteristics of 23.8.2 may be incorporated in the transmission area type frame work by generating multiple versions of the transmission area types such that the transmission area type for a given subarea of Pmay change depending on the combination of time varying environmental characteristics to be considered in the transmission area types. For instance to account for seasonality four versions of the partitions Pand Pmay be generated one for each of the seasons and subsequently generate a potentially different partition Pfor each season. Further the type and or characteristics of base station antennas may also be included in an embodiment of the transmission area type.

Other embodiments of area types are also within the scope of the present invention. As mentioned above each of the first order models have default confidence values associated therewith and these confidence values may be probabilities. More precisely such probability confidence values can be determined as follows. Assume there is a partition of the coverage area into subareas each subarea being denoted a partition area. For each partition area activate each first order model with historical location data in the Location Signature Data Base wherein the historical location data has been obtained from corresponding known mobile station locations in the partition area. For each first order model determine a probability of the first order model generating a location hypothesis whose location estimate contains the corresponding known mobile station location. To accomplish this assume the coverage area is partitioned into partition areas A wherein each partition area A is specified as the collection of coverage area locations such that for each location the detected wireless transmissions between the network base stations and a target mobile station at the location can be straightforwardly equated with other locations of area A. For example one such partition P can be defined wherein each partition area A is specified in terms of three sets of base station identifiers namely a the base station identifiers of the base stations that can be both detected at each location of A and can detect a target mobile station at each location b the identifiers for base stations that can detect a target mobile station at each location of A but can not be detected by the target mobile station and c the identifiers for base stations that can be detected by a target mobile station at each location of A but these base stations can not detect the target mobile station. That is two locations Iand I. are identified as being in A if and only if the three sets of a b and c for Iare respectively identical to the three sets of a b and c for I.

Accordingly assuming the partition Pis used a description can be given as to how probabilities may be assigned as the confidence values of location hypotheses generated by the first order models . For each partition area A a first order model is supplied with wireless measurements of archived location data in the Location Signature Data Base associated with corresponding verified mobile station locations. Thus a probability can be determined as to how likely the first order model is to generate a location hypothesis having a location estimate containing the corresponding verified mobile station location. Accordingly a table of partition area probabilities can be determined for each first order model . Thus when a location hypothesis is generated and identified as belonging to one of the partition areas the corresponding probability for that partition area may be assigned as the confidence value for the location hypothesis. The advantages to using actual probabilities here is that as will be discussed below the most likelihood estimator can compute a straightforward probability for each distinct intersection of the multiple location hypotheses generated by the multiple first order models such that each such probability indicates a likelihood that the target mobile station is in the corresponding intersection.

It is an aspect of the present invention that MS location processing performed by the location center gateway should become increasingly better at locating a target MS both by a building an increasingly more detailed model of the signal characteristics of locations in the service area for the present invention and also b by providing capabilities for the location center processing to adapt to environmental changes.

One way these aspects of the present invention are realized is by providing one or more data base management systems and data bases for 

 a storing and associating wireless MS signal characteristics with known locations of MSs used in providing the signal characteristics. Such stored associations may not only provide an increasingly better model of the signal characteristics of the geography of the service area but also provide an increasingly better model of more changeable signal characteristic affecting environmental factors such as weather seasons and or traffic patterns 

 b adaptively updating the signal characteristic data stored so that it reflects changes in the environment of the service area such as for example a new high rise building or a new highway.

Referring again to of the collective representation of these data bases is the location information data bases . Included among these data bases is a data base for providing training and or calibration data to one or more trainable calibratable FOMs as well as an archival data base for archiving historical MS location information related to the performance of the FOMs. These data bases will be discussed as necessary hereinbelow. However a further brief introduction to the archival data base is provided here. Accordingly the term location signature data base is used hereinafter to denote the archival data base and or data base management system depending on the context of the discussion. The location signature data base shown in for example and labeled is a repository for wireless signal characteristic data derived from wireless signal communications between an MS and one or more base stations wherein the corresponding location of the MS is known and also stored in the location signature data base . More particularly the location signature data base associates each such known MS location with the wireless signal characteristic data derived from wireless signal communications between the MS and one or more base stations at this MS location. Accordingly it is an aspect of the present invention to utilize such historical MS signal location data for enhancing the correctness and or confidence of certain location hypotheses as will be described in detail in other sections below.

In one embodiment there are four fundamental entity types or object classes in an object oriented programming paradigm utilized in the location signature data base . Briefly these data entities are described in the items 24.1 through 24.4 that follow 

It is important to note that a loc sig is in one embodiment an instance of the data structure containing the signal characteristic measurements output by the signal filtering and normalizing subsystem also denoted as the signal processing subsystem describing the signals between i a specific base station BS and ii a mobile station MS wherein the BS s location is known and the MS s location is assumed to be substantially constant during a 2 5 second interval in one embodiment of the present invention during communication with the MS for obtaining a single instance of loc sig data although the MS location may or may not be known. Further for notational purposes the BS and the MS for a loc sig hereinafter will be denoted the BS associated with the loc sig and the MS associated with the loc sig respectively. Moreover the location of the MS at the time the loc sig data is obtained will be denoted the location associated with the loc sig this location possibly being unknown .

Note that additional description of this aspect of the present invention can be found in one of the following two copending U.S. patent applications which are incorporated herein by reference a Location Of A Mobile Station filed Nov. 24 1999 having application Ser. No. 09 194 367 whose inventors are D. J. Dupray and C. L. Karr and b A Wireless Location System For Calibrating Multiple Location Estimators filed Oct. 21 1998 having application Ser. No. 09 176 587 whose inventor is D. J. Dupray wherein these copending patent applications may have essential material for the present specification. In particular these copending patent applications may have essential material relating to the location signature data base .

It is important to note that the architecture for the location center gateway and the location engine provided by the present invention is designed for extensibility and flexibility so that MS location accuracy and reliability may be enhanced as further location data become available and as enhanced MS location techniques become available. In addressing the design goals of extensibility and flexibility the high level architecture for generating and processing MS location estimates may be considered as divided into the following high level functional groups described hereinbelow.

Low Level Wireless Signal Processing Subsystem for Receiving and Conditioning Wireless Signal Measurements

A first functional group of location engine modules is for performing signal processing and filtering of MS location signal data received from a conventional wireless e.g. CDMA infrastructure as discussed in the steps 23.1 and 23.2 above. This group is denoted the signal processing subsystem herein. One embodiment of such a subsystem is described in the U.S. copending patent application titled Wireless Location Using A Plurality of Commercial Network Infrastructures by F. W. LeBlanc Dupray and Karr filed Jan. 22 1999 and having U.S. Pat. No. 6 236 365. Note that this copending patent application is incorporated herein entirely by reference since it may contain essential material for the present invention. In particular regarding the signal processing subsystem . Note however that the signal processing subsystem may be unnecessary for the gateway unless the gateway supplies wireless location signal data to one or more FOMs.

A second functional group of modules at least accessible by the location engine are the FOM for generating various target MS location initial estimates as described in step 23.3 . A brief description of some types of first order models is provided immediately below. Note that illustrates another more detail view of an embodiment of the location center gateway for the present invention. In particular this figure illustrates some of the FOMs at least accessible but not necessarily co located with the other location center gateway modules shown in this figure and additionally illustrates the primary communications with other modules of the gateway. However it is important to note that the present invention is not limited to the FOMs shown and discussed herein. That is it is a primary aspect of the present invention to easily incorporate FOMs using other signal processing and or computational location estimating techniques than those presented herein. Further note that each FOM type may have a plurality of its MS location estimating models at least accessible by the gateway .

For example as will be described in further detail below one such type of model or FOM hereinafter models of this type are referred to as terrestrial communication station offset TCSO models or terrestrial communication station offset TCSO first order models or terrestrial communication station offset TCSO FOMs may be based on a range offset and or distance computation such as on a base station signal reception angle determination between the target MS from each of one or more base stations. Basically such TCSO models determine a location estimate of the target MS by determining an offset from each of one or more base stations possibly in a particular direction from each some of the base stations so that e.g. an intersection of each area locus defined by the base station offsets may provide an estimate of the location of the target MS. TCSO FOMs may compute such offsets based on e.g. 

Another type of FOM is a statistically based first order model wherein a statistical technique such as regression techniques e.g. least squares partial least squares principle decomposition or e.g. Bollenger Bands e.g. for computing minimum and maximum base station offsets . In general models of this type output location hypotheses determined by performing one or more statistical techniques or comparisons between the verified location signatures in location signature data base and the wireless signal measurements from a target MS. Models of this type are also referred to hereinafter as a stochastic signal first order model or a stochastic FOM or a statistical model. Of course statistically based FOMs may be a hybrid combination with another type of FOM such as a TCSO FOM.

Still another type of FOM is an adaptive learning model such as an artificial neural net or a genetic algorithm wherein the FOM may be trained to recognize or associate each of a plurality of locations with a corresponding set of signal characteristics for communications between the target MS at the location and the base stations . Moreover typically such a FOM is expected to accurately interpolate extrapolate target MS location estimates from a set of signal characteristics from an unknown target MS location. Models of this type are also referred to hereinafter variously as artificial neural net models or neural net models or trainable models or learning models. Note that a related type of FOM is based on pattern recognition. These FOMs can recognize patterns in the signal characteristics of communications between the target MS at the location and the base stations and thereby estimate a location area of the target MS. However such FOMs may not be trainable.

Yet another type of FOM can be based on a collection of dispersed low power low cost fixed location wireless transceivers also denoted location base stations hereinabove that are provided for detecting a target MS in areas where e.g. there is insufficient base station infrastructure coverage for providing a desired level of MS location accuracy. For example it may uneconomical to provide high traffic wireless voice coverage of a typical wireless base station in a nature preserve or at a fair ground that is only populated a few days out of the year. However if such low cost location base stations can be directed to activate and deactivate via the direction of a FOM of the present type then these location base stations can be used to both location a target MS and also provide indications of where the target MS is not. For example if there are location base stations populating an area where the target MS is presumed to be then by activating these location base stations evidence may be obtained as to whether or not the target MS is actually in the area e.g. if the target MS is detected by a location base station then a corresponding location hypothesis having a location estimate corresponding to the coverage area of the location base station may have a very high confidence value. Alternatively if the target MS is not detected by a location base station then a corresponding location hypothesis having a location estimate corresponding to the coverage area of the location base station may have a very low confidence value. Models of this type are referred to hereinafter as location base station models. 

Yet another type of FOM can be based on input from a mobile base station wherein location hypotheses may be generated from target MS location data received from the mobile base station .

Still other types of FOM can be based on various techniques for recognizing wireless signal measurement patterns and associating particular patterns with locations in the coverage area . For example artificial neural networks or other learning models can used as the basis for various FOMs.

Note that the FOM types mentioned here as well as other FOM types are discussed in detail hereinbelow. Moreover it is important to keep in mind that in one embodiment of the present invention the substantially simultaneous use or activation of a potentially large number of such first order models may be able to enhance both the reliability of location estimates and the accuracy of such estimates. Additionally note that in some embodiments of the present invention the first order models can be activated when appropriate signal measurements are obtained. For example a TDOA FOM may be activated when only a single signal time delay measurement is obtained from some plurality of base station . However if for instance additional time delay values are obtained and assuming such additional values are necessary then one or more wireless signal pattern matching FOM may also be activated in conjunction with the TDOA FOM. Additionally a FOM using satellite signals e.g. GPS to perform a triangulation may be activated whenever appropriate measurements are received regardless of whether additional FOMs are capable of being substantially simultaneously activated or not. Accordingly since such satellite signal FOMs are generally more accurate output from such a FOM may dominate any other previous or simultaneous estimates unless there is evidence to the contrary.

Moreover the present invention provides a framework for incorporating MS location estimators to be subsequently provided as new FOMs in a straightforward manner. For example a FOM based on wireless signal time delay measurements from a distributed antenna system for wireless communication may be incorporated into the present invention for thereby locating a target MS in an enclosed area serviced by the distributed antenna system. Accordingly by using such a distributed antenna FOM the present invention may determine the floor of a multi story building from which a target MS is transmitting. Thus MSs can be located in three dimensions using such a distributed antenna FOM. Additionally FOMs for detecting certain registration changes within for example a public switched telephone network can also be used for locating a target MS . For example for some MSs there may be an associated or dedicated device for each such MS that allows the MS to function as a cordless phone to a line based telephone network when the device detects that the MS is within signaling range. In one use of such a device also denoted herein as a home base station the device registers with a home location register of the public switched telephone network when there is a status change such as from not detecting the corresponding MS to detecting the MS or visa versa as one skilled in the art will understand. Accordingly by providing a FOM that accesses the MS status in the home location register the location engine can determine whether the MS is within signaling range of the home base station or not and generate location hypotheses accordingly. Moreover other FOMs based on for example chaos theory and or fractal theory are also within the scope of the present invention.

Alternatively for complex wireless signal environments such as in cities like San Francisco Tokyo or New York a large number of FOMs may be simultaneously utilized for generating MS location hypotheses.

A third functional group of location engine modules evaluates location hypotheses output by the first order models and thereby provides a most likely target MS location estimate. The modules for this functional group are collectively denoted the hypothesis evaluator .

A primary purpose of the hypothesis evaluator is to mitigate conflicts and ambiguities related to location hypotheses output by the first order models and thereby output a most likely estimate of an MS for which there is a request for it to be located. In providing this capability there are various related embodiments of the hypothesis evaluator that are within the scope of the present invention. Since each location hypothesis includes both an MS location area estimate and a corresponding confidence value indicating a perceived confidence or likelihood of the target MS being within the corresponding location area estimate there is a monotonic relationship between MS location area estimates and confidence values. That is by increasing an MS location area estimate the corresponding confidence value may also be increased in an extreme case the location area estimate could be the entire coverage area and thus the confidence value may likely correspond to the highest level of certainty i.e. 1.0 . Accordingly given a target MS location area estimate of a location hypothesis an adjustment to its accuracy may be performed by adjusting the MS location area estimate and or the corresponding confidence value. Thus if the confidence value is for example excessively low then the area estimate may be increased as a technique for increasing the confidence value. Alternatively if the estimated area is excessively large and there is flexibility in the corresponding confidence value then the estimated area may be decreased and the confidence value also decreased. Thus if at some point in the processing of a location hypothesis if the location hypothesis is judged to be more less accurate than initially determined then i the confidence value of the location hypothesis may be increased decreased and or ii the MS location area estimate can be decreased increased . Moreover note that when the confidence values are probabilities such adjustments are may require the reactivation of one or more FOMs with requests to generate location hypotheses having location estimates of different sizes. Alternatively adjuster modules and or discussed hereinbelow may be invoked for generating location hypotheses having area estimates of different sizes. Moreover the confidence value on such an adjusted location hypothesis actually a new location hypothesis corresponding to the originally generated hypothesis may also be a probability in that combinations of FOMs and adjuster modules and can also be calibrated for thereby yielding probabilities as confidence values to the resulting location hypotheses.

In a first class of embodiments typically wherein the confidence values are not maintained as probabilities the hypothesis evaluator evaluates location hypotheses and adjusts or modifies only their confidence values for MS location area estimates and subsequently uses these MS location estimates with the adjusted confidence values for determining a most likely MS location estimate for outputting. Alternatively in a second class of embodiments for the hypothesis evaluator also typically wherein the confidence values are not maintained as probabilities MS location area estimates can be adjusted while confidence values remain substantially fixed. However in one preferred embodiment of the present embodiment both location hypothesis area estimates and confidence values are modified.

The hypothesis evaluator may perform any or most of the following tasks depending on the embodiment of the hypothesis evaluator. That is 

Alternatively if for example the difference between a previous location estimate of a target MS and a current location hypothesis indicates that the MS is 

Note that additional description of the hypothesis evaluator can be found in one of the following two copending U.S. patent applications which are incorporated herein by reference a Location Of A Mobile Station filed Nov. 24 1999 having application Ser. No. 09 194 367 whose inventors are D. J. Dupray and C. L. Karr and b A Wireless Location System For Calibrating Multiple Location Estimators filed Oct. 21 1998 having application Ser. No. 09 176 587 whose inventor is D. J. Dupray wherein these copending patent applications may have essential material for the present specification. In particular these copending patent applications may have essential material relating to their descriptions of the hypothesis evaluator.

The context adjuster alternatively denoted location adjuster modules module enhances both the comparability and predictability of the location hypotheses output by the first order models . In one embodiment typically where confidence values of location hypotheses are not maintained as probabilities this module modifies location hypotheses received from the FOMs so that the resulting location hypotheses output by the context adjuster may be further processed uniformly and substantially without concern as to differences in accuracy between the first order models from which location hypotheses originate. Further embodiments of the context adjuster may determine those factors that are perceived to impact the perceived accuracy e.g. confidence of the location hypotheses . For instance environmental characteristics may be taken into account here such as time of day season month weather geographical area categorizations e.g. dense urban urban suburban rural mountain etc. area subcategorizations e.g. heavily treed hilly high traffic area etc. .

In two such adjuster modules are shown namely an adjuster for enhancing reliability and an adjuster for enhancing accuracy . Both of these adjusters perform their location hypothesis adjustments in the manner described above. The difference between these two adjuster modules and is primarily the size of the localized area nearby the newly generated location estimate. In particular since it is believed that the larger smaller the localized nearby area is the more likely less likely the corresponding adjusted image is to contain the target mobile station location the adjuster for enhancing reliability may determine its localized areas nearby a newly generated location estimate as for example having a 40 larger diameter alternatively area than the location area estimate generated by a first order model . Alternatively the adjuster for enhancing accuracy may determine its localized areas nearby a newly generated location estimate as for example having a 30 smaller diameter alternatively area than the location area estimate generated by a first order model . Thus each newly generated location hypothesis can potentially be used to derive at least two additional adjusted location hypotheses with some of these adjusted location hypotheses being more reliable and some being more accurate than the location hypotheses generated directly from the first order models .

Note that additional description of context adjuster aspects of the present invention can be found in the following two copending U.S. patent applications which are incorporated herein by reference a Location Of A Mobile Station filed Nov. 24 1999 having application Ser. No. 09 194 367 whose inventors are D. J. Dupray and C. L. Karr and b A Wireless Location System For Calibrating Multiple Location Estimators filed Oct. 21 1998 having application Ser. No. 09 176 587 whose inventor is D. J. Dupray wherein these copending patent applications may have essential material for the present specification. In particular these copending patent applications may have essential material relating to the context adjuster .

The MS status repository is a run time storage manager for storing location hypotheses from previous activations of the location engine as well as for storing the output most likely target MS location estimate s so that a target MS may be tracked using target MS location hypotheses from previous location engine activations to determine for example a movement of the target MS between evaluations of the target MS location.

The location hypothesis analyzer may adjust confidence values of the location hypotheses according to 

Note that additional description of this aspect of the present invention can be found in one of the following copending U.S. patent application which is incorporated herein by reference Location Of A Mobile Station filed Nov. 24 1999 having application Ser. No. 09 194 367 whose inventors are D. J. Dupray and C. L. Karr.

The most likelihood estimator is a module for determining a most likely location estimate for a target MS being located by the location engine . The most likelihood estimator receives a collection of active or relevant location hypotheses from the hypothesis analyzer and uses these location hypotheses to determine one or more most likely estimates for the target MS .

There are various embodiments of the most likelihood estimator that may be utilized with the present invention. One such embodiment will now be described. At a high level an area of interest is first determined which contains the target MS whose location is desired. This can be straightforwardly determined by identifying the base stations that can be detected by the target MS and or the base stations that can detect the target MS. Subsequently assuming that this area of interest has been previously partitioned into cells e.g. small rectangular areas of for example 50 to 200 feet per side and that the resulting location hypotheses for estimating the location of the target MS each have a likelihood probability associated therewith then for each such location hypothesis a probability more generally confidence value is capable of being assigned to each cell intersecting and or included in the associated target MS location estimate. In particular for each location hypothesis a portion of the probability value P for the associated location estimate A can be assigned to each cell C intersecting the estimate. One simple way to perform this is to divide P by the number of cells C and increment for each cell C a corresponding probability indicative of the target MS being in C with the result from the division. One skilled in the art will readily recognize numerous other ways of incrementing such cell probabilities including providing a Gaussian or other probabilistic distribution of probability values according to e.g. the distance of the cell from the centroid of the location estimate. Accordingly assuming all such probability increments have been assigned to all such cells C from all location hypotheses generated for locating the target MS then the following is one embodiment of a program for determining one or more most likely locations of the target MS.

Note that numerous similar embodiments of the above program maybe used as one skilled in the art will understand. For instance instead of building Result as provided in the above program Result can be whittled from the area of interest. Accordingly Result would be initialized to the entire area of interest and cells would be selected for removal from Result. Additionally note that the above program determines a fast approximation to the optimal most likely area containing the target MS having at least a particular desired confidence. However a similar program may be readily provided where a most likely area having less than a desired extent or dimension is output e.g. such a program would could be used to provide an answer to the question What city block is the target MS most likely in 

Additionally note that a center of gravity type of computation for obtaining the most likely location estimate of the target MS may be used as described in U.S. Pat. No. 5 293 642 642 patent filed Dec. 19 1990 having an issue data of Mar. 8 1994 with inventor Lo which is incorporated by reference herein and may contain essential material for the present invention.

Still referring to the hypothesis evaluator it is important to note that not all the above mentioned modules are required in all embodiments of the present invention. In particular the hypothesis analyzer may be unnecessary. Accordingly in such an embodiment the enhanced location hypotheses output by the context adjuster are provided directly to the most likelihood estimator .

A fourth functional group of location engine modules is the control and output gating modules which includes the location center control subsystem and the output gateway . The location control subsystem provides the highest level of control and monitoring of the data processing performed by the location center . In particular this subsystem performs the following functions 

Referring now to the output gateway this module routes target MS location estimates to the appropriate location application s . For instance upon receiving a location estimate from the most likelihood estimator the output gateway may determine that the location estimate is for an automobile being tracked by the police and therefore must be provided must be provided according to the particular protocol.

A fifth functional group of location engine modules provides the ability to enhance the MS locating reliability and or accuracy of the present invention by providing it with the capability to adapt to particular operating configurations operating conditions and wireless signaling environments without performing intensive manual analysis of the performance of various embodiments of the location engine . That is this functional group automatically enhances the performance of the location engine for locating MSs within a particular coverage area using at least one wireless network infrastructure therein. More precisely this functional group allows the present invention to adapt by tuning or optimizing certain system parameters according to location engine location estimate accuracy and reliability.

There are a number location engine system parameters whose values affect location estimation and it is an aspect of the present invention that the MS location processing performed should become increasingly better at locating a target MS not only through building an increasingly more detailed model of the signal characteristics of location in the coverage area such as discussed above regarding the location signature data base but also by providing automated capabilities for the location center processing to adapt by adjusting or tuning the values of such location center system parameters.

Accordingly the present invention may include a module denoted herein as an adaptation engine that performs an optimization procedure on the location center system parameters either periodically or concurrently with the operation of the location center in estimating MS locations. That is the adaptation engine directs the modifications of the system parameters so that the location engine increases in overall accuracy in locating target MSs . In one embodiment the adaptation engine includes an embodiment of a genetic algorithm as the mechanism for modifying the system parameters. Genetic algorithms are basically search algorithms based on the mechanics of natural genetics.

Note that additional description of this aspect of the present invention can be found in one of the following two copending U.S. patent applications which are incorporated herein by reference a Location Of A Mobile Station filed Nov. 24 1999 having application Ser. No. 09 194 367 whose inventors are D. J. Dupray and C. L. Karr and b A Wireless Location System For Calibrating Multiple Location Estimators filed Oct. 21 1998 having application Ser. No. 09 176 587 whose inventor is D. J. Dupray wherein these copending patent applications may have essential material for the present specification. In particular these copending patent applications may have essential material relating to the use of genetic algorithm implementations for adaptively tuning system parameters of a particular embodiment of the present invention.

Further descriptions of various first order models are provided in this section. However it is important to note that these are merely representative embodiments of location estimators that are within the scope of the present invention. In particular two or more of the wireless location technologies described hereinbelow may be combined to created additional First Order Models. For example various triangulation techniques between a target MS and the base station infrastructure e.g. time difference of arrival TDOA or time of arrival TOA may be combined with an angle of arrival AOA technique. For instance if a single direct line of sight angle measurement and a single direct line of sight distance measurement determined by e.g. TDOA or TOA can effectively location the target MS . In such cases the resulting First Order Models may be more complex. However location hypotheses may generated from such models where individually the triangulation techniques and the AOA techniques would be unable to generate effective location estimates.

As discussed in the Location Center Architecture Overview section herein above TCSO models determine a presumed direction and or distance more generally an offset that a target MS is from one or more base stations . In some embodiments of TCSO models the target MS location estimate s generated are obtained using radio signal analysis techniques that are quite general and therefore are not capable of taking into account the peculiarities of the topography of a particular radio coverage area. For example substantially all radio signal analysis techniques using conventional procedures or formulas are based on signal characteristic measurements such as 

Furthermore such signal analysis techniques are likely predicated on certain very general assumptions that can not fully account for signal attenuation and multipath due to a particular radio coverage area topography.

Taking CDMA or TDMA base station network as an example each base station BS is required to emit a constant signal strength pilot channel pseudo noise PN sequence on the forward link channel identified uniquely in the network by a pilot sequence offset and frequency assignment. It is possible to use the pilot channels of the active candidate neighboring and remaining sets maintained in the target MS for obtaining signal characteristic measurements e.g. TOA and or TDOA measurements between the target MS and the base stations in one or more of these sets.

Based on such signal characteristic measurements and the speed of signal propagation signal characteristic ranges or range differences related to the location of the target MS can be calculated. Using TOA and or TDOA ranges as exemplary these ranges can then be input to either the radius radius multilateration or the time difference multilateration algorithms along with the known positions of the corresponding base stations to thereby obtain one or more location estimates of the target MS . For example if there are four base stations in the active set the target MS may cooperate with each of the base stations in this set to provide signal arrival time measurements. Accordingly each of the resulting four sets of three of these base stations may be used to provide an estimate of the target MS as one skilled in the art will understand. Thus potentially assuming the measurements for each set of three base stations yields a feasible location solution there are four estimates for the location of the target MS . Further since such measurements and BS positions can be sent either to the network or the target MS location can be determined in either entity.

Since many of the signal measurements utilized by embodiments of TCSO models are subject to signal attenuation and multipath due to a particular area topography. Many of the sets of base stations from which target MS location estimates are desired may result in either no location estimate or an inaccurate location estimate.

Accordingly some embodiments of TCSO FOMs may attempt to mitigate such ambiguity or inaccuracies by e.g. identifying discrepancies or consistencies between arrival time measurements and other measurements e.g. signal strength these discrepancies or consistencies may be used to filter out at least those signal measurements and or generated location estimates that appear less accurate. In particular such identifying and filtering may be performed by for example an expert system residing in the TCSO FOM.

Another approach for enhancing certain location techniques such as TDOA or angle or arrival AOA is that of super resolution as disclosed in U.S. Pat. No. 5 890 068 also referred to as the 068 patent herein filed on Oct. 3 1996 having an issue date of Mar. 30 1999 with inventors Fattouche et. al. which is incorporated by reference herein and which may contain essential material for the present invention. In particular the following portions of the 068 patent are particularly important the Summary section the Detailed Description portion regarding FIGS. 12 17 and the section titled Description Of The Preferred Embodiments Of The Invention. 

Another approach regardless of the FOM utilized for mitigating such ambiguity or conflicting MS location estimates is particularly novel in that each of the target MS location estimates is used to generate a location hypothesis regardless of its apparent accuracy. Accordingly these location hypotheses are input to an embodiment of the context adjuster . In particular in one context adjuster embodiment each location hypothesis is adjusted according to past performance of its generating FOM in an area of the initial location estimate of the location hypothesis the area e.g. determined as a function of distance from this initial location estimate this alternative embodiment adjusts each of the location hypotheses generated by a first order model according to a past performance of the model as applied to signal characteristic measurements from the same set of base stations as were used in generating the location hypothesis. That is instead of only using only an identification of the first order model i.e. its FOM ID to for example retrieve archived location estimates generated by the model in an area of the location hypothesis estimate when determining the model s past performance the retrieval retrieves the archived location estimates that are in addition derived from the signal characteristics measurement obtained from the same collection of base stations as was used in generating the location hypothesis. Thus the adjustment performed by this embodiment of the context adjuster adjusts according to the past performance of the distance model and the collection of base stations used.

Note in one embodiment such adjustments can also be implemented using a precomputed vector location error gradient field. Thus each of the location error vectors as determined by past performance for the FOM of the gradient field has its starting location at a location previously generated by the FOM and its vector head at a corresponding verified location where the target MS actually was. Accordingly for a location hypothesis of an unknown location this embodiment determines or selects the location error vectors having starting locations within a small area e.g. possibly of a predetermined size but alternatively dependent on the density of the location error vector starting locations nearby to the location hypothesis of the location hypothesis. Additionally the determination or selection may also be based upon a similarity of signal characteristics also obtained from the target MS being located with signal characteristics corresponding to the starting locations of location error vectors of the gradient field. For example such sign characteristics may be e.g. time delay signal strength multipath characteristics.

Various mobile station location estimating models can be based on the angle of arrival AOA of wireless signals transmitted from a target MS to the base station infrastructure as one skilled in the art will understand. Such AOA models sometimes also referred to as direction of arrival or DOA models typically require precise angular measurements of the wireless signals and accordingly utilize specialized antennas at the base stations . The determined signal transmission angles are subject to multipath aberrations. Therefore AOA is most effective when there is an unimpeded line of sight simultaneous transmission between the target MS and at least two base stations .

Another TCSO first order model denoted the Grubeck model FOM herein is disclosed in U.S. Pat. No. 6 009 334 filed Nov. 26 1997 and issued Dec. 28 1999 having Grubeck Fischer and Lundqvist as inventors this patent being fully incorporated herein by reference. The Grubeck model includes a location estimator for determining more accurately the distance between a wireless receiver at RX e.g. a CMRS fixed location communication station such as a BS and a target MS wherein wireless signals are repeatedly transmitted from the target MS and may be subject to multipath. An embodiment of the Grubeck model may be applied to TOA TDOA and or AOA wireless measurements. For the TOA case the following steps are performed 

As mentioned above an embodiment of the Grubeck FOM may also be provides for TDOA and or AOA wireless location techniques wherein a similar incoherent integration may be performed.

Note that a Grubeck FOM may be particularly useful for locating a target MS in a GSM wireless network.

A first order model denoted the Parl model herein is substantially disclosed in U.S. Pat. No. 5 883 598 denoted the 598 patent herein filed Dec. 15 1995 and issued Mar. 16 1999 having Parl Bussgang Weitzen and Zagami as inventors this patent being fully incorporated herein by reference. The Parl FOM includes a system for receiving representative signals denoted also locating signal s from the target MS via e.g. base stations and subsequently combining information regarding the amplitude and phase of the MS transmitted signals received at the base stations to determine the position of the target MS . In one embodiment the Parl model uses input from a locating signal having two or more single frequency tones as one skilled in the art will understand. Moreover at least some of the base stations preferably include at least two antennas spaced from each other by a distance between a quarter wavelength and several wavelengths of the wireless locating signals received from the target MS . Optionally another antenna vertically above or below the two or more antennas also spaced by a distance of between a quarter wavelength and several wavelengths can be used where elevation is also being estimated. The base stations sample locating signals from the target MS . The locating signals include tones that can be at different frequencies. The tones can also be transmitted at different times or in an alternative embodiment they can be transmitted simultaneously. Because in one embodiment only single frequency tones are used as the locating signal instead of modulated signals substantial transmission circuitry may be eliminated. The Parl FOM extracts information from each representative signal received from a target MS wherein at least some of the extracted information is related to the amplitude and phase of the received signal.

In one embodiment of a Parl FOM related to the disclosure in the 598 patent when the locations of the BSs are known and the direction from any two of the BSs to the target MS the MS s location can be initially roughly determined by signal direction finding techniques. For example an estimate of the phase difference between the signals at a pair of antennas at any BS having two such antennas can lead to the determination of the angle from the base station to the target MS and thus the determination of the target MS direction. Subsequently an enhanced location of the target MS is computed directly from received target MS signal data using an ambiguity function A x y described in the 598 patent wherein for each point at x y the ambiguity function A x y depends upon the probability that the MS is located at the geolocation represented by x y . Essentially the Parl FOM combines angle of arrival related data and TDOA related data for obtaining an optimized estimate of the target MS . However it appears that independent AOA and TDOA MS locations are not used in determining a resulting target MS location e.g. without the need for projecting lines at angles of arrival or computing the intersection of hyperbolas defined by pairs of base stations . Instead the Parl FOM estimates the target MS s location by minimizing a joint probability of location related errors. In particular such minimization may use the mean square error and the location x y at which minimization occurs is taken as the estimate of the target MS . In particular the ambiguity function A x y defines the error involved in a position determination for each point in a geolocation Cartesian coordinate system. The Parl model optimizes the ambiguity function to select a point x y at which the associated error is minimized. The resulting location for x y is taken as the estimate of the location of the target MS . Any of several different optimization procedures can be used to optimize the ambiguity function A x y . E.g. a first rough estimate of the target MS s location may be obtained by direction finding as discussed above . Next six points x y may be selected that are in close proximity to the estimated point. The ambiguity function A x y is solved for each of the x y points to obtain six values. The six computed values are then used to define a parabolic surface. The point x y at which the maximum value of the parabolic surface occurs is then taken as the estimate of the target MS . However other optimization techniques may also be used. For example a standard technique such as an iterative progression through trial and error to converge to the maximum can be used. Also gradient search can be used to optimize the ambiguity function. In the case of three dimensional location the two dimensional ambiguity function A x y is extended to a three dimensional function A x y z . As in the two dimensional case the ambiguity function may be optimized to select a point x y z as the best estimate of the target MS s location in three dimensions. Again any of several known optimization procedures such as iterative progression through trial and error gradient search etc. can be used to optimize the ambiguity function.

It is believed that from the location center gateway architecture and from the architecture of the mobile station location subsystem described in a separate section hereinbelow that target MS location related information can be obtained from an MBS and or one or more LBSs . Moreover such location related information can be supplied to any FOM that is able to accept such information as input. Thus pattern recognition and adaptive FOMs may accept such information. However to provide an alternative description of how MS location related information from an MBS and or LBS may be used reference is made to U.S. Pat. No. 6 031 490 denoted the 490 Patent herein filed Dec. 23 1997 and issued Feb. 29 2000 having Forssen Berg and Ghisler as inventors this patent being fully incorporated herein by reference. A TCSO FOM denoted the FORSSEN FOM herein using TDOA AOA is disclosed in the 490 Patent.

The FORSSEN FOM includes a location estimator for determining the Time Difference of Arrival TDOA of the position of a target MS which is based on Time of Arrival TOA and or AOA measurements. This FOM uses data received from measuring devices provided within a wireless telecommunications network. The measuring devices measure TOA on demand and optionally Direction of Arrival DOA on a digital uplink time slot or on digital information on an analog uplink traffic channel in one or more radio base stations. The TOA and DOA information and the traffic channel number are reported to a Mobile Services Switching Center MSC which obtains the identity of the target MS from the traffic channel number and sends the target MS identity and TOA and DOA measurement information to a Service Node e.g. location center of the network. The Service Node calculates the position of the target MS using the TOA information supplemented by the DOA information when available . Note that the FORSSEN model may utilize data from a second mobile radio terminal that is colocated on a mobile platform auto emergency vehicle etc. with one of the radio base stations e.g. MBS which can be moved into relatively close proximity with the target MS . Consequently by moving one of the radio base stations MBSs close to the region of interest near the target MS the position determination accuracy is significantly improved.

Note that the 490 patent also discloses techniques for rising the target MS s transmission power for thereby allowing wireless signals from the target MS to be better detected by distant BSs .

Radio coverage area of individual base stations may be used to generate location estimates of the target MS . Although a first order model based on this notion may be less accurate than other techniques if a reasonably accurate RF coverage area is known for each or most of the base stations then such a FOM denoted hereinafter as a coverage area first order model or simply coverage area model may be very reliable. To determine approximate maximum radio frequency RF location coverage areas with respect to BSs antennas and or sector coverage areas for a given class or classes of e.g. CDMA or TDMA mobile station s location coverage should be based on an MS s ability to adequately detect the pilot channel as opposed to adequate signal quality for purposes of carrying user acceptable traffic in the voice channel. Note that more energy is necessary for traffic channel activity typically on the order of at least 94 to 104 dBm received signal strength to support voice than energy needed to simply detect a pilot channel s presence for location purposes typically a maximum weakest signal strength range of between 104 to 110 dBm thus the Location Coverage Area will generally be a larger area than that of a typical Voice Coverage Area although industry studies have found some occurrences of no coverage areas within a larger covered area

The approximate maximum RF coverage area for a given sector of more generally angular range about a base station may be represented as a set of points representing a polygonal area potentially with e.g. holes therein to account for dead zones and or notches . Note that if such polygonal RF coverage area representations can be reliably determined and maintained over time for one or more BS signal power level settings then such representations can be used in providing a set theoretic or Venn diagram approach to estimating the location of a target MS . Coverage area first order models utilize such an approach.

One embodiment a coverage area model utilizes both the detection and non detection of base stations by the target MS conversely of the MS by one or more base stations to define an area where the target MS may likely be. A relatively straightforward application of this technique is to 

As mentioned hereinabove there are various satellite systems that may be used to provide location estimates of a target MS e.g. GPS GLONASS LEOs and MEOs . In many cases such location estimates can be very accurate and accordingly such accuracy would be reflected in the present invention by relatively high confidence values for the location hypotheses generated from such models in comparison to other FOMs. However it may be difficult for the target MS to detect and or lock onto such satellite signals sufficiently well to provide a location estimate. For example it may be very unlikely that such satellite signals can be detected by the MS in the middle of high rise concrete buildings or parking structures having very reduced exposure to the sky.

A first order model denoted the WATTERS FOM herein is disclosed in U.S. Pat. No. 5 982 324 filed May 14 1998 and issued Nov. 9 1999 having Watters Strawczynski and Steer as inventors this patent being fully incorporated herein by reference. The WATTERS FOM includes a location estimator for determining the location of a target MS using satellite signals to the target MS as well as delay in wireless signals communicated between the target MS and base stations . For example aspects of global positioning system GPS technology and cellular technology are combined in order to locate a target MS . The WATTERS FOM may be used to determine target MS location in a wireless network wherein the network is utilized to collect differential GPS error correction data which is forwarded to the target MS via the wireless network. The target MS which includes a receiver R for receiving non terrestrial wireless signals from e.g. GPS or other satellites or even airborne craft receives this data along with GPS pseudoranges using its receiver R and calculates its position using this information. However when the requisite number of satellites are not in view of the MS then a pseudosatellite signal broadcast from a BS of the wireless network is received by the target MS and processed as a substitute for the missing satellite signal. Additionally in at least some circumstances when the requisite number of satellites more generally non terrestrial wireless transmitters are not detected by the receiver R then the target MS s location is calculated using the wireless network infrastructure via TDOA TOA with the BSs of the network. When the requisite number of satellites more generally non terrestrial wireless transmitters are again detected by the receiver R then the target MS is again calculated using wireless signals from the non terrestrial wireless transmitters. Additionally the WATTERS FOM may use wireless signals already being transmitted from base stations to the target MS in wireless network to calculate a round trip time delay from which a distance calculation between the base station and the target MS can be made. This distance calculation substitutes for a missing non terrestrial transmission signal.

In the location base station LBS model FOM a database is accessed which contains electrical radio propagation and coverage area characteristics of each of the location base stations in the radio coverage area. The LBS model is an active model in that it can probe or excite one or more particular LBSs in an area for which the target MS to be located is suspected to be placed. Accordingly the LBS model may receive as input a most likely target MS location estimate previously output by the location engine of the present invention and use this location estimate to determine which if any LBSs to activate and or deactivate for enhancing a subsequent location estimate of the target MS. Moreover the feedback from the activated LBSs may be provided to other FOMs as appropriate as well as to the LBS model. However it is an important aspect of the LBS model that when it receives such feedback it may output location hypotheses having relatively small target MS location area estimates about the active LBSs and each such location hypothesis also has a high confidence value indicative of the target MS positively being in the corresponding location area estimate e.g. a confidence value of 0.9 to 1 or having a high confidence value indicative of the target MS not being in the corresponding location area estimate i.e. a confidence value of 0.9 to 1 . Note that in some embodiments of the LBS model these embodiments may have functionality similar to that of the coverage area first order model described above. Further note that for LBSs within a neighborhood of the target MS wherein there is a reasonable chance that with movement of the target MS may be detected by these LBSs such LBSs may be requested to periodically activate. Note that it is not assumed that such LBSs have an on line external power source e.g. some may be solar powered . Moreover in the case where an LBS includes sufficient electronics to carry voice communication with the target MS and is the primary BS for the target MS or alternatively in the active or candidate set then the LBS model will not deactivate this particular LBS during its procedure of activating and deactivating various LBSs .

The stochastic first order models may use statistical prediction techniques such as principle decomposition partial least squares partial least squares or other regression techniques for predicting for example expected minimum and maximum distances of the target MS from one or more base stations e.g. Bollenger Bands. Additionally some embodiments may use Markov processes and Random Walks predicted incremental MS movement for determining an expected area within which the target MS is likely to be. That is such a process measures the incremental time differences of each pilot as the MS moves for predicting a size of a location area estimate using past MS estimates such as the verified location signatures in the location signature data base .

Regarding FOMs using pattern recognition or associativity techniques there are many such techniques available. For example there are statistically based systems such as CART acronym for Classification and Regression Trees by ANGOSS Software International Limited of Toronto Canada that may be used for automatically for detecting or recognizing patterns in data that were not provided and likely previously unknown . Accordingly by imposing a relatively fine mesh or grid of cells of the radio coverage area wherein each cell is entirely within a particular area type categorization such as the transmission area types discussed in the section Coverage Area Area Types And Their Determination above the verified location signature clusters within the cells of each area type may be analyzed for signal characteristic patterns. Accordingly if such a characteristic pattern is found then it can be used to identify one or more of the cells in which a target MS is likely to be located. That is one or more location hypotheses may be generated having target MS location estimates that cover an area having the identified cells wherein the target MS is likely to be located. Further note that such statistically based pattern recognition systems as CART include software code generators for generating expert system software embodiments for recognizing the patterns detected within a training set e.g. the verified location signature clusters .

A related statistical pattern recognition FOM is also disclosed in U.S. Pat. No. 6 026 304 filed Jan. 8 1997 and issued Feb. 15 2000 having Hilsenrath and Wax as inventors this patent denoted the Hilsenrath patent herein being incorporated herein fully by reference. An embodiment of a FOM based on the disclosure of the Hilsenrath patent is referred to herein as the Hilsenrath FOM. The Hilsenrath FOM includes a wireless location estimator that locates a target MS using measurements of multipath signals in order to accurately determine the location of the target MS . More particularly to locate the target MS the Hilsenrath FOM uses wireless measurements of both a direct signal transmission path and multipath transmission signals from the MS to a base station receiver. The wireless signals from the target MS arrive at and are detected by an antenna array of the receiver at the BS wherein the antenna array includes a plurality of antennas. A signal signature e.g. an embodiment of a location signature herein for this FOM may be derived from any combination of amplitude phase delay direction and polarization information of the wireless signals transmitted from the target MS to the base station receiver. The Hilsenrath FOM determines a signal signature from a signal subspace of a covariance matrix. In particular for p antennas included in the base station receiver these antennas are used to receive complex signal envelopes x. t X. t . . . x. t respectively which are conventionally grouped together to form a p dimensional array vector x t x t x t . . . x. t . The signal subspace may be determined from a collection of M such array vectors x t by several techniques. In one such technique the outer products of the M vectors are added together to form a pxp signal covariance matrix R 1 M x t x t . . . x t x t . The eigenvalues of R whose magnitudes exceed a predetermined threshold determine a set of dominant eigenvectors. The signal subspace is the space spanned by these dominant eigenvectors. The signal signature is compared to a database of calibrated signal signatures and corresponding locations e.g. an embodiment of the location signature data base wherein the signal signatures in the database include representations of the signal subspaces such as the dominant eigenvectors of the covariance matrices. Accordingly a location whose calibrated signature best matches the signal signature of the target MS is selected as the most likely location of the target MS . Note that the database of calibrated signal signatures and corresponding verified locations is generated by a calibration procedure in which a calibrating MS transmits location data derived from a co located GPS receiver to the base stations . Thus for each of a plurality of locations distributed through a service area the location has associated therewith the GPS or verified location information and the corresponding signal signature of the calibrating MS .

Accordingly the location of a target MS in the service area may be determined as follows. Signals originating from the target MS at an unknown location are received at a base station . A signal processor e.g. at the base station then determines the signal signature as described above. The signal signature is then compared with the calibrated signal signatures stored in the above described embodiment of the location signature database during the calibration procedure. Using a measure of difference between subspaces e.g. an angle between subspaces a set of likely locations is selected from this location signature database embodiment. These selected likely locations are those locations whose associated calibrated signal signatures differ by less than a minimum threshold value from the target MS signal signature. The difference measure is further used to provide a corresponding measure of the probability that each of the selected likely locations is the actual target MS location. Moreover for one or more of the selected likely location the corresponding measure may be output as the confidence value for a corresponding location hypothesis output by a Hilsenrath FOM .

Thus an embodiment of the present invention using such a Hilsenrath FOM performs the following steps a d 

Note that regardless of the reliability some FOMs as described here may not be exceedingly accurate but may be very reliable. Thus since an aspect of at least some embodiments of the present invention is to use a plurality of MS location techniques FOMs for generating location estimates and to analyze the generated estimates likely after being adjusted to detect patterns of convergence or clustering among the estimates even large MS location area estimates may be useful. For example it can be the case that four different and relatively large MS location estimates each having very high reliability have an area of intersection that is acceptably precise and inherits the very high reliability from each of the large MS location estimates from which the intersection area was derived.

Note that another statistically based FOM may be provided wherein the radio coverage area is decomposed substantially as above but in addition to using the signal characteristics for detecting useful signal patterns the specific identifications of the base station providing the signal characteristics may also be used. Thus assuming there is a sufficient density of verified location signature clusters in some of the mesh cells so that the statistical pattern recognizer can detect patterns in the signal characteristic measurements an expert system may be generated that outputs a target MS location estimate that may provide both a reliable and accurate location estimate of a target MS .

The term adaptive is used to describe a data processing component that can modify its data processing behavior in response to certain inputs that are used to change how subsequent inputs are processed by the component. Accordingly a data processing component may be explicitly adaptive by modifying its behavior according to the input of explicit instructions or control data that is input for changing the component s subsequent behavior in ways that are predictable and expected. That is the input encodes explicit instructions that are known by a user of the component. Alternatively a data processing component may be implicitly adaptive in that its behavior is modified by other than instructions or control data whose meaning is known by a user of the component. For example such implicitly adaptive data processors may learn by training on examples by substantially unguided exploration of a solution space or other data driven adaptive strategies such as statistically generated decision trees. Accordingly it is an aspect of the present invention to utilize not only explicitly adaptive MS location estimators within FOMs but also implicitly adaptive MS location estimators. In particular artificial neural networks also denoted neural nets and ANNs herein are used in some embodiments as implicitly adaptive MS location estimators within FOMs. Thus in the sections below neural net architectures and their application to locating an MS is described.

Artificial neural networks may be particularly useful in developing one or more first order models for locating an MS since for example ANNs can be trained for classifying and or associatively pattern matching of various RF signal measurements such as the location signatures. That is by training one or more artificial neural nets using RF signal measurements from verified locations so that RF signal transmissions characteristics indicative of particular locations are associated with their corresponding locations such trained artificial neural nets can be used to provide additional target MS location hypotheses. Moreover it is an aspect of the present invention that the training of such artificial neural net based FOMs ANN FOMs is provided without manual intervention as will be discussed hereinbelow. Additional description of this aspect of the present invention can be found in the copending U.S. patent application titled Location Of A Mobile Station filed Nov. 24 1999 having application Ser. No. 09 194 367 whose inventors are D. J. Dupray and C. L. Karr which is incorporated herein by reference and wherein this copending patent application may have essential material for the present invention. In particular this copending patent application may have essential material relating to the use of ANNs as mobile station location estimators .

U.S. Pat. No. 5 390 339 339 patent filed Oct. 23 1991 having an issue date of Feb. 14 1995 with inventor being Bruckert et. al. provides number of embodiments of wireless location estimators for estimating the location of a remote unit. In particular various location estimator embodiments are described in relation to therein. The location estimators in the 339 patent are in general directed to determining weighted or adjusted distances of the remote unit e.g. MS from one or more transceivers e.g. base stations . The distances are determined using signal strength measurements of wireless signals transmitted between the remote unit and the transceivers. However adjustments are in the signal strengths according to various signal transmission anomalies e.g. co channel interference impairments and or errors. Additionally a signal RF propagation model may be utilized and a likelihood of the remote unit being in the designated coverage areas cells of particular transceivers e.g. base stations is determined using probabilistic techniques such as posteriori probabilities. Accordingly the Bruckert 339 patent is fully incorporated by reference herein and may contain essential material for the present invention.

U.S. Pat. No. 5 570 412 412 patent filed Sept. 28 1994 having an issue date of Oct. 29 1996 with inventors LeBlanc et. al. provides further embodiments of wireless location estimators that may be used as First Order Models . The location estimating techniques of the LeBlanc 412 patent are described with reference to and succeeding figures therein. At a high level wireless location techniques of the 412 patent can be characterized by the following quote therefrom 

U.S. Pat. No. 5 293 645 645 patent filed Oct. 4 1991 having an issue date of Mar. 8 1994 with inventor Sood. provide further embodiments of wireless location estimators that may be used as First Order Models . In particular the 645 patent describes wireless location estimating techniques using triangulations or other geographical intersection techniques. Further one such technique is described in column 6 line 42 through column 7 line 7. Accordingly the Sood 645 patent is fully incorporated by reference herein and may contain essential material for the present invention.

U.S Pat. No. 5 293 642 642 patent filed Dec. 19 1990 having an issue date of Mar. 8 1994 with inventor Lo provide further embodiments of wireless location estimators that may be used as First Order Models . In particular the 642 patent determines a corresponding probability density function pdf about each of a plurality of base stations in communication with the target MS . That is upon receiving wireless signal measurements from the transmissions between the target MS and base stations for each BS a corresponding pdf is obtained from prior measurements of a particular wireless signal characteristic at locations around the base station. Subsequently a most likely location estimation is determined from a joint probability density function of the individual base station probability density functions. Further description can be found in the Description Of The Preferred Embodiment section of the 642 patent. Accordingly the Lo 642 patent is incorporated by reference herein and may contain essential material for the present invention.

A first order model denoted the Yost model herein. The Yost model includes a location estimator that uses a combination of Time Difference of Arrival TDOA and Timing Advance TA location determining techniques for determining the location of a target MS wherein there are minor modifications to a telecommunication network such as a CMRS. The hybrid wireless location technique utilized by this location estimator uses TDOA measurements and TA measurements to obtain substantially independent location estimates of the target MS wherein the TDOA measurements determine hyperbolae MS loci about base stations communicating uni or bi directionally with the target MS and the TA measurements determine circles about the base stations . Accordingly an enhanced location estimate of the MS can be obtained by using a least squares or other statistical technique wherein the least squares technique determines a location for the MS between the various curves hyperbolae and circles that best approximates a point of intersection. Note that TA is used in all Time Division Multiple Access TDMA systems as one skilled in the art will understand and measurements of TA can provide a measurement of the distance of the MS from a TDMA communication station in communication with the target MS . The Yost model is disclosed in U.S. Pat. No. 5 987 329 329 Patent filed Jul. 30 1997 and issued Nov. 16 1999 having Yost and Panchapakesan as inventors this patent being fully incorporated herein fully by reference to thereby further describe the Yost model. The following quote from the 329 Patent describes an important aspect of the Yost model 

As an aside note that a timing advance TA first order model may be provided as a separate FOM independent from the TDOA portion of the Yost model. Thus if an embodiment of the present invention includes both a TA FOM and a TDOA FOM then the multiple location estimator architecture of the present invention may substantially include the Yost model whenever the TA FOM and TDOA FOM are both activated for a same location instance of a target MS . However it is an aspect of the present invention to also activate such a TA FOM and a TDOA FOM asynchronously from one another.

A first order model denoted the Sheynblat model FOM herein is disclosed in U.S. Pat. No. 5 999 124 denoted the 124 patent herein filed Apr. 22 1998 and issued Dec. 7 1999 having Sheynblat as the inventor this patent being fully incorporated herein by reference The Sheynblat FOM provides a location estimator for processing target MS location related information obtained from a satellite signals of a satellite positioning system denoted SPS in the 124 patent e.g. GPS or GLONASS LEO positioning satellites and or MEO positioning satellites and b communication signals transmitted in the terrestrial wireless cellular network of BSs for a radio coverage area e.g. coverage area wherein there is two way wireless communication between the target MS and the BSs. In one embodiment of the Sheynblat FOM the location related information obtained from the satellite signals includes a representation of a time of travel of SPS satellite signals from a SPS satellite to a corresponding SPS receiver operatively coupled to and co located with the target MS such time of travel is referred to as a pseudorange to the SPS satellite Additionally for this embodiment the location related information obtained from the communication signals in the wireless cellular network includes time of travel related information for a message in the communication signals between a BS transceiver and the target MS this second time of travel related information is referred to as a cellular pseudorange . Accordingly various combinations of pseudoranges to SPS satellites and cellular pseudoranges can be used to determine a likely location of the target MS . As an example if the target MS enhanced with a SPS receiver can receive SPS satellite signals from one satellite and additionally the target MS is also in wireless communication or can be in wireless communication with two BSs then three pseudoranges may be obtained and used to determine the position of the target MS by e.g. triangulation. Of course other combinations are possible for determining a location of the target MS e.g. pseudoranges to two SPS satellites and one cellular pseudorange. Additionally various techniques may be used to mitigate the effects of multipath on these pseudoranges. For example since it is typical for the target MS to detect or be detected by a plurality of BSs a corresponding plurality of cellular pseudoranges may be obtained wherein such cellular pseudoranges may be used in a cluster analysis technique to disambiguate MS locations identified by the satellite pseudoranges. Moreover the determination of a location hypothesis is performed in at least one embodiment at a site remote from the target MS such as the location center gateway or another site that communicates with the location center gateway for supplying a resulting MS location to the gateway. Alternatively the target MS may perform the calculations to determine its own location. Note that this alternative technique may be particularly useful when the target MS is a mobile base station .

The MS status repository is a run time storage manager for storing location hypotheses from previous activations of the location engine as well as the output target MS location estimate s so that a target MS may be tracked using target MS location hypotheses from previous location engine activations to determine for example a movement of the target MS between evaluations of the target MS location. Thus by retaining a moving window of previous location hypotheses used in evaluating positions of a target MS measurements of the target MS s velocity acceleration and likely next position may be determined by the location hypothesis analyzer . Further by providing accessibility to recent MS location hypotheses these hypotheses may be used to resolve conflicts between hypotheses in a current activation for locating the target MS e.g. MS paths may be stored here for use in extrapolating a new location

Any collection of mobile electronics denoted mobile location unit that is able to both estimate a location of a target MS and communicate with the base station network may be utilized by the present invention to more accurately locate the target MS. Such mobile location units may provide greater target MS location accuracy by for example homing in on the target MS and by transmitting additional MS location information to the location center . There are a number of embodiments for such a mobile location unit contemplated by the present invention. For example in a minimal version such the electronics of the mobile location unit may be little more than an onboard MS a sectored directional antenna and a controller for communicating between them. Thus the onboard MS is used to communicate with the location center and possibly the target MS while the antenna monitors signals for homing in on the target MS . In an enhanced version of the mobile location unit a GPS receiver may also be incorporated so that the location of the mobile location unit may be determined and consequently an estimate of the location of the target MS may also be determined. However such a mobile location unit is unlikely to be able to determine substantially more than a direction of the target MS via the sectored directional antenna without further base station infrastructure cooperation in for example determining the transmission power level of the target MS or varying this power level. Thus if the target MS or the mobile location unit leaves the coverage area or resides in a poor communication area it may be difficult to accurately determine where the target MS is located. None the less such mobile location units may be sufficient for many situations and in fact the present invention contemplates their use. However in cases where direct communication with the target MS is desired without constant contact with the base station infrastructure the present invention includes a mobile location unit that is also a scaled down version of a base station . Thus given that such a mobile base station or MBS includes at least an onboard MS a sectored directional antenna a GPS receiver a scaled down base station and sufficient components including a controller for integrating the capabilities of these devices an enhanced autonomous MS mobile location system can be provided that can be effectively used in for example emergency vehicles air planes and boats. Accordingly the description that follows below describes an embodiment of an MBS having the above mentioned components and capabilities for use in a vehicle.

As a consequence of the MBS being mobile there are fundamental differences in the operation of an MBS in comparison to other types of BS s . In particular other types of base stations have fixed locations that are precisely determined and known by the location center whereas a location of an MBS may be known only approximately and thus may require repeated and frequent re estimating. Secondly other types of base stations have substantially fixed and stable communication with the location center via possibly other BS s in the case of LBSs and therefore although these BS s may be more reliable in their in their ability to communicate information related to the location of a target MS with the location center accuracy can be problematic in poor reception areas. Thus MBSs may be used in areas such as wilderness areas where there may be no other means for reliably and cost effectively locating a target MS i.e. there may be insufficient fixed location BS s coverage in an area .

Additionally many commercial wireless telephony technologies require all BS s in a network to be very accurately time synchronized both for transmitting MS voice communication as well as for other services such as MS location. Accordingly the MBS will also require such time synchronization. However since an MBS may not be in constant communication with the fixed location BS network and indeed may be off line for substantial periods of time on board highly accurate timing device may be necessary. In one embodiment such a device may be a commercially available ribidium oscillator as shown in .

Since the MBS includes a scaled down version of a BS denoted in it is capable of performing most typical BS tasks albeit on a reduced scale. In particular the base station portion of the MBS can 

MS via the MBS operator telephony interface if the MS supports voice communication. Further the MBS can if it becomes the primary base station communicating with the MS request the MS to raise lower its power or more generally control the communication with the MS via the base station components . However since the MBS will likely have substantially reduced telephony traffic capacity in comparison to a standard infrastructure base station note that the pilot channel for the MBS is preferably a nonstandard pilot channel in that it should not be identified as a conventional telephony traffic bearing BS by MS s seeking normal telephony communication. Thus a target MS requesting to be located may depending on its capabilities either automatically configure itself to scan for certain predetermined MBS pilot channels or be instructed via the fixed location base station network equivalently BS infrastructure to scan for a certain predetermined MBS pilot channel.

Moreover the MBS has an additional advantage in that it can substantially increase the reliability of communication with a target MS in comparison to the base station infrastructure by being able to move toward or track the target MS even if this MS is in or moves into a reduced infrastructure base station network coverage area. Furthermore an MBS may preferably use a directional or smart antenna to more accurately locate a direction of signals from a target MS . Thus the sweeping of such a smart antenna physically or electronically provides directional information regarding signals received from the target MS . That is such directional information is determined by the signal propagation delay of signals from the target MS to the angular sectors of one of more directional antennas on board the MBS .

Before proceeding to further details of the MBS location subsystem an example of the operation of an MBS in the context of responding to a 911 emergency call is given. In particular this example describes the high level computational states through which the MBS transitions these states also being illustrated in the state transition diagram of . Note that this figure illustrates the primary state transitions between these MBS states wherein the solid state transitions are indicative of a typical ideal progression when locating or tracking a target MS and the dashed state transitions are the primary state reversions due for example to difficulties in locating the target MS .

Accordingly initially the MBS may be in an inactive state wherein the MBS location subsystem is effectively available for voice or data communication with the fixed location base station network but the MS locating capabilities of the MBS are not active. From the inactive state the MBS e.g. a police or rescue vehicle may enter an active state once an MBS operator has logged onto the MBS location subsystem of the MBS such logging being for authentication verification and journaling of MBS events. In the active state the MBS may be listed by a 911 emergency center and or the location center as eligible for service in responding to a 911 request. From this state the MBS may transition to a ready state signifying that the MBS is ready for use in locating and or intercepting a target MS . That is the MBS may transition to the ready state by performing the following steps 

Thus while in the ready state as the MBS moves it has its location repeatedly re estimated via for example GPS signals location center S location estimates from the base stations and and an on board deadreckoning subsystem having an MBS location estimator according to the programs described hereinbelow. However note that the accuracy of the base station time synchronization via the ribidium oscillator and the accuracy of the MBS location may need to both be periodically recalibrated according to 1a and 1b above.

Assuming a 911 signal is transmitted by a target MS this signal is transmitted via the fixed location base station infrastructure to the 911 emergency center and the location center and assuming the MBS is in the ready state if a corresponding 911 emergency request is transmitted to the MBS via the base station infrastructure from the 911 emergency center or the location center then the MBS may transition to a seek state by performing the following steps 

Subsequently when the MBS is in the seek state the MBS may commence toward the target MS location estimate provided. Note that it is likely that the MBS is not initially in direct signal contact with the target MS. Accordingly in the seek state the following steps may be for example performed 

Assuming that the MBS and target MS detect one another which typically occurs when the two units are within 0.25 to 3 miles of one another the MBS enters a contact state when the target MS enters a soft hand off state with the MBS. Accordingly in the contact state the following steps are for example performed 

When the target MS detects that the MBS pilot channel is sufficiently strong the target MS may switch to using the MBS as its primary base station. When this occurs the MBS enters a control state wherein the following steps are for example performed 

Note there can be more than one MBS tracking or locating an MS . There can also be more than one target MS to be tracked concurrently and each target MS being tracked may be stationary or moving.

An MBS uses MS signal characteristic data for locating the MS . The MBS may use such signal characteristic data to facilitate determining whether a given signal from the MS is a direct shot or an multipath signal. That is in one embodiment the MBS attempts to determine or detect whether an MS signal transmission is received directly or whether the transmission has been reflected or deflected. For example the MBS may determine whether the expected signal strength and TOA agree in distance estimates for the MS signal transmissions. Note other signal characteristics may also be used if there are sufficient electronics and processing available to the MBS i.e. determining signal phase and or polarity as other indications of receiving a direct shot from an MS .

In one embodiment the MBS includes an MBS controller for controlling the location capabilities of the MBS . In particular the MBS controller initiates and controls the MBS state changes as described in . Additionally the MBS controller also communicates with the location controller wherein this latter controller controls MBS activities related to MBS location and target MS location. The location controller receives data input from an event generator for generating event records to be provided to the location controller . For example records may be generated from data input received from a the vehicle movement detector indicating that the MBS has moved at least a predetermined amount and or has changed direction by at least a predetermined angle or b the MBS signal processing subsystem indicating that the additional signal measurement data has been received from either the location center or the target MS . Note that the MBS signal processing subsystem in one embodiment is similar to the signal processing subsystem of the location center . may have multiple command schedulers. In particular a scheduler for commands related to communicating with the location center a scheduler for commands related to GPS communication via GPS receiver a scheduler for commands related to the frequency and granularity of the reporting of MBS changes in direction and or position via the MBS dead reckoning subsystem note that this scheduler is potentially optional and that such commands may be provided directly to the deadreckoning estimator and a scheduler for communicating with the target MS s being located. Further it is assumed that there is sufficient hardware and or software to appear to perform commands in different schedulers substantially concurrently.

In order to display an MBS computed location of a target MS a location of the MBS must be known or determined. Accordingly each MBS has a plurality of MBS location estimators or hereinafter also simply referred to as location estimators for determining the location of the MBS. Each such location estimator computes MBS location information such as MBS location estimates changes to MBS location estimates or an MBS location estimator may be an interface for buffering and or translating a previously computed MBS location estimate into an appropriate format. In particular the MBS location module which determines the location of the MBS may include the following MBS location estimators also denoted baseline location estimators 

Additionally note that a plurality of MBS location technologies and their corresponding MBS location estimators are utilized due to the fact that there is currently no single location technology available that is both sufficiently fast accurate and accessible in substantially all terrains to meet the location needs of an MBS . For example in many terrains GPS technologies may be sufficiently accurate however GPS technologies a may require a relatively long time to provide an initial location estimate e.g. greater than 2 minutes b when GPS communication is disturbed it may require an equally long time to provide a new location estimate c clouds buildings and or mountains can prevent location estimates from being obtained d in some cases signal reflections can substantially skew a location estimate. As another example an MBS may be able to use triangulation or trilateralization technologies to obtain a location estimate however this assumes that there is sufficient fixed location infrastructure BS coverage in the area the MBS is located. Further it is well known that the multipath phenomenon can substantially distort such location estimates. Thus for an MBS to be highly effective in varied terrains an MBS is provided with a plurality of location technologies each supplying an MBS location estimate.

In fact much of the architecture of the location engine could be incorporated into an MBS . For example in some embodiments of the MBS the following FOMs may have similar location models incorporated into the MBS 

However for those MBS location models requiring communication with the base station infrastructure an alternative embodiment is to rely on the location center to perform the computations for at least some of these MBS FOM models. That is since each of the MBS location models mentioned immediately above require communication with the network of fixed location BS s it may be advantageous to transmit MBS location estimating data to the location center as if the MBS were another MS for the location center to locate and thereby rely on the location estimation capabilities at the location center rather than duplicate such models in the MBS . The advantages of this approach are that 

As will be discussed further below in one embodiment of the MBS there are confidence values assigned to the locations output by the various location estimators . Thus the confidence for a manual entry of location data by an MBS operator may be rated the highest and followed by the confidence for any GPS location data followed by the confidence for any location center location estimates followed by the confidence for any location estimates using signal characteristic data from LBSs. However such prioritization may vary depending on for instance the radio coverage area . In an one embodiment of the present invention it is an aspect of the present invention that for MBS location data received from the GPS and location center their confidences may vary according to the area in which the MBS resides. That is if it is known that for a given area there is a reasonable probability that a GPS signal may suffer multipath distortions and that the location center has in the past provided reliable location estimates then the confidences for these two location sources may be reversed.

In one embodiment of the present invention MBS operators may be requested to occasionally manually enter the location of the MBS when the MBS is stationary for determining and or calibrating the accuracy of various MBS location estimators.

There is an additional important source of location information for the MBS that is incorporated into an MBS vehicle such as a police vehicle that has no comparable functionality in the network of fixed location BS s. That is the MBS may use deadreckoning information provided by a deadreckoning MBS location estimator whereby the MBS may obtain MBS deadreckoning location change estimates. Accordingly the deadreckoning MBS location estimator may use for example an on board gyroscope a wheel rotation measurement device e.g. odometer and optionally an accelerometer not shown . Thus such a deadreckoning MBS location estimator periodically provides at least MBS distance and directional data related to MBS movements from a most recent MBS location estimate. More precisely in the absence of any other new MBS location information the deadreckoning MBS location estimator outputs a series of measurements wherein each such measurement is an estimated change or delta in the position of the MBS between a request input timestamp and a closest time prior to the timestamp wherein a previous deadreckoning terminated. Thus each deadreckoning location change estimate includes the following fields 

Further the frequency of such measurements provided by the deadreckoning subsystem may be adaptively provided depending on the velocity of the MBS and or the elapsed time since the most recent MBS location update. Accordingly the architecture of at least some embodiments of the MBS location subsystem must be such that it can utilize such deadreckoning information for estimating the location of the MBS .

In one embodiment of the MBS location subsystem described in further detail hereinbelow the outputs from the deadreckoning MBS location estimator are used to synchronize MBS location estimates from different MBS baseline location estimators. That is since such a deadreckoning output may be requested for substantially any time from the deadreckoning MBS location estimator such an output can be requested for substantially the same point in time as the occurrence of the signals from which a new MBS baseline location estimate is derived. Accordingly such a deadreckoning output can be used to update other MBS location estimates not using the new MBS baseline location estimate.

It is assumed that the error with dead reckoning increases with deadreckoning distance. Accordingly it is an aspect of the embodiment of the MBS location subsystem that when incrementally updating the location of the MBS using deadreckoning and applying deadreckoning location change estimates to a most likely area in which the MBS is believed to be this area is incrementally enlarged as well as shifted. The enlargement of the area is used to account for the inaccuracy in the deadreckoning capability. Note however that the deadreckoning MBS location estimator is periodically reset so that the error accumulation in its outputs can be decreased. In particular such resetting occurs when there is a high probability that the location of the MBS is known. For example the deadreckoning MBS location estimator may be reset when an MBS operator manually enters an MBS location or verifies an MBS location or a computed MBS location has sufficiently high confidence.

Thus due to the MBS having less accurate location information both about itself and a target MS and further that deadreckoning information must be utilized in maintaining MBS location estimates a first embodiment of the MBS location subsystem architecture is somewhat different from the location engine architecture. That is the architecture of this first embodiment is simpler than that of the architecture of the location engine . However it important to note that at a high level the architecture of the location engine may also be applied for providing a second embodiment of the MBS location subsystem as one skilled in the art will appreciate after reflecting on the architectures and processing provided at an MBS . For example an MBS location subsystem architecture may be provided that has one or more first order models whose output is supplied to for example a blackboard or expert system for resolving MBS location estimate conflicts such an architecture being analogous to one embodiment of the location engine architecture.

Furthermore it is also an important aspect of the present invention that at a high level the MBS location subsystem architecture may also be applied as an alternative architecture for the location engine . For example in one embodiment of the location engine each of the first order models may provide its MS location hypothesis outputs to a corresponding location track analogous to the MBS location tracks described hereinbelow and subsequently a most likely MS current location estimate may be developed in a current location track also described hereinbelow using the most recent location estimates in other location tracks. Thus the location estimating models of the location center and those of the MBS are may be interchanged depending on the where it is deemed most appropriate for such each such model to reside. Additionally note that in different embodiments of the present invention various combinations of the location center location architecture and the mobile station architecture may be utilized at either the location center or the MBS . Thus by providing substantially all location estimating computational models at the location center the models described here for locating the MBS and equivalently its incorporated MS can be used for locating other MSs that are be capable of supporting transmission of wireless signal measurements that relate to models requiring the additional electronics available at the MBS e.g. GPS or other satellite signals used for location .

Further note that the ideas and methods discussed here relating to MBS location estimators and MBS location tracks and the related programs hereinbelow are sufficiently general so that these ideas and methods may be applied in a number of contexts related to determining the location of a device capable of movement and wherein the location of the device must be maintained in real time. For example the present ideas and methods may be used by a robot in a very cluttered environment e.g. a warehouse wherein the robot has access a to a plurality of robot location estimators that may provide the robot with sporadic location information and b to a deadreckoning location estimator.

Each MBS additionally has a location display denoted the MBS operator visual user interface in where area maps that may be displayed together with location data. In particular MS location data may be displayed on this display as a nested collection of areas each smaller nested area being the most likely area within any encompassing area for locating a target MS . Note that the MBS controller algorithm below may be adapted to receive location center data for displaying the locations of other MBSs as well as target MSs .

Further the MBS may constrain any location estimates to streets on a street map using the MBS location snap to street module . For example an estimated MBS location not on a street may be snapped to a nearest street location. Note that a nearest street location determiner may use normal orientations of vehicles on streets as a constraint on the nearest street location. Particularly if an MBS is moving at typical rates of speed and acceleration and without abrupt changes direction. For example if the deadreckoning MBS location estimator indicates that the MBS is moving in a northerly direction then the street snapped to should be a north south running street. Moreover the MBS location snap to street module may also be used to enhance target MS location estimates when for example it is known or suspected that the target MS is in a vehicle and the vehicle is moving at typical rates of speed. Furthermore the snap to street location module may also be used in enhancing the location of a target MS by either the MBS or by the location engine . In particular the location estimator or an additional module between the location estimator and the output gateway may utilize an embodiment of the snap to street location module to enhance the accuracy of target MS location estimates that are known to be in vehicles. Note that this may be especially useful in locating stolen vehicles that have embedded wireless location transceivers MSs wherein appropriate wireless signal measurements can be provided to the location center .

Assuming the existence of at least some of the location estimators that were mentioned above the discussion here refers substantially to the data structures and their organization as illustrated in .

The location estimates or hypotheses for an MBS determining its own location each have an error or range estimate associated with the MBS location estimate. That is each such MBS location estimate includes a most likely MBS point location within a most likely area . The most likely MBS point location is assumed herein to be the centroid of the most likely area. In one embodiment of the MBS location subsystem a nested series of most likely areas may be provided about a most likely MBS point location. However to simplify the discussion herein each MBS location estimate is assumed to have a single most likely area . One skilled in the art will understand how to provide such nested most likely areas from the description herein. Additionally it is assumed that such most likely areas are not grossly oblong i.e. area cross sectioning lines through the centroid of the area do not have large differences in their lengths. For example for any such most likely area A no two such cross sectioning lines of A through the centroid thereof may have lengths that vary by more than a factor of five.

Each MBS location estimate also has a confidence associated therewith providing a measurement of the perceived accuracy of the MBS being in the most likely area of the location estimate.

A MBS location track is an data structure or object having a queue of a predetermined length for maintaining a temporal timestamp ordering of location track entries such as the location track entries and wherein each such MBS location track entry is an estimate of the location of the MBS at a particular corresponding time.

There is an MBS location track for storing MBS location entries obtained from MBS location estimation information from each of the MBS baseline location estimators described above i.e. a GPS location track for storing MBS location estimations obtained from the GPS location estimator a location center location track for storing MBS location estimations obtained from the location estimator deriving its MBS location estimates from the location center an LBS location track for storing MBS location estimations obtained from the location estimator deriving its MBS location estimates from base stations and or and a manual location track for MBS operator entered MBS locations . Additionally there is one further location track denoted the current location track whose location track entries may be derived from the entries in the other location tracks described further hereinbelow . Further for each location track there is a location track head that is the head of the queue for the location track. The location track head is the most recent and presumably the most accurate MBS location estimate residing in the location track. Thus for the GPS location track has location track head the location center location track has location track head the LBS location track has location track head the manual location track has location track head and the current location track has location track head . Additionally for notational convenience for each location track the time series of previous MBS location estimations i.e. location track entries in the location track will herein be denoted the path for the location track. Such paths are typically the length of the location track queue containing the path. Note that the length of each such queue may be determined using at least the following considerations 

For each MBS location track there are two categories of MBS location track entries that may be inserted into a MBS location track 

In order to be able to properly compare the track heads to determine the most likely MBS location estimate it is an aspect of the present invention that the track heads of all location tracks include MBS location estimates that are for substantially the same latest timestamp. However the MBS location information from each MBS baseline location estimator is inherently substantially unpredictable and unsynchronized. In fact the only MBS location information that may be considered predicable and controllable is the deadreckoning location change estimates from the deadreckoning MBS location estimator in that these estimates may reliably be obtained whenever there is a query from the location controller for the most recent estimate in the change of the location for the MBS . Consequently referring to synchronization records having at least a portion and in some cases also having a portion may be provided for updating each location track with a new MBS location estimate as a new track head. In particular each synchronization record includes a deadreckoning location change estimate to be used in updating all but at most one of the location track heads with a new MBS location estimate by using a deadreckoning location change estimate in conjunction with each MBS location estimate from an MBS baseline location estimator the location track heads may be synchronized according to timestamp. More precisely for each MBS location estimate E from an MBS baseline location estimator the present invention also substantially simultaneously queries the deadreckoning MBS location estimator for a corresponding most recent change in the location of the MBS . Accordingly E and the retrieved MBS deadreckoning location change estimate C have substantially the same latest timestamp . Thus the location estimate E may be used to create a new baseline track head for the location track having the corresponding type for E and C may be used to create a corresponding extrapolation entry as the head of each of the other location tracks. Accordingly since for each MBS location estimate E there is a MBS deadreckoning location change estimate C having substantially the same latest timestamp E and C will be hereinafter referred as paired. 

Such wireless location applications as were briefly described above in reference to the gateway will now be described in further detail. Note that the following location related services are considered within the scope of the invention and such services can in general be provided without use of a gateway albeit e.g. in a likely more restricted context wherein not all available wireless location estimating techniques are utilized and or by multiplying the number of interfaces to geolocation service providers e.g. distinct wireless location interfaces are provided directly to each wireless location service provider utilized .

In one noteworthy routing application hotels and other personal service providers such as auto rental agencies hotels resorts and cruise ships may provide an inexpensive MS that can be used substantially only for contacting i the personal service ii emergency services and or iii receiving directions to return to the personal service. Accordingly the MS may be wirelessly located during operations ii and iii via wireless communications between the MS and a local commercial wireless service provider wherein a request to locate the MS is provided to e.g. the gateway and the resulting MS location estimate is provided to a public safety emergency center e.g. E911 for dispatching emergency services or provided to a mapping and routing system such as provided by MapInfo or disclosed in the LeBlanc et. al. patent application filed Jan. 22 1999 and having U.S. Pat. No. 6 236 365 which is fully incorporated herein by reference so that the MS user may be routed safely and expeditiously to a predetermined location of the personal service. Note that data representing the location of the personal service can be associated with an identification of the MS so that MS activation for iii above results in one or more audio and or visual presentations of directions for directing the user to return to the personal service.

The MS and the MS location providing wireless network e.g. a CMRS a PSTN or the Internet may also provide the MS user with the ability to explicitly request to be substantially continuously tracked wherein the MS tracked locations are stored for access by those having permission e.g. the user parents and or associates of the user . Additionally the velocity and or expected time of arrival at a predetermined destination may be derived from such tracking and may be provided to the user or his her associates e.g. employer friends and or family . Further note that this tracking and notification of information obtained therefrom may be provided via a commercial telephony or Internet enabled mobile station or a mobile station in operable communication with a short messaging service. For example the MS registered owner may provide permissions for those able to access such MS tracking information so that such information can be automatically provided to certain associates and or provided on request to certain associates. Additionally note that the MS and the MS location providing wireless network may also allow the MS user to deactivate such MS tracking functionality. In one embodiment an MS user may activate such tracking for his her MS during working hours and deactivate such tracking during non working hours. Accordingly an employer can then track employee s whereabouts during work hours while the employee is able to retain his her location privacy when not working although the employer may be still able to contact the employee in case of an emergency during the employee s non working time. Note that this location capability and method of obtaining location information about an MS user while assuring privacy at other times may be useful for appropriately monitoring in personnel in the military hospitals transportation services e.g. for couriers bus and taxis drivers telecommunications personnel emergency rescue and correctional institution personnel. Further note that this selective MS location capability may be performed in a number of ways. For example the MS may activate and deactivate such tracking by dialing a predetermined number e.g. by manually or speed dialing the number for switching between activation of a process that periodically requests a wireless location of the MS from e.g. the location gateway . Note that the resulting MS location information may be made available to other users at a predetermined phone number Internet address or having sufficient validation information e.g. a password . Alternatively the MS location providing wireless network may automatically activate such MS tracking for predetermined times of the day and for predetermined days of the week. Note that this latter embodiment may be particularly useful for both tracking employees e.g. at large construction sites and e.g. determining when each employee is at his her work site. Thus in this embodiment the MS location providing wireless network may provide database storage of times and days of the week for activation and deactivation of this selective MS tracking capability that is accessible via e.g. a network service control point or other telephony network control points as one skilled in the art will understand wherein triggers may be provided within the database for generating a network message to e.g. the gateway requesting the commencement of tracking the MS or the deactivation of such tracking. Accordingly the resulting MS location information may be provided to an employer s tracking and payroll system so that the employer is able to determine the actual time an employee arrives at and leaves a work location site.

In another routing related application of the present invention an MS and the MS location providing wireless network may provide the MS user with functionality to register certain locations so that data representing such locations can be easily accessed for use at a later time. For example the MS user may be staying at a hotel in an unfamiliar area. Accordingly using the present capability of the invention the user can request via his her MS that his her location at the hotel be determined and registered so that it is available at a later time for routing the user back to the hotel. In fact the user may have personal location registrations of a plurality of locations in various cities and countries so that when traveling the user has wireless access to directions to preferred locations such as his her hotel preferred restaurants shopping areas scenic areas rendezvous points theatres athletic events churches entertainment establishments locations of acquaintances etc. Note that such personal location registration information may reside primarily on the user s subscriber network but upon the MS user s request his her personal location registrations may be transmitted to another network from which the user is receiving wireless services as a roamer. Moreover any new location registrations or deletions may be duplicated in the user s personal registration of the user s subscriber network. However in some instances an MS user may wish to retain such registered locations only temporarily while the user is in a particular area e.g. a predetermined network coverage area. Accordingly the MS user may indicate or such may be the default that a new personal location registration be retained for a particular length of time and or until a location of the user is outside the area to which such new location registrations appear to be applicable. However prior to deleting any such registrations the MS user may be queried to confirm such deletions. For example if the MS user has new location registrations for the Dallas Tex. area and the MS user subsequently travels to London then upon the first wireless location performed by the MS user for location registration services the MS user may be queried as whether to save the new Dallas Tex. location registrations permanently for an particular length of time e.g. 30 days or delete all or selected portions thereof.

Other routing related applications of the present invention are for security e.g. tracking how do I get back to my hotel safely and e.g. sight seeing guided tour where there is interactivity depending on feedback from users.

Advertising may be directed to an MS according to its location. In at least some studies it is believed that MS users do not respond well to unsolicited wireless advertisement whether location based or otherwise. However in response to certain user queries for locally available merchandise certain advertisements may be viewed as more friendly. Thus by allowing an MS user to contact e.g. a wireless advertising portal by voice or via wireless Internet and describe certain products or services desired e.g. via interacting with an automated speech interaction unit the user may be able to describe and receive at his her MS audio and or visual presentations of such products or services that may satisfy such a user s request. For example a user may enter a request I need a Hawaiian shirt who has such shirts near here 

In the area of advertising the present invention has advantages both for the MS user as well as the wireline user and for product and service providers that are nearby to the MS user. For instance an MS user may be provided with or request a default set of advertisements for an area when the MS user enters the area registers with a hotel in the area or makes a purchase in the area and or requests information about a particular product or service in the area. Moreover there may be different collections of advertisements for MS users that are believed to have different demographic profiles and or purposes for being in the area. Accordingly an MS whose location is being determined periodically may be monitored by an advertisement wizard such that this wizard may maintain a collection of the MS user s preferences and needs so that when the MS user comes near a business that can satisfy such a preference or need then an advertisement relating to the fulfillment of the preference or need may be presented to the MS user. However it is an aspect of the invention that such potential advertising presentations be intelligently selected using as much information about the user as is available. In particular in one embodiment of the invention MS user preferences and needs may be ordered according to importance. Moreover such user preferences and needs may be categorized by temporal importance i.e. must be satisfied within a particular time frame e g immediately today or next month and by situational importance wherein user preferences and needs in this category are less time critical e.g. do not have to be satisfied immediately and or within a specified time period but if certain criteria are met the user will consider satisfying such a preference or need. Thus finding a Chinese restaurant for dinner may be in the temporal importance category while purchasing a bicycle and a new pair of athletic shoes may be ordered as listed here in the situational category. Accordingly advertisements for Chinese restaurants may be provided to the user at least partially dependent upon the user s location. Thus once such a restaurant is selected and routing directions are determined then the advertising wizard may examine advertisements or other available product inventories and or services that are within a predetermined distance of the route to the restaurant for determining whether there is product or service along the route that could potentially satisfy one of the user s preferences or needs from the situational importance category. If so then the MS user may be provided with the option of examining such product or service information and registering the locations of user selected businesses providing such products or services. Accordingly the route to the restaurant may be modified to incorporate detours to one or more of these selected businesses. Of course an MS user s situationally categorized preferences and needs may allow the MS user to receive unrequested advertising during other situations as well. Thus whenever an MS user is moving such an advertisement wizard e.g. if activated by the user may attempt to satisfy the MS user s preferences and needs by presenting to the user advertisements of nearby merchants that appear to be directed to such user preferences and needs.

Accordingly for MS user preferences and needs the wizard will attempt to present information e.g. advertisements coupons discounts product price and quality comparisons related to products and or services that may satisfy the user s corresponding preference or need a within the time frame designated by the MS user when identified as having a temporal constraint and or b consistent with situational criteria provided by the MS user e.g. item on sale item is less than a specified amount within a predetermined traveling distance and or traveling time when identified as having a situational constraint. Moreover such information may be dependent on the geolocation of both the user and a merchant s having such products and or services. Additionally such information may be dependent on a proposed or expected user route e.g. a route to work a trip route . Thus items in the temporal category are ordered according to how urgent must a preference or need must be satisfied while items in the situational category may be substantially unordered and or ordered according to desirableness e.g. an MS user might want a motorcycle of a particular make and maximum price but want a new car more . However since items in the situational category may be fulfilled by substantially serendipitous circumstances detected by the wizard various orderings or no ordering may be used. Thus e.g. if the MS user travels from one commercial area to another the wizard may compare a new collection of merchant products and or services against the items on an MS user s temporal and situational lists and at least alert the MS user that there may be new information available about a user desired service or product which is within a predetermined traveling time from where the user is. Note that such alerts may be visual e.g. textual or iconic displays or audio presentations using e.g. synthesized speech such as Discounted motorcycles ahead three blocks at Cydes Cycles .

Note that the advertising aspects of the present invention may be utilized by an intelligent electronic yellow pages which can utilize the MS user s location and or anticipated locations e.g. due to roadways being traversed together with user preferences and needs as well as other constraints to both intelligently respond to user requests as well as intelligently anticipate user preferences and needs. A block diagram showing the high level components of an electronic yellow pages according to this aspect of the present invention is shown in . Accordingly in one aspect of the present invention advertising is user driven in that the MS user is able to select advertising based on attributes such as merchant proximity traffic parking conditions the product service desired quality ratings price user merchant preferences product service availability coupons and or discounts. That is the MS user may be able to determine an ordering of advertisements presented based on e.g. his her selection inputs for categorizing such attributes. For example the MS user may request advertisements of athletic shoes be ordered according to the following values a within 20 minutes travel time of the MS user s current location b midrange in price c currently in stock and d no preferred merchants. Note that in providing advertisements according to the MS user s criteria the electronic yellow pages may have to make certain assumptions such as if the MS user does not specify a time for being at the merchant the electronic yellow pages may default the time to a range of times somewhat longer than the travel time thereby going on the assumption that MS user will likely be traveling to an advertised merchant relatively soon. Accordingly the electronic yellow pages may also check stored data on the merchant e.g. in the merchant profile location database of to assure that the MS user can access the merchant once the MS user arrives at the merchant s location e.g. that the merchant is open for business . Accordingly the MS user may dynamically and in real time vary such advertising selection parameters for thereby substantially immediately changing the advertising being provided to the user s MS. For example the MS display may provide an area for entering an identification of a product service name wherein the network determines a list of related or complementary products services. Accordingly if an MS user desires to purchase a wedding gift and knows that the couple to be wed are planning a trip to Australia then upon the MS user providing input in response to activating a related products services feature and then inputting e.g. trip to Australia as well as any other voluntary information indicating that the purchase is for a gift for a wedding and or a price of less than 100.00 then the intelligent yellow pages may be able to respond with advertisements for related products services such as portable electric power converter for personal appliances that is available from a merchant local and or non local to the MS user. Moreover such related products services and or suggestion functionality may be interactive with the MS user. For example there may be a network response to the MS user s above gift inquiry such as type of gift conventional or unconventional . Moreover the network may inquire as to the maximum travel time or distance the MS user is willing to devote to finding a desired product service and or the maximum travel time or distance the MS user is willing to devote to visiting any one merchant. Note that in one embodiment of the electronic yellow pages priorities may be provided by the MS user as to a presentation ordering of advertisements wherein such ordering may be by price

Note that various aspects of such an electronic yellow pages described herein are not constrained to using the MS user s location. In general the MS user s location is but one attribute that can be intelligently used for providing users with targeted advertising and importantly advertising that is perceived as informative and or addresses current user preferences and needs. Accordingly such electronic yellow page aspects of the present invention that are not related to a change in the MS user s location over time also apply to stationary communication stations such home computers wherein e.g. such electronic yellow pages are accessed via the Internet. Additionally the MS user may be able to adjust e.g. via iconic selection switches e.g. buttons or toggles and icon range specifiers e.g. slider bars the relevancy and a corresponding range for various purchasing criteria. In particular once a parameter is indicated as relevant e.g. via activating a toggle switch a slider bar may be used for indicating a relative or absolute value for the parameter. Thus parameter values may be for product service quality ratings e.g. display given to highest quality price low comparable price to high comparable price travel time maximum estimated time to get to merchant parking conditions.

The following is a high level description of some of the components shown in of an illustrative embodiment of the electronic yellow pages of the present invention.

When an MS appears to be traveling an extended distance through a plurality of areas as determined e.g. by recent MS locations along an interstate that traverse a plurality of areas then upon entering each new area having a new collection of location registrations and possibly a new location registration wizard may be provided. For example a new default set of local location registrations may become available to the user. Accordingly the user may be notified that new temporary location registrations are available for the MS user to access if desired. For example such notification may be a color change on a video display indicating that new temporary registrations are available. Moreover if the MS user has a personal profile that also is accessible by a location registration wizard then the wizard may provide advertising for local businesses and services that are expected to better meet the MS user s tastes and needs. Thus if such a wizard knows that the MS user prefers fine Italian food but does not want to travel more than 20 minutes by auto from his her hotel to reach a restaurant then advertisements for restaurants satisfying such criteria will become available to the user. However MS users may also remain anonymous to such wizards.

Note that by retaining MS user preferences and needs if permission is provided e.g. for anonymously capturing such user information this information could be provided to merchants. Thus merchants can get an understanding of what nearby MS user s would like to purchase and under what conditions e.g. an electric fan for less than 10 . Note such user s may be traveling through the area or user s may live nearby. Accordingly it is a feature of the present invention to provide merchant s with MS user preferences and needs according to whether the MS user is a passerby or lives nearby so that the merchant can better target his her advertising.

In one embodiment a single wizard may be used over the coverage area of a CMRS and the database of local businesses and services changes as the MS user travels from one location registration area to another. Moreover such a wizard may determine the frequency and when requests for MS locations are provided to the gateway . For example such databases of local businesses and services may be coincident with LATA boundaries. Additionally the wizard may take into account the direction and roadway the MS is traveling so that e.g. only businesses within a predetermined area and preferably in the direction of travel of the MS are candidates to have advertising displayed to the MS user.

Flowcharts for Routing Applications. The flowchart of is illustrative of the steps performed when e.g. MS user input of preferences and needs is iteratively examined at various user locations for determining the location s that sufficiently satisfy user specified constraints e.g. temporal or situational constraints so that the user is alerted or notified of products and or services that satisfy the user s input.

The invention can used for sight seeing guided tours where the invention is interactive depending on feedback from users. Such interactivity being both verbal descriptions and directions to points of interest.

The invention may provide Internet picture capture with real time voice capture and location information for sightseeing and or security.

The foregoing description of preferred embodiments of the present invention has been provided for the purposes of illustration and description. It is not intended to be exhaustive or to limit the invention to the precise forms disclosed herein. Modifications and variations commensurate with the description herein will be apparent those skilled in the art and are intended to be within the scope of the present invention to the extent permitted by the relevant art. The embodiments provided are for enabling others skilled in the art to understand the invention its various embodiments and modifications as are suited for uses contemplated. It is intended that the scope of the invention protected herein be defined by the following claims and their equivalents.

